{
    "docs": [
        {
            "location": "/", 
            "text": "Citrix StoreFront SDK\n\n\nThis SDK documents include following components \n\n\n\n\nStoreFront Web API \n\n\nStoreFront authentication SDK StoreFront\n\n\nCustomization SDK\n\n\n\n\nPlease find the content details in navigation bar.", 
            "title": "Overview"
        }, 
        {
            "location": "/#citrix-storefront-sdk", 
            "text": "This SDK documents include following components    StoreFront Web API   StoreFront authentication SDK StoreFront  Customization SDK   Please find the content details in navigation bar.", 
            "title": "Citrix StoreFront SDK"
        }, 
        {
            "location": "/overview/", 
            "text": "Overview of the Citrix Receiver for Web\n\n\nCitrix Receiver for Web is a component of Citrix StoreFront. Citrix Receiver for Web provides access to IT resources such as Windows apps, desktops, documents, Web apps and SaaS apps, all using the Web. Citrix Receiver for Web comprises a User Interface tier (referred to as the UI tier) and a Citrix StoreFront Services Web Proxy tier (referred to as the Web Proxy). The Citrix Receiver for Web architecture is illustrated below.\n\n\n\n\nUI tier\n\n\nThe UI tier is responsible for displaying the Citrix Receiver for Web user interface and responding to user interactions. The UI tier is implemented using JavaScript/Ajax technology, loaded to and executed at the Web browser. It is divided into three areas:\n\n\n\n\nPlugin Assistant\u2014detects whether the native HDX engine is installed and provides UI for downloading Citrix Receiver.\n\n\nAuthentication\u2014deals with authentication matters; for example, log on, change password, and log off.\n\n\nStore\u2014responsible for the main Citrix Receiver for Web functionality, such as store browsing, search, subscription, launch, workspace control, etc.\n\n\n\n\nWeb Proxy tier\n\n\nThe Web Proxy is a bridge between the UI tier and Citrix StoreFront Services. The Web Proxy provides a simplified API to Citrix StoreFront Services suitable for consumption by a JavaScript/Ajax client running in a Web browser. The Web Proxy comprises of two parts: a Web Auth Manager and a Store Proxy, which are hosted in a single Web app.\n\n\n\n\nThe \nWeb Auth Manager\n provides support for the UI tier to authenticate users. It also manages the authentication tokens used by the Store Proxy when communicating with the Citrix StoreFront Store Service. The authentication tokens issued by the Authentication Service are kept at the Web Proxy and are not passed to the UI tier. Instead, the Web Auth Manager maps browser cookies (i.e. HTTP sessions) to authentication tokens, shielding the client from some of the complexity of the Citrix StoreFront authentication process.\n\n\nThe \nStore Proxy\n provides an API for the UI tier to access resources supplied by the Citrix StoreFront Store Service. It also provides optimizations for Web access; for example, persistent icon caching, combining some Store Service operations and converting resource information from XML to JSON.\n\n\n\n\nMany of the facilities available through the Store Service API are also available through the Web Proxy, which typically proxies requests through to the Store Service (supplying requisite authentication tokens) and transforming responses into JavaScript-friendly JSON representation, as appropriate. The main operations available through the Web Proxy include:\n\n\n\n\nAuthenticating users through a variety of mechanisms: explicit forms, domain pass- through, smart card, gateway single sign-on, and post credentials.\n\n\nEnumeration of resources from a single Citrix StoreFront Store Service. This may itself aggregate resources from various servers, with load-balancing and failover support for XenApp and XenDesktop sites with multiple controllers.\n\n\nLaunching apps or desktops remotely using the ICA protocol.\n\n\nLaunching desktops remotely using the RDP protocol.\n\n\nLaunching SaaS and Web apps published on App Controller, using single sign-on.\n\n\nPowering-off specific XenDesktop desktops.\n\n\nRetrieving images and icons for resources.\n\n\nSubscribing to resources, allowing different clients to store data associated with a subscribed resource.\n\n\nEnumerating available user sessions and session-related operations: reconnect, disconnect and logoff.", 
            "title": "Overview"
        }, 
        {
            "location": "/overview/#overview-of-the-citrix-receiver-for-web", 
            "text": "Citrix Receiver for Web is a component of Citrix StoreFront. Citrix Receiver for Web provides access to IT resources such as Windows apps, desktops, documents, Web apps and SaaS apps, all using the Web. Citrix Receiver for Web comprises a User Interface tier (referred to as the UI tier) and a Citrix StoreFront Services Web Proxy tier (referred to as the Web Proxy). The Citrix Receiver for Web architecture is illustrated below.", 
            "title": "Overview of the Citrix Receiver for Web"
        }, 
        {
            "location": "/overview/#ui-tier", 
            "text": "The UI tier is responsible for displaying the Citrix Receiver for Web user interface and responding to user interactions. The UI tier is implemented using JavaScript/Ajax technology, loaded to and executed at the Web browser. It is divided into three areas:   Plugin Assistant\u2014detects whether the native HDX engine is installed and provides UI for downloading Citrix Receiver.  Authentication\u2014deals with authentication matters; for example, log on, change password, and log off.  Store\u2014responsible for the main Citrix Receiver for Web functionality, such as store browsing, search, subscription, launch, workspace control, etc.", 
            "title": "UI tier"
        }, 
        {
            "location": "/overview/#web-proxy-tier", 
            "text": "The Web Proxy is a bridge between the UI tier and Citrix StoreFront Services. The Web Proxy provides a simplified API to Citrix StoreFront Services suitable for consumption by a JavaScript/Ajax client running in a Web browser. The Web Proxy comprises of two parts: a Web Auth Manager and a Store Proxy, which are hosted in a single Web app.   The  Web Auth Manager  provides support for the UI tier to authenticate users. It also manages the authentication tokens used by the Store Proxy when communicating with the Citrix StoreFront Store Service. The authentication tokens issued by the Authentication Service are kept at the Web Proxy and are not passed to the UI tier. Instead, the Web Auth Manager maps browser cookies (i.e. HTTP sessions) to authentication tokens, shielding the client from some of the complexity of the Citrix StoreFront authentication process.  The  Store Proxy  provides an API for the UI tier to access resources supplied by the Citrix StoreFront Store Service. It also provides optimizations for Web access; for example, persistent icon caching, combining some Store Service operations and converting resource information from XML to JSON.   Many of the facilities available through the Store Service API are also available through the Web Proxy, which typically proxies requests through to the Store Service (supplying requisite authentication tokens) and transforming responses into JavaScript-friendly JSON representation, as appropriate. The main operations available through the Web Proxy include:   Authenticating users through a variety of mechanisms: explicit forms, domain pass- through, smart card, gateway single sign-on, and post credentials.  Enumeration of resources from a single Citrix StoreFront Store Service. This may itself aggregate resources from various servers, with load-balancing and failover support for XenApp and XenDesktop sites with multiple controllers.  Launching apps or desktops remotely using the ICA protocol.  Launching desktops remotely using the RDP protocol.  Launching SaaS and Web apps published on App Controller, using single sign-on.  Powering-off specific XenDesktop desktops.  Retrieving images and icons for resources.  Subscribing to resources, allowing different clients to store data associated with a subscribed resource.  Enumerating available user sessions and session-related operations: reconnect, disconnect and logoff.", 
            "title": "Web Proxy tier"
        }, 
        {
            "location": "/how-the-api-works/", 
            "text": "How the API works\n\n\nThis topic describes the behavior of the StoreFront Web API including authentication behavior, cookies, localization specifics, release compatibility and URL discovery.\n\n\nAuthentication challenge\n\n\nSome Web Proxy URLs are protected and require authentication information to allow access. If the required authentication information is not present, the Web Proxy returns an empty response (HTTP status code 200) with the following HTTP header:\n\n\nCitrixWebReceiver-Authenticate: reason=\nTokenRequired\n,\nlocation=\nAuthentication/GetAuthMethods\n\n\n\n\nThe location value in the challenge specifies a URL that the client requests (via Ajax) to determine which authentication methods are available. The challenge may contain an additional attribute \nmode=Redirect\n, which triggers the client to redirect to a 3rd party page instead to perform the authentication step.\n\n\nEven after the user has authenticated, a challenge may be returned. For example, if the user's Web Proxy session has terminated for any reason, the \nASP.NET_SessionId cookie\n is absent from the client request, or if the StoreFront credential wallet service has restarted.\n\n\nTherefore, the client must be prepared to respond to such an authentication challenge at any time by prompting the user to re-authenticate to the site.\n\n\nClient Name, Client Address and Device Id\n\n\nWhen the Web Proxy communicates with certain Store Service APIs, it supplies values for client name, client address and device id. These values are required for workspace control to function correctly. It is important that the Web Proxy passes consistent data for these parameters to all Store Services that take these parameters.\n\n\nClient name specifies the hostname of the client machine and device id specifies a value unique to the client device. Since a typical browser-based client has limited access to the client OS and cannot determine the hostname, the Web Proxy automatically generates a random string value to use for both client name and device id. This value is returned to the client as a persistent cookie, named CtxsDeviceId, in a successful response (HTTP status 200) to a resource enumeration. It is expected that this cookie is returned by the client in subsequent requests.\n\n\nClient address identifies the client IP address. This may be used on some XenApp/ XenDesktop systems to determine if a client should be presented with a particular resource. The Web Proxy automatically determines the client address from the Microsoft ASP.NET API \nHttpRequest.UserHostAddress\n, which returns the IP address of the client as seen at the web server. This may not be the actual client address; for example, if connecting through a NetScaler Gateway or other proxy server.\n\n\nIf multiple web browsers connect to a Citrix Receiver for Web site from the same client machine, a different (random) value for the CtxsDeviceId cookie is returned to each browser to represent the client name and device id. This results in the sessions being treated by the Store Services as running on separate devices. This may lead to apps disappearing and reappearing when performing session operations; for example, querying and reconnecting to sessions.\n\n\nCookies\n\n\nThe Web Proxy sets a number of cookies as outlined in the table below. The client must return the cookies in subsequent requests, as indicated by the cookie life time.\n\n\n\n\n\n\n\n\nCookie\n\n\nLife time\n\n\nHttpOnly\n\n\nWhen Set\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nASP.NET_SessionId\n\n\nSession\n\n\nYes\n\n\nFirst response from Web Proxy\n\n\nASP.NET session id, represents the web session between client and Web Proxy.\n\n\n\n\n\n\nCtxsAuthId\n\n\nSession\n\n\nYes\n\n\nResponse indicating successful authentication\n\n\nProtects against session fixation attacks\n\n\n\n\n\n\nCsrfToken\n\n\nSession\n\n\nNo\n\n\nFirst response from Web Proxy\n\n\nProtects against cross- site request forgery attacks\n\n\n\n\n\n\nCtxsDeviceId\n\n\nPersistent, 2 years\n\n\nYes\n\n\nResponse indicating successful resource enumeration\n\n\nSpecifies the value to use for client name and device id (see above)\n\n\n\n\n\n\n\n\nHTTPS indicator to secure cookies\n\n\nUnless specified otherwise, the Web Proxy API requires the client to indicate whether it is using an HTTPS connection or not by supplying a header named \nX-Citrix- IsUsingHTTPS\n with value \"Yes\" or \"No\". When the value is set to \"Yes\", the Web Proxy sets the Secure attribute for all cookies that it generates to protect them from being viewed from non-HTTPS connections. This caters for NetScaler Gateway scenarios where the connection from the browser to the gateway is over HTTPS but the connection from the gateway to the internal Citrix Receiver for Web site (where the Web Proxy runs) is HTTP.\n\n\nCross-site request forgery token\n\n\nTo protect against cross-site request forgery (CSRF) attacks, the Web Proxy APIs require that a CSRF token be supplied by the client, unless specified otherwise. This is a random string generated by the Web Proxy for the duration of the session and communicated to the client using a session cookie. Clients must read the value of this cookie and send it back to the Web Proxy in most API calls, as either the value of a header named Csrf-Token (note the hyphen) for POST requests, or as the value of a query string parameter named CsrfToken for GET requests.\n\n\nLocalization\n\n\nGenerally, the Web Proxy does not return user-facing strings to display in a UI. However, the authentication process uses the Citrix Common Forms protocol to obtain a definition of the logon form (amongst other forms), which typically includes strings for UI controls (for example, a \"Username: \" label or \"Log On\" button). The value specified in the Accept-Language HTTP header is used to determine the language for such strings. This value is also reflected back to the client in the response to the /Home/ Configuration request so that the client may perform any additional localization to match the language used for authentication forms.\n\n\nHypermedia control and parameterized URLs\n\n\nThe StoreFront Web API uses the concept of hypermedia controls. With hypermedia controls, links to resources and actions are obtained from the server, either from the client configuration (/Home/Configuration) or directly as the result of calling this API. This means that clients must never construct URLs.\nIn these topics, various parameterized URLs are discussed, such as /Resources/ Subscription/{id}. It is important to note that these are indicative only, because the client code must not construct URLs directly. Instead, all parameterized URLs must be obtained from the service itself. For example, the URL to launch a particular resource must be extracted from the JSON data returned from the request to /Resources/List/.\nIn some cases, additional parameters can be supplied to a service that is invoked by a GET HTTP request. These parameters are supplied to the service by adding query string parameters to the base service URL. Clients must not make assumptions on the form of the service URL, which may vary with different releases. In particular, clients must not make assumptions about the presence or absence of query string parameters in the base service URL and must determine in each case whether new parameters should be appended with '?' or '\n'.\n\n\nBackwards and forwards compatibility\n\n\nThis is a preliminary revision of the Web Proxy API. No guarantees are made about backwards or forwards compatibility with any previous or future releases of Citrix Receiver for Web.\n\n\nURL discovery\n\n\nWhen the JavaScript code executes in the browser, it first makes an Ajax request to the Web Proxy URL defined by the variable CTXS.configUrl (this defaults to /Home/ Configuration, but can be overridden by a JavaScript customization). This returns an XML document describing various Citrix Receiver for Web configuration settings, including a number of URL paths (relative to the site root) that the client must use for subsequent API calls. In addition to these \"fixed\" URLs, the client may later be sent additional URL paths specific to a given resource. For example, calling Resource/List returns JSON data describing all resources available to the user, including URL paths (per resource) for resource-specific operations such as launching a given resource or subscribing to a resource. These URL paths contain a resource id embedded within them.\n\n\nAPI usage pattern\n\n\nAt a high level, the client accesses the Web Proxy API by performing calls in the following order:\n\n\n\n\nFetch the site configuration, to determine behavior and discover URLs for subsequent operations\n\n\nPerform authentication, to allow access to resources\n\n\nList sessions, to perform auto session reconnect at logon\n\n\nList resources, to fetch additional (per-resource) URLs for launch and subscription operations\n\n\nLaunch and subscribe to resources in response to user actions in the UI\n\n\n\n\nHTTP POST Parameters\n\n\nThroughout the API, any request parameters in the POST body must follow standard form URL-encoding rules, with Content-Type set to:\n\n\napplication/x-www-form-urlencoded", 
            "title": "How the API works"
        }, 
        {
            "location": "/how-the-api-works/#how-the-api-works", 
            "text": "This topic describes the behavior of the StoreFront Web API including authentication behavior, cookies, localization specifics, release compatibility and URL discovery.", 
            "title": "How the API works"
        }, 
        {
            "location": "/how-the-api-works/#authentication-challenge", 
            "text": "Some Web Proxy URLs are protected and require authentication information to allow access. If the required authentication information is not present, the Web Proxy returns an empty response (HTTP status code 200) with the following HTTP header:  CitrixWebReceiver-Authenticate: reason= TokenRequired ,\nlocation= Authentication/GetAuthMethods  The location value in the challenge specifies a URL that the client requests (via Ajax) to determine which authentication methods are available. The challenge may contain an additional attribute  mode=Redirect , which triggers the client to redirect to a 3rd party page instead to perform the authentication step.  Even after the user has authenticated, a challenge may be returned. For example, if the user's Web Proxy session has terminated for any reason, the  ASP.NET_SessionId cookie  is absent from the client request, or if the StoreFront credential wallet service has restarted.  Therefore, the client must be prepared to respond to such an authentication challenge at any time by prompting the user to re-authenticate to the site.", 
            "title": "Authentication challenge"
        }, 
        {
            "location": "/how-the-api-works/#client-name-client-address-and-device-id", 
            "text": "When the Web Proxy communicates with certain Store Service APIs, it supplies values for client name, client address and device id. These values are required for workspace control to function correctly. It is important that the Web Proxy passes consistent data for these parameters to all Store Services that take these parameters.  Client name specifies the hostname of the client machine and device id specifies a value unique to the client device. Since a typical browser-based client has limited access to the client OS and cannot determine the hostname, the Web Proxy automatically generates a random string value to use for both client name and device id. This value is returned to the client as a persistent cookie, named CtxsDeviceId, in a successful response (HTTP status 200) to a resource enumeration. It is expected that this cookie is returned by the client in subsequent requests.  Client address identifies the client IP address. This may be used on some XenApp/ XenDesktop systems to determine if a client should be presented with a particular resource. The Web Proxy automatically determines the client address from the Microsoft ASP.NET API  HttpRequest.UserHostAddress , which returns the IP address of the client as seen at the web server. This may not be the actual client address; for example, if connecting through a NetScaler Gateway or other proxy server.  If multiple web browsers connect to a Citrix Receiver for Web site from the same client machine, a different (random) value for the CtxsDeviceId cookie is returned to each browser to represent the client name and device id. This results in the sessions being treated by the Store Services as running on separate devices. This may lead to apps disappearing and reappearing when performing session operations; for example, querying and reconnecting to sessions.", 
            "title": "Client Name, Client Address and Device Id"
        }, 
        {
            "location": "/how-the-api-works/#cookies", 
            "text": "The Web Proxy sets a number of cookies as outlined in the table below. The client must return the cookies in subsequent requests, as indicated by the cookie life time.     Cookie  Life time  HttpOnly  When Set  Description      ASP.NET_SessionId  Session  Yes  First response from Web Proxy  ASP.NET session id, represents the web session between client and Web Proxy.    CtxsAuthId  Session  Yes  Response indicating successful authentication  Protects against session fixation attacks    CsrfToken  Session  No  First response from Web Proxy  Protects against cross- site request forgery attacks    CtxsDeviceId  Persistent, 2 years  Yes  Response indicating successful resource enumeration  Specifies the value to use for client name and device id (see above)", 
            "title": "Cookies"
        }, 
        {
            "location": "/how-the-api-works/#https-indicator-to-secure-cookies", 
            "text": "Unless specified otherwise, the Web Proxy API requires the client to indicate whether it is using an HTTPS connection or not by supplying a header named  X-Citrix- IsUsingHTTPS  with value \"Yes\" or \"No\". When the value is set to \"Yes\", the Web Proxy sets the Secure attribute for all cookies that it generates to protect them from being viewed from non-HTTPS connections. This caters for NetScaler Gateway scenarios where the connection from the browser to the gateway is over HTTPS but the connection from the gateway to the internal Citrix Receiver for Web site (where the Web Proxy runs) is HTTP.", 
            "title": "HTTPS indicator to secure cookies"
        }, 
        {
            "location": "/how-the-api-works/#cross-site-request-forgery-token", 
            "text": "To protect against cross-site request forgery (CSRF) attacks, the Web Proxy APIs require that a CSRF token be supplied by the client, unless specified otherwise. This is a random string generated by the Web Proxy for the duration of the session and communicated to the client using a session cookie. Clients must read the value of this cookie and send it back to the Web Proxy in most API calls, as either the value of a header named Csrf-Token (note the hyphen) for POST requests, or as the value of a query string parameter named CsrfToken for GET requests.", 
            "title": "Cross-site request forgery token"
        }, 
        {
            "location": "/how-the-api-works/#localization", 
            "text": "Generally, the Web Proxy does not return user-facing strings to display in a UI. However, the authentication process uses the Citrix Common Forms protocol to obtain a definition of the logon form (amongst other forms), which typically includes strings for UI controls (for example, a \"Username: \" label or \"Log On\" button). The value specified in the Accept-Language HTTP header is used to determine the language for such strings. This value is also reflected back to the client in the response to the /Home/ Configuration request so that the client may perform any additional localization to match the language used for authentication forms.", 
            "title": "Localization"
        }, 
        {
            "location": "/how-the-api-works/#hypermedia-control-and-parameterized-urls", 
            "text": "The StoreFront Web API uses the concept of hypermedia controls. With hypermedia controls, links to resources and actions are obtained from the server, either from the client configuration (/Home/Configuration) or directly as the result of calling this API. This means that clients must never construct URLs.\nIn these topics, various parameterized URLs are discussed, such as /Resources/ Subscription/{id}. It is important to note that these are indicative only, because the client code must not construct URLs directly. Instead, all parameterized URLs must be obtained from the service itself. For example, the URL to launch a particular resource must be extracted from the JSON data returned from the request to /Resources/List/.\nIn some cases, additional parameters can be supplied to a service that is invoked by a GET HTTP request. These parameters are supplied to the service by adding query string parameters to the base service URL. Clients must not make assumptions on the form of the service URL, which may vary with different releases. In particular, clients must not make assumptions about the presence or absence of query string parameters in the base service URL and must determine in each case whether new parameters should be appended with '?' or ' '.", 
            "title": "Hypermedia control and parameterized URLs"
        }, 
        {
            "location": "/how-the-api-works/#backwards-and-forwards-compatibility", 
            "text": "This is a preliminary revision of the Web Proxy API. No guarantees are made about backwards or forwards compatibility with any previous or future releases of Citrix Receiver for Web.", 
            "title": "Backwards and forwards compatibility"
        }, 
        {
            "location": "/how-the-api-works/#url-discovery", 
            "text": "When the JavaScript code executes in the browser, it first makes an Ajax request to the Web Proxy URL defined by the variable CTXS.configUrl (this defaults to /Home/ Configuration, but can be overridden by a JavaScript customization). This returns an XML document describing various Citrix Receiver for Web configuration settings, including a number of URL paths (relative to the site root) that the client must use for subsequent API calls. In addition to these \"fixed\" URLs, the client may later be sent additional URL paths specific to a given resource. For example, calling Resource/List returns JSON data describing all resources available to the user, including URL paths (per resource) for resource-specific operations such as launching a given resource or subscribing to a resource. These URL paths contain a resource id embedded within them.", 
            "title": "URL discovery"
        }, 
        {
            "location": "/how-the-api-works/#api-usage-pattern", 
            "text": "At a high level, the client accesses the Web Proxy API by performing calls in the following order:   Fetch the site configuration, to determine behavior and discover URLs for subsequent operations  Perform authentication, to allow access to resources  List sessions, to perform auto session reconnect at logon  List resources, to fetch additional (per-resource) URLs for launch and subscription operations  Launch and subscribe to resources in response to user actions in the UI", 
            "title": "API usage pattern"
        }, 
        {
            "location": "/how-the-api-works/#http-post-parameters", 
            "text": "Throughout the API, any request parameters in the POST body must follow standard form URL-encoding rules, with Content-Type set to:  application/x-www-form-urlencoded", 
            "title": "HTTP POST Parameters"
        }, 
        {
            "location": "/requests/", 
            "text": "Requests\n\n\nThe following topics describe the requests available using the API. Each request is described, together with possible response codes and examples.\n\n\n\n\nNote\n\n\nIn some examples, line breaks and white space have been added for readability.\n\n\n\n\nClient Configuration\n\n\nUse this request to obtain the client configuration settings for the site. These settings define the behavior of the client and provide Web Proxy URLs for other services such as authentication and resource enumeration.\nThis request can be performed before authentication has taken place and before a web session has been established.\n\n\nRequest\n\n\n\n\n\n\n\n\nURL\n\n\nMethod\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n/Home/Configuration\n\n\nGET\n\n\nRequests the client configuration, which is returned as an XML document\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nResponse Code\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n200\n\n\nSuccess\n\n\n\n\n\n\n403\n\n\nForbidden, due to one of the following reasons:\n\n\n\n\n\n\n\n\n- Invalid CSRF token\n\n\n\n\n\n\n\n\n- Invalid X-Citrix-IsUsingHTTPS header\n\n\n\n\n\n\n\n\nSuccess Response Content\n\n\nIf a successful response (HTTP status code 200 OK) is returned, the response body contains an XML document describing the Citrix Receiver for Web configuration settings for the client, with root node \nclientSettings\n. For more information about the various configuration elements and attributes, see Using configuration elements on page 81.\n\n\nExample: Client Configuration\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/Home/Configuration HTTP/\n1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/\n20100101 Firefox/23.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCsrf-Token: 4F4F307CAEAB89EEA86EF511788B1BB1\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.0\nSet-Cookie: CsrfToken=597E2BAC2A18AF3816B229D5022B6E2A; path=/\nCitrix/StoreWeb/\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Fri, 20 Sep 2013 15:03:40 GMT\nContent-Length: 1592\n\nclientSettings\n\n  \nsession timeout=\n20\n userLanguages=\nen-US,en;q=0.5\n /\n\n  \nauthManager getUsernameURL=\nAuthentication/GetUserName\n\n               changeCredentialsURL=\nAuthentication/\nGetChangeCredentialForm\n\n               logoffURL=\nAuthentication/Logoff\n\nloginFormTimeout=\n5\n /\n\n  \nstoreProxy keepAliveURL=\nHome/KeepAlive\n\n    \nresourcesProxy listURL=\nResources/List\n\nresourceDetails=\ndefault\n /\n\n    \nsessionsProxy listAvailableURL=\nSessions/ListAvailable\n\n                   disconnectURL=\nSessions/Disconnect\n\n                   logoffURL=\nSessions/Logoff\n /\n\n  \n/storeProxy\n\n  \npluginAssistant enabled=\ntrue\n upgradeAtLogin=\ntrue\n\n    \nwin32 path=\nhttp://\ndownloadplugins.citrix.com.edgesuite.net/Windows/\nCitrixReceiverWeb.exe\n /\n\n    \nmacOS path=http://\ndownloadplugins.citrix.com.edgesuite.net/Mac/\nCitrixReceiverWeb.dmg\n           minimumSupportedOSVersion=\n10.6\n /\n\n    \nhtml5 enabled=\nOff\n\n           platforms=\nFirefox;Chrome;Version/([6-9]|\\d\n\\d).*Safari;MSIE \\d\\d;Trident;\n\n           launchURL=\nclients/HTML5Client/src/\nSessionWindow.html\n\n           preferences=\n singleTabLaunch=\nfalse\n\nchromeAppOrigins=\nchrome-extension://\nhaiffjcadagjlijoggckpgfnoeiflnem|chrome-extension://\nbgiigkppjadidglloadcadeihlnbpagp\n /\n\n  \n/pluginAssistant\n\n  \nuserInterface frameOptions=\ndeny\n autoLaunchDesktop=\ntrue\n\n    \nworkspaceControl enabled=\ntrue\n\nautoReconnectAtLogon=\ntrue\n logoffAction=\ndisconnect\n\n                      showReconnectButton=\ntrue\n\nshowDisconnectButton=\ntrue\n /\n\n    \nreceiverConfiguration enabled=\ntrue\n\n                           downloadURL=\nServiceRecord/\nGetDocument/receiverconfig.cr\n /\n\n    \nuiViews showDesktopsView=\ntrue\n showAppsView=\ntrue\n\ndefaultView=\ndesktops\n /\n\n    \nappShortcuts enabled=\nfalse\n\nallowSessionReconnect=\nfalse\n /\n\n  \n/userInterface\n\n\n/clientSettings\n\n\n\n\nSession Keep Alive\n\n\nUse this request to extend the duration of a session. The request can be performed before authentication takes place and before a web session is established. Simply contacting the server keeps the server-side session alive and resets the ASP.NET session idle timer. For example, if the session timeout is 20 minutes and this call is made after 15 minutes of idle time, the user is allowed a further 20 minutes before the session times out.\n\n\nRequest\n\n\n\n\n\n\n\n\nURL\n\n\nMethod\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n/Home/KeepAlive\n\n\nHEAD\n\n\nReturns an empty response with an HTTP 200 status code. This is used by the client to extend the life of the HTTP session, which by default times out if no requests are received within a period of 20 minutes.\n\n\n\n\n\n\n\n\nResponse\n\n\n\n\n\n\n\n\nResponse Code\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n200\n\n\nSuccess\n\n\n\n\n\n\n403\n\n\nForbidden, due to one of the following reasons:\n\n\n\n\n\n\n\n\n* Invalid CSRF token\n\n\n\n\n\n\n\n\n* Invalid X-Citrix-IsUsingHTTPS header\n\n\n\n\n\n\n\n\nSuccess Response Content\n\n\nIf a successful response (HTTP status code 200 OK) is returned, the response body is empty.\n\n\nExample: Session Keep Alive\n\n\nRequest\n\n\nHEAD http://webserver/Citrix/StoreWeb/Home/KeepAlive HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/\n20100101 Firefox/23.0\nAccept: text/plain, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCsrf-Token: 4DE109CB32EBE310E1902D05D8DD5BDF\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCsrfToken=4DE109CB32EBE310E1902D05D8DD5BDF;\nCtxsAuthId=B3C9A3C0D34C04EE7CC7C0C6B94A509D;\nASP.NET_SessionId=jti1oxzixf5pvwisz5zw05wg; AGSSOHasOccurred=;\nPasswordChangeAllowed=\nConnection: keep-alive\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Length: 0\nContent-Type: text/html\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Mon, 23 Sep 2013 09:16:35 GMT\n\n\n\n\nAuthentication Methods\n\n\nUse the following URL to determine which authentication methods are available, prior to initiating authentication.\n\n\nRequest\n\n\n\n\n\n\n\n\nURL (indicative only)\n\n\nMethod\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n/Authentication/ GetAuthMethods\n\n\nPOST\n\n\nReturns a list of available authentication methods in XML format.\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\n\nThe client must first make a POST request to /Resources/List. Since the user is not yet   authenticated, this returns a challenge in the form of a CitrixWebReceiver- Authenticate    header with the GetAuthMethods URL in the location field.\n\n\n\n\n\n\nFor example:\n\n\nCitrixWebReceiver-Authenticate:\nreason=\nTokenRequired\n,location=\nAuthentication/\nGetAuthMethods\n`\n\n\n\n\n\n\nNote\n\n\n\n\nThe client must not skip this request by hard-coding any of the authentication URLs, as   these may change from release to release.\n\n\nThe available authentication methods are specified in the Citrix Receiver for Web     configuration file. The list of methods returned is the intersection of those configured    for the Citrix Receiver for Web site and those configured for the StoreFront    Authentication service.\n\n\nWhen Gateway authentication is available, use this in preference to (and to the   exclusion of) all other authentication methods. This is because Gateway authentication is   available only when the user is connecting to Citrix Receiver for Web externally through a  NetScaler Gateway, while the other authentication methods are intended only for intranet    use.\n\n\n\n\n\n\nResponse\n\n\n\n\n\n\n\n\nResponse Code\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n200\n\n\nSuccess\n\n\n\n\n\n\n403\n\n\nForbidden, due to one of the following reasons:\n\n\n\n\n\n\n\n\n* Invalid CSRF token\n\n\n\n\n\n\n\n\n* Invalid X-Citrix-IsUsingHTTPS header\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nResponse Format\n\n\nRequest Accept/Response Content-Type Header\n\n\n\n\n\n\n\n\n\n\nXML\n\n\napplication/xml\n\n\n\n\n\n\n\n\nSuccess Response Content\n\n\nWhen a successful response (HTTP status code 200) is returned, the response body contains an XML document with root node authMethods and zero or more method child elements. Each method child element contains a name attribute identifying the authentication method and a url attribute that the client uses to initiate authentication using the given method. The possible authentication method names are:\n\n\n\n\n\n\n\n\nMethod name\n\n\nTypical URL (indicative only)\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nExplicitForms\n\n\nExplicitAuth/Login\n\n\nExplicit authentication with user-supplied credentials such as username, domain and password.\n\n\n\n\n\n\nIntegratedWindows\n\n\nDomainPassthroughAuth/ Login\n\n\nDomain pass-through authentication\n\n\n\n\n\n\nCertificate\n\n\nSmartcardAuth/Login\n\n\nSmart card (client certificate) authentication\n\n\n\n\n\n\nCitrixAGBasic\n\n\nGatewayAuth/Login\n\n\nAutomatic authentication (\"single-sign-on\") to NetScaler Gateway\n\n\n\n\n\n\nPostCredentials\n\n\nPostCredentialsAuth/Login\n\n\nAuthentication achieved by posting user credentials directly to the Web Proxy.\n\n\n\n\n\n\n\n\nExample: Get Auth Methods\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/Authentication/\nGetAuthMethods HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nCsrf-Token: EE87320F00C8694137FBB9319DE3EE80\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=EE87320F00C8694137FBB9319DE3EE80;\nASP.NET_SessionId=vo0ii2tbv2oaqcrko5zjjjlx\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Wed, 15 Jan 2014 13:17:19 GMT\nContent-Length: 282\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nauthMethods\n\n    \nmethod name=\nIntegratedWindows\n\nurl=\nDomainPassthroughAuth/Login\n/\n\n    \nmethod name=\nCertificate\n url=\nSmartcardAuth/Login\n/\n\n    \nmethod name=\nExplicitForms\n url=\nExplicitAuth/Login\n/\n\n\n/authMethods\n\n\n\n\nDomain Pass-Through and Smart Card Authentication\n\n\nUse these requests to authenticate a user either using pass through authentication or a smart card device.\n\n\nRequest\n\n\n\n\n\n\n\n\nURL (indicative only)\n\n\nMethod\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n/DomainPassthroughAuth/ Login\n\n\nPOST\n\n\nAuthenticates the user using the credentials with which he or she logged on to the computer.\n\n\n\n\n\n\n/SmartcardAuth/Login\n\n\nPOST\n\n\nAuthenticates the user using a smart card connected to the user's client computer.\n\n\n\n\n\n\n\n\n\n\nNotes\n\n\n\n\nDomain pass-through authentication requires the client browser to be running on   Microsoft Windows. The caller must check the client platform OS prior to initiating pass-   through authentication.\n\n\nThe pass-through URL is configured in IIS to be protected by Integrated Windows   Authentication (IWA). The actual authentication takes place between the browser and IIS,    transparently to Citrix Receiver for Web.\n\n\nThe smart card URL is configured in IIS to be accessible only via HTTPS and to require a  client certificate to be supplied by the browser.\n\n\nBoth pass-through and smart card authentication require that the option 'Trust requests   to the XML Service' is enabled on the back-end XenDesktop/XenApp server.\n\n\nWhen pass-through authentication is used to authenticate to Citrix Receiver for Web, the  user's password is not available to StoreFront. For launches to work without the user   being prompted for credentials, configure Citrix Receiver as described in \nhttp://  support.citrix.com/article/CTX133855\n.\n\n\nSmart card authentication requires two PIN prompts, one to authenticate to the web site   and another to authenticate to the remote session.\n\n\nIf authentication fails, check the StoreFront event logs which may reveal further     information to assist with diagnosing the failure.\n\n\n\n\n\n\nResponse\n\n\n\n\n\n\n\n\nResponse Code\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n200\n\n\nSuccess or failure.\n\n\n\n\n\n\n401\n\n\nUnauthorized. Returned in the following situations:\n\n\n\n\n\n\n\n\n* The user attempts pass-through authentication from a computer not joined to the StoreFront domain, and cancels the browser dialog prompting for domain credentials\n\n\n\n\n\n\n\n\n* The user attempts smart card authentication and cancels one of the browser prompts to insert a card, select a certificate, or enter a PIN.\n\n\n\n\n\n\n403\n\n\nForbidden, due to one of the following reasons:\n\n\n\n\n\n\n\n\n* Invalid CSRF token\n\n\n\n\n\n\n\n\n* Invalid X-Citrix-IsUsingHTTPS header\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nResponse Format\n\n\nRequest Accept/Response Content-Type Header\n\n\n\n\n\n\n\n\n\n\nXML\n\n\napplication/xml\n\n\n\n\n\n\n\n\nSuccess Response Content\n\n\nWhen a successful response (HTTP status code 200) is returned, the response body contains an XML document with root node \nAuthenticationStatus\n and the following child elements:\n\n\n\n\n\n\n\n\nElement name\n\n\nRequired\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nResult\n\n\nYes\n\n\nValue \"success\" or \"failure\".\n\n\n\n\n\n\nAuthType\n\n\nNo\n\n\nThe authentication type, one of the authentication method strings \"ExplicitForms\", \"IntegratedWindows\", \"Certificate\", \"CitrixAGBasic\", \"PostCredentials\". Only sent when authentication succeeds.\n\n\n\n\n\n\nLogMessage\n\n\nNo\n\n\nAn error id indicating the reason for the authentication failure. Typically the generic value \"fatalerror\" is returned, but \"sessiontimeout\" is returned if the Citrix Receiver for Web session has timed out. Only sent when authentication fails.\n\n\n\n\n\n\n\n\nExample: Successful smart card authentication\n\n\nRequest\n\n\nPOST https://webserver.domain.com/Citrix/StoreWeb/\nSmartcardAuth/Login HTTP/1.1\nCsrf-Token: C34A98583E032C5D26D4332A54738447\nAccept: application/xml, text/xml, */*; q=0.01\nX-Citrix-IsUsingHTTPS: Yes\nX-Requested-With: XMLHttpRequest\nReferer: https://webserver.domain.com/Citrix/StoreWeb/\nAccept-Language: en-GB\nAccept-Encoding: gzip, deflate\nUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.3;\nWOW64; Trident/7.0; .NET4.0E; .NET4.0C; .NET CLR\n3.5.30729; .NET CLR 2.0.50727; .NET CLR 3.0.30729; InfoPath.3)\nHost: webserver.domain.com\nContent-Length: 0\nDNT: 1\nConnection: Keep-Alive\nCache-Control: no-cache\nCookie: CsrfToken=C34A98583E032C5D26D4332A54738447;\nASP.NET_SessionId=aisncy3nsdcz2snnpc045y1h\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/7.5\nSet-Cookie: CtxsAuthId=5989E6314A2ADEB10D4F4A71093CAF6D; path=/\nCitrix/StoreWeb/; secure; HttpOnly\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Fri, 17 Jan 2014 17:39:44 GMT\nContent-Length: 255\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticationStatus\n\n  \nResult\nsuccess\n/Result\n\n  \nAuthType\nCertificate\n/AuthType\n\n\n/AuthenticationStatus\n\n\n\n\nExample: Failed pass-through authentication\n\n\nIn this example, the computer is off-domain, and the user cancels the browser prompt for domain credentials.\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/DomainPassthroughAuth/\nLogin HTTP/1.1\nHost: webserver\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nCsrf-Token: 74F22328CCE9A0C62097A5A77FC7D58B\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=74F22328CCE9A0C62097A5A77FC7D58B;\nASP.NET_SessionId=flz4othwj5g5sc0fw3ywtzos\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0\n\n\n\n\nResponse\n\n\nHTTP/1.1 401 Unauthorized\nContent-Type: text/html; charset=utf-8\nServer: Microsoft-IIS/7.5\nWWW-Authenticate: Negotiate\nWWW-Authenticate: NTLM\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Fri, 17 Jan 2014 17:44:14 GMT\nContent-Length: 1293\nProxy-Support: Session-Based-Authentication\n\n!DOCTYPE html PUBLIC \n-//W3C//DTD XHTML 1.0 Strict//EN\n\n\nhttp://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\n\n\nhtml xmlns=\nhttp://www.w3.org/1999/xhtml\n\n\nhead\n\n\nmeta http-equiv=\nContent-Type\n content=\ntext/html;\ncharset=iso-8859-1\n/\n\n\ntitle\n401 - Unauthorized: Access is denied due to invalid\ncredentials.\n/title\n\n\nstyle type=\ntext/css\n\n\n!--\nbody{margin:0;font-size:.7em;font-family:Verdana, Arial,\nHelvetica, sans-serif;background:#EEEEEE;}\nfieldset{padding:0 15px 10px 15px;}\nh1{font-size:2.4em;margin:0;color:#FFF;}\nh2{font-size:1.7em;margin:0;color:#CC0000;}\nh3{font-size:1.2em;margin:10px 0 0 0;color:#000000;}\n#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-\nfamily:\ntrebuchet MS\n, Verdana, sans-serif;color:#FFF;\nbackground-color:#555555;}\n#content{margin:0 0 0 2%;position:relative;}\n.content-container{background:#FFF;width:96%;margin-top:\n8px;padding:10px;position:relative;}\n--\n\n\n/style\n\n\n/head\n\n\nbody\n\n\ndiv id=\nheader\nh1\nServer Error\n/h1\n/div\n\n\ndiv id=\ncontent\n\n \ndiv class=\ncontent-container\nfieldset\n\n \nh2\n401 - Unauthorized: Access is denied due to invalid\ncredentials.\n/h2\n\n  \nh3\nYou do not have permission to view this directory or\npage using the credentials that you supplied.\n/h3\n\n \n/fieldset\n/div\n\n\n/div\n\n\n/body\n\n\n/html\n\n\n\n\nExplicit Forms Authentication\n\n\nUse this request to authenticate a user using explicit forms authentication. Explicit authentication, where the user enters credentials manually, is performed using the Citrix Common Forms Protocol. See the Citrix StoreFront API documentation for more information about Common Forms authentication.\n\n\nThe client initiates a forms conversation by making a request to the Web Proxy Explicit Forms URL (returned by /Authentication/GetAuthMethods) to get the first form in a possible series of forms. The Web Proxy forwards form requests to the StoreFront Authentication service and relays replies back to the client. All forms are unmodified by the Web Proxy, with the sole exception that any post-back URLs are modified to point to Web Proxy URLs, so that the client never contacts the Authentication service directly.\n\n\nThe forms are always returned as XML, which must be parsed by the client, transformed into corresponding HTML and displayed to the user. Once the user completes and submits a form, the client posts the form data back to a post-back URL provided in the original form XML. This may result in further forms being sent to the client to solicit additional information from the user. The client continues the process of rendering and submitting forms until either an authentication success or failure response is received.\n\n\nThe client must not assume that the initial form returned represents a logon form. Typically, this is the case, but another form may be returned in certain circumstances; for example, a change password form is returned if password expiry is configured and the user's password has expired. Third parties may also use the StoreFront Authentication SDK to inject custom forms into the authentication process.\n\n\nRequest\n\n\n\n\n\n\n\n\nURL (indicative only)\n\n\nMethod\n\n\nAccepts POST data\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n/ExplicitAuth/Login\n\n\nPOST\n\n\nNo\n\n\nRequests the first form in an explicit forms conversation. The URL is returned by / Authentication/ GetAuthMethods.\n\n\n\n\n\n\n/ExplicitAuth/ LoginAttempt\n\n\nPOST\n\n\nYes\n\n\nAttempts an explicit logon. The URL is returned as the PostBack element in a login form.\n\n\n\n\n\n\n/ExplicitAuth/ SendForm\n\n\nPOST\n\n\nYes\n\n\nProxies a form back to the StoreFront Authentication service. The URL is returned as the PostBack element in a form.\n\n\n\n\n\n\n/ExplicitAuth/ GetChangeCredentialForm\n\n\nPOST\n\n\nNo\n\n\nRequests a change credential form. Used when elective change password support is enabled in the StoreFront Authentication service. The URL is supplied in the RfWeb configuration.\n\n\n\n\n\n\n/ExplicitAuth/ CancelForm\n\n\nPOST\n\n\nNo\n\n\nCancels the current form. The URL is returned as the CancelPostBack element in a form.\n\n\n\n\n\n\n\n\nWhen the user submits a form (for example, by activating a Logon button), the client must process the user-supplied data as described in the section Processing Form Data of the document \"Citrix Receiver Common Authentication Forms Language v2.0\" in the Citrix StoreFront API documentation.\n\n\n\n\nNotes\n\n\n\n\nIf the client omits to post any of the required data, the Authentication service rejects  the form, resulting in a failed logon.\n\n\nOnce the user submits a form that results in successful authentication, the StoreFront    Authentication service returns a primary authentication token for the user. All tokens,     including the primary token plus any secondary tokens that are subsequently acquired for    other StoreFront services (for example, Resources service), are held at the Web Proxy on    behalf of the user, so that the client does not need to deal with the complexities of the   authentication system.\n\n\nTokens are maintained in the Web Proxy in an ASP.NET session object, which is bound to    the user's browser session via the ASP.NET_SessionId cookie.\n\n\n\n\n\n\nResponse\n\n\n\n\n\n\n\n\nResponse Code\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n200\n\n\nSuccess or failure or an XML form\n\n\n\n\n\n\n403\n\n\nForbidden, due to one of the following reasons:\n\n\n\n\n\n\n\n\n* Invalid CSRF token\n\n\n\n\n\n\n\n\n* Invalid X-Citrix-IsUsingHTTPS header\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nResponse Format\n\n\nRequest Accept/Response Content-Type Header\n\n\n\n\n\n\n\n\n\n\nXML\n\n\napplication/xml\n\n\n\n\n\n\n\n\nSuccess Response Content\n\n\nWhen a successful response (HTTP status code 200) is returned, the response body contains an XML document where the root node is either AuthenticationStatus or AuthenticateResponse.\n\n\nAn AuthenticationStatus response indicates either success or failure and contains the following child elements:\n\n\n\n\n\n\n\n\nElement name\n\n\nRequired\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nResult\n\n\nYes\n\n\nValue \"success\" or \"failure\".\n\n\n\n\n\n\nAuthType\n\n\nNo\n\n\nThe authentication type, indicated by one of the authentication method strings \"ExplicitForms\", \"IntegratedWindows\", \"Certificate\", \"CitrixAGBasic\", \"PostCredentials\". Only sent when authentication succeeds.\n\n\n\n\n\n\nLogMessage\n\n\nNo\n\n\nAn error id indicating the reason for the authentication failure. Typically, the generic value \"fatalerror\" is returned, but \"sessiontimeout\" is returned if the Citrix Receiver for Web session has timed out. Only sent when authentication fails.\n\n\n\n\n\n\nIsChangePasswordEnabled\n\n\nNo\n\n\nValue \"true\". Only sent when authentication succeeds and elective change password is enabled.\n\n\n\n\n\n\nIsExpiryNotificationEnabled\n\n\nNo\n\n\nValue \"true\". Only sent when authentication succeeds, password expiry notification is enabled, and the user's password is due to expire within the configured time.\n\n\n\n\n\n\nTimeRemaining\n\n\nNo\n\n\nThe time remaining (in minutes) until the user's password expires. Only sent when authentication succeeds, password expiry notification is enabled and the user's password is due to expire within the configured time.\n\n\n\n\n\n\n\n\nAuthenticateResponse\n is an XML description of a form that is displayed to the user to collect additional information required for the authentication operation (typically, logon on change password). See the Common Forms Authentication documentation for information about the various form elements.\n\n\nExample: Explicit Authentication\u2014Logon Form Returned\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/ExplicitAuth/Login HTTP/\n1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nCsrf-Token: 23E18D9002817048C931EA636E0D5C81\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CtxsAuthMethod=ExplicitForms;\nCsrfToken=23E18D9002817048C931EA636E0D5C81;\nASP.NET_SessionId=hdqnxu21dz3p2nb2zcfo2sfs\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/\nvnd.citrix.authenticateresponse-1+xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nX-Citrix-ExplicitAuthProtocol: ExplicitForms\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Fri, 17 Jan 2014 16:25:09 GMT\nContent-Length: 1555\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/\nresponse/1\n\n  \nStatus\nsuccess\n/Status\n\n  \nResult\nmore-info\n/Result\n\n  \nStateContext /\n\n  \nAuthenticationRequirements\n\n    \nPostBack\nExplicitAuth/LoginAttempt\n/PostBack\n\n    \nCancelPostBack\nExplicitAuth/CancelForm\n/CancelPostBack\n\n    \nCancelButtonText\nCancel\n/CancelButtonText\n\n    \nRequirements\n\n      \nRequirement\n\n    \nCredential\n\n      \nID\nusername\n/ID\n\n      \nSaveID\nExplicitForms-Username\n/SaveID\n\n      \nType\nusername\n/Type\n\n    \n/Credential\n\n    \nLabel\n\n      \nText\nUser name:\n/Text\n\n      \nType\nplain\n/Type\n\n    \n/Label\n\n    \nInput\n\n      \nAssistiveText\ndomain\\user or user@domain.com\n/\nAssistiveText\n\n      \nText\n\n        \nSecret\nfalse\n/Secret\n\n        \nReadOnly\nfalse\n/ReadOnly\n\n        \nInitialValue\n\n        \n/InitialValue\n\n        \nConstraint\n.+\n/Constraint\n\n      \n/Text\n\n    \n/Input\n\n      \n/Requirement\n\n      \nRequirement\nCredential\n\n      \nID\npassword\n/ID\n\n      \nSaveID\nExplicitForms-Password\n/SaveID\n\n      \nType\npassword\n/Type\n\n    \n/Credential\n\n    \nLabel\n\n      \nText\nPassword:\n/Text\n\n      \nType\nplain\n/Type\n\n    \n/Label\n\n    \nInput\n\n      \nText\n\n        \nSecret\ntrue\n/Secret\n\n        \nReadOnly\nfalse\n/ReadOnly\n\n        \nInitialValue\n\n        \n/InitialValue\n\n        \nConstraint\n.+\n/Constraint\n\n      \n/Text\n\n    \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n    \nCredential\n\n      \nID\nsaveCredentials\n/ID\n\n      \nType\nsavecredentials\n/Type\n\n    \n/Credential\n\n    \nLabel\n\n      \nText\nRemember my password\n/Text\n\n      \nType\nplain\n/Type\n\n    \n/Label\n\n    \nInput\n\n      \nCheckBox\n\n        \nInitialValue\nfalse\n/InitialValue\n\n      \n/CheckBox\n\n    \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n    \nCredential\n\n      \nID\nloginBtn\n/ID\n\n      \nType\nnone\n/Type\n\n    \n/Credential\n\n    \nLabel\n\n      \nType\nnone\n/Type\n\n    \n/Label\n\n    \nInput\n\n      \nButton\nLog On\n/Button\n\n    \n/Input\n\n      \n/Requirement\n\n    \n/Requirements\n\n  \n/AuthenticationRequirements\n\n\n/AuthenticateResponse\n\n\n\n\nThe client transforms the XML form description into an HTML representation, which is then dynamically added to the web page DOM. The above XML results in an HTML form consisting of a \nUser name\n label and text input field, a \nPassword\n label and password input field, and a \nLog On\n button.\n\n\nThe user types his or her credentials in the input fields and submits the form by clicking the \nLog On\n button.\n\n\nThe client intercepts the form submission and follows the Common Forms Authentication rules to build the form data to send back to the Web Proxy (to be forwarded to the Authentication service). The form is submitted to the PostBack URL; in this case Authentication/LoginAttempt. However, the user mistypes their password which results in the Authentication service returning another logon form XML document, this time highlighting the error with an additional Requirements node.\n\n\nExample: Explicit Authentication\u2014Incorrect Credentials Submitted\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/ExplicitAuth/\nLoginAttempt HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: E2FF5D342BA9193DF707062EA7A31C54\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 72\nCookie: CtxsAuthMethod=ExplicitForms;\nCsrfToken=E2FF5D342BA9193DF707062EA7A31C54;\nASP.NET_SessionId=1zfyotwrcjr3uzry3jbqcpvg\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nusername=acmecorp%5Cuser1\npassword=rubbish\nloginBtn=Log\n+On\nStateContext=\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nSet-Cookie: CtxsAuthId=22BE25569A283D63B1C5668580119320; path=/\nCitrix/StoreWeb/; HttpOnly\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Fri, 17 Jan 2014 16:42:49 GMT\nContent-Length: 157\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticationStatus\n\n  \nResult\nsuccess\n/Result\n\n  \nAuthType\nExplicitForms\n/AuthType\n\n\n/AuthenticationStatus\n\n\n\n\nExample: Explicit Authentication\u2014Password Expired\n\n\nIf StoreFront is configured to allow users to change an expired password and a user attempts to log on when their password has expired, a change password XML form is returned when the user submits their credentials. This form includes a label to inform the user that their password must be changed, and text input fields (plus corresponding labels) for the user to enter the old password and to enter and confirm a new password. Note that the post-back URL is also updated to point back to the Web Proxy URL Authentication/ChangePassword.\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/ExplicitAuth/\nLoginAttempt HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: A75AC234CA8C565EEEBE96FF81E495BA\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 70\nCookie: CtxsAuthMethod=ExplicitForms;\nCsrfToken=A75AC234CA8C565EEEBE96FF81E495BA;\nASP.NET_SessionId=ulemrewlolkvhallkgcbwm3l\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nusername=acmecorp%5Cuser1\npassword=mypassword\nloginBtn=Log\n+On\nStateContext=\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/\nvnd.citrix.authenticateresponse-1+xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nX-Citrix-ExplicitAuthProtocol: ExplicitForms\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Mon, 20 Jan 2014 10:53:59 GMT\nContent-Length: 2111\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/\nresponse/1\n\n  \nStatus\nsuccess\n/Status\n\n  \nResult\nupdate-credentials\n/Result\n\n  \nStateContext /\n\n  \nAuthenticationRequirements\n\n    \nPostBack\nExplicitAuth/SendForm\n/PostBack\n\n    \nCancelPostBack\nExplicitAuth/CancelForm\n/CancelPostBack\n\n    \nCancelButtonText\nCancel\n/CancelButtonText\n\n    \nRequirements\n\n      \nRequirement\n\n    \nCredential\n\n      \nType\nnone\n/Type\n\n    \n/Credential\n\n    \nLabel\n\n      \nText\nChange Password\n/Text\n\n      \nType\nheading\n/Type\n\n    \n/Label\n\n    \nInput /\n\n      \n/Requirement\n\n      \nRequirement\n\n    \nCredential\n\n      \nType\nnone\n/Type\n\n    \n/Credential\n\n    \nLabel\n\n      \nText\nYour password has expired and must be changed.\n/\nText\n\n      \nType\ninformation\n/Type\n\n    \n/Label\n\n    \nInput /\n\n      \n/Requirement\n\n      \nRequirement\n\n    \nCredential\n\n  \nType\nusername\n/Type\n\n\n/Credential\n\n\nLabel\n\n  \nText\nUser name:\n/Text\n\n  \nType\nplain\n/Type\n\n\n/Label\n\n\nInput\n\n  \nText\n\n    \nSecret\nfalse\n/Secret\n\n    \nReadOnly\ntrue\n/ReadOnly\n\n    \nInitialValue\nacmecorp\\user1\n/InitialValue\n\n    \nConstraint\n.+\n/Constraint\n\n  \n/Text\n\n\n/Input\n\n  \n/Requirement\n\n  \nRequirement\n\n\nCredential\n\n  \nID\noldPassword\n/ID\n\n  \nType\npassword\n/Type\n\n\n/Credential\n\n\nLabel\n\n  \nText\nOld password:\n/Text\n\n  \nType\nplain\n/Type\n\n\n/Label\n\n\nInput\n\n  \nText\n\n    \nSecret\ntrue\n/Secret\n\n    \nReadOnly\nfalse\n/ReadOnly\n\n    \nInitialValue\n\n    \n/InitialValue\n\n    \nConstraint\n.+\n/Constraint\n\n  \n/Text\n\n\n/Input\n\n  \n/Requirement\n\n  \nRequirement\n\n\nCredential\n\n  \nID\nnewPassword\n/ID\n\n  \nSaveID\nExplicitForms-Password\n/SaveID\n\n  \nType\nnewpassword\n/Type\n\n\n/Credential\n\n\nLabel\n\n  \nText\nNew password:\n/Text\n\n  \nType\nplain\n/Type\n\n\n/Label\n\n\nInput\n\n  \nText\n\n    \nSecret\ntrue\n/Secret\n\n    \nReadOnly\nfalse\n/ReadOnly\n\n    \nInitialValue\n\n    \n/InitialValue\n\n    \nConstraint\n.+\n/Constraint\n\n  \n/Text\n\n\n/Input\n\n  \n/Requirement\n\n  \nRequirement\n\n\nCredential\n\n  \nID\nconfirmPassword\n/ID\n\n\nType\nnewpassword\n/Type\n\n    \n/Credential\n\n    \nLabel\n\n      \nText\nConfirm password:\n/Text\n\n      \nType\nplain\n/Type\n\n    \n/Label\n\n    \nInput\n\n      \nText\n\n        \nSecret\ntrue\n/Secret\n\n        \nReadOnly\nfalse\n/ReadOnly\n\n        \nInitialValue\n\n        \n/InitialValue\n\n        \nConstraint\n.+\n/Constraint\n\n      \n/Text\n\n    \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n    \nCredential\n\n      \nID\nchangePasswordBtn\n/ID\n\n      \nType\nnone\n/Type\n\n    \n/Credential\n\n    \nLabel\n\n      \nType\nnone\n/Type\n\n    \n/Label\n\n    \nInput\n\n      \nButton\nOK\n/Button\n\n    \n/Input\n\n      \n/Requirement\n\n    \n/Requirements\n\n  \n/AuthenticationRequirements\n\n\n/AuthenticateResponse\n\n\n\n\nWhen the user enters the requested information and submits the form, a further form is returned by the Authentication service for the user to confirm that their password has been successfully changed. Note that the request specifies the button id changePasswordBtn specified in the form above; failing to specify the correct button id results in the form being rejected. The confirmation form comprises simply of a text label and OK button.\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/ExplicitAuth/SendForm\nHTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: 94FEF17799905C51ADD4599AC0056209\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 95\nCookie: CtxsAuthMethod=ExplicitForms;\nCsrfToken=94FEF17799905C51ADD4599AC0056209;\nASP.NET_SessionId=01omrcuoenllin1eugyr142j\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\noldPassword=mypassword\nnewPassword=newpassword\nconfirmPassword=\nnewpassword\nchangePasswordBtn=OK\nStateContext=\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/\nvnd.citrix.authenticateresponse-1+xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nX-Citrix-ExplicitAuthProtocol: ExplicitForms\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Mon, 20 Jan 2014 11:13:18 GMT\nContent-Length: 720\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/\nresponse/1\n\n  \nStatus\nsuccess\n/Status\n\n  \nResult\nmore-info\n/Result\n\n  \nStateContext /\n\n  \nAuthenticationRequirements\n\n    \nPostBack\nExplicitAuth/SendForm\n/PostBack\n\n    \nCancelPostBack\n\n    \n/CancelPostBack\n\n    \nRequirements\n\n      \nRequirement\n\n    \nCredential\n\n      \nType\nnone\n/Type\n\n    \n/Credential\n\n    \nLabel\n\n      \nText\nYour password has been changed successfully.\n/Text\n\n      \nType\nconfirmation\n/Type\n\n    \n/Label\n\n    \nInput /\n\n      \n/Requirement\n\n      \nRequirement\n\n    \nCredential\n\n      \nID\nchangePasswordConfirmBtn\n/ID\n\n      \nType\nnone\n/Type\n\n    \n/Credential\n\n    \nLabel\n\n      \nType\nnone\n/Type\n\n    \n/Label\n\n    \nInput\n\n      \nButton\nOK\n/Button\n\n    \n/Input\n\n      \n/Requirement\n\n    nticationRequirements\n\n\n/AuthenticateResponse\n\n\n\n\nAfter the user clicks the OK button, the confirmation form is submitted and a successful authentication response is obtained.\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/ExplicitAuth/SendForm\nHTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: 94FEF17799905C51ADD4599AC0056209\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 41\nCookie: CtxsAuthMethod=ExplicitForms;\nCsrfToken=94FEF17799905C51ADD4599AC0056209;\nASP.NET_SessionId=01omrcuoenllin1eugyr142j\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nchangePasswordConfirmBtn=OK\nStateContext=\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nSet-Cookie: CtxsAuthId=7BFB98069F1D33A0FB4268F702B0C983; path=/\nCitrix/StoreWeb/; HttpOnly\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Mon, 20 Jan 2014 11:13:24 GMT\nContent-Length: 157\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticationStatus\n\n  \nResult\nsuccess\n/Result\n\n  \nAuthType\nExplicitForms\n/AuthType\n\n\n/AuthenticationStatus\n\n\n\n\nExample: Explicit Authentication\u2014Elective Change Password\n\n\nIf StoreFront is configured to allow users to change their password at any time and a user attempts to log on when their password is due to expire within the configured expiry period, a successful authentication response is returned. This response includes additional elements indicating that expiry notification is enabled and the number of days remaining until the password expires.\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/ExplicitAuth/\nLoginAttempt HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: 94FD74E2F4DF05D6B0642D25021F632A\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 70\nCookie: CtxsAuthMethod=ExplicitForms;\nCsrfToken=94FD74E2F4DF05D6B0642D25021F632A;\nASP.NET_SessionId=mgucndg5j24cgvymxgrjblr4\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nusername=acmecorp%5Cuser1\npassword=mypassword\nloginBtn=Log\n+On\nStateContext=\n\n####Response\n```curl\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nSet-Cookie: CtxsAuthId=F431D32D995E3CF6A59F5728A0F54085; path=/\nCitrix/StoreWeb/; HttpOnly\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Mon, 20 Jan 2014 11:25:46 GMT\nContent-Length: 320\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticationStatus\n\n  \nResult\nsuccess\n/Result\n\n  \nAuthType\nExplicitForms\n/AuthType\n\n  \nIsChangePasswordEnabled\ntrue\n/IsChangePasswordEnabled\n\n  \nIsExpiryNotificationEnabled\ntrue\n/\nIsExpiryNotificationEnabled\n\n  TimeRemaining\n89\n/TimeRemaining\n\n\n/AuthenticationStatus\n\n\n\n\nThe client may then provide an interface for the user to initiate an elective change password request at any time using the changeCredentials URL obtained from the Citrix Receiver for Web configuration at XPath /clientSettings/authManager. Requesting this URL initiates a Common Forms protocol conversation, in a similar way to /ExplicitAuth/ Login. If the user submits the form after entering invalid data (or omitting required data), further forms may be generated. The client must be prepared to receive multiple forms in succession and process these until either a success or failure response is received. If the password change is successful, a password confirmation form is returned; when the confirmation form is submitted a successful AuthenticationStatus response is returned. In other words, the change password conversation proceeds exactly as described in the example for the case where the user's password has expired at logon time.\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/Authentication/\nGetChangeCredentialForm HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nCsrf-Token: A4BF7CB3334846575421F41AD44EBA67\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CtxsAuthMethod=ExplicitForms;\nCsrfToken=A4BF7CB3334846575421F41AD44EBA67;\nCtxsAuthId=910C6BFC2C98184CA57F77556041E0D3;\nASP.NET_SessionId=cxd25yc3xwq10qevwpxywyxu\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/\nvnd.citrix.authenticateresponse-1+xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nX-Citrix-ExplicitAuthProtocol: ExplicitForms\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Mon, 20 Jan 2014 11:48:00 GMT\nContent-Length: 2097\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/\nresponse/1\n\n  \nStatus\nsuccess\n/Status\n\n  \nResult\nupdate-credentials\n/Result\n\n  \nStateContext /\n\n  \nAuthenticationRequirements\n\n    \nPostBack\nExplicitAuth/SendForm\n/PostBack\n\n    \nCancelPostBack\nExplicitAuth/CancelForm\n/CancelPostBack\n\n    \nCancelButtonText\nCancel\n/CancelButtonText\n\n    \nRequirements\n\n      \nRequirement\n\n    \nCredential\n\n      \nType\nnone\n/Type\n\n    \n/Credential\n\n    \nLabel\n\n      \nText\nChange Password\n/Text\n\n      \nType\nheading\n/Type\n\n    \n/Label\n\n    \nInput /\n\n      \n/Requirement\n\n      \nRequirement\n\n    \nCredential\n\n      \nType\nnone\n/Type\n\n    \n/Credential\n\n    \nLabel\n\n      \nText\nEnter your old and new passwords\n/Text\n\n      \nType\ninformation\n/Type\n\n    \n/Label\n\n    \nInput /\n\n      \n/Requirement\n\n      \nRequirement\n\n    \nCredential\n\n      \nType\nusername\n/Type\n\n    \n/Credential\n\n    \nLabel\n\n      \nText\nUser name:\n/Text\n\n      \nType\nplain\n/Type\n\n    \n/Label\n\n    \nInput\n\n      \nText\n\n        \nSecret\nfalse\n/Secret\n\n        \nReadOnly\ntrue\n/ReadOnly\n\n        \nInitialValue\nacmecorp\\user1\n/InitialValue\n\n        \nConstraint\n.+\n/Constraint\n\n      \n/Text\n\n    \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n    \nCredential\n\n      \nID\noldPassword\n/ID\n\n      \nType\npassword\n/Type\n\n    \n/Credential\n\n    \nLabel\n\n      \nText\nOld password:\n/Text\n\n      \nType\nplain\n/Type\n\n    \n/Label\n\n\nInput\n\n\nText\n\n    \nSecret\ntrue\n/Secret\n\n    \nReadOnly\nfalse\n/ReadOnly\n\n    \nInitialValue\n\n    \n/InitialValue\n\n    \nConstraint\n.+\n/Constraint\n\n  \n/Text\n\n\n/Input\n\n  \n/Requirement\n\n  \nRequirement\n\n\nCredential\n\n  \nID\nnewPassword\n/ID\n\n  \nSaveID\nExplicitForms-Password\n/SaveID\n\n  \nType\nnewpassword\n/Type\n\n\n/Credential\n\n\nLabel\n\n  \nText\nNew password:\n/Text\n\n  \nType\nplain\n/Type\n\n\n/Label\n\n\nInput\n\n  \nText\n\n    \nSecret\ntrue\n/Secret\n\n    \nReadOnly\nfalse\n/ReadOnly\n\n    \nInitialValue\n\n    \n/InitialValue\n\n    \nConstraint\n.+\n/Constraint\n\n  \n/Text\n\n\n/Input\n\n  \n/Requirement\n\n  \nRequirement\n\n\nCredential\n\n  \nID\nconfirmPassword\n/ID\n\n  \nType\nnewpassword\n/Type\n\n\n/Credential\n\n\nLabel\n\n  \nText\nConfirm password:\n/Text\n\n  \nType\nplain\n/Type\n\n\n/Label\n\n\nInput\n\n  \nText\n\n    \nSecret\ntrue\n/Secret\n\n    \nReadOnly\nfalse\n/ReadOnly\n\n    \nInitialValue\n\n    \n/InitialValue\n\n    \nConstraint\n.+\n/Constraint\n\n  \n/Text\n\n\n/Input\n\n  \n/Requirement\n\n  \nRequirement\n\n\nCredential\n\n  \nID\nchangePasswordBtn\n/ID\n\n  \nType\nnone\n/Type\n\n\n/Credential\n\n\nLabel\n\n  \nType\nnone\n/Type\n\n\n/Label\n\n\nInput\n\n \nButton\nOK\n/Button\n\n    \n/Input\n\n      \n/Requirement\n\n    \n/Requirements\n\n  \n/AuthenticationRequirements\n\n\n/AuthenticateResponse\n\n\n\n\nWith elective change password the user has already authenticated to Citrix Receiver for Web. Since the change password request is not essential to access the site, the client UI should provide a Cancel button on the form. If the user chooses to cancel, the Web Proxy cancel post-back URL in the above form must be used to relay to the Authentication service that the request has been cancelled.\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/ExplicitAuth/CancelForm\nHTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: 3E5784A870D03FF16BF7A37415F9E0AB\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 73\nCookie: CtxsAuthMethod=ExplicitForms;\nCsrfToken=3E5784A870D03FF16BF7A37415F9E0AB;\nCtxsAuthId=C389FA6A3BD8E1E3811C184C01918411;\nASP.NET_SessionId=chgeeknlk5aiewkyyqfwp43p\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\noldPassword=\nnewPassword=\nconfirmPassword=\ncancelBtn=Cancel\nSta\nteContext=\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/\nvnd.citrix.authenticateresponse-1+xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Mon, 20 Jan 2014 12:02:33 GMT\nContent-Length: 201\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/\nresponse/1\n\n  \nStatus\nsuccess\n/Status\n\n  \nResult\ncancelled\n/Result\n\n  \nStateContext /\n\n\n/AuthenticateResponse\n\n\n\n\nPost Credentials Authentication\n\n\nWith post credentials authentication, the client supplies the user's credentials directly using HTTP POST. This provides a simpler authentication mechanism than Explicit Forms because the client does not need to parse XML forms and handle the forms conversation. However, this method is less flexible than Explicit Forms authentication and does not support change password functionality, which uses the Common Forms protocol.\n\n\nRequest\n\n\n\n\n\n\n\n\nURL (indicative only)\n\n\nMethod\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n/PostCredentialsAuth/ Login\n\n\nPOST\n\n\nAuthenticates the user using the credentials supplied in the POST body. The URL is returned by / Authentication/ GetAuthMethods.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPOST parameter\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nusername\n\n\nThe username, including a domain specification if required, in either SAM or UPN format. For example, domain\\fred or fred@some.domain\n\n\n\n\n\n\npassword\n\n\nThe password.\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\n\nThe Http Basic authentication method must be enabled for the Authentication service   because the Web Proxy internally uses HttpBasic to authenticate the user to StoreFront.\n\n\nA non-empty username string value must be supplied, but the password may be supplied  with an empty value.\n\n\n\n\n\n\n\n\n\n\n\n\nResponse Code\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n200\n\n\nSuccess or failure\n\n\n\n\n\n\n400\n\n\nThe username or password was not supplied.\n\n\n\n\n\n\n403\n\n\nForbidden, due to one of the following reasons:\n\n\n\n\n\n\n\n\n* Invalid CSRF token\n\n\n\n\n\n\n\n\n* Invalid X-Citrix-IsUsingHTTPS header\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nResponse Format\n\n\nRequest Accept/Response Content-Type Header\n\n\n\n\n\n\n\n\n\n\nXML\n\n\napplication/xml\n\n\n\n\n\n\n\n\nSuccess Response Content\n\n\nWhen a successful response (HTTP status code 200) is returned, the response body contains an XML document with root node AuthenticationStatus and the following child elements:\n\n\n\n\n\n\n\n\nElement name\n\n\nRequired\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nResult\n\n\nYes\n\n\nValue \"success\" or \"failure\".\n\n\n\n\n\n\nAuthType\n\n\nNo\n\n\nThe authentication type, as indicated by one of the authentication method strings: \"ExplicitForms\", \"IntegratedWindows\", \"Certificate\", \"CitrixAGBasic\", \"PostCredentials\". Only sent when authentication succeeds.\n\n\n\n\n\n\nLogMessage\n\n\nNo\n\n\nAn error id indicating the reason for the authentication failure. Typically the generic value \"fatalerror\" is returned, but \"sessiontimeout\" is returned if the Citrix Receiver for Web session has timed out. When the credentials are rejected by the Authentication service, \"loginfailed\" is returned. Only sent when authentication fails.\n\n\n\n\n\n\n\n\nExample: Successful Post Credentials Authentication\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/PostCredentialsAuth/\nLogin HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: 04416E5028580B5783E1A051732214B4\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/ApiExample.html\nContent-Length: 42\nCookie: CsrfToken=04416E5028580B5783E1A051732214B4;\nASP.NET_SessionId=m5utlgwykupmhhbq11c2gt0s\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nusername=acmecorp%5Cuser1\npassword=mypassword\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nSet-Cookie: CtxsAuthId=488731E2C57EF91E84729A3ECB3E5CAF; path=/\nCitrix/StoreWeb/; HttpOnly\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Tue, 28 Jan 2014 13:44:18 GMT\nContent-Length: 159\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticationStatus\n\n  \nResult\nsuccess\n/Result\n\n  \nAuthType\nPostCredentials\n/AuthType\n\n\n/AuthenticationStatus\n \n\n\n\n\nNetScaler Gateway Single Sign-On\n\n\nUse this request to automatically authenticate a user who has authenticated to NetScaler Gateway.\n\n\nRequest\n\n\n\n\n\n\n\n\nURL\n\n\nMethod\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n/GatewayAuth/Login\n\n\nPOST\n\n\nAuthenticates the user using NetScaler Gateway single sign-on.\n\n\n\n\n\n\n\n\n\n\nNotes\n\n\n\n\nWhen Citrix Receiver for Web is accessed through NetScaler Gateway, changing an expired   password during logon is dealt with by the Gateway.\n\n\nSince Citrix Receiver for Web is not involved in the explicit forms authentication, it    does not provide password expiry notification when a user's password expires soon.\n\n\nWhen elective change password is enabled and a user successfully changes their password,  the client must log the user off because there is no way to sync up with NetScaler  Gateway. The user then has to log onto the Gateway again.\n\n\nWhen authentication fails, the StoreFront event logs may reveal further information to    assist with diagnosing the failure.\n\n\n\n\n\n\nResponse\n\n\n\n\n\n\n\n\nResponse Code\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n200\n\n\nSuccess or failure\n\n\n\n\n\n\n403\n\n\nForbidden, due to one of the following reasons:\n\n\n\n\n\n\n\n\n* Invalid CSRF token\n\n\n\n\n\n\n\n\n* Invalid X-Citrix-IsUsingHTTPS header\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nResponse Format\n\n\nRequest Accept/Response Content-Type Header\n\n\n\n\n\n\n\n\n\n\nXML\n\n\napplication/xml\n\n\n\n\n\n\n\n\nSuccess Response Content\n\n\nWhen a successful response (HTTP status code 200) is returned, the response body contains an XML document with root node AuthenticationStatus with the same child elements as described for Explicit Authentication.\n\n\nExample: Successful NetScaler Gateway Authentication\n\n\nRequest\n\n\nPOST https://gateway.acme.com/Citrix/StoreWeb/GatewayAuth/\nLogin HTTP/1.1\nHost: gateway.acme.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nCsrf-Token: AD11BBE759D84186CE8753ABA4246FDD\nX-Citrix-IsUsingHTTPS: Yes\nX-Requested-With: XMLHttpRequest\nReferer: https://gateway.acme.com/Citrix/StoreWeb\nCookie: CsrfToken=AD11BBE759D84186CE8753ABA4246FDD;\nNSC_AAAC=84dc5a2985fe2cdddcb18697f37d49ec0094e9e2145525d5f4f584\n55e445a4a42; ASP.NET_SessionId=rozslfqggjk32jbjggkwptpj\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0\n\n\n\n\nResponse\n\n\nResponse\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nSet-Cookie: CtxsAuthId=9ADB4CFDA7CE38BEA0C64A64C5914145; path=/\nCitrix/StoreWeb/; secure; HttpOnly\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Mon, 20 Jan 2014 15:27:41 GMT\nContent-Length: 216\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticationStatus\n\n  \nResult\nsuccess\n/Result\n\n  \nAuthType\nCitrixAGBasic\n/AuthType\n\n  \nIsChangePasswordEnabled\ntrue\n/IsChangePasswordEnabled\n\n\n/AuthenticationStatus\n\n\n\n\nGet User Name\n\n\nUse this request to obtain the full user name, as configured in Active Directory. If the full user name is unavailable, the user's logon name is returned instead.\n\n\nRequest\n\n\n\n\n\n\n\n\nURL\n\n\nMethod\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n/Authentication/ GetUserName\n\n\nPOST\n\n\nReturns the user name. Obtain the URL from the Citrix Receiver for Web configuration using the getUsernameURL attribute at XPath /clientSettings/ authManager\n\n\n\n\n\n\n\n\n\n\nNotes\n\n\n\n\nThis request requires an authenticated session, indicated by the cookies  ASP.NET_SessionId and CtxsAuthId. When using an unauthenticated Store, no user has  actually logged on and an HTTP 403 response is returned.\n\n\nThe Web Proxy uses the StoreFront Token Validation service to obtain the user name from   the authentication token.\n\n\n\n\n\n\nResponse\n\n\n\n\n\n\n\n\nResponse Code\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n200\n\n\nSuccess or authentication challenge\n\n\n\n\n\n\n403\n\n\nForbidden, due to one of the following reasons:\n\n\n\n\n\n\n\n\n* Invalid CSRF token\n\n\n\n\n\n\n\n\n* Invalid X-Citrix-IsUsingHTTPS header w Invalid CtxsAuthId cookie\n\n\n\n\n\n\n\n\n* Missing authentication token in server session, when the user has not yet logged on\n\n\n\n\n\n\n\n\nSuccess Response Content\n\n\nIf a successful response (HTTP status code 200 OK) is returned, the response body contains the user name as a string in plain text format, encoded as UTF-8.\n\n\nExample: Get User Name\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/Authentication/\nGetUserName HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:24.0) Gecko/\n20100101 Firefox/24.0\nAccept: text/plain, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCsrf-Token: 128B2AA41FE56F42CA4550FEE88198CB\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=128B2AA41FE56F42CA4550FEE88198CB;\nCtxsAuthId=82221BEE46C4C14CAFD2405F9A3C600F;\nASP.NET_SessionId=5cfuoz0dc0p3y0o2nidhglkh\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: text; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Fri, 18 Oct 2013 13:43:17 GMT\nContent-Length: 9\nJoe Blogs\n\n\n\n\nLog Off\n\n\nUse this request to log off a user's web session.\n\n\nRequest\n\n\n\n\n\n\n\n\nURL\n\n\nMethod\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n/Authentication/Logoff\n\n\nPOST\n\n\nTerminates the user's web session. Obtain the URL from the Citrix Receiver for Web configuration using the logoffURL attribute at: XPath /clientSettings/ authManager.\n\n\n\n\n\n\n\n\n\n\nNotes\n\n\n\n\nThis request requires an authenticated session, indicated by the cookies  ASP.NET_SessionId and CtxsAuthId.\n\n\nThe StoreFront Authentication service is called to destroy the user's primary token.\n\n\nThe Web session is terminated and the following cookies are cleared: ASP.NET_SessionId,   CtxsAuthId, CsrfToken.\n\n\n\n\n\n\nResponse\n\n\n\n\n\n\n\n\nResponse Code\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n200\n\n\nSuccess\n\n\n\n\n\n\n403\n\n\nForbidden, due to one of the following reasons:\n\n\n\n\n\n\n\n\n* Invalid CSRF token\n\n\n\n\n\n\n\n\n* Invalid X-Citrix-IsUsingHTTPS header w Invalid CtxsAuthId cookie\n\n\n\n\n\n\n\n\nSuccess Response Content\n\n\nIf a successful response (HTTP status code 200 OK) is returned, the response body is empty.\n\n\nExample: Log Off\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/Authentication/Logoff\nHTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:24.0) Gecko/\n20100101 Firefox/24.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCsrf-Token: 128B2AA41FE56F42CA4550FEE88198CB\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=128B2AA41FE56F42CA4550FEE88198CB;\nCtxsAuthId=82221BEE46C4C14CAFD2405F9A3C600F;\nASP.NET_SessionId=5cfuoz0dc0p3y0o2nidhglkh; AGSSOHasOccurred=;\nPasswordChangeAllowed=\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/\nvnd.citrix.webreceiver.authenticationlogoffresponse+xml\nExpires: -1\nServer: Microsoft-IIS/8.0\nSet-Cookie: CsrfToken=128B2AA41FE56F42CA4550FEE88198CB;\nexpires=Tue, 18-Oct-1983 13:43:23 GMT; path=/Citrix/StoreWeb/\nSet-Cookie: CtxsAuthId=82221BEE46C4C14CAFD2405F9A3C600F;\nexpires=Tue, 18-Oct-1983 13:43:23 GMT; path=/Citrix/StoreWeb/\nSet-Cookie: ASP.NET_SessionId=; path=/\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Fri, 18 Oct 2013 13:43:22 GMT\nContent-Length: 0\n\n\n\n\nResource Enumeration\n\n\nUse this request to get a list of all the resources available for a user. \n\n\nRequest\n\n\n\n\n\n\n\n\nURL (indicative only)\n\n\nMethod\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n/Resources/List\n\n\nPOST\n\n\nReturns a list of all resources available for the user in JSON format\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPOST parameters\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nresourcesDetails\n\n\nThe resource details to include in the response. Use one of the following supported values:\n\n\n\n\n\n\n\n\n* Default\u2014a default set of resource details (see below).\n\n\n\n\n\n\n\n\n* Full\u2014an extended set of resource details (see below).\n\n\n\n\n\n\n\n\nIf you do not specify the parameter, \"Default\" is assumed.\n\n\n\n\n\n\n\n\n\n\nNotes\n\n\n\n\nTypically, this request requires an authenticated session, indicated by the cookies   ASP.NET_SessionId and CtxsAuthId. However, when the Web Proxy is configured to use an   unauthenticated Store, an authenticated session is not required.\n\n\nThe Web Proxy always performs a fresh enumeration for the user by communicating with the  StoreFront Store service to pick up any changes that may have occurred.\n\n\n\n\n\n\nResponse\n\n\n\n\n\n\n\n\nResponse Code\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n200\n\n\nSuccess or authentication challenge\n\n\n\n\n\n\n403\n\n\nForbidden, due to one of the following reasons: w Invalid CSRF token\n\n\n\n\n\n\n\n\n* Invalid X-Citrix-IsUsingHTTPS header w Invalid CtxsAuthId cookie\n\n\n\n\n\n\n\n\n* Invalid CtxsAuthId cookie\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nResponse Format\n\n\nRequest Accept/Response Content-Type Header\n\n\n\n\n\n\n\n\n\n\nJSON\n\n\napplication/json\n\n\n\n\n\n\n\n\nSuccess Response Content\n\n\nWhen a successful response (HTTP status code 200) is returned, the response body contains a JSON object describing the resources that are available for the authenticated user. This object contains the following fields:\n\n\n\n\n\n\n\n\nField\n\n\nJavaScript Type\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nresources\n\n\nObject Array\n\n\nDetails of each published resource available to the user. Each object in the array corresponds to a single resource and contains a set of fields, as described below.\n\n\n\n\n\n\nisSubscriptionEna bled\n\n\nBoolean\n\n\nWhether subscription operations are enabled for the Store or not.\n\n\n\n\n\n\nisUnauthenticated Store\n\n\nBoolean\n\n\nWhether or not the Store is accessible only without first authenticating.\n\n\n\n\n\n\n\n\nThe resources field in the table above is an array of resource objects. Each resource object always contains the following set of fields:\n\n\n\n\n\n\n\n\nField\n\n\nJavaScript Type\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nclienttypes\n\n\nString Array\n\n\nAn array of string values identifying the clients supported for launches. Known values include \nica30\n, \nrade\n, \nrdp\n (XenApp/XenDesktop), \napplication/ios\n, \napplication/android\n (AppController), \ng2m\n, \ng2t\n etc. (Citrix Online Integration using Generic applications).\n\n\n\n\n\n\niconurl\n\n\nString\n\n\nThe URL to request the resource's icon image data.\n\n\n\n\n\n\nid\n\n\nString\n\n\nUnique resource identifier, created by the Web Proxy.\n\n\n\n\n\n\nlaunchstatusurl\n\n\nString\n\n\nThe URL to determine whether a resource is ready to launch or not (see ICA Launch).\n\n\n\n\n\n\nlaunchurl\n\n\nString\n\n\nThe URL to make a launch request (see ICA Launch).\n\n\n\n\n\n\nname\n\n\nString\n\n\nThe user-friendly name of the resource.\n\n\n\n\n\n\npath\n\n\nString\n\n\nThe path defined in the XenApp/XenDesktop site (farm) for the resource.\n\n\n\n\n\n\nshortcutvalidation url\n\n\nString\n\n\nThe app shortcut validation URL, to confirm that an app may be launched using a shortcut.\n\n\n\n\n\n\nsubscriptionstatus\n\n\nString\n\n\nThe subscription status (see Resource Subscription).\n\n\n\n\n\n\n\n\nIn addition, each resource object may contain the following optional fields:\n\n\n\n\n\n\n\n\nField\n\n\nJavaScript Type\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nassigndesktopurl\n\n\nString\n\n\nCall this URL to assign a desktop to the user. Supplied only for XenDesktop assign-on-first-use desktops.\n\n\n\n\n\n\ncontent\n\n\nBoolean\n\n\nSupplied with value \ntrue\n if the resource represents a document as opposed to a published application/desktop, otherwise omitted.\n\n\n\n\n\n\ndescription\n\n\nString\n\n\nA longer text description of the resource.\n\n\n\n\n\n\ndesktopassignmenttype\n\n\nString\n\n\nThe desktop assignment type: one of the values \nshared\n, \nassign-on-first-use\n or \nassigned\n. Supplied only for XenDesktop resources.\n\n\n\n\n\n\ndesktophostname\n\n\nString\n\n\nThe desktop host name, if known. Supplied only for XenDesktop assigned desktops.\n\n\n\n\n\n\ndisabled\n\n\nBoolean\n\n\nSupplied with value \ntrue\n if the resource is not enabled, otherwise omitted.\n\n\n\n\n\n\nisdesktop\n\n\nBoolean\n\n\nSupplied with value \ntrue\n if the resource is a desktop, otherwise omitted.\n\n\n\n\n\n\nkeywords\n\n\nString Array\n\n\nAn array of string values identifying keywords associated with the resource.\n\n\n\n\n\n\nmandatory\n\n\nBoolean\n\n\nSupplied with value true if the resource is tagged by the back-end resource provider as mandatory, otherwise omitted.\n\n\n\n\n\n\nposition\n\n\nString\n\n\nA string representing the relative position of a subscribed resource in the Citrix Receiver for Web UI. Only generated for resources for which a position has already been defined.\n\n\n\n\n\n\npoweroffurl\n\n\nString\n\n\nThe URL to make a machine power-off request. Only supplied if the resource can be powered- off, as reported by the StoreFront Resources service.\n\n\n\n\n\n\nprelaunchurl\n\n\nString\n\n\nThe URL to call to contact the AppController pre-launch service to obtain an updated content URL for single sign-on.\n\n\n\n\n\n\nrecommended\n\n\nBoolean\n\n\nSupplied with value true if the resource is tagged by the back-end resource provider as \nfeatured\n or \nrecommended\n, otherwise omitted.\n\n\n\n\n\n\nrequiresvpn\n\n\nBoolean\n\n\nSupplied with value true if the resource is marked (using the Resources Service VPN keyword,) as launchable remotely (with NetScaler Gatway) only when using a VPN, otherwise omitted.\n\n\n\n\n\n\nrequiresworkflow\n\n\nBoolean\n\n\nSupplied with value true if workflow is enabled for the resource (typically due to the presence of the \nWFS\n keyword).\n\n\n\n\n\n\nsubscriptionurl\n\n\nString\n\n\nThe URL to make a subscription request (see Resource Subscription).\n\n\n\n\n\n\n\n\nWhen the \nresourceDetails\n request parameter specifies that a \"Full\" enumeration should be performed, the following additional, and optional fields may be returned:\n\n\n\n\n\n\n\n\nField\n\n\nJavaScript Type\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nimages\n\n\nObject Array\n\n\nAn array of objects identifying the image sizes and color depths of the resource icon held by the StoreFront Services server (may be used to determine which image sizes are likely to give good results when requested by the client). Each object in the array contains a pair of integer fields named \nsize\n and \ndepth\n.\n\n\n\n\n\n\nplaysfiletypes\n\n\nObject Array\n\n\nAn array of objects describing the file extensions supported by the resource [Application only]. Each object in the array may contain the following fields:\n\n\n\n\n\n\n\n\n\n\nname\n (String): file type association name\n\n\n\n\n\n\n\n\n\n\ndescription\n (String): file type association description\n\n\n\n\n\n\n\n\n\n\nisdefault\n (Boolean): whether this is the default file type association or not\n\n\n\n\n\n\n\n\n\n\nfileextensions\n (String Array): array of file extensions that can be opened by this resource\n\n\n\n\n\n\n\n\n\n\nmimetypes\n (String Array): array of mime types supported by the resource\n\n\n\n\n\n\n\n\n\n\nparameters\n (String Array): array of parameters used for launching the resource\n\n\n\n\n\n\nproperties\n\n\nObject Array\n\n\nResource properties\u2014an array of name value pairs associated with the resource and ultimately supplied by the resource provider. Each object in the array contains a string field name describing the property \nname\n and a string array field \nvalues\n describing a list of property values.\n\n\n\n\n\n\npublishername\n\n\nString\n\n\nThe name of the publisher (the farm name for XenApp).\n\n\n\n\n\n\nshortcuturl\n\n\nString\n\n\nThe app shortcut URL, to use when embedding a link to the resource in a portal page.\n\n\n\n\n\n\nsubscriptionproperties\n\n\nObject Array\n\n\nSubscription properties \u2014 an array of name value pairs associated with the resource subscription and stored in the subscription database. Each object in the array contains a string field name for the property \nname\n and an optional string array field \nvalues\n for the list of property values. For more information, see Resource Subscription.\n\n\n\n\n\n\ntype\n\n\nString\n\n\nThe resource type, typically one of the following values:\n\n\n\n\n\n\n\n\n\n\n* Citrix.MPS.Application\n\n\n\n\n\n\n\n\n\n\n* Citrix.MPS.Desktop\n\n\n\n\n\n\n\n\n\n\n* Citrix.MPS.Document\n\n\n\n\n\n\n\n\n\n\nNotes\n\n\n\n\nThe iconurl value encodes a particular icon size, as configured in the Web.config site    configuration file (resourcesService section, within serverSettings). The StoreFront Store  service returns the icon that best matches the requested size.\n\n\nThe iconurl represents image data at the point that the enumeration was performed. If     the icon for a resource subsequently changes, the URL will not point to the updated image.  However, the URL is persistent because it always points to the same icon, although it may   return 404 after the icon has been updated on the XenApp/XenDesktop server.\n\n\nThe subscriptionUrl is used for both subscribing to and unsubscribing from a resource,    with the operation selected by a POST parameter.\n\n\n\n\n\n\nExample: Request all resources\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/Resources/List HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/\n20100101 Firefox/23.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: EC8A9490C8D32616B21C3EED398FE9EE\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 32\nCookie: CsrfToken=EC8A9490C8D32616B21C3EED398FE9EE;\nCtxsAuthId=BB8B836131AA35C54DF588E631838946;\nASP.NET_SessionId=jel5evcolmhl4bcm1i31exqo; AGSSOHasOccurred=;\nPasswordChangeAllowed=\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nformat=json\nresourceDetails=Default\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Tue, 24 Sep 2013 11:03:37 GMT\nContent-Length: xxxxx\n{\nresources\n:[\n  {\nclienttypes\n:[\nica30\n,\nrdp\n],\n   \ndescription\n:\n,\n   \niconurl\n:\nResources\\/Icon\\/\nNUM2RDNDRDU1QzdBMUE0RjU0NjA4NjRBNTkwMzY0NzQyMEM2OTQ3QQ--\\/48\n,\n   \nid\n:\nQ29udHJvbGxlci4hJCVeJl8rLQ--\n,\n   \nlaunchurl\n:\nResources\\/LaunchIca\\/\nQ29udHJvbGxlci4hJCVeJl8rLQ--\n,\n   \nname\n:\nMicrosoft Word\n,\n   \npath\n:\n\\\\Office Apps\\\\\n,\n   \nshortcutvalidationurl\n:\nResources\\/\nValidateAppShortcutLaunch\\/Q29udHJvbGxlci4hJCVeJl8rLQ--\n,\n   \nsubscriptionstatus\n:null,\n   \nsubscriptionurl\n:\nResources\\/Subscription\\/\nQ29udHJvbGxlci4hJCVeJl8rLQ--\n\n  },\n  {\nclienttypes\n:[\nica30\n,\nrdp\n],\n   \ndescription\n:\n,\n   \ndisabled\n:true,\n   \niconurl\n:\nResources\\/Icon\\/\nNUM2RDNDRDU1QzdBMUE0RjU0NjA4NjRBNTkwMzY0NzQyMEM2OTQ3QQ--\\/48\n,\n   \nid\n:\nQ29udHJvbGxlci4hJF4kJV4-\n,\n   \nlaunchurl\n:\nResources\\/LaunchIca\\/\nQ29udHJvbGxlci4hJF4kJV4-\n,\n   \nname\n:\n!$^$%^\n,\n   \npath\n:\n\\\\Yabba\\\\\n,\n   \nshortcutvalidationurl\n:\nResources\\/\nValidateAppShortcutLaunch\\/Q29udHJvbGxlci4hJF4kJV4-\n,\n   \nsubscriptionstatus\n:null,\n   \nsubscriptionurl\n:\nResources\\/Subscription\\/\nQ29udHJvbGxlci4hJF4kJV4-\n\n   },\n... ],\n \nsubscriptionsEnabled\n:true,\n}\n\n\n\n\nExample: Request all resources (full enumeration)\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/Resources/List HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:24.0) Gecko/\n20100101 Firefox/24.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: 1062D9DA90BA01931DB472C09D61A6EB\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 56\nCookie: CsrfToken=1062D9DA90BA01931DB472C09D61A6EB;\nCtxsAuthId=FEB9E833C66E9D7B4124E04AEC12C3B5;\nASP.NET_SessionId=2zsqy14dgxdctivbs351fmvo\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nformat=json\nresourceDetails=Default\nresourceDetails=Full\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Tue, 24 Sep 2013 11:03:37 GMT\nContent-Length: xxxxx\n{\ncategories\n:[],\n \nresources\n:[\n  {\n    \ntype\n: \nCitrix.MPS.Application\n,\n    \nsubscriptionurl\n: \nResources\\/Subscription\\/\nX83heiDGddg1ldasf87asdfg--\n,\n    \nshortcutvalidationurl\n: \nResources\\/\nValidateAppShortcutLaunch\\/X83heiDGddg1ldasf87asdfg--\n,\n    \nshortcuturl\n: \nhttp:\\/\\/kontiki\\/Citrix\\/StoreWeb\\/#\\/\nlaunch\\/Notepad\n,\n    \npublishername\n: \nfoobar-ic6659\n,\n    \npath\n: \n\\\\\n,\n    \nname\n: \nNotepad\n,\n    \nlaunchurl\n: \nResources\\/LaunchIca\\/\nX83heiDGddg1ldasf87asdfg--\n,\n    \nlaunchstatusurl\n: \nResources\\/GetLaunchStatus\\/\nX83heiDGddg1ldasf87asdfg--\n,\n    \nimages\n: [\n{\n\nsize\n: 48,\n\ndepth\n: 4 },\n{\n\nsize\n: 32,\n\ndepth\n: 4 },\n{\n\nsize\n: 48,\n\ndepth\n: 8 },\n{\n\nsize\n: 32,\n\ndepth\n: 8 },\n       {\n         \nsize\n: 256,\n         \ndepth\n: 32\n       },\n{\n\nsize\n: 48,\n         \ndepth\n: 32\n       },\n{\n\nsize\n: 32,\n         \ndepth\n: 32\n       },\n     ],\n    \nid\n: \nX83heiDGddg1ldasf87asdfg--\n,\n    \niconurl\n: \nResources\\/Icon\\/\nNUM2RDNDRDU1QzdBMUE0RjU0NjA4NjRBNTkwMzY0NzQyMEM2OTQ3QQ--?\nsize=48\n,\n    \ndescription\n: \nTake note!\n,\n    \nclienttypes\n: [\n\nica30\n,\n\nrdp\n ]\n},\n... ],\n \nsubscriptionsEnabled\n:true,\n}\n\n\n\n\nICA Launch\n\n\nUse this request to check if a resource is ready to launch, or to get an ICA file for launching a resource.\n\n\nRequest\n\n\n\n\n\n\n\n\nURL (indicative only)\n\n\nMethod\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n/Resources/ GetLaunchStatus/{id}\n\n\nPOST\n\n\nRequest whether the specified resource is ready to launch or not.\n\n\n\n\n\n\n/Resources/LaunchIca/{id}\n\n\nGET\n\n\nRequest an ICA file for launching the specified resource.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nParameter\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n{id}\n\n\nUnique identifier for a particular resource. Note, this parameter is a component of the URL.\n\n\n\n\n\n\ndisplayNameDesktopTitle\n\n\nThe desktop display name. This is inserted in the generated ICA file as the value for the Title setting. This name is then displayed in the title bar of the Desktop Viewer. Note: this is a POST parameter for GetLaunchStatus and a query string parameter for LaunchIca.\n\n\n\n\n\n\n\n\n\n\nNotes\n\n\n\n\nTypically, these requests require an authenticated session, indicated by the cookies  ASP.NET_SessionId and CtxsAuthId. However, when the Web Proxy is configured to use an   unauthenticated Store, an authenticated session is not required.\n\n\nThe URLs given above are for illustrative purposes; the actual URLs used by a client  must be taken from the result of an earlier enumeration request to /Resources/List.\n\n\nLaunchIca is a GET instead of a POST so that it can be loaded by a browser in a hidden    iframe (using the iframe's src=\"url\" attribute) to trigger a launch via file-type   association.\n\n\nGetLaunchStatus makes a launch request to the Store Service to determine whether the  specified resource is ready to launch or not. If this returns an ICA file, the ICA file is  cached for up to 90 seconds. If a subsequent call is made to LaunchIca within this time,    the cached ICA file is returned without making an additional launch request to the Store    Service.\n\n\nFor LaunchIca, clients must append a query string key with a random value to prevent  browsers from returning a cached response when making multiple launch requests for the  same resource. See the launchId query string parameter in the examples below.\n\n\nCalling GetResourceStatus can trigger a desktop VM to start up.\n\n\n\n\n\n\nResponse\n\n\n\n\n\n\n\n\nResponse Code\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n200\n\n\nSuccess/Retry required/failure, or authentication challenge.\n\n\n\n\n\n\n403\n\n\nForbidden, due to one of the following reasons:\n\n\n\n\n\n\n\n\n* Invalid CSRF token\n\n\n\n\n\n\n\n\n* Invalid X-Citrix-IsUsingHTTPS header (only required for the POST request)\n\n\n\n\n\n\n\n\n* Invalid CtxsAuthId cookie\n\n\n\n\n\n\n404\n\n\nResource identified by {id} was not known to the Web Proxy.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nResponse Format\n\n\nRequest Accept/Response Content-Type Header\n\n\n\n\n\n\n\n\n\n\nJSON\n\n\napplication/json or text/plain (see below)\n\n\n\n\n\n\nICA File\n\n\napplication/octet-stream\n\n\n\n\n\n\n\n\nSuccess Response Content\n\n\nWhen a successful response (HTTP status code 200) for GetLaunchStatus is returned, the response body contains a JSON string describing whether the supplied resource is ready to be launched or not, with the following fields:\n\n\n\n\n\n\n\n\nAttribute\n\n\nJavaScript Type\n\n\nRequired\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nstatus\n\n\nString\n\n\nYes\n\n\nOne of the following strings:\n\n\n\n\n\n\n\n\n\n\n\n\n* success: the resource is ready to be launched.\n\n\n\n\n\n\n\n\n\n\n\n\n* retry: currently, the resource is not ready to be launched (for example, a desktop VM that first needs to be powered on before a connection can be made to it), but the launch attempt may be retried later.\n\n\n\n\n\n\n\n\n\n\n\n\n* failure: the attempt to retrieve launch information failed.\n\n\n\n\n\n\npollTimeout\n\n\nNumber\n\n\nNo\n\n\n\n\n\n\n\n\nerrorId\n\n\nString\n\n\nNo\n\n\n\n\n\n\n\n\nsuggestRestart\n\n\nBoolean\n\n\nNo\n\n\n\n\n\n\n\n\n\n\nWhen a successful response for LaunchIca is returned, the response body can be either a JSON string, as described above, for GetLaunchStatus or, if the resource is ready to launch, an ICA file. Clients typically load the LaunchIca URL into an iframe to obtain an ICA file and trigger a launch via file type association. If LaunchIca returns a JSON response instead of an ICA file, the content type is set to \"text/plain\" because Internet Explorer does not render an \"application/json\" response into the iframe document and instead prompts the user to Open or Save it. If the client is using jQuery, the JSON text response can be deserialized to a JavaScript object by calling $.parseJSON(responseData).\n\n\nExample: Successful ICA launch\n\n\nRequest\n\n\nGET http://webserver/Citrix/StoreWeb/Resources/LaunchIca/\nQ29udHJvbGxlci5EZXNrdG9w.ica?\nCsrfToken=85E9295DFD9CF333F31F0A53B769D915\nlaunchId=13800307750\n58\ndisplayNameDesktopTitle=Desktop HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/\n20100101 Firefox/23.0\nAccept: text/html,application/xhtml+xml,application/\nxml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=85E9295DFD9CF333F31F0A53B769D915;\nCtxsAuthId=5A0B7A991C8136CE17A0D43113C00740;\nASP.NET_SessionId=jel5evcolmhl4bcm1i31exqo\nConnection: keep-alive\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: private, max-age=0, s-maxage=0\nContent-Type: application/octet-stream; charset=utf-8\nExpires: Tue, 24 Sep 2013 13:52:55 GMT\nLast-Modified: Tue, 24 Sep 2013 13:52:55 GMT\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Tue, 24 Sep 2013 13:52:55 GMT\nContent-Length: 1263\n[Encoding]\nInputEncoding=UTF8\n[WFClient]\nProxyFavorIEConnectionSetting=Yes\nProxyTimeout=30000\nProxyType=Auto\nProxyUseFQDN=Off\nRemoveICAFile=yes\nTransportReconnectEnabled=On\n\n... etc. \n\n\n\n\nExample: Failed ICA launch\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/Resources/\nGetLaunchStatus/Q29udHJvbGxlci5Db3B5IG9mIFdvcmRQYWQz HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/\n20100101 Firefox/23.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCsrf-Token: 2730933D4A9C7EFCDA52BD89EC345DD5\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=2730933D4A9C7EFCDA52BD89EC345DD5;\nCtxsAuthId=669C20DF67B0ABC5C0E1F35451EF02A5;\nASP.NET_SessionId=jel5evcolmhl4bcm1i31exqo; AGSSOHasOccurred=;\nPasswordChangeAllowed=\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Tue, 24 Sep 2013 15:49:50 GMT\nContent-Length: 77\n{\nstatus\n:\nfailure\n}\n\n\n\n\nExample: ICA launch with retry\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/Resources/\nGetLaunchStatus/Q29udHJvbGxlci5GaXNoY2FrZSE- HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:24.0) Gecko/\n20100101 Firefox/24.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCsrf-Token: 0035B0DB846D2399576612132C95AF33\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=0035B0DB846D2399576612132C95AF33;\nCtxsAuthId=421E99814A2B99CFA57BB146EE036710;\nASP.NET_SessionId=vmia5swazanokecxwjefwvub\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0\ndisplayNameDesktopTitle=Desktop+Two!\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Tue, 15 Oct 2013 16:22:51 GMT\nContent-Length: 34\n{\nstatus\n:\nretry\n,\npollTimeout\n:5}\n\n\n\n\nIcons\n\n\nUse this request to retrieve icon image data relating to one or more resources. This uses the concept of a 'thumbprint' to allow sharing of image data for resources with equivalent images. The 'thumbprint' is designed to be the same for images with the same content.\n\n\nRequest\n\n\n\n\n\n\n\n\nURL (indicative only)\n\n\nMethod\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n/Resources/Icon/ {thumbprint}?size={size}\n\n\nGET\n\n\nReturns the specified icon image. For more information about the format and details of the response, see below.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nParameter\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n{thumbprint}\n\n\nThe thumbprint for the icon image. This value is included in the iconurl returned from an earlier enumeration request.\n\n\n\n\n\n\n{size}\n\n\nThe pixel size of the icon image to return. Only the values 16, 24, 32, 48, 64, 96, 128, 256 and 512 are supported. This value is included in the iconurl returned from an earlier enumeration request, based on the image size configured in the Citrix Receiver for Web site configuration file (defaults to 48).\n\n\n\n\n\n\n\n\n\n\nNotes\n\n\n\n\nThis request requires an authenticated session, indicated by the cookies  ASP.NET_SessionId and CtxsAuthId.\n\n\nA CSRF token is not required, nor is the X-Citrix-IsUsingHTTPS header, allowing the icon  URL to be directly fetched by a browser (HTTP GET) when specified as the src for an HTML    img element.\n\n\nThe URLs above are for illustrative purposes only; the actual URLs used by a client must  be taken from the result of an earlier enumeration request, which provides a separate icon  URL for each resource.\n\n\nThe thumbprint represents the image data for the resource at the time of enumeration and  so may be different in a subsequent enumeration if the image data has changed.\n\n\nThe response image is always returned in PNG format, with the Content-Type set to image/  png.\n\n\nThe Web Proxy uses the StoreFront Resources API to obtain icon images. The image data is  cached to disk as a performance optimization by default, unless persistent caching is   disabled in the Citrix Receiver for Web configuration file.\n\n\nCaching headers are set in the response to indicate that the icon image may be cached by  the client for one year.\n\n\n\n\n\n\nResponse\n\n\n\n\n\n\n\n\nResponse Code\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n200 (OK)\n\n\nSuccess\n\n\n\n\n\n\n304 (Not Modified)\n\n\nThe request is a 'conditional GET', indicated by the presence of an If-Modified-Since header. If the image has been changed at the back-end, this is only discovered at the next enumeration.\n\n\n\n\n\n\n400 (Bad Request)\n\n\nThe specified size does not match one of the supported icon sizes.\n\n\n\n\n\n\n403 (Forbidden)\n\n\nForbidden, due to an invalid \nCtxsAuthId\n cookie.\n\n\n\n\n\n\n404 (Not Found)\n\n\nReturned for the following cases:\n\n\n\n\n\n\n\n\n* Unknown/missing thumbprint\n\n\n\n\n\n\n\n\n* The requested size does not match the size configured for the Citrix Receiver for Web site\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nResponse Format\n\n\nRequest Accept /Response Content-Type Header\n\n\n\n\n\n\n\n\n\n\nPNG\n\n\nimage/png\n\n\n\n\n\n\n\n\nExample: Successful request for a 48x48 image\n\n\nRequest\n\n\nGET http://webserver/Citrix/StoreWeb/Resources/Icon/\nRjczNDEyMzc3ODlENzE5REZDRUQ4MDczQ0QxMDBGRjI4MDY5MDg2RQ--/48\nHTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/\n20100101 Firefox/23.0\nAccept: image/png,image/*;q=0.8,*/*;q=0.5\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=A902FEE631743C79C5B125FE4BC4DB56;\nCtxsAuthId=5E4A8BF161FBBBC90F64241E40A7D849;\nASP.NET_SessionId=tzqrwypgtof5fnna1fh1jmme\nConnection: keep-alive\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: private, max-age=31536000, s-maxage=0\nContent-Type: image/png\nExpires: Thu, 25 Sep 2014 12:28:46 GMT\nLast-Modified: Wed, 25 Sep 2013 12:28:46 GMT\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Wed, 25 Sep 2013 12:28:46 GMT\nContent-Length: 3184\n... 48 x 48 png image data ...\n\n\n\n\nMachine Power Off\n\n\nUse this request to trigger a power off operation for the specified resource. Only certain resources support this action, and typically only for a limited set of users. If the power off operation does not occur within the time-limit defined on the XenDesktop server, an error response may be returned even if the power off is successful.\n\n\nRequest\n\n\n\n\n\n\n\n\nURL (indicative only)\n\n\nMethod\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n/Resources/PowerOff/{id}\n\n\nPOST\n\n\nAttempts to power off the specified resource.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nParameter\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n{id}\n\n\nUnique identifier for a particular resource.\n\n\n\n\n\n\n\n\n\n\nNotes\n\n\n\n\nThis request requires an authenticated session, indicated by the cookies  ASP.NET_SessionId and CtxsAuthId.\n\n\nThe URL above is for illustrative purposes only; the actual URL used in a request must    be taken from the result of an earlier enumeration request to /Resources/List.\n\n\n\n\n\n\nResponse\n\n\n\n\n\n\n\n\nResponse Code\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n200\n\n\nPowerOff request sent to machine leading to success/ failure of power off operation, or authentication challenge.\n\n\n\n\n\n\n403\n\n\nForbidden, due to one of the following reasons:\n\n\n\n\n\n\n\n\n* Invalid CSRF token\n\n\n\n\n\n\n\n\n* Invalid X-Citrix-IsUsingHTTPS header\n\n\n\n\n\n\n\n\n* Invalid CtxsAuthId cookie\n\n\n\n\n\n\n404\n\n\nResource identified by {id} was not found or the power- off action did not exist or was not enabled for that resource for the current user.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nResponse Format\n\n\nRequest Accept/Response Content-Type Header\n\n\n\n\n\n\n\n\n\n\nJSON\n\n\napplication/json\n\n\n\n\n\n\n\n\nThe response returns a simple JSON object containing the following fields:\n\n\n\n\n\n\n\n\nField\n\n\nJavaScript Type\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nstatus\n\n\nString\n\n\n\"success\" if the power off operation was reported to have completed successfully, otherwise \"failure\".\n\n\n\n\n\n\nerrorId\n\n\nString\n\n\nA string providing a reason for a power off failure (see below).\n\n\n\n\n\n\n\n\nIf the power off operation fails, the error reason is indicated by one of the following error id strings:\n\n\n\n\n\n\n\n\nError Id\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nin-maintenance-mode\n\n\nThe requested operation could not be performed because the machine is in maintenance mode.\n\n\n\n\n\n\nno-machine\n\n\nNo assigned machines were found for the user in the specified machine group.\n\n\n\n\n\n\nnot-supported\n\n\nThe requested operation is not supported on the requested machine group type.\n\n\n\n\n\n\noperation-in-progress\n\n\nThe server is busy with a control operation on the specified machine and cannot handle another request at this time.\n\n\n\n\n\n\ntimed-out\n\n\nThe server timed out waiting for the request to complete. Note: the power off operation may have succeeded, but not within the timeout period defined on the XenDesktop server.\n\n\n\n\n\n\nnot-trusted\n\n\nThe client is not trusted to perform the requested operation. This does not indicate whether the supplied credentials are valid or not.\n\n\n\n\n\n\nunspecified\n\n\nError condition not covered by the other values.\n\n\n\n\n\n\n\n\nExample: Successful Power Off\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/Resources/PowerOff/\nQ29udHJvbGxlci5NaWtlQiBEZXNrdG9wIEdyb3VwICRTMS0x HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:24.0) Gecko/\n20100101 Firefox/24.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCsrf-Token: 5798C908E45771AD767E66F1D176E2D1\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=5798C908E45771AD767E66F1D176E2D1;\nCtxsAuthId=01FBA1051F0D45129D308C6E2F2C303D;\nASP.NET_SessionId=j3xcfc2fdvmjuynowgqlpad4\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Thu, 17 Oct 2013 09:12:53 GMT\nContent-Length: 43\n{\nstatus\n:\nsuccess\n}\n\n\n\n\nResource Subscription\n\n\nUse these requests to perform resource subscription and unsubscription, and to update the relative position (as shown in the UI) of subscribed resources. Subscribed resources are displayed on the Receiver for Web \"Home\" screen, visible when the user logs on. These represent a list of \"favorites\" for quick access. Receiver for Web requires that application resources are subscribed before they can be launched, although no such restriction exists in the protocol. Desktop resources are treated as a special case and are always displayed by Receiver for Web (on a separate UI tab), regardless of subscription state.\n\n\nRequest\n\n\n\n\n\n\n\n\nURL (indicative)\n\n\nMethod\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n/Resources/Subscription/ {id}\n\n\nPOST\n\n\nAction depends upon the operation attribute value specified in the POST parameters:\n\n\n\n\n\n\n\n\n\n\n* \nsubscribe\n\u2014attempt to subscribe to the resource. This may create a new subscription (if one does not already exist) and, by default, sets the subscription to the subscribed state.\n\n\n\n\n\n\n\n\n\n\n* \nunsubscribe\n\u2014attempt to unsubscribe from the resource. This may delete the subscription and, by default, set the subscription to the notSubscribed state.\n\n\n\n\n\n\n\n\n\n\n* \nupdate\n\u2014updates the subscription properties for the resource.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPOST parameter\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nId\n\n\nUnique identifier for a particular resource. Note: this parameter is a component of the URL.\n\n\n\n\n\n\noperation\n\n\nThe subscription operation to perform: either \nsubscribe\n, \nunsubscribe\n, or \nupdate\n.\n\n\n\n\n\n\nupdateMode\n\n\nWhether any supplied subscription properties are to be merged with existing properties, or if the batch of supplied properties will completely replace any existing properties; either \nmerge\n or \nreplace\n.\n\n\n\n\n\n\nsubscription properties\n\n\nOther key=value pairs supplied as request parameters are taken to represent subscription properties.\n\n\n\n\n\n\n\n\n\n\nNotes\n\n\n\n\nThis request requires an authenticated session, indicated by the cookies \nASP . NET _     SessionId\n and \nCtxsAuthId\n.\n\n\nThe URL above is for illustrative purposes only; the actual URLs used in a request must   be taken from the result of an earlier enumeration request to /Resources/List.\n\n\nWhen the Web Proxy is configured to use an unauthenticated Store, subscription    operations are unavailable and these URLs are omitted from the resource enumeration     response. They are also omitted for resources that are configured at XenApp or XenDesktop   to be mandatory resources, which are always displayed to all users.\n\n\nSubscription information is persisted in the Store Service's subscription store and is    returned during enumeration, allowing subscriptions to remain intact across a Citrix    Receiver for Web session and be visible to other Receivers.\n\n\n\n\n\n\n\n\n\n\n\n\nResponse Code (and friendly name)\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n200 (OK)\n\n\nResource subscribed or unsubscribed successfully, or authentication challenge.\n\n\n\n\n\n\n400 (Bad Request)\n\n\nAn unsupported value was supplied for operation or updateMode.\n\n\n\n\n\n\n403 (Forbidden)\n\n\nForbidden, due to one of the following reasons:\n\n\n\n\n\n\n\n\n* Invalid CSRF token\n\n\n\n\n\n\n\n\n* Invalid X-Citrix-IsUsingHTTPS header\n\n\n\n\n\n\n\n\n* Invalid CtxsAuthId cookie\n\n\n\n\n\n\n404 (Not Found)\n\n\nResource identified by {id} was not found.\n\n\n\n\n\n\n503 (Service Unavailable)\n\n\nSubscription operations are unavailable for the specified resource, due to one of the following reasons:\n\n\n\n\n\n\n\n\n* No subscription URL was returned for the requested resource when the previous enumeration request was made, indicating that the StoreFront subscription service was unavailable when that enumeration was performed\n\n\n\n\n\n\n\n\n* The Store Service subscription database is currently unavailable\n\n\n\n\n\n\n\n\nSuccess Response Content\n\n\nWhen a successful response (HTTP status code 200) is returned, the response body contains a JSON object containing one of the following fields:\n\n\n\n\n\n\n\n\nField\n\n\nJavaScript Type\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nstatus\n\n\nString\n\n\nThe new subscription status for the resource, as indicated by one of the following values: \"subscribed\", \"unsubscribed\", \"pending\", \"approved\", \"denied\", \"pendingunsubscribe\", \"subscribedpendingunsubsc ribe\", \"failure\". The first two values are returned for successful operations, when subscriptions are not associated with workflow. The \"failure\" value indicates the subscription request was not successfully proxied to the Store service. The other values relate to workflow scenarios.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nResponse Format\n\n\nRequest Accept /Response Content- Type Header\n\n\n\n\n\n\n\n\n\n\nJSON\n\n\napplication/json\n\n\n\n\n\n\n\n\nExample: Successful subscription\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/Resources/Subscription/\nQ29udHJvbGxlci5Xb3JkUGFk HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/\n20100101 Firefox/23.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: 35D3DAC189174D65DC6D843C9FDAB46A\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 42\nCookie: CsrfToken=35D3DAC189174D65DC6D843C9FDAB46A;\nCtxsAuthId=535CF2577B2FF0DF53F76D3C2D994B92;\nASP.NET_SessionId=0eu5dnpqapdgeu2j1n3sz4zh\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\noperation=subscribe\nposition=B\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Wed, 25 Sep 2013 15:58:41 GMT\nContent-Length: 23\n{\nstatus\n:\nsubscribed\n}\n\n\n\n\nExample: Unsuccessful unsubscription\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/Resources/Subscription/\nQ29udHJvbGxlci5Xb3JkUGFk HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/\n20100101 Firefox/23.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: 35D3DAC189174D65DC6D843C9FDAB46A\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 33\nCookie: CsrfToken=35D3DAC189174D65DC6D843C9FDAB46A;\nCtxsAuthId=535CF2577B2FF0DF53F76D3C2D994B92;\nASP.NET_SessionId=0eu5dnpqapdgeu2j1n3sz4zh\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\noperation=unsubscribe\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Wed, 25 Sep 2013 16:00:23 GMT\nContent-Length: 20\n{\nstatus\n:\nfailure\n}\n\n\n\n\nExample: Successful update of subscription properties\n\n\nThis is an example of a successful update of the data associated with a subscription. The property ids and values are arbitrary from the perspective of the Resources service. Note that the 'bar' property key is repeated to specify a multi-valued property.\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/Resources/Subscription/\nQ29udHJvbGxlci5GaXNoY2FrZSE- HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:24.0) Gecko/\n20100101 Firefox/24.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: 48C7A008D81F87116B4BDE418FB63B3C\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 24\nCookie: CsrfToken=48C7A008D81F87116B4BDE418FB63B3C;\nCtxsAuthId=1AA0681CE60D7E625A504BA0B1E70824;\nASP.NET_SessionId=stoi5utb5zfam1xtfqkjklfd\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\noperation=update\nupdateMode=replace\nfoo=fooValue\nbar=barValue\nb\nar=barValue2\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Tue, 15 Oct 2013 17:12:49 GMT\nContent-Length: 23\n{\nstatus\n:\nsubscribed\n}\n\n\n\n\nSession Enumeration\n\n\nUse this request to enumerate the authenticated user's ICA sessions that are not connected to by the current client, regardless of whether the sessions are disconnected or active on another client. Once enumerated, these sessions can be reconnected using the session launch API.\n\n\nRequest\n\n\n\n\n\n\n\n\nURL (indicative)\n\n\nMethod\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n/Sessions/ListAvailable\n\n\nPOST\n\n\nReturns a list of all available sessions for the user in JSON format.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPOST parameter\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nresourceTypes\n\n\nThe types of resource to include in the response, one of the following values: Citrix.MPS.Application - to request application sessions. Citrix.MPS.Desktop - to request desktop sessions.\n\n\n\n\n\n\n\n\n\n\nNotes\n\n\n\n\nThis request requires an authenticated session, indicated by the cookies  ASP.NET_SessionId and CtxsAuthId. When the Web Proxy is configured to use an    unauthenticated Store, an empty session list is returned.\n\n\nSessions initiated by the current client, as indicated by the DeviceId, are not included  in the returned list of sessions.\n\n\nThe downstream request to enumerate sessions from the StoreFront Store Service always     adds the parameter to include active sessions.\n\n\nWhen used with previous versions of XenApp and XenDesktop, this request also disconnects  any active sessions. This issue was fixed in XenDesktop 7.\n\n\nThe expected usage pattern is for clients to enumerate all available sessions (possibly   for a particular type of resource) and then launch each one in succession. This is how the  Citrix Receiver for Web \"auto reconnect at logon\" functionality is implemented.\n\n\n\n\n\n\nResponse\n\n\n\n\n\n\n\n\nResponse Code (and friendly name)\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n200 (OK)\n\n\nList of available sessions (possibly empty), or authentication challenge.\n\n\n\n\n\n\n403 (Forbidden)\n\n\nForbidden, due to one of the following reasons:\n\n\n\n\n\n\n\n\n* Invalid CSRF token\n\n\n\n\n\n\n\n\n* Invalid X-Citrix-IsUsingHTTPS header w Invalid CtxsAuthId cookie\n\n\n\n\n\n\n\n\nSuccess Response Content\n\n\nWhen a successful response (HTTP status code 200) is returned, the response body contains a JSON array of objects, each containing the following fields:\n\n\n\n\n\n\n\n\nField\n\n\nJavaScript Type\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nlaunchurl\n\n\nString\n\n\nThe URL to make a launch request (see ICA Launch on page 57)\n\n\n\n\n\n\nlaunchstatusurl\n\n\nString\n\n\nThe URL to determine whether a resource is ready to launch (see ICA Launch on page 57)\n\n\n\n\n\n\ninitialApp\n\n\nString\n\n\nThe name of a previously launched app that that caused the session to initially be created.\n\n\n\n\n\n\npublishername\n\n\nString\n\n\nThe name of the publisher (the farm name for XA).\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nResponse Format\n\n\nRequest Accept/Response Content-Type Header\n\n\n\n\n\n\n\n\n\n\nJSON\n\n\napplication/json\n\n\n\n\n\n\n\n\nExample: Session Enumeration\n\n\nIn this example, all sessions are requested by not qualifying the server and client types. \n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/Sessions/ListAvailable\nHTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:24.0) Gecko/\n20100101 Firefox/24.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: BC8E733316E514C1C1E31541D9E44AF9\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 36\nCookie: CtxsDeviceId=WR_AjT2owY5yJ4ED0J-x;\nCsrfToken=BC8E733316E514C1C1E31541D9E44AF9;\nCtxsAuthId=35037C55868C4C1AEE3A24488062C3BD;\nASP.NET_SessionId=ltutfqnaollcehgvre25mwip\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nresourceTypes=Citrix.MPS.Application\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Fri, 18 Oct 2013 09:25:45 GMT\nContent-Length: 191\n[\n {\n  \ninitialapp\n:\nNotepad\n,\n  \nlaunchstatusurl\n:\nSessions\\/GetLaunchStatus\\/\nQ29udHJvbGxlci4xODM5MC4y\n,\n  \nlaunchurl\n:\nSessions\\/LaunchIca\\/Q29udHJvbGxlci4xODM5MC4y\n,\n  \npublishername\n:\njohnc-ic6659\n\n }\n]\n\n\n\n\nSession Launch\n\n\nUse this request to attempt to reconnect to an existing session (either disconnected or active on another client), as specified by session id.\n\n\nRequest\n\n\n\n\n\n\n\n\nURL (indicative)\n\n\nMethod\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n/Sessions/Launch/{id}\n\n\nGET\n\n\nRequest whether the specified session is ready to launch or not.\n\n\n\n\n\n\n/Sessions/ GetLaunchStatus/{id}\n\n\nPOST\n\n\nRequest an ICA file for launching the specified session.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nURL Parameter\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n{id}\n\n\nUnique identifier for a particular session.\n\n\n\n\n\n\n\n\n\n\nNotes\n\n\n\n\nThese requests require an authenticated session, indicated by the cookies \nASP . NET _    SessionId\n and \nCtxsAuthId\n.\n\n\nThe URLs above are for illustrative purposes only; the actual URLs used by a client must  be taken from the result of an earlier session enumeration request to / Sessions/   ListAvailable. When the Web Proxy is configured to use an unauthenticated Store, session    enumeration returns an empty list and session launch is therefore unavailable.\n\n\nLaunch is a GET instead of a POST so that it can be loaded by a browser in a hidden   iframe (using the iframe's src=\"url\" attribute) to trigger a launch via file-type   association.\n\n\nGetLaunchStatus makes a launch request to the Store Service to determine whether the  specified resource is ready to launch or not. If this returns an ICA file, the ICA file is  cached for up to 90 seconds. If a subsequent call is made to LaunchIca within this time,    the cached ICA file is returned without making an additional launch request to the Store    Service.\n\n\nFor LaunchIca, clients must append a query string key with a random value to prevent  browsers from returning a cached response when making multiple launch requests for the  same resource. See the launchId query string parameter in the examples below.\n\n\n\n\n\n\nResponse\n\n\n\n\n\n\n\n\nResponse Code\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n200\n\n\nSuccess/Retry required/failure, or authentication challenge.\n\n\n\n\n\n\n403\n\n\nForbidden, due to one of the following reasons: a) Invalid CSRF token b) Invalid \nX-Citrix-IsUsingHTTPS\n header c) Invalid \nCtxsAuthId\n cookie\n\n\n\n\n\n\n404\n\n\nResource identified by {id} was not found.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nResponse Format\n\n\nRequest Accept/Response Content-Type Header\n\n\n\n\n\n\n\n\n\n\nJSON\n\n\napplication/json\n\n\n\n\n\n\nICA File\n\n\napplication/octet-stream\n\n\n\n\n\n\n\n\nSuccess Response Content\n\n\nWhen a successful response (HTTP status code 200) for GetLaunchStatus is returned, the response body contains a JSON object describing whether the supplied resource is ready to be launched, with the following possible fields:\n\n\n\n\n\n\n\n\nAttribute\n\n\nRequired\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nstatus\n\n\nYes\n\n\nOne of the following strings:\n\n\n\n\n\n\n\n\n\n\n* success\u2014the resource is ready to be launched\n\n\n\n\n\n\n\n\n\n\n* retry\u2014the resource is not currently ready to be launched (for example, a desktop VM that first needs to be powered on before a connection can be made to it), but the launch attempt may be retried later.\n\n\n\n\n\n\n\n\n\n\n* failure\u2014the attempt to retrieve launch information failed\n\n\n\n\n\n\npollTimeout\n\n\nNo\n\n\nOnly supplied when status is \nretry\n, the number of seconds to wait before retrying the launch request.\n\n\n\n\n\n\nerrorId\n\n\nNo\n\n\nOnly supplied when status is \nfailure\n , an error code as described in the Launch section of the StoreFront Store Services API specification.\n\n\n\n\n\n\nsuggestRestart\n\n\nNo\n\n\nOnly supplied when status is \nfailure\n , a \ntrue\n or \nfalse\n value indicating whether the Store service included a \"remedy hint\" that a failed desktop launch could potentially be resolved by restarting the desktop.\n\n\n\n\n\n\n\n\nWhen a successful response for LaunchIca is returned, the response body can be either a JSON string as described above for \nGetLaunchStatus\n or, if the resource is ready to launch, an ICA file.\n\n\nExample: Session Get Launch Status Success\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/Sessions/GetLaunchStatus/\nQ29udHJvbGxlci4xODM5MC4y HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:24.0) Gecko/\n20100101 Firefox/24.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCsrf-Token: BC8E733316E514C1C1E31541D9E44AF9\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=BC8E733316E514C1C1E31541D9E44AF9;\nCtxsAuthId=35037C55868C4C1AEE3A24488062C3BD;\nASP.NET_SessionId=ltutfqnaollcehgvre25mwip\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Fri, 18 Oct 2013 09:25:45 GMT\nContent-Length: 20\n{\nstatus\n:\nsuccess\n}\n\n\n\n\nExample: Session Launch Success\n\n\nRequest\n\n\nGET http://webserver/Citrix/StoreWeb/Sessions/Launch/\nQ29udHJvbGxlci4xODM5MC41.ica?\nCsrfToken=0068C0184E13600DE24B6C1469952BEB\nlaunchId=13801992004\n94 HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/\n20100101 Firefox/23.0\nAccept: text/html,application/xhtml+xml,application/\nxml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=0068C0184E13600DE24B6C1469952BEB;\nCtxsAuthId=6E4966414BE6CE4E46D791655730672B;\nASP.NET_SessionId=kxh5cmlkkjbm5njp22feodrt\nConnection: keep-alive\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/x-ica; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Thu, 26 Sep 2013 12:40:00 GMT\nContent-Length: 1279\n[Encoding]\nInputEncoding=UTF8\n[WFClient]\nProxyFavorIEConnectionSetting=Yes\nProxyTimeout=30000\nProxyType=Auto\n\netc...\n\n\n\n\nSession Disconnect and Logoff\n\n\nUse these requests to disconnect or logoff a user's currently connected sessions at the server.\n\n\nRequest\n\n\n\n\n\n\n\n\nURL (indicative)\n\n\nMethod\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n/Sessions/Disconnect\n\n\nPOST\n\n\nDisconnects the user's sessions.\n\n\n\n\n\n\n/Sessions/Logoff\n\n\nPOST\n\n\nLogs off the user's sessions.\n\n\n\n\n\n\n\n\n\n\nNotes\n\n\n\n\nThese requests require an authenticated session, indicated by the cookies \nASP .NET_  SessionId\n and \nCtxsAuthId\n.\n\n\nWhen the Web Proxy is configured to use an unauthenticated Store, there is no associated  user for whom sessions can be disconnected, and session disconnect has no effect.\n\n\nThese requests operate only on sessions that were initiated from the current client, as   indicated by the DeviceId cookie.\n\n\n\n\n\n\nResponse\n\n\n\n\n\n\n\n\nURL (indicative)\n\n\nMethod\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n/Sessions/Disconnect\n\n\nPOST\n\n\nDisconnects the user's sessions.\n\n\n\n\n\n\n/Sessions/Logoff\n\n\nPOST\n\n\nLogs off the user's sessions.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nResponse Code\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n200\n\n\nSuccess/failure, or authentication challenge.\n\n\n\n\n\n\n403\n\n\nForbidden, due to one of the following reasons:\n\n\n\n\n\n\n\n\n* Invalid CSRF token\n\n\n\n\n\n\n\n\n* Invalid X-Citrix-IsUsingHTTPS header\n\n\n\n\n\n\n\n\n* Invalid CtxsAuthId cookie\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nResponse Format\n\n\nRequest Accept/Response Content-Type Header\n\n\n\n\n\n\n\n\n\n\nJSON\n\n\napplication/json\n\n\n\n\n\n\n\n\nSuccess Response Content\n\n\nWhen a successful response (HTTP status code 200) for Disconnect or Logoff is returned, the response body contains a JSON object with a single JavaScript String field \"status\" with one of the values: \"success\", \"failure\", \"partial\" indicating whether the user's sessions were successfully disconnected or not. The value \"partial\" means that some of the user's sessions were successfully disconnected while others were not.\n\n\nExample: Session Disconnect\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/Sessions/Disconnect HTTP/\n1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/\n20100101 Firefox/23.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCsrf-Token: D6E47EE6160CA2121C3797D0E850FFA0\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=D6E47EE6160CA2121C3797D0E850FFA0;\nCtxsAuthId=BC5CC0F3EC36E6577B3810A12063280C;\nASP.NET_SessionId=jzvwqr2uh1ksws4c3bd2x4gp\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Thu, 26 Sep 2013 14:23:56 GMT\nContent-Length: 20\n{\nstatus\n:\nsuccess\n}\n\n\n\n\nExample: Session Logoff\n\n\nRequest\n\n\nPOST http://webserver/Citrix/StoreWeb/Sessions/Logoff HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:24.0) Gecko/\n20100101 Firefox/24.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCsrf-Token: EA871815F7B33602B391EA5F85757FE8\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=EA871815F7B33602B391EA5F85757FE8;\nCtxsAuthId=C1796CE16F1841181ABFD7DC5DC3E7E2;\nASP.NET_SessionId=zegkvwsdy0hqglxkgtgdcxda\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Fri, 18 Oct 2013 11:12:19 GMT\nContent-Length: 20\n{\nstatus\n:\nsuccess\n}", 
            "title": "Requests"
        }, 
        {
            "location": "/requests/#requests", 
            "text": "The following topics describe the requests available using the API. Each request is described, together with possible response codes and examples.   Note  In some examples, line breaks and white space have been added for readability.", 
            "title": "Requests"
        }, 
        {
            "location": "/requests/#client-configuration", 
            "text": "Use this request to obtain the client configuration settings for the site. These settings define the behavior of the client and provide Web Proxy URLs for other services such as authentication and resource enumeration.\nThis request can be performed before authentication has taken place and before a web session has been established.", 
            "title": "Client Configuration"
        }, 
        {
            "location": "/requests/#request", 
            "text": "URL  Method  Description      /Home/Configuration  GET  Requests the client configuration, which is returned as an XML document        Response Code  Description      200  Success    403  Forbidden, due to one of the following reasons:     - Invalid CSRF token     - Invalid X-Citrix-IsUsingHTTPS header", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#success-response-content", 
            "text": "If a successful response (HTTP status code 200 OK) is returned, the response body contains an XML document describing the Citrix Receiver for Web configuration settings for the client, with root node  clientSettings . For more information about the various configuration elements and attributes, see Using configuration elements on page 81.", 
            "title": "Success Response Content"
        }, 
        {
            "location": "/requests/#example-client-configuration", 
            "text": "", 
            "title": "Example: Client Configuration"
        }, 
        {
            "location": "/requests/#request_1", 
            "text": "POST http://webserver/Citrix/StoreWeb/Home/Configuration HTTP/\n1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/\n20100101 Firefox/23.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCsrf-Token: 4F4F307CAEAB89EEA86EF511788B1BB1\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.0\nSet-Cookie: CsrfToken=597E2BAC2A18AF3816B229D5022B6E2A; path=/\nCitrix/StoreWeb/\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Fri, 20 Sep 2013 15:03:40 GMT\nContent-Length: 1592 clientSettings \n   session timeout= 20  userLanguages= en-US,en;q=0.5  / \n   authManager getUsernameURL= Authentication/GetUserName \n               changeCredentialsURL= Authentication/\nGetChangeCredentialForm \n               logoffURL= Authentication/Logoff \nloginFormTimeout= 5  / \n   storeProxy keepAliveURL= Home/KeepAlive \n     resourcesProxy listURL= Resources/List \nresourceDetails= default  / \n     sessionsProxy listAvailableURL= Sessions/ListAvailable \n                   disconnectURL= Sessions/Disconnect \n                   logoffURL= Sessions/Logoff  / \n   /storeProxy \n   pluginAssistant enabled= true  upgradeAtLogin= true \n     win32 path= http://\ndownloadplugins.citrix.com.edgesuite.net/Windows/\nCitrixReceiverWeb.exe  / \n     macOS path=http://\ndownloadplugins.citrix.com.edgesuite.net/Mac/\nCitrixReceiverWeb.dmg\n           minimumSupportedOSVersion= 10.6  / \n     html5 enabled= Off \n           platforms= Firefox;Chrome;Version/([6-9]|\\d\n\\d).*Safari;MSIE \\d\\d;Trident; \n           launchURL= clients/HTML5Client/src/\nSessionWindow.html \n           preferences=  singleTabLaunch= false \nchromeAppOrigins= chrome-extension://\nhaiffjcadagjlijoggckpgfnoeiflnem|chrome-extension://\nbgiigkppjadidglloadcadeihlnbpagp  / \n   /pluginAssistant \n   userInterface frameOptions= deny  autoLaunchDesktop= true \n     workspaceControl enabled= true \nautoReconnectAtLogon= true  logoffAction= disconnect \n                      showReconnectButton= true \nshowDisconnectButton= true  / \n     receiverConfiguration enabled= true \n                           downloadURL= ServiceRecord/\nGetDocument/receiverconfig.cr  / \n     uiViews showDesktopsView= true  showAppsView= true \ndefaultView= desktops  / \n     appShortcuts enabled= false \nallowSessionReconnect= false  / \n   /userInterface  /clientSettings", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#session-keep-alive", 
            "text": "Use this request to extend the duration of a session. The request can be performed before authentication takes place and before a web session is established. Simply contacting the server keeps the server-side session alive and resets the ASP.NET session idle timer. For example, if the session timeout is 20 minutes and this call is made after 15 minutes of idle time, the user is allowed a further 20 minutes before the session times out.", 
            "title": "Session Keep Alive"
        }, 
        {
            "location": "/requests/#request_2", 
            "text": "URL  Method  Description      /Home/KeepAlive  HEAD  Returns an empty response with an HTTP 200 status code. This is used by the client to extend the life of the HTTP session, which by default times out if no requests are received within a period of 20 minutes.", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_1", 
            "text": "Response Code  Description      200  Success    403  Forbidden, due to one of the following reasons:     * Invalid CSRF token     * Invalid X-Citrix-IsUsingHTTPS header", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#success-response-content_1", 
            "text": "If a successful response (HTTP status code 200 OK) is returned, the response body is empty.", 
            "title": "Success Response Content"
        }, 
        {
            "location": "/requests/#example-session-keep-alive", 
            "text": "", 
            "title": "Example: Session Keep Alive"
        }, 
        {
            "location": "/requests/#request_3", 
            "text": "HEAD http://webserver/Citrix/StoreWeb/Home/KeepAlive HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/\n20100101 Firefox/23.0\nAccept: text/plain, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCsrf-Token: 4DE109CB32EBE310E1902D05D8DD5BDF\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCsrfToken=4DE109CB32EBE310E1902D05D8DD5BDF;\nCtxsAuthId=B3C9A3C0D34C04EE7CC7C0C6B94A509D;\nASP.NET_SessionId=jti1oxzixf5pvwisz5zw05wg; AGSSOHasOccurred=;\nPasswordChangeAllowed=\nConnection: keep-alive", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_2", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Length: 0\nContent-Type: text/html\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Mon, 23 Sep 2013 09:16:35 GMT", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#authentication-methods", 
            "text": "Use the following URL to determine which authentication methods are available, prior to initiating authentication.", 
            "title": "Authentication Methods"
        }, 
        {
            "location": "/requests/#request_4", 
            "text": "URL (indicative only)  Method  Description      /Authentication/ GetAuthMethods  POST  Returns a list of available authentication methods in XML format.      Note   The client must first make a POST request to /Resources/List. Since the user is not yet   authenticated, this returns a challenge in the form of a CitrixWebReceiver- Authenticate    header with the GetAuthMethods URL in the location field.    For example:  CitrixWebReceiver-Authenticate:\nreason= TokenRequired ,location= Authentication/\nGetAuthMethods `   Note   The client must not skip this request by hard-coding any of the authentication URLs, as   these may change from release to release.  The available authentication methods are specified in the Citrix Receiver for Web     configuration file. The list of methods returned is the intersection of those configured    for the Citrix Receiver for Web site and those configured for the StoreFront    Authentication service.  When Gateway authentication is available, use this in preference to (and to the   exclusion of) all other authentication methods. This is because Gateway authentication is   available only when the user is connecting to Citrix Receiver for Web externally through a  NetScaler Gateway, while the other authentication methods are intended only for intranet    use.", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_3", 
            "text": "Response Code  Description      200  Success    403  Forbidden, due to one of the following reasons:     * Invalid CSRF token     * Invalid X-Citrix-IsUsingHTTPS header        Response Format  Request Accept/Response Content-Type Header      XML  application/xml", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#success-response-content_2", 
            "text": "When a successful response (HTTP status code 200) is returned, the response body contains an XML document with root node authMethods and zero or more method child elements. Each method child element contains a name attribute identifying the authentication method and a url attribute that the client uses to initiate authentication using the given method. The possible authentication method names are:     Method name  Typical URL (indicative only)  Description      ExplicitForms  ExplicitAuth/Login  Explicit authentication with user-supplied credentials such as username, domain and password.    IntegratedWindows  DomainPassthroughAuth/ Login  Domain pass-through authentication    Certificate  SmartcardAuth/Login  Smart card (client certificate) authentication    CitrixAGBasic  GatewayAuth/Login  Automatic authentication (\"single-sign-on\") to NetScaler Gateway    PostCredentials  PostCredentialsAuth/Login  Authentication achieved by posting user credentials directly to the Web Proxy.", 
            "title": "Success Response Content"
        }, 
        {
            "location": "/requests/#example-get-auth-methods", 
            "text": "", 
            "title": "Example: Get Auth Methods"
        }, 
        {
            "location": "/requests/#request_5", 
            "text": "POST http://webserver/Citrix/StoreWeb/Authentication/\nGetAuthMethods HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nCsrf-Token: EE87320F00C8694137FBB9319DE3EE80\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=EE87320F00C8694137FBB9319DE3EE80;\nASP.NET_SessionId=vo0ii2tbv2oaqcrko5zjjjlx\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_4", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Wed, 15 Jan 2014 13:17:19 GMT\nContent-Length: 282 ?xml version= 1.0  encoding= UTF-8 ?  authMethods \n     method name= IntegratedWindows \nurl= DomainPassthroughAuth/Login / \n     method name= Certificate  url= SmartcardAuth/Login / \n     method name= ExplicitForms  url= ExplicitAuth/Login /  /authMethods", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#domain-pass-through-and-smart-card-authentication", 
            "text": "Use these requests to authenticate a user either using pass through authentication or a smart card device.", 
            "title": "Domain Pass-Through and Smart Card Authentication"
        }, 
        {
            "location": "/requests/#request_6", 
            "text": "URL (indicative only)  Method  Description      /DomainPassthroughAuth/ Login  POST  Authenticates the user using the credentials with which he or she logged on to the computer.    /SmartcardAuth/Login  POST  Authenticates the user using a smart card connected to the user's client computer.      Notes   Domain pass-through authentication requires the client browser to be running on   Microsoft Windows. The caller must check the client platform OS prior to initiating pass-   through authentication.  The pass-through URL is configured in IIS to be protected by Integrated Windows   Authentication (IWA). The actual authentication takes place between the browser and IIS,    transparently to Citrix Receiver for Web.  The smart card URL is configured in IIS to be accessible only via HTTPS and to require a  client certificate to be supplied by the browser.  Both pass-through and smart card authentication require that the option 'Trust requests   to the XML Service' is enabled on the back-end XenDesktop/XenApp server.  When pass-through authentication is used to authenticate to Citrix Receiver for Web, the  user's password is not available to StoreFront. For launches to work without the user   being prompted for credentials, configure Citrix Receiver as described in  http://  support.citrix.com/article/CTX133855 .  Smart card authentication requires two PIN prompts, one to authenticate to the web site   and another to authenticate to the remote session.  If authentication fails, check the StoreFront event logs which may reveal further     information to assist with diagnosing the failure.", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_5", 
            "text": "Response Code  Description      200  Success or failure.    401  Unauthorized. Returned in the following situations:     * The user attempts pass-through authentication from a computer not joined to the StoreFront domain, and cancels the browser dialog prompting for domain credentials     * The user attempts smart card authentication and cancels one of the browser prompts to insert a card, select a certificate, or enter a PIN.    403  Forbidden, due to one of the following reasons:     * Invalid CSRF token     * Invalid X-Citrix-IsUsingHTTPS header        Response Format  Request Accept/Response Content-Type Header      XML  application/xml", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#success-response-content_3", 
            "text": "When a successful response (HTTP status code 200) is returned, the response body contains an XML document with root node  AuthenticationStatus  and the following child elements:     Element name  Required  Description      Result  Yes  Value \"success\" or \"failure\".    AuthType  No  The authentication type, one of the authentication method strings \"ExplicitForms\", \"IntegratedWindows\", \"Certificate\", \"CitrixAGBasic\", \"PostCredentials\". Only sent when authentication succeeds.    LogMessage  No  An error id indicating the reason for the authentication failure. Typically the generic value \"fatalerror\" is returned, but \"sessiontimeout\" is returned if the Citrix Receiver for Web session has timed out. Only sent when authentication fails.", 
            "title": "Success Response Content"
        }, 
        {
            "location": "/requests/#example-successful-smart-card-authentication", 
            "text": "", 
            "title": "Example: Successful smart card authentication"
        }, 
        {
            "location": "/requests/#request_7", 
            "text": "POST https://webserver.domain.com/Citrix/StoreWeb/\nSmartcardAuth/Login HTTP/1.1\nCsrf-Token: C34A98583E032C5D26D4332A54738447\nAccept: application/xml, text/xml, */*; q=0.01\nX-Citrix-IsUsingHTTPS: Yes\nX-Requested-With: XMLHttpRequest\nReferer: https://webserver.domain.com/Citrix/StoreWeb/\nAccept-Language: en-GB\nAccept-Encoding: gzip, deflate\nUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.3;\nWOW64; Trident/7.0; .NET4.0E; .NET4.0C; .NET CLR\n3.5.30729; .NET CLR 2.0.50727; .NET CLR 3.0.30729; InfoPath.3)\nHost: webserver.domain.com\nContent-Length: 0\nDNT: 1\nConnection: Keep-Alive\nCache-Control: no-cache\nCookie: CsrfToken=C34A98583E032C5D26D4332A54738447;\nASP.NET_SessionId=aisncy3nsdcz2snnpc045y1h", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_6", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/7.5\nSet-Cookie: CtxsAuthId=5989E6314A2ADEB10D4F4A71093CAF6D; path=/\nCitrix/StoreWeb/; secure; HttpOnly\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Fri, 17 Jan 2014 17:39:44 GMT\nContent-Length: 255 ?xml version= 1.0  encoding= UTF-8 ?  AuthenticationStatus \n   Result success /Result \n   AuthType Certificate /AuthType  /AuthenticationStatus", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#example-failed-pass-through-authentication", 
            "text": "In this example, the computer is off-domain, and the user cancels the browser prompt for domain credentials.", 
            "title": "Example: Failed pass-through authentication"
        }, 
        {
            "location": "/requests/#request_8", 
            "text": "POST http://webserver/Citrix/StoreWeb/DomainPassthroughAuth/\nLogin HTTP/1.1\nHost: webserver\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nCsrf-Token: 74F22328CCE9A0C62097A5A77FC7D58B\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=74F22328CCE9A0C62097A5A77FC7D58B;\nASP.NET_SessionId=flz4othwj5g5sc0fw3ywtzos\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_7", 
            "text": "HTTP/1.1 401 Unauthorized\nContent-Type: text/html; charset=utf-8\nServer: Microsoft-IIS/7.5\nWWW-Authenticate: Negotiate\nWWW-Authenticate: NTLM\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Fri, 17 Jan 2014 17:44:14 GMT\nContent-Length: 1293\nProxy-Support: Session-Based-Authentication !DOCTYPE html PUBLIC  -//W3C//DTD XHTML 1.0 Strict//EN  http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd  html xmlns= http://www.w3.org/1999/xhtml  head  meta http-equiv= Content-Type  content= text/html;\ncharset=iso-8859-1 /  title 401 - Unauthorized: Access is denied due to invalid\ncredentials. /title  style type= text/css  !--\nbody{margin:0;font-size:.7em;font-family:Verdana, Arial,\nHelvetica, sans-serif;background:#EEEEEE;}\nfieldset{padding:0 15px 10px 15px;}\nh1{font-size:2.4em;margin:0;color:#FFF;}\nh2{font-size:1.7em;margin:0;color:#CC0000;}\nh3{font-size:1.2em;margin:10px 0 0 0;color:#000000;}\n#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-\nfamily: trebuchet MS , Verdana, sans-serif;color:#FFF;\nbackground-color:#555555;}\n#content{margin:0 0 0 2%;position:relative;}\n.content-container{background:#FFF;width:96%;margin-top:\n8px;padding:10px;position:relative;}\n--  /style  /head  body  div id= header h1 Server Error /h1 /div  div id= content \n  div class= content-container fieldset \n  h2 401 - Unauthorized: Access is denied due to invalid\ncredentials. /h2 \n   h3 You do not have permission to view this directory or\npage using the credentials that you supplied. /h3 \n  /fieldset /div  /div  /body  /html", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#explicit-forms-authentication", 
            "text": "Use this request to authenticate a user using explicit forms authentication. Explicit authentication, where the user enters credentials manually, is performed using the Citrix Common Forms Protocol. See the Citrix StoreFront API documentation for more information about Common Forms authentication.  The client initiates a forms conversation by making a request to the Web Proxy Explicit Forms URL (returned by /Authentication/GetAuthMethods) to get the first form in a possible series of forms. The Web Proxy forwards form requests to the StoreFront Authentication service and relays replies back to the client. All forms are unmodified by the Web Proxy, with the sole exception that any post-back URLs are modified to point to Web Proxy URLs, so that the client never contacts the Authentication service directly.  The forms are always returned as XML, which must be parsed by the client, transformed into corresponding HTML and displayed to the user. Once the user completes and submits a form, the client posts the form data back to a post-back URL provided in the original form XML. This may result in further forms being sent to the client to solicit additional information from the user. The client continues the process of rendering and submitting forms until either an authentication success or failure response is received.  The client must not assume that the initial form returned represents a logon form. Typically, this is the case, but another form may be returned in certain circumstances; for example, a change password form is returned if password expiry is configured and the user's password has expired. Third parties may also use the StoreFront Authentication SDK to inject custom forms into the authentication process.", 
            "title": "Explicit Forms Authentication"
        }, 
        {
            "location": "/requests/#request_9", 
            "text": "URL (indicative only)  Method  Accepts POST data  Description      /ExplicitAuth/Login  POST  No  Requests the first form in an explicit forms conversation. The URL is returned by / Authentication/ GetAuthMethods.    /ExplicitAuth/ LoginAttempt  POST  Yes  Attempts an explicit logon. The URL is returned as the PostBack element in a login form.    /ExplicitAuth/ SendForm  POST  Yes  Proxies a form back to the StoreFront Authentication service. The URL is returned as the PostBack element in a form.    /ExplicitAuth/ GetChangeCredentialForm  POST  No  Requests a change credential form. Used when elective change password support is enabled in the StoreFront Authentication service. The URL is supplied in the RfWeb configuration.    /ExplicitAuth/ CancelForm  POST  No  Cancels the current form. The URL is returned as the CancelPostBack element in a form.     When the user submits a form (for example, by activating a Logon button), the client must process the user-supplied data as described in the section Processing Form Data of the document \"Citrix Receiver Common Authentication Forms Language v2.0\" in the Citrix StoreFront API documentation.   Notes   If the client omits to post any of the required data, the Authentication service rejects  the form, resulting in a failed logon.  Once the user submits a form that results in successful authentication, the StoreFront    Authentication service returns a primary authentication token for the user. All tokens,     including the primary token plus any secondary tokens that are subsequently acquired for    other StoreFront services (for example, Resources service), are held at the Web Proxy on    behalf of the user, so that the client does not need to deal with the complexities of the   authentication system.  Tokens are maintained in the Web Proxy in an ASP.NET session object, which is bound to    the user's browser session via the ASP.NET_SessionId cookie.", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_8", 
            "text": "Response Code  Description      200  Success or failure or an XML form    403  Forbidden, due to one of the following reasons:     * Invalid CSRF token     * Invalid X-Citrix-IsUsingHTTPS header        Response Format  Request Accept/Response Content-Type Header      XML  application/xml", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#success-response-content_4", 
            "text": "When a successful response (HTTP status code 200) is returned, the response body contains an XML document where the root node is either AuthenticationStatus or AuthenticateResponse.  An AuthenticationStatus response indicates either success or failure and contains the following child elements:     Element name  Required  Description      Result  Yes  Value \"success\" or \"failure\".    AuthType  No  The authentication type, indicated by one of the authentication method strings \"ExplicitForms\", \"IntegratedWindows\", \"Certificate\", \"CitrixAGBasic\", \"PostCredentials\". Only sent when authentication succeeds.    LogMessage  No  An error id indicating the reason for the authentication failure. Typically, the generic value \"fatalerror\" is returned, but \"sessiontimeout\" is returned if the Citrix Receiver for Web session has timed out. Only sent when authentication fails.    IsChangePasswordEnabled  No  Value \"true\". Only sent when authentication succeeds and elective change password is enabled.    IsExpiryNotificationEnabled  No  Value \"true\". Only sent when authentication succeeds, password expiry notification is enabled, and the user's password is due to expire within the configured time.    TimeRemaining  No  The time remaining (in minutes) until the user's password expires. Only sent when authentication succeeds, password expiry notification is enabled and the user's password is due to expire within the configured time.     AuthenticateResponse  is an XML description of a form that is displayed to the user to collect additional information required for the authentication operation (typically, logon on change password). See the Common Forms Authentication documentation for information about the various form elements.", 
            "title": "Success Response Content"
        }, 
        {
            "location": "/requests/#example-explicit-authenticationlogon-form-returned", 
            "text": "", 
            "title": "Example: Explicit Authentication\u2014Logon Form Returned"
        }, 
        {
            "location": "/requests/#request_10", 
            "text": "POST http://webserver/Citrix/StoreWeb/ExplicitAuth/Login HTTP/\n1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nCsrf-Token: 23E18D9002817048C931EA636E0D5C81\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CtxsAuthMethod=ExplicitForms;\nCsrfToken=23E18D9002817048C931EA636E0D5C81;\nASP.NET_SessionId=hdqnxu21dz3p2nb2zcfo2sfs\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_9", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/\nvnd.citrix.authenticateresponse-1+xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nX-Citrix-ExplicitAuthProtocol: ExplicitForms\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Fri, 17 Jan 2014 16:25:09 GMT\nContent-Length: 1555 ?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/\nresponse/1 \n   Status success /Status \n   Result more-info /Result \n   StateContext / \n   AuthenticationRequirements \n     PostBack ExplicitAuth/LoginAttempt /PostBack \n     CancelPostBack ExplicitAuth/CancelForm /CancelPostBack \n     CancelButtonText Cancel /CancelButtonText \n     Requirements \n       Requirement \n     Credential \n       ID username /ID \n       SaveID ExplicitForms-Username /SaveID \n       Type username /Type \n     /Credential \n     Label \n       Text User name: /Text \n       Type plain /Type \n     /Label \n     Input \n       AssistiveText domain\\user or user@domain.com /\nAssistiveText \n       Text \n         Secret false /Secret \n         ReadOnly false /ReadOnly \n         InitialValue \n         /InitialValue \n         Constraint .+ /Constraint \n       /Text \n     /Input \n       /Requirement \n       Requirement Credential \n       ID password /ID \n       SaveID ExplicitForms-Password /SaveID \n       Type password /Type \n     /Credential \n     Label \n       Text Password: /Text \n       Type plain /Type \n     /Label \n     Input \n       Text \n         Secret true /Secret \n         ReadOnly false /ReadOnly \n         InitialValue \n         /InitialValue \n         Constraint .+ /Constraint \n       /Text \n     /Input \n       /Requirement \n       Requirement \n     Credential \n       ID saveCredentials /ID \n       Type savecredentials /Type \n     /Credential \n     Label \n       Text Remember my password /Text \n       Type plain /Type \n     /Label \n     Input \n       CheckBox \n         InitialValue false /InitialValue \n       /CheckBox \n     /Input \n       /Requirement \n       Requirement \n     Credential \n       ID loginBtn /ID \n       Type none /Type \n     /Credential \n     Label \n       Type none /Type \n     /Label \n     Input \n       Button Log On /Button \n     /Input \n       /Requirement \n     /Requirements \n   /AuthenticationRequirements  /AuthenticateResponse  The client transforms the XML form description into an HTML representation, which is then dynamically added to the web page DOM. The above XML results in an HTML form consisting of a  User name  label and text input field, a  Password  label and password input field, and a  Log On  button.  The user types his or her credentials in the input fields and submits the form by clicking the  Log On  button.  The client intercepts the form submission and follows the Common Forms Authentication rules to build the form data to send back to the Web Proxy (to be forwarded to the Authentication service). The form is submitted to the PostBack URL; in this case Authentication/LoginAttempt. However, the user mistypes their password which results in the Authentication service returning another logon form XML document, this time highlighting the error with an additional Requirements node.", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#example-explicit-authenticationincorrect-credentials-submitted", 
            "text": "", 
            "title": "Example: Explicit Authentication\u2014Incorrect Credentials Submitted"
        }, 
        {
            "location": "/requests/#request_11", 
            "text": "POST http://webserver/Citrix/StoreWeb/ExplicitAuth/\nLoginAttempt HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: E2FF5D342BA9193DF707062EA7A31C54\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 72\nCookie: CtxsAuthMethod=ExplicitForms;\nCsrfToken=E2FF5D342BA9193DF707062EA7A31C54;\nASP.NET_SessionId=1zfyotwrcjr3uzry3jbqcpvg\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nusername=acmecorp%5Cuser1 password=rubbish loginBtn=Log\n+On StateContext=", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_10", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nSet-Cookie: CtxsAuthId=22BE25569A283D63B1C5668580119320; path=/\nCitrix/StoreWeb/; HttpOnly\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Fri, 17 Jan 2014 16:42:49 GMT\nContent-Length: 157 ?xml version= 1.0  encoding= UTF-8 ?  AuthenticationStatus \n   Result success /Result \n   AuthType ExplicitForms /AuthType  /AuthenticationStatus", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#example-explicit-authenticationpassword-expired", 
            "text": "If StoreFront is configured to allow users to change an expired password and a user attempts to log on when their password has expired, a change password XML form is returned when the user submits their credentials. This form includes a label to inform the user that their password must be changed, and text input fields (plus corresponding labels) for the user to enter the old password and to enter and confirm a new password. Note that the post-back URL is also updated to point back to the Web Proxy URL Authentication/ChangePassword.", 
            "title": "Example: Explicit Authentication\u2014Password Expired"
        }, 
        {
            "location": "/requests/#request_12", 
            "text": "POST http://webserver/Citrix/StoreWeb/ExplicitAuth/\nLoginAttempt HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: A75AC234CA8C565EEEBE96FF81E495BA\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 70\nCookie: CtxsAuthMethod=ExplicitForms;\nCsrfToken=A75AC234CA8C565EEEBE96FF81E495BA;\nASP.NET_SessionId=ulemrewlolkvhallkgcbwm3l\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nusername=acmecorp%5Cuser1 password=mypassword loginBtn=Log\n+On StateContext=", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_11", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/\nvnd.citrix.authenticateresponse-1+xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nX-Citrix-ExplicitAuthProtocol: ExplicitForms\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Mon, 20 Jan 2014 10:53:59 GMT\nContent-Length: 2111 ?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/\nresponse/1 \n   Status success /Status \n   Result update-credentials /Result \n   StateContext / \n   AuthenticationRequirements \n     PostBack ExplicitAuth/SendForm /PostBack \n     CancelPostBack ExplicitAuth/CancelForm /CancelPostBack \n     CancelButtonText Cancel /CancelButtonText \n     Requirements \n       Requirement \n     Credential \n       Type none /Type \n     /Credential \n     Label \n       Text Change Password /Text \n       Type heading /Type \n     /Label \n     Input / \n       /Requirement \n       Requirement \n     Credential \n       Type none /Type \n     /Credential \n     Label \n       Text Your password has expired and must be changed. /\nText \n       Type information /Type \n     /Label \n     Input / \n       /Requirement \n       Requirement \n     Credential \n   Type username /Type  /Credential  Label \n   Text User name: /Text \n   Type plain /Type  /Label  Input \n   Text \n     Secret false /Secret \n     ReadOnly true /ReadOnly \n     InitialValue acmecorp\\user1 /InitialValue \n     Constraint .+ /Constraint \n   /Text  /Input \n   /Requirement \n   Requirement  Credential \n   ID oldPassword /ID \n   Type password /Type  /Credential  Label \n   Text Old password: /Text \n   Type plain /Type  /Label  Input \n   Text \n     Secret true /Secret \n     ReadOnly false /ReadOnly \n     InitialValue \n     /InitialValue \n     Constraint .+ /Constraint \n   /Text  /Input \n   /Requirement \n   Requirement  Credential \n   ID newPassword /ID \n   SaveID ExplicitForms-Password /SaveID \n   Type newpassword /Type  /Credential  Label \n   Text New password: /Text \n   Type plain /Type  /Label  Input \n   Text \n     Secret true /Secret \n     ReadOnly false /ReadOnly \n     InitialValue \n     /InitialValue \n     Constraint .+ /Constraint \n   /Text  /Input \n   /Requirement \n   Requirement  Credential \n   ID confirmPassword /ID  Type newpassword /Type \n     /Credential \n     Label \n       Text Confirm password: /Text \n       Type plain /Type \n     /Label \n     Input \n       Text \n         Secret true /Secret \n         ReadOnly false /ReadOnly \n         InitialValue \n         /InitialValue \n         Constraint .+ /Constraint \n       /Text \n     /Input \n       /Requirement \n       Requirement \n     Credential \n       ID changePasswordBtn /ID \n       Type none /Type \n     /Credential \n     Label \n       Type none /Type \n     /Label \n     Input \n       Button OK /Button \n     /Input \n       /Requirement \n     /Requirements \n   /AuthenticationRequirements  /AuthenticateResponse  When the user enters the requested information and submits the form, a further form is returned by the Authentication service for the user to confirm that their password has been successfully changed. Note that the request specifies the button id changePasswordBtn specified in the form above; failing to specify the correct button id results in the form being rejected. The confirmation form comprises simply of a text label and OK button.", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#request_13", 
            "text": "POST http://webserver/Citrix/StoreWeb/ExplicitAuth/SendForm\nHTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: 94FEF17799905C51ADD4599AC0056209\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 95\nCookie: CtxsAuthMethod=ExplicitForms;\nCsrfToken=94FEF17799905C51ADD4599AC0056209;\nASP.NET_SessionId=01omrcuoenllin1eugyr142j\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\noldPassword=mypassword newPassword=newpassword confirmPassword=\nnewpassword changePasswordBtn=OK StateContext=", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_12", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/\nvnd.citrix.authenticateresponse-1+xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nX-Citrix-ExplicitAuthProtocol: ExplicitForms\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Mon, 20 Jan 2014 11:13:18 GMT\nContent-Length: 720 ?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/\nresponse/1 \n   Status success /Status \n   Result more-info /Result \n   StateContext / \n   AuthenticationRequirements \n     PostBack ExplicitAuth/SendForm /PostBack \n     CancelPostBack \n     /CancelPostBack \n     Requirements \n       Requirement \n     Credential \n       Type none /Type \n     /Credential \n     Label \n       Text Your password has been changed successfully. /Text \n       Type confirmation /Type \n     /Label \n     Input / \n       /Requirement \n       Requirement \n     Credential \n       ID changePasswordConfirmBtn /ID \n       Type none /Type \n     /Credential \n     Label \n       Type none /Type \n     /Label \n     Input \n       Button OK /Button \n     /Input \n       /Requirement \n    nticationRequirements  /AuthenticateResponse  After the user clicks the OK button, the confirmation form is submitted and a successful authentication response is obtained.", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#request_14", 
            "text": "POST http://webserver/Citrix/StoreWeb/ExplicitAuth/SendForm\nHTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: 94FEF17799905C51ADD4599AC0056209\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 41\nCookie: CtxsAuthMethod=ExplicitForms;\nCsrfToken=94FEF17799905C51ADD4599AC0056209;\nASP.NET_SessionId=01omrcuoenllin1eugyr142j\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nchangePasswordConfirmBtn=OK StateContext=", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_13", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nSet-Cookie: CtxsAuthId=7BFB98069F1D33A0FB4268F702B0C983; path=/\nCitrix/StoreWeb/; HttpOnly\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Mon, 20 Jan 2014 11:13:24 GMT\nContent-Length: 157 ?xml version= 1.0  encoding= UTF-8 ?  AuthenticationStatus \n   Result success /Result \n   AuthType ExplicitForms /AuthType  /AuthenticationStatus", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#example-explicit-authenticationelective-change-password", 
            "text": "If StoreFront is configured to allow users to change their password at any time and a user attempts to log on when their password is due to expire within the configured expiry period, a successful authentication response is returned. This response includes additional elements indicating that expiry notification is enabled and the number of days remaining until the password expires.", 
            "title": "Example: Explicit Authentication\u2014Elective Change Password"
        }, 
        {
            "location": "/requests/#request_15", 
            "text": "POST http://webserver/Citrix/StoreWeb/ExplicitAuth/\nLoginAttempt HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: 94FD74E2F4DF05D6B0642D25021F632A\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 70\nCookie: CtxsAuthMethod=ExplicitForms;\nCsrfToken=94FD74E2F4DF05D6B0642D25021F632A;\nASP.NET_SessionId=mgucndg5j24cgvymxgrjblr4\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nusername=acmecorp%5Cuser1 password=mypassword loginBtn=Log\n+On StateContext=\n\n####Response\n```curl\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nSet-Cookie: CtxsAuthId=F431D32D995E3CF6A59F5728A0F54085; path=/\nCitrix/StoreWeb/; HttpOnly\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Mon, 20 Jan 2014 11:25:46 GMT\nContent-Length: 320 ?xml version= 1.0  encoding= UTF-8 ?  AuthenticationStatus \n   Result success /Result \n   AuthType ExplicitForms /AuthType \n   IsChangePasswordEnabled true /IsChangePasswordEnabled \n   IsExpiryNotificationEnabled true /\nIsExpiryNotificationEnabled \n  TimeRemaining 89 /TimeRemaining  /AuthenticationStatus  The client may then provide an interface for the user to initiate an elective change password request at any time using the changeCredentials URL obtained from the Citrix Receiver for Web configuration at XPath /clientSettings/authManager. Requesting this URL initiates a Common Forms protocol conversation, in a similar way to /ExplicitAuth/ Login. If the user submits the form after entering invalid data (or omitting required data), further forms may be generated. The client must be prepared to receive multiple forms in succession and process these until either a success or failure response is received. If the password change is successful, a password confirmation form is returned; when the confirmation form is submitted a successful AuthenticationStatus response is returned. In other words, the change password conversation proceeds exactly as described in the example for the case where the user's password has expired at logon time.", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#request_16", 
            "text": "POST http://webserver/Citrix/StoreWeb/Authentication/\nGetChangeCredentialForm HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nCsrf-Token: A4BF7CB3334846575421F41AD44EBA67\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CtxsAuthMethod=ExplicitForms;\nCsrfToken=A4BF7CB3334846575421F41AD44EBA67;\nCtxsAuthId=910C6BFC2C98184CA57F77556041E0D3;\nASP.NET_SessionId=cxd25yc3xwq10qevwpxywyxu\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_14", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/\nvnd.citrix.authenticateresponse-1+xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nX-Citrix-ExplicitAuthProtocol: ExplicitForms\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Mon, 20 Jan 2014 11:48:00 GMT\nContent-Length: 2097 ?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/\nresponse/1 \n   Status success /Status \n   Result update-credentials /Result \n   StateContext / \n   AuthenticationRequirements \n     PostBack ExplicitAuth/SendForm /PostBack \n     CancelPostBack ExplicitAuth/CancelForm /CancelPostBack \n     CancelButtonText Cancel /CancelButtonText \n     Requirements \n       Requirement \n     Credential \n       Type none /Type \n     /Credential \n     Label \n       Text Change Password /Text \n       Type heading /Type \n     /Label \n     Input / \n       /Requirement \n       Requirement \n     Credential \n       Type none /Type \n     /Credential \n     Label \n       Text Enter your old and new passwords /Text \n       Type information /Type \n     /Label \n     Input / \n       /Requirement \n       Requirement \n     Credential \n       Type username /Type \n     /Credential \n     Label \n       Text User name: /Text \n       Type plain /Type \n     /Label \n     Input \n       Text \n         Secret false /Secret \n         ReadOnly true /ReadOnly \n         InitialValue acmecorp\\user1 /InitialValue \n         Constraint .+ /Constraint \n       /Text \n     /Input \n       /Requirement \n       Requirement \n     Credential \n       ID oldPassword /ID \n       Type password /Type \n     /Credential \n     Label \n       Text Old password: /Text \n       Type plain /Type \n     /Label  Input  Text \n     Secret true /Secret \n     ReadOnly false /ReadOnly \n     InitialValue \n     /InitialValue \n     Constraint .+ /Constraint \n   /Text  /Input \n   /Requirement \n   Requirement  Credential \n   ID newPassword /ID \n   SaveID ExplicitForms-Password /SaveID \n   Type newpassword /Type  /Credential  Label \n   Text New password: /Text \n   Type plain /Type  /Label  Input \n   Text \n     Secret true /Secret \n     ReadOnly false /ReadOnly \n     InitialValue \n     /InitialValue \n     Constraint .+ /Constraint \n   /Text  /Input \n   /Requirement \n   Requirement  Credential \n   ID confirmPassword /ID \n   Type newpassword /Type  /Credential  Label \n   Text Confirm password: /Text \n   Type plain /Type  /Label  Input \n   Text \n     Secret true /Secret \n     ReadOnly false /ReadOnly \n     InitialValue \n     /InitialValue \n     Constraint .+ /Constraint \n   /Text  /Input \n   /Requirement \n   Requirement  Credential \n   ID changePasswordBtn /ID \n   Type none /Type  /Credential  Label \n   Type none /Type  /Label  Input \n  Button OK /Button \n     /Input \n       /Requirement \n     /Requirements \n   /AuthenticationRequirements  /AuthenticateResponse  With elective change password the user has already authenticated to Citrix Receiver for Web. Since the change password request is not essential to access the site, the client UI should provide a Cancel button on the form. If the user chooses to cancel, the Web Proxy cancel post-back URL in the above form must be used to relay to the Authentication service that the request has been cancelled.", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#request_17", 
            "text": "POST http://webserver/Citrix/StoreWeb/ExplicitAuth/CancelForm\nHTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: 3E5784A870D03FF16BF7A37415F9E0AB\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 73\nCookie: CtxsAuthMethod=ExplicitForms;\nCsrfToken=3E5784A870D03FF16BF7A37415F9E0AB;\nCtxsAuthId=C389FA6A3BD8E1E3811C184C01918411;\nASP.NET_SessionId=chgeeknlk5aiewkyyqfwp43p\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\noldPassword= newPassword= confirmPassword= cancelBtn=Cancel Sta\nteContext=", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_15", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/\nvnd.citrix.authenticateresponse-1+xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Mon, 20 Jan 2014 12:02:33 GMT\nContent-Length: 201 ?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/\nresponse/1 \n   Status success /Status \n   Result cancelled /Result \n   StateContext /  /AuthenticateResponse", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#post-credentials-authentication", 
            "text": "With post credentials authentication, the client supplies the user's credentials directly using HTTP POST. This provides a simpler authentication mechanism than Explicit Forms because the client does not need to parse XML forms and handle the forms conversation. However, this method is less flexible than Explicit Forms authentication and does not support change password functionality, which uses the Common Forms protocol.", 
            "title": "Post Credentials Authentication"
        }, 
        {
            "location": "/requests/#request_18", 
            "text": "URL (indicative only)  Method  Description      /PostCredentialsAuth/ Login  POST  Authenticates the user using the credentials supplied in the POST body. The URL is returned by / Authentication/ GetAuthMethods.        POST parameter  Description      username  The username, including a domain specification if required, in either SAM or UPN format. For example, domain\\fred or fred@some.domain    password  The password.      Note   The Http Basic authentication method must be enabled for the Authentication service   because the Web Proxy internally uses HttpBasic to authenticate the user to StoreFront.  A non-empty username string value must be supplied, but the password may be supplied  with an empty value.       Response Code  Description      200  Success or failure    400  The username or password was not supplied.    403  Forbidden, due to one of the following reasons:     * Invalid CSRF token     * Invalid X-Citrix-IsUsingHTTPS header        Response Format  Request Accept/Response Content-Type Header      XML  application/xml", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#success-response-content_5", 
            "text": "When a successful response (HTTP status code 200) is returned, the response body contains an XML document with root node AuthenticationStatus and the following child elements:     Element name  Required  Description      Result  Yes  Value \"success\" or \"failure\".    AuthType  No  The authentication type, as indicated by one of the authentication method strings: \"ExplicitForms\", \"IntegratedWindows\", \"Certificate\", \"CitrixAGBasic\", \"PostCredentials\". Only sent when authentication succeeds.    LogMessage  No  An error id indicating the reason for the authentication failure. Typically the generic value \"fatalerror\" is returned, but \"sessiontimeout\" is returned if the Citrix Receiver for Web session has timed out. When the credentials are rejected by the Authentication service, \"loginfailed\" is returned. Only sent when authentication fails.", 
            "title": "Success Response Content"
        }, 
        {
            "location": "/requests/#example-successful-post-credentials-authentication", 
            "text": "", 
            "title": "Example: Successful Post Credentials Authentication"
        }, 
        {
            "location": "/requests/#request_19", 
            "text": "POST http://webserver/Citrix/StoreWeb/PostCredentialsAuth/\nLogin HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: 04416E5028580B5783E1A051732214B4\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/ApiExample.html\nContent-Length: 42\nCookie: CsrfToken=04416E5028580B5783E1A051732214B4;\nASP.NET_SessionId=m5utlgwykupmhhbq11c2gt0s\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nusername=acmecorp%5Cuser1 password=mypassword", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_16", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nSet-Cookie: CtxsAuthId=488731E2C57EF91E84729A3ECB3E5CAF; path=/\nCitrix/StoreWeb/; HttpOnly\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Tue, 28 Jan 2014 13:44:18 GMT\nContent-Length: 159 ?xml version= 1.0  encoding= UTF-8 ?  AuthenticationStatus \n   Result success /Result \n   AuthType PostCredentials /AuthType  /AuthenticationStatus", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#netscaler-gateway-single-sign-on", 
            "text": "Use this request to automatically authenticate a user who has authenticated to NetScaler Gateway.", 
            "title": "NetScaler Gateway Single Sign-On"
        }, 
        {
            "location": "/requests/#request_20", 
            "text": "URL  Method  Description      /GatewayAuth/Login  POST  Authenticates the user using NetScaler Gateway single sign-on.      Notes   When Citrix Receiver for Web is accessed through NetScaler Gateway, changing an expired   password during logon is dealt with by the Gateway.  Since Citrix Receiver for Web is not involved in the explicit forms authentication, it    does not provide password expiry notification when a user's password expires soon.  When elective change password is enabled and a user successfully changes their password,  the client must log the user off because there is no way to sync up with NetScaler  Gateway. The user then has to log onto the Gateway again.  When authentication fails, the StoreFront event logs may reveal further information to    assist with diagnosing the failure.", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_17", 
            "text": "Response Code  Description      200  Success or failure    403  Forbidden, due to one of the following reasons:     * Invalid CSRF token     * Invalid X-Citrix-IsUsingHTTPS header        Response Format  Request Accept/Response Content-Type Header      XML  application/xml", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#success-response-content_6", 
            "text": "When a successful response (HTTP status code 200) is returned, the response body contains an XML document with root node AuthenticationStatus with the same child elements as described for Explicit Authentication.", 
            "title": "Success Response Content"
        }, 
        {
            "location": "/requests/#example-successful-netscaler-gateway-authentication", 
            "text": "", 
            "title": "Example: Successful NetScaler Gateway Authentication"
        }, 
        {
            "location": "/requests/#request_21", 
            "text": "POST https://gateway.acme.com/Citrix/StoreWeb/GatewayAuth/\nLogin HTTP/1.1\nHost: gateway.acme.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/\n20100101 Firefox/26.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-us,en;q=0.7,fr;q=0.3\nAccept-Encoding: gzip, deflate\nCsrf-Token: AD11BBE759D84186CE8753ABA4246FDD\nX-Citrix-IsUsingHTTPS: Yes\nX-Requested-With: XMLHttpRequest\nReferer: https://gateway.acme.com/Citrix/StoreWeb\nCookie: CsrfToken=AD11BBE759D84186CE8753ABA4246FDD;\nNSC_AAAC=84dc5a2985fe2cdddcb18697f37d49ec0094e9e2145525d5f4f584\n55e445a4a42; ASP.NET_SessionId=rozslfqggjk32jbjggkwptpj\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_18", 
            "text": "Response\nHTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nSet-Cookie: CtxsAuthId=9ADB4CFDA7CE38BEA0C64A64C5914145; path=/\nCitrix/StoreWeb/; secure; HttpOnly\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Mon, 20 Jan 2014 15:27:41 GMT\nContent-Length: 216 ?xml version= 1.0  encoding= UTF-8 ?  AuthenticationStatus \n   Result success /Result \n   AuthType CitrixAGBasic /AuthType \n   IsChangePasswordEnabled true /IsChangePasswordEnabled  /AuthenticationStatus", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#get-user-name", 
            "text": "Use this request to obtain the full user name, as configured in Active Directory. If the full user name is unavailable, the user's logon name is returned instead.", 
            "title": "Get User Name"
        }, 
        {
            "location": "/requests/#request_22", 
            "text": "URL  Method  Description      /Authentication/ GetUserName  POST  Returns the user name. Obtain the URL from the Citrix Receiver for Web configuration using the getUsernameURL attribute at XPath /clientSettings/ authManager      Notes   This request requires an authenticated session, indicated by the cookies  ASP.NET_SessionId and CtxsAuthId. When using an unauthenticated Store, no user has  actually logged on and an HTTP 403 response is returned.  The Web Proxy uses the StoreFront Token Validation service to obtain the user name from   the authentication token.", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_19", 
            "text": "Response Code  Description      200  Success or authentication challenge    403  Forbidden, due to one of the following reasons:     * Invalid CSRF token     * Invalid X-Citrix-IsUsingHTTPS header w Invalid CtxsAuthId cookie     * Missing authentication token in server session, when the user has not yet logged on", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#success-response-content_7", 
            "text": "If a successful response (HTTP status code 200 OK) is returned, the response body contains the user name as a string in plain text format, encoded as UTF-8.", 
            "title": "Success Response Content"
        }, 
        {
            "location": "/requests/#example-get-user-name", 
            "text": "", 
            "title": "Example: Get User Name"
        }, 
        {
            "location": "/requests/#request_23", 
            "text": "POST http://webserver/Citrix/StoreWeb/Authentication/\nGetUserName HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:24.0) Gecko/\n20100101 Firefox/24.0\nAccept: text/plain, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCsrf-Token: 128B2AA41FE56F42CA4550FEE88198CB\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=128B2AA41FE56F42CA4550FEE88198CB;\nCtxsAuthId=82221BEE46C4C14CAFD2405F9A3C600F;\nASP.NET_SessionId=5cfuoz0dc0p3y0o2nidhglkh\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_20", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: text; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Fri, 18 Oct 2013 13:43:17 GMT\nContent-Length: 9\nJoe Blogs", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#log-off", 
            "text": "Use this request to log off a user's web session.", 
            "title": "Log Off"
        }, 
        {
            "location": "/requests/#request_24", 
            "text": "URL  Method  Description      /Authentication/Logoff  POST  Terminates the user's web session. Obtain the URL from the Citrix Receiver for Web configuration using the logoffURL attribute at: XPath /clientSettings/ authManager.      Notes   This request requires an authenticated session, indicated by the cookies  ASP.NET_SessionId and CtxsAuthId.  The StoreFront Authentication service is called to destroy the user's primary token.  The Web session is terminated and the following cookies are cleared: ASP.NET_SessionId,   CtxsAuthId, CsrfToken.", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_21", 
            "text": "Response Code  Description      200  Success    403  Forbidden, due to one of the following reasons:     * Invalid CSRF token     * Invalid X-Citrix-IsUsingHTTPS header w Invalid CtxsAuthId cookie", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#success-response-content_8", 
            "text": "If a successful response (HTTP status code 200 OK) is returned, the response body is empty.", 
            "title": "Success Response Content"
        }, 
        {
            "location": "/requests/#example-log-off", 
            "text": "", 
            "title": "Example: Log Off"
        }, 
        {
            "location": "/requests/#request_25", 
            "text": "POST http://webserver/Citrix/StoreWeb/Authentication/Logoff\nHTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:24.0) Gecko/\n20100101 Firefox/24.0\nAccept: application/xml, text/xml, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCsrf-Token: 128B2AA41FE56F42CA4550FEE88198CB\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=128B2AA41FE56F42CA4550FEE88198CB;\nCtxsAuthId=82221BEE46C4C14CAFD2405F9A3C600F;\nASP.NET_SessionId=5cfuoz0dc0p3y0o2nidhglkh; AGSSOHasOccurred=;\nPasswordChangeAllowed=\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_22", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/\nvnd.citrix.webreceiver.authenticationlogoffresponse+xml\nExpires: -1\nServer: Microsoft-IIS/8.0\nSet-Cookie: CsrfToken=128B2AA41FE56F42CA4550FEE88198CB;\nexpires=Tue, 18-Oct-1983 13:43:23 GMT; path=/Citrix/StoreWeb/\nSet-Cookie: CtxsAuthId=82221BEE46C4C14CAFD2405F9A3C600F;\nexpires=Tue, 18-Oct-1983 13:43:23 GMT; path=/Citrix/StoreWeb/\nSet-Cookie: ASP.NET_SessionId=; path=/\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Fri, 18 Oct 2013 13:43:22 GMT\nContent-Length: 0", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#resource-enumeration", 
            "text": "Use this request to get a list of all the resources available for a user.", 
            "title": "Resource Enumeration"
        }, 
        {
            "location": "/requests/#request_26", 
            "text": "URL (indicative only)  Method  Description      /Resources/List  POST  Returns a list of all resources available for the user in JSON format        POST parameters  Description      resourcesDetails  The resource details to include in the response. Use one of the following supported values:     * Default\u2014a default set of resource details (see below).     * Full\u2014an extended set of resource details (see below).     If you do not specify the parameter, \"Default\" is assumed.      Notes   Typically, this request requires an authenticated session, indicated by the cookies   ASP.NET_SessionId and CtxsAuthId. However, when the Web Proxy is configured to use an   unauthenticated Store, an authenticated session is not required.  The Web Proxy always performs a fresh enumeration for the user by communicating with the  StoreFront Store service to pick up any changes that may have occurred.", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_23", 
            "text": "Response Code  Description      200  Success or authentication challenge    403  Forbidden, due to one of the following reasons: w Invalid CSRF token     * Invalid X-Citrix-IsUsingHTTPS header w Invalid CtxsAuthId cookie     * Invalid CtxsAuthId cookie        Response Format  Request Accept/Response Content-Type Header      JSON  application/json", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#success-response-content_9", 
            "text": "When a successful response (HTTP status code 200) is returned, the response body contains a JSON object describing the resources that are available for the authenticated user. This object contains the following fields:     Field  JavaScript Type  Description      resources  Object Array  Details of each published resource available to the user. Each object in the array corresponds to a single resource and contains a set of fields, as described below.    isSubscriptionEna bled  Boolean  Whether subscription operations are enabled for the Store or not.    isUnauthenticated Store  Boolean  Whether or not the Store is accessible only without first authenticating.     The resources field in the table above is an array of resource objects. Each resource object always contains the following set of fields:     Field  JavaScript Type  Description      clienttypes  String Array  An array of string values identifying the clients supported for launches. Known values include  ica30 ,  rade ,  rdp  (XenApp/XenDesktop),  application/ios ,  application/android  (AppController),  g2m ,  g2t  etc. (Citrix Online Integration using Generic applications).    iconurl  String  The URL to request the resource's icon image data.    id  String  Unique resource identifier, created by the Web Proxy.    launchstatusurl  String  The URL to determine whether a resource is ready to launch or not (see ICA Launch).    launchurl  String  The URL to make a launch request (see ICA Launch).    name  String  The user-friendly name of the resource.    path  String  The path defined in the XenApp/XenDesktop site (farm) for the resource.    shortcutvalidation url  String  The app shortcut validation URL, to confirm that an app may be launched using a shortcut.    subscriptionstatus  String  The subscription status (see Resource Subscription).     In addition, each resource object may contain the following optional fields:     Field  JavaScript Type  Description      assigndesktopurl  String  Call this URL to assign a desktop to the user. Supplied only for XenDesktop assign-on-first-use desktops.    content  Boolean  Supplied with value  true  if the resource represents a document as opposed to a published application/desktop, otherwise omitted.    description  String  A longer text description of the resource.    desktopassignmenttype  String  The desktop assignment type: one of the values  shared ,  assign-on-first-use  or  assigned . Supplied only for XenDesktop resources.    desktophostname  String  The desktop host name, if known. Supplied only for XenDesktop assigned desktops.    disabled  Boolean  Supplied with value  true  if the resource is not enabled, otherwise omitted.    isdesktop  Boolean  Supplied with value  true  if the resource is a desktop, otherwise omitted.    keywords  String Array  An array of string values identifying keywords associated with the resource.    mandatory  Boolean  Supplied with value true if the resource is tagged by the back-end resource provider as mandatory, otherwise omitted.    position  String  A string representing the relative position of a subscribed resource in the Citrix Receiver for Web UI. Only generated for resources for which a position has already been defined.    poweroffurl  String  The URL to make a machine power-off request. Only supplied if the resource can be powered- off, as reported by the StoreFront Resources service.    prelaunchurl  String  The URL to call to contact the AppController pre-launch service to obtain an updated content URL for single sign-on.    recommended  Boolean  Supplied with value true if the resource is tagged by the back-end resource provider as  featured  or  recommended , otherwise omitted.    requiresvpn  Boolean  Supplied with value true if the resource is marked (using the Resources Service VPN keyword,) as launchable remotely (with NetScaler Gatway) only when using a VPN, otherwise omitted.    requiresworkflow  Boolean  Supplied with value true if workflow is enabled for the resource (typically due to the presence of the  WFS  keyword).    subscriptionurl  String  The URL to make a subscription request (see Resource Subscription).     When the  resourceDetails  request parameter specifies that a \"Full\" enumeration should be performed, the following additional, and optional fields may be returned:     Field  JavaScript Type  Description      images  Object Array  An array of objects identifying the image sizes and color depths of the resource icon held by the StoreFront Services server (may be used to determine which image sizes are likely to give good results when requested by the client). Each object in the array contains a pair of integer fields named  size  and  depth .    playsfiletypes  Object Array  An array of objects describing the file extensions supported by the resource [Application only]. Each object in the array may contain the following fields:      name  (String): file type association name      description  (String): file type association description      isdefault  (Boolean): whether this is the default file type association or not      fileextensions  (String Array): array of file extensions that can be opened by this resource      mimetypes  (String Array): array of mime types supported by the resource      parameters  (String Array): array of parameters used for launching the resource    properties  Object Array  Resource properties\u2014an array of name value pairs associated with the resource and ultimately supplied by the resource provider. Each object in the array contains a string field name describing the property  name  and a string array field  values  describing a list of property values.    publishername  String  The name of the publisher (the farm name for XenApp).    shortcuturl  String  The app shortcut URL, to use when embedding a link to the resource in a portal page.    subscriptionproperties  Object Array  Subscription properties \u2014 an array of name value pairs associated with the resource subscription and stored in the subscription database. Each object in the array contains a string field name for the property  name  and an optional string array field  values  for the list of property values. For more information, see Resource Subscription.    type  String  The resource type, typically one of the following values:      * Citrix.MPS.Application      * Citrix.MPS.Desktop      * Citrix.MPS.Document      Notes   The iconurl value encodes a particular icon size, as configured in the Web.config site    configuration file (resourcesService section, within serverSettings). The StoreFront Store  service returns the icon that best matches the requested size.  The iconurl represents image data at the point that the enumeration was performed. If     the icon for a resource subsequently changes, the URL will not point to the updated image.  However, the URL is persistent because it always points to the same icon, although it may   return 404 after the icon has been updated on the XenApp/XenDesktop server.  The subscriptionUrl is used for both subscribing to and unsubscribing from a resource,    with the operation selected by a POST parameter.", 
            "title": "Success Response Content"
        }, 
        {
            "location": "/requests/#example-request-all-resources", 
            "text": "", 
            "title": "Example: Request all resources"
        }, 
        {
            "location": "/requests/#request_27", 
            "text": "POST http://webserver/Citrix/StoreWeb/Resources/List HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/\n20100101 Firefox/23.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: EC8A9490C8D32616B21C3EED398FE9EE\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 32\nCookie: CsrfToken=EC8A9490C8D32616B21C3EED398FE9EE;\nCtxsAuthId=BB8B836131AA35C54DF588E631838946;\nASP.NET_SessionId=jel5evcolmhl4bcm1i31exqo; AGSSOHasOccurred=;\nPasswordChangeAllowed=\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nformat=json resourceDetails=Default", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_24", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Tue, 24 Sep 2013 11:03:37 GMT\nContent-Length: xxxxx\n{ resources :[\n  { clienttypes :[ ica30 , rdp ],\n    description : ,\n    iconurl : Resources\\/Icon\\/\nNUM2RDNDRDU1QzdBMUE0RjU0NjA4NjRBNTkwMzY0NzQyMEM2OTQ3QQ--\\/48 ,\n    id : Q29udHJvbGxlci4hJCVeJl8rLQ-- ,\n    launchurl : Resources\\/LaunchIca\\/\nQ29udHJvbGxlci4hJCVeJl8rLQ-- ,\n    name : Microsoft Word ,\n    path : \\\\Office Apps\\\\ ,\n    shortcutvalidationurl : Resources\\/\nValidateAppShortcutLaunch\\/Q29udHJvbGxlci4hJCVeJl8rLQ-- ,\n    subscriptionstatus :null,\n    subscriptionurl : Resources\\/Subscription\\/\nQ29udHJvbGxlci4hJCVeJl8rLQ-- \n  },\n  { clienttypes :[ ica30 , rdp ],\n    description : ,\n    disabled :true,\n    iconurl : Resources\\/Icon\\/\nNUM2RDNDRDU1QzdBMUE0RjU0NjA4NjRBNTkwMzY0NzQyMEM2OTQ3QQ--\\/48 ,\n    id : Q29udHJvbGxlci4hJF4kJV4- ,\n    launchurl : Resources\\/LaunchIca\\/\nQ29udHJvbGxlci4hJF4kJV4- ,\n    name : !$^$%^ ,\n    path : \\\\Yabba\\\\ ,\n    shortcutvalidationurl : Resources\\/\nValidateAppShortcutLaunch\\/Q29udHJvbGxlci4hJF4kJV4- ,\n    subscriptionstatus :null,\n    subscriptionurl : Resources\\/Subscription\\/\nQ29udHJvbGxlci4hJF4kJV4- \n   },\n... ],\n  subscriptionsEnabled :true,\n}", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#example-request-all-resources-full-enumeration", 
            "text": "", 
            "title": "Example: Request all resources (full enumeration)"
        }, 
        {
            "location": "/requests/#request_28", 
            "text": "POST http://webserver/Citrix/StoreWeb/Resources/List HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:24.0) Gecko/\n20100101 Firefox/24.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: 1062D9DA90BA01931DB472C09D61A6EB\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 56\nCookie: CsrfToken=1062D9DA90BA01931DB472C09D61A6EB;\nCtxsAuthId=FEB9E833C66E9D7B4124E04AEC12C3B5;\nASP.NET_SessionId=2zsqy14dgxdctivbs351fmvo\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nformat=json resourceDetails=Default resourceDetails=Full", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_25", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Tue, 24 Sep 2013 11:03:37 GMT\nContent-Length: xxxxx\n{ categories :[],\n  resources :[\n  {\n     type :  Citrix.MPS.Application ,\n     subscriptionurl :  Resources\\/Subscription\\/\nX83heiDGddg1ldasf87asdfg-- ,\n     shortcutvalidationurl :  Resources\\/\nValidateAppShortcutLaunch\\/X83heiDGddg1ldasf87asdfg-- ,\n     shortcuturl :  http:\\/\\/kontiki\\/Citrix\\/StoreWeb\\/#\\/\nlaunch\\/Notepad ,\n     publishername :  foobar-ic6659 ,\n     path :  \\\\ ,\n     name :  Notepad ,\n     launchurl :  Resources\\/LaunchIca\\/\nX83heiDGddg1ldasf87asdfg-- ,\n     launchstatusurl :  Resources\\/GetLaunchStatus\\/\nX83heiDGddg1ldasf87asdfg-- ,\n     images : [\n{ size : 48, depth : 4 },\n{ size : 32, depth : 4 },\n{ size : 48, depth : 8 },\n{ size : 32, depth : 8 },\n       {\n          size : 256,\n          depth : 32\n       },\n{ size : 48,\n          depth : 32\n       },\n{ size : 32,\n          depth : 32\n       },\n     ],\n     id :  X83heiDGddg1ldasf87asdfg-- ,\n     iconurl :  Resources\\/Icon\\/\nNUM2RDNDRDU1QzdBMUE0RjU0NjA4NjRBNTkwMzY0NzQyMEM2OTQ3QQ--?\nsize=48 ,\n     description :  Take note! ,\n     clienttypes : [ ica30 , rdp  ]\n},\n... ],\n  subscriptionsEnabled :true,\n}", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#ica-launch", 
            "text": "Use this request to check if a resource is ready to launch, or to get an ICA file for launching a resource.", 
            "title": "ICA Launch"
        }, 
        {
            "location": "/requests/#request_29", 
            "text": "URL (indicative only)  Method  Description      /Resources/ GetLaunchStatus/{id}  POST  Request whether the specified resource is ready to launch or not.    /Resources/LaunchIca/{id}  GET  Request an ICA file for launching the specified resource.        Parameter  Description      {id}  Unique identifier for a particular resource. Note, this parameter is a component of the URL.    displayNameDesktopTitle  The desktop display name. This is inserted in the generated ICA file as the value for the Title setting. This name is then displayed in the title bar of the Desktop Viewer. Note: this is a POST parameter for GetLaunchStatus and a query string parameter for LaunchIca.      Notes   Typically, these requests require an authenticated session, indicated by the cookies  ASP.NET_SessionId and CtxsAuthId. However, when the Web Proxy is configured to use an   unauthenticated Store, an authenticated session is not required.  The URLs given above are for illustrative purposes; the actual URLs used by a client  must be taken from the result of an earlier enumeration request to /Resources/List.  LaunchIca is a GET instead of a POST so that it can be loaded by a browser in a hidden    iframe (using the iframe's src=\"url\" attribute) to trigger a launch via file-type   association.  GetLaunchStatus makes a launch request to the Store Service to determine whether the  specified resource is ready to launch or not. If this returns an ICA file, the ICA file is  cached for up to 90 seconds. If a subsequent call is made to LaunchIca within this time,    the cached ICA file is returned without making an additional launch request to the Store    Service.  For LaunchIca, clients must append a query string key with a random value to prevent  browsers from returning a cached response when making multiple launch requests for the  same resource. See the launchId query string parameter in the examples below.  Calling GetResourceStatus can trigger a desktop VM to start up.", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_26", 
            "text": "Response Code  Description      200  Success/Retry required/failure, or authentication challenge.    403  Forbidden, due to one of the following reasons:     * Invalid CSRF token     * Invalid X-Citrix-IsUsingHTTPS header (only required for the POST request)     * Invalid CtxsAuthId cookie    404  Resource identified by {id} was not known to the Web Proxy.        Response Format  Request Accept/Response Content-Type Header      JSON  application/json or text/plain (see below)    ICA File  application/octet-stream", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#success-response-content_10", 
            "text": "When a successful response (HTTP status code 200) for GetLaunchStatus is returned, the response body contains a JSON string describing whether the supplied resource is ready to be launched or not, with the following fields:     Attribute  JavaScript Type  Required  Description      status  String  Yes  One of the following strings:       * success: the resource is ready to be launched.       * retry: currently, the resource is not ready to be launched (for example, a desktop VM that first needs to be powered on before a connection can be made to it), but the launch attempt may be retried later.       * failure: the attempt to retrieve launch information failed.    pollTimeout  Number  No     errorId  String  No     suggestRestart  Boolean  No      When a successful response for LaunchIca is returned, the response body can be either a JSON string, as described above, for GetLaunchStatus or, if the resource is ready to launch, an ICA file. Clients typically load the LaunchIca URL into an iframe to obtain an ICA file and trigger a launch via file type association. If LaunchIca returns a JSON response instead of an ICA file, the content type is set to \"text/plain\" because Internet Explorer does not render an \"application/json\" response into the iframe document and instead prompts the user to Open or Save it. If the client is using jQuery, the JSON text response can be deserialized to a JavaScript object by calling $.parseJSON(responseData).", 
            "title": "Success Response Content"
        }, 
        {
            "location": "/requests/#example-successful-ica-launch", 
            "text": "", 
            "title": "Example: Successful ICA launch"
        }, 
        {
            "location": "/requests/#request_30", 
            "text": "GET http://webserver/Citrix/StoreWeb/Resources/LaunchIca/\nQ29udHJvbGxlci5EZXNrdG9w.ica?\nCsrfToken=85E9295DFD9CF333F31F0A53B769D915 launchId=13800307750\n58 displayNameDesktopTitle=Desktop HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/\n20100101 Firefox/23.0\nAccept: text/html,application/xhtml+xml,application/\nxml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=85E9295DFD9CF333F31F0A53B769D915;\nCtxsAuthId=5A0B7A991C8136CE17A0D43113C00740;\nASP.NET_SessionId=jel5evcolmhl4bcm1i31exqo\nConnection: keep-alive", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_27", 
            "text": "HTTP/1.1 200 OK\nCache-Control: private, max-age=0, s-maxage=0\nContent-Type: application/octet-stream; charset=utf-8\nExpires: Tue, 24 Sep 2013 13:52:55 GMT\nLast-Modified: Tue, 24 Sep 2013 13:52:55 GMT\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Tue, 24 Sep 2013 13:52:55 GMT\nContent-Length: 1263\n[Encoding]\nInputEncoding=UTF8\n[WFClient]\nProxyFavorIEConnectionSetting=Yes\nProxyTimeout=30000\nProxyType=Auto\nProxyUseFQDN=Off\nRemoveICAFile=yes\nTransportReconnectEnabled=On ... etc.", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#example-failed-ica-launch", 
            "text": "", 
            "title": "Example: Failed ICA launch"
        }, 
        {
            "location": "/requests/#request_31", 
            "text": "POST http://webserver/Citrix/StoreWeb/Resources/\nGetLaunchStatus/Q29udHJvbGxlci5Db3B5IG9mIFdvcmRQYWQz HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/\n20100101 Firefox/23.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCsrf-Token: 2730933D4A9C7EFCDA52BD89EC345DD5\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=2730933D4A9C7EFCDA52BD89EC345DD5;\nCtxsAuthId=669C20DF67B0ABC5C0E1F35451EF02A5;\nASP.NET_SessionId=jel5evcolmhl4bcm1i31exqo; AGSSOHasOccurred=;\nPasswordChangeAllowed=\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_28", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Tue, 24 Sep 2013 15:49:50 GMT\nContent-Length: 77\n{ status : failure }", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#example-ica-launch-with-retry", 
            "text": "", 
            "title": "Example: ICA launch with retry"
        }, 
        {
            "location": "/requests/#request_32", 
            "text": "POST http://webserver/Citrix/StoreWeb/Resources/\nGetLaunchStatus/Q29udHJvbGxlci5GaXNoY2FrZSE- HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:24.0) Gecko/\n20100101 Firefox/24.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCsrf-Token: 0035B0DB846D2399576612132C95AF33\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=0035B0DB846D2399576612132C95AF33;\nCtxsAuthId=421E99814A2B99CFA57BB146EE036710;\nASP.NET_SessionId=vmia5swazanokecxwjefwvub\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0\ndisplayNameDesktopTitle=Desktop+Two!", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_29", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Tue, 15 Oct 2013 16:22:51 GMT\nContent-Length: 34\n{ status : retry , pollTimeout :5}", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#icons", 
            "text": "Use this request to retrieve icon image data relating to one or more resources. This uses the concept of a 'thumbprint' to allow sharing of image data for resources with equivalent images. The 'thumbprint' is designed to be the same for images with the same content.", 
            "title": "Icons"
        }, 
        {
            "location": "/requests/#request_33", 
            "text": "URL (indicative only)  Method  Description      /Resources/Icon/ {thumbprint}?size={size}  GET  Returns the specified icon image. For more information about the format and details of the response, see below.        Parameter  Description      {thumbprint}  The thumbprint for the icon image. This value is included in the iconurl returned from an earlier enumeration request.    {size}  The pixel size of the icon image to return. Only the values 16, 24, 32, 48, 64, 96, 128, 256 and 512 are supported. This value is included in the iconurl returned from an earlier enumeration request, based on the image size configured in the Citrix Receiver for Web site configuration file (defaults to 48).      Notes   This request requires an authenticated session, indicated by the cookies  ASP.NET_SessionId and CtxsAuthId.  A CSRF token is not required, nor is the X-Citrix-IsUsingHTTPS header, allowing the icon  URL to be directly fetched by a browser (HTTP GET) when specified as the src for an HTML    img element.  The URLs above are for illustrative purposes only; the actual URLs used by a client must  be taken from the result of an earlier enumeration request, which provides a separate icon  URL for each resource.  The thumbprint represents the image data for the resource at the time of enumeration and  so may be different in a subsequent enumeration if the image data has changed.  The response image is always returned in PNG format, with the Content-Type set to image/  png.  The Web Proxy uses the StoreFront Resources API to obtain icon images. The image data is  cached to disk as a performance optimization by default, unless persistent caching is   disabled in the Citrix Receiver for Web configuration file.  Caching headers are set in the response to indicate that the icon image may be cached by  the client for one year.", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_30", 
            "text": "Response Code  Description      200 (OK)  Success    304 (Not Modified)  The request is a 'conditional GET', indicated by the presence of an If-Modified-Since header. If the image has been changed at the back-end, this is only discovered at the next enumeration.    400 (Bad Request)  The specified size does not match one of the supported icon sizes.    403 (Forbidden)  Forbidden, due to an invalid  CtxsAuthId  cookie.    404 (Not Found)  Returned for the following cases:     * Unknown/missing thumbprint     * The requested size does not match the size configured for the Citrix Receiver for Web site        Response Format  Request Accept /Response Content-Type Header      PNG  image/png", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#example-successful-request-for-a-48x48-image", 
            "text": "", 
            "title": "Example: Successful request for a 48x48 image"
        }, 
        {
            "location": "/requests/#request_34", 
            "text": "GET http://webserver/Citrix/StoreWeb/Resources/Icon/\nRjczNDEyMzc3ODlENzE5REZDRUQ4MDczQ0QxMDBGRjI4MDY5MDg2RQ--/48\nHTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/\n20100101 Firefox/23.0\nAccept: image/png,image/*;q=0.8,*/*;q=0.5\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=A902FEE631743C79C5B125FE4BC4DB56;\nCtxsAuthId=5E4A8BF161FBBBC90F64241E40A7D849;\nASP.NET_SessionId=tzqrwypgtof5fnna1fh1jmme\nConnection: keep-alive", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_31", 
            "text": "HTTP/1.1 200 OK\nCache-Control: private, max-age=31536000, s-maxage=0\nContent-Type: image/png\nExpires: Thu, 25 Sep 2014 12:28:46 GMT\nLast-Modified: Wed, 25 Sep 2013 12:28:46 GMT\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Wed, 25 Sep 2013 12:28:46 GMT\nContent-Length: 3184\n... 48 x 48 png image data ...", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#machine-power-off", 
            "text": "Use this request to trigger a power off operation for the specified resource. Only certain resources support this action, and typically only for a limited set of users. If the power off operation does not occur within the time-limit defined on the XenDesktop server, an error response may be returned even if the power off is successful.", 
            "title": "Machine Power Off"
        }, 
        {
            "location": "/requests/#request_35", 
            "text": "URL (indicative only)  Method  Description      /Resources/PowerOff/{id}  POST  Attempts to power off the specified resource.        Parameter  Description      {id}  Unique identifier for a particular resource.      Notes   This request requires an authenticated session, indicated by the cookies  ASP.NET_SessionId and CtxsAuthId.  The URL above is for illustrative purposes only; the actual URL used in a request must    be taken from the result of an earlier enumeration request to /Resources/List.", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_32", 
            "text": "Response Code  Description      200  PowerOff request sent to machine leading to success/ failure of power off operation, or authentication challenge.    403  Forbidden, due to one of the following reasons:     * Invalid CSRF token     * Invalid X-Citrix-IsUsingHTTPS header     * Invalid CtxsAuthId cookie    404  Resource identified by {id} was not found or the power- off action did not exist or was not enabled for that resource for the current user.        Response Format  Request Accept/Response Content-Type Header      JSON  application/json     The response returns a simple JSON object containing the following fields:     Field  JavaScript Type  Description      status  String  \"success\" if the power off operation was reported to have completed successfully, otherwise \"failure\".    errorId  String  A string providing a reason for a power off failure (see below).     If the power off operation fails, the error reason is indicated by one of the following error id strings:     Error Id  Description      in-maintenance-mode  The requested operation could not be performed because the machine is in maintenance mode.    no-machine  No assigned machines were found for the user in the specified machine group.    not-supported  The requested operation is not supported on the requested machine group type.    operation-in-progress  The server is busy with a control operation on the specified machine and cannot handle another request at this time.    timed-out  The server timed out waiting for the request to complete. Note: the power off operation may have succeeded, but not within the timeout period defined on the XenDesktop server.    not-trusted  The client is not trusted to perform the requested operation. This does not indicate whether the supplied credentials are valid or not.    unspecified  Error condition not covered by the other values.", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#example-successful-power-off", 
            "text": "", 
            "title": "Example: Successful Power Off"
        }, 
        {
            "location": "/requests/#request_36", 
            "text": "POST http://webserver/Citrix/StoreWeb/Resources/PowerOff/\nQ29udHJvbGxlci5NaWtlQiBEZXNrdG9wIEdyb3VwICRTMS0x HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:24.0) Gecko/\n20100101 Firefox/24.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCsrf-Token: 5798C908E45771AD767E66F1D176E2D1\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=5798C908E45771AD767E66F1D176E2D1;\nCtxsAuthId=01FBA1051F0D45129D308C6E2F2C303D;\nASP.NET_SessionId=j3xcfc2fdvmjuynowgqlpad4\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_33", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Thu, 17 Oct 2013 09:12:53 GMT\nContent-Length: 43\n{ status : success }", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#resource-subscription", 
            "text": "Use these requests to perform resource subscription and unsubscription, and to update the relative position (as shown in the UI) of subscribed resources. Subscribed resources are displayed on the Receiver for Web \"Home\" screen, visible when the user logs on. These represent a list of \"favorites\" for quick access. Receiver for Web requires that application resources are subscribed before they can be launched, although no such restriction exists in the protocol. Desktop resources are treated as a special case and are always displayed by Receiver for Web (on a separate UI tab), regardless of subscription state.", 
            "title": "Resource Subscription"
        }, 
        {
            "location": "/requests/#request_37", 
            "text": "URL (indicative)  Method  Description      /Resources/Subscription/ {id}  POST  Action depends upon the operation attribute value specified in the POST parameters:      *  subscribe \u2014attempt to subscribe to the resource. This may create a new subscription (if one does not already exist) and, by default, sets the subscription to the subscribed state.      *  unsubscribe \u2014attempt to unsubscribe from the resource. This may delete the subscription and, by default, set the subscription to the notSubscribed state.      *  update \u2014updates the subscription properties for the resource.        POST parameter  Description      Id  Unique identifier for a particular resource. Note: this parameter is a component of the URL.    operation  The subscription operation to perform: either  subscribe ,  unsubscribe , or  update .    updateMode  Whether any supplied subscription properties are to be merged with existing properties, or if the batch of supplied properties will completely replace any existing properties; either  merge  or  replace .    subscription properties  Other key=value pairs supplied as request parameters are taken to represent subscription properties.      Notes   This request requires an authenticated session, indicated by the cookies  ASP . NET _     SessionId  and  CtxsAuthId .  The URL above is for illustrative purposes only; the actual URLs used in a request must   be taken from the result of an earlier enumeration request to /Resources/List.  When the Web Proxy is configured to use an unauthenticated Store, subscription    operations are unavailable and these URLs are omitted from the resource enumeration     response. They are also omitted for resources that are configured at XenApp or XenDesktop   to be mandatory resources, which are always displayed to all users.  Subscription information is persisted in the Store Service's subscription store and is    returned during enumeration, allowing subscriptions to remain intact across a Citrix    Receiver for Web session and be visible to other Receivers.       Response Code (and friendly name)  Description      200 (OK)  Resource subscribed or unsubscribed successfully, or authentication challenge.    400 (Bad Request)  An unsupported value was supplied for operation or updateMode.    403 (Forbidden)  Forbidden, due to one of the following reasons:     * Invalid CSRF token     * Invalid X-Citrix-IsUsingHTTPS header     * Invalid CtxsAuthId cookie    404 (Not Found)  Resource identified by {id} was not found.    503 (Service Unavailable)  Subscription operations are unavailable for the specified resource, due to one of the following reasons:     * No subscription URL was returned for the requested resource when the previous enumeration request was made, indicating that the StoreFront subscription service was unavailable when that enumeration was performed     * The Store Service subscription database is currently unavailable", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#success-response-content_11", 
            "text": "When a successful response (HTTP status code 200) is returned, the response body contains a JSON object containing one of the following fields:     Field  JavaScript Type  Description      status  String  The new subscription status for the resource, as indicated by one of the following values: \"subscribed\", \"unsubscribed\", \"pending\", \"approved\", \"denied\", \"pendingunsubscribe\", \"subscribedpendingunsubsc ribe\", \"failure\". The first two values are returned for successful operations, when subscriptions are not associated with workflow. The \"failure\" value indicates the subscription request was not successfully proxied to the Store service. The other values relate to workflow scenarios.        Response Format  Request Accept /Response Content- Type Header      JSON  application/json", 
            "title": "Success Response Content"
        }, 
        {
            "location": "/requests/#example-successful-subscription", 
            "text": "", 
            "title": "Example: Successful subscription"
        }, 
        {
            "location": "/requests/#request_38", 
            "text": "POST http://webserver/Citrix/StoreWeb/Resources/Subscription/\nQ29udHJvbGxlci5Xb3JkUGFk HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/\n20100101 Firefox/23.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: 35D3DAC189174D65DC6D843C9FDAB46A\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 42\nCookie: CsrfToken=35D3DAC189174D65DC6D843C9FDAB46A;\nCtxsAuthId=535CF2577B2FF0DF53F76D3C2D994B92;\nASP.NET_SessionId=0eu5dnpqapdgeu2j1n3sz4zh\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\noperation=subscribe position=B", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_34", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Wed, 25 Sep 2013 15:58:41 GMT\nContent-Length: 23\n{ status : subscribed }", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#example-unsuccessful-unsubscription", 
            "text": "", 
            "title": "Example: Unsuccessful unsubscription"
        }, 
        {
            "location": "/requests/#request_39", 
            "text": "POST http://webserver/Citrix/StoreWeb/Resources/Subscription/\nQ29udHJvbGxlci5Xb3JkUGFk HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/\n20100101 Firefox/23.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: 35D3DAC189174D65DC6D843C9FDAB46A\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 33\nCookie: CsrfToken=35D3DAC189174D65DC6D843C9FDAB46A;\nCtxsAuthId=535CF2577B2FF0DF53F76D3C2D994B92;\nASP.NET_SessionId=0eu5dnpqapdgeu2j1n3sz4zh\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\noperation=unsubscribe", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_35", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Wed, 25 Sep 2013 16:00:23 GMT\nContent-Length: 20\n{ status : failure }", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#example-successful-update-of-subscription-properties", 
            "text": "This is an example of a successful update of the data associated with a subscription. The property ids and values are arbitrary from the perspective of the Resources service. Note that the 'bar' property key is repeated to specify a multi-valued property.", 
            "title": "Example: Successful update of subscription properties"
        }, 
        {
            "location": "/requests/#request_40", 
            "text": "POST http://webserver/Citrix/StoreWeb/Resources/Subscription/\nQ29udHJvbGxlci5GaXNoY2FrZSE- HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:24.0) Gecko/\n20100101 Firefox/24.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: 48C7A008D81F87116B4BDE418FB63B3C\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 24\nCookie: CsrfToken=48C7A008D81F87116B4BDE418FB63B3C;\nCtxsAuthId=1AA0681CE60D7E625A504BA0B1E70824;\nASP.NET_SessionId=stoi5utb5zfam1xtfqkjklfd\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\noperation=update updateMode=replace foo=fooValue bar=barValue b\nar=barValue2", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_36", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Tue, 15 Oct 2013 17:12:49 GMT\nContent-Length: 23\n{ status : subscribed }", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#session-enumeration", 
            "text": "Use this request to enumerate the authenticated user's ICA sessions that are not connected to by the current client, regardless of whether the sessions are disconnected or active on another client. Once enumerated, these sessions can be reconnected using the session launch API.", 
            "title": "Session Enumeration"
        }, 
        {
            "location": "/requests/#request_41", 
            "text": "URL (indicative)  Method  Description      /Sessions/ListAvailable  POST  Returns a list of all available sessions for the user in JSON format.        POST parameter  Description      resourceTypes  The types of resource to include in the response, one of the following values: Citrix.MPS.Application - to request application sessions. Citrix.MPS.Desktop - to request desktop sessions.      Notes   This request requires an authenticated session, indicated by the cookies  ASP.NET_SessionId and CtxsAuthId. When the Web Proxy is configured to use an    unauthenticated Store, an empty session list is returned.  Sessions initiated by the current client, as indicated by the DeviceId, are not included  in the returned list of sessions.  The downstream request to enumerate sessions from the StoreFront Store Service always     adds the parameter to include active sessions.  When used with previous versions of XenApp and XenDesktop, this request also disconnects  any active sessions. This issue was fixed in XenDesktop 7.  The expected usage pattern is for clients to enumerate all available sessions (possibly   for a particular type of resource) and then launch each one in succession. This is how the  Citrix Receiver for Web \"auto reconnect at logon\" functionality is implemented.", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_37", 
            "text": "Response Code (and friendly name)  Description      200 (OK)  List of available sessions (possibly empty), or authentication challenge.    403 (Forbidden)  Forbidden, due to one of the following reasons:     * Invalid CSRF token     * Invalid X-Citrix-IsUsingHTTPS header w Invalid CtxsAuthId cookie", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#success-response-content_12", 
            "text": "When a successful response (HTTP status code 200) is returned, the response body contains a JSON array of objects, each containing the following fields:     Field  JavaScript Type  Description      launchurl  String  The URL to make a launch request (see ICA Launch on page 57)    launchstatusurl  String  The URL to determine whether a resource is ready to launch (see ICA Launch on page 57)    initialApp  String  The name of a previously launched app that that caused the session to initially be created.    publishername  String  The name of the publisher (the farm name for XA).        Response Format  Request Accept/Response Content-Type Header      JSON  application/json", 
            "title": "Success Response Content"
        }, 
        {
            "location": "/requests/#example-session-enumeration", 
            "text": "In this example, all sessions are requested by not qualifying the server and client types.", 
            "title": "Example: Session Enumeration"
        }, 
        {
            "location": "/requests/#request_42", 
            "text": "POST http://webserver/Citrix/StoreWeb/Sessions/ListAvailable\nHTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:24.0) Gecko/\n20100101 Firefox/24.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCsrf-Token: BC8E733316E514C1C1E31541D9E44AF9\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nContent-Length: 36\nCookie: CtxsDeviceId=WR_AjT2owY5yJ4ED0J-x;\nCsrfToken=BC8E733316E514C1C1E31541D9E44AF9;\nCtxsAuthId=35037C55868C4C1AEE3A24488062C3BD;\nASP.NET_SessionId=ltutfqnaollcehgvre25mwip\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nresourceTypes=Citrix.MPS.Application", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_38", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Fri, 18 Oct 2013 09:25:45 GMT\nContent-Length: 191\n[\n {\n   initialapp : Notepad ,\n   launchstatusurl : Sessions\\/GetLaunchStatus\\/\nQ29udHJvbGxlci4xODM5MC4y ,\n   launchurl : Sessions\\/LaunchIca\\/Q29udHJvbGxlci4xODM5MC4y ,\n   publishername : johnc-ic6659 \n }\n]", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#session-launch", 
            "text": "Use this request to attempt to reconnect to an existing session (either disconnected or active on another client), as specified by session id.", 
            "title": "Session Launch"
        }, 
        {
            "location": "/requests/#request_43", 
            "text": "URL (indicative)  Method  Description      /Sessions/Launch/{id}  GET  Request whether the specified session is ready to launch or not.    /Sessions/ GetLaunchStatus/{id}  POST  Request an ICA file for launching the specified session.        URL Parameter  Description      {id}  Unique identifier for a particular session.      Notes   These requests require an authenticated session, indicated by the cookies  ASP . NET _    SessionId  and  CtxsAuthId .  The URLs above are for illustrative purposes only; the actual URLs used by a client must  be taken from the result of an earlier session enumeration request to / Sessions/   ListAvailable. When the Web Proxy is configured to use an unauthenticated Store, session    enumeration returns an empty list and session launch is therefore unavailable.  Launch is a GET instead of a POST so that it can be loaded by a browser in a hidden   iframe (using the iframe's src=\"url\" attribute) to trigger a launch via file-type   association.  GetLaunchStatus makes a launch request to the Store Service to determine whether the  specified resource is ready to launch or not. If this returns an ICA file, the ICA file is  cached for up to 90 seconds. If a subsequent call is made to LaunchIca within this time,    the cached ICA file is returned without making an additional launch request to the Store    Service.  For LaunchIca, clients must append a query string key with a random value to prevent  browsers from returning a cached response when making multiple launch requests for the  same resource. See the launchId query string parameter in the examples below.", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_39", 
            "text": "Response Code  Description      200  Success/Retry required/failure, or authentication challenge.    403  Forbidden, due to one of the following reasons: a) Invalid CSRF token b) Invalid  X-Citrix-IsUsingHTTPS  header c) Invalid  CtxsAuthId  cookie    404  Resource identified by {id} was not found.        Response Format  Request Accept/Response Content-Type Header      JSON  application/json    ICA File  application/octet-stream", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#success-response-content_13", 
            "text": "When a successful response (HTTP status code 200) for GetLaunchStatus is returned, the response body contains a JSON object describing whether the supplied resource is ready to be launched, with the following possible fields:     Attribute  Required  Description      status  Yes  One of the following strings:      * success\u2014the resource is ready to be launched      * retry\u2014the resource is not currently ready to be launched (for example, a desktop VM that first needs to be powered on before a connection can be made to it), but the launch attempt may be retried later.      * failure\u2014the attempt to retrieve launch information failed    pollTimeout  No  Only supplied when status is  retry , the number of seconds to wait before retrying the launch request.    errorId  No  Only supplied when status is  failure  , an error code as described in the Launch section of the StoreFront Store Services API specification.    suggestRestart  No  Only supplied when status is  failure  , a  true  or  false  value indicating whether the Store service included a \"remedy hint\" that a failed desktop launch could potentially be resolved by restarting the desktop.     When a successful response for LaunchIca is returned, the response body can be either a JSON string as described above for  GetLaunchStatus  or, if the resource is ready to launch, an ICA file.", 
            "title": "Success Response Content"
        }, 
        {
            "location": "/requests/#example-session-get-launch-status-success", 
            "text": "", 
            "title": "Example: Session Get Launch Status Success"
        }, 
        {
            "location": "/requests/#request_44", 
            "text": "POST http://webserver/Citrix/StoreWeb/Sessions/GetLaunchStatus/\nQ29udHJvbGxlci4xODM5MC4y HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:24.0) Gecko/\n20100101 Firefox/24.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCsrf-Token: BC8E733316E514C1C1E31541D9E44AF9\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=BC8E733316E514C1C1E31541D9E44AF9;\nCtxsAuthId=35037C55868C4C1AEE3A24488062C3BD;\nASP.NET_SessionId=ltutfqnaollcehgvre25mwip\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_40", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Fri, 18 Oct 2013 09:25:45 GMT\nContent-Length: 20\n{ status : success }", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#example-session-launch-success", 
            "text": "", 
            "title": "Example: Session Launch Success"
        }, 
        {
            "location": "/requests/#request_45", 
            "text": "GET http://webserver/Citrix/StoreWeb/Sessions/Launch/\nQ29udHJvbGxlci4xODM5MC41.ica?\nCsrfToken=0068C0184E13600DE24B6C1469952BEB launchId=13801992004\n94 HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/\n20100101 Firefox/23.0\nAccept: text/html,application/xhtml+xml,application/\nxml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=0068C0184E13600DE24B6C1469952BEB;\nCtxsAuthId=6E4966414BE6CE4E46D791655730672B;\nASP.NET_SessionId=kxh5cmlkkjbm5njp22feodrt\nConnection: keep-alive", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_41", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/x-ica; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Thu, 26 Sep 2013 12:40:00 GMT\nContent-Length: 1279\n[Encoding]\nInputEncoding=UTF8\n[WFClient]\nProxyFavorIEConnectionSetting=Yes\nProxyTimeout=30000\nProxyType=Auto etc...", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#session-disconnect-and-logoff", 
            "text": "Use these requests to disconnect or logoff a user's currently connected sessions at the server.", 
            "title": "Session Disconnect and Logoff"
        }, 
        {
            "location": "/requests/#request_46", 
            "text": "URL (indicative)  Method  Description      /Sessions/Disconnect  POST  Disconnects the user's sessions.    /Sessions/Logoff  POST  Logs off the user's sessions.      Notes   These requests require an authenticated session, indicated by the cookies  ASP .NET_  SessionId  and  CtxsAuthId .  When the Web Proxy is configured to use an unauthenticated Store, there is no associated  user for whom sessions can be disconnected, and session disconnect has no effect.  These requests operate only on sessions that were initiated from the current client, as   indicated by the DeviceId cookie.", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_42", 
            "text": "URL (indicative)  Method  Description      /Sessions/Disconnect  POST  Disconnects the user's sessions.    /Sessions/Logoff  POST  Logs off the user's sessions.        Response Code  Description      200  Success/failure, or authentication challenge.    403  Forbidden, due to one of the following reasons:     * Invalid CSRF token     * Invalid X-Citrix-IsUsingHTTPS header     * Invalid CtxsAuthId cookie        Response Format  Request Accept/Response Content-Type Header      JSON  application/json", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#success-response-content_14", 
            "text": "When a successful response (HTTP status code 200) for Disconnect or Logoff is returned, the response body contains a JSON object with a single JavaScript String field \"status\" with one of the values: \"success\", \"failure\", \"partial\" indicating whether the user's sessions were successfully disconnected or not. The value \"partial\" means that some of the user's sessions were successfully disconnected while others were not.", 
            "title": "Success Response Content"
        }, 
        {
            "location": "/requests/#example-session-disconnect", 
            "text": "", 
            "title": "Example: Session Disconnect"
        }, 
        {
            "location": "/requests/#request_47", 
            "text": "POST http://webserver/Citrix/StoreWeb/Sessions/Disconnect HTTP/\n1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/\n20100101 Firefox/23.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCsrf-Token: D6E47EE6160CA2121C3797D0E850FFA0\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=D6E47EE6160CA2121C3797D0E850FFA0;\nCtxsAuthId=BC5CC0F3EC36E6577B3810A12063280C;\nASP.NET_SessionId=jzvwqr2uh1ksws4c3bd2x4gp\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_43", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Thu, 26 Sep 2013 14:23:56 GMT\nContent-Length: 20\n{ status : success }", 
            "title": "Response"
        }, 
        {
            "location": "/requests/#example-session-logoff", 
            "text": "", 
            "title": "Example: Session Logoff"
        }, 
        {
            "location": "/requests/#request_48", 
            "text": "POST http://webserver/Citrix/StoreWeb/Sessions/Logoff HTTP/1.1\nHost: kontiki\nUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:24.0) Gecko/\n20100101 Firefox/24.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCsrf-Token: EA871815F7B33602B391EA5F85757FE8\nX-Citrix-IsUsingHTTPS: No\nX-Requested-With: XMLHttpRequest\nReferer: http://webserver/Citrix/StoreWeb/\nCookie: CsrfToken=EA871815F7B33602B391EA5F85757FE8;\nCtxsAuthId=C1796CE16F1841181ABFD7DC5DC3E7E2;\nASP.NET_SessionId=zegkvwsdy0hqglxkgtgdcxda\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Length: 0", 
            "title": "Request"
        }, 
        {
            "location": "/requests/#response_44", 
            "text": "HTTP/1.1 200 OK\nCache-Control: no-cache, no-store\nPragma: no-cache\nContent-Type: application/json\nExpires: -1\nServer: Microsoft-IIS/8.0\nX-Powered-By: ASP.NET\nX-Citrix-Application: Receiver for Web\nDate: Fri, 18 Oct 2013 11:12:19 GMT\nContent-Length: 20\n{ status : success }", 
            "title": "Response"
        }, 
        {
            "location": "/using-configuration-elements/", 
            "text": "Using configuration elements\n\n\nThis topic describes the elements and attributes of the XML document that is returned following a successful request to /Home/Configuration. These settings specify the behavior of the client and provide Web Proxy URLs for subsequent operations.\n\n\n\n\nNote\n\n\nDefault values appear in bold. \n\n\n\n\nSession\n\n\nXPath: /clientSettings/session\n\n\n\n\n\n\n\n\nAttribute\n\n\nValues\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\ntimeout\n\n\nTime in minutes (\n20\n)\n\n\nThe number of minutes of idle time before the web session times out and the user must re-authenticate.\n\n\n\n\n\n\nuserLanguages\n\n\nThe value of the Accept-Language header sent by the browser\n\n\nThe list of languages supported by the client (typically browser).\n\n\n\n\n\n\n\n\nAuthentication Manager\n\n\nXPath: /clientSettings/authManager\n\n\n\n\n\n\n\n\nAttribute\n\n\nValues\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\ngetUsernameURL\n\n\nAuthentication/ GetUserName\n\n\nURL to obtain the full user name.\n\n\n\n\n\n\nchangeCredentialsURL\n\n\nExplicitAuth/ GetChangeCredentialFor m\n\n\nURL to initiate a change password operation.\n\n\n\n\n\n\nlogoffURL\n\n\nAuthentication/Logoff\n\n\nURL to log off the Citrix Receiver for Web session.\n\n\n\n\n\n\nloginFormTimeout\n\n\nTime in minutes (\n5\n)\n\n\nHow long Citrix Receiver for Web displays the logon form for.\n\n\n\n\n\n\n\n\nStore Proxy\n\n\nXPath: /clientSettings/storeProxy\n\n\n\n\n\n\n\n\nAttribute\n\n\nValues (default in bold)\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nkeepAliveURL\n\n\nHome/KeepAlive\n\n\nURL to keep the session alive.\n\n\n\n\n\n\n\n\nResources Proxy\n\n\nXPath: /clientSettings/storeProxy/resourcesProxy\n\n\n\n\n\n\n\n\nAttribute\n\n\nValues (default in bold)\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nlistURL\n\n\nResources/List\n\n\nURL to enumerate the user's available resources.\n\n\n\n\n\n\nresourceDetails\n\n\ndefault\n\n\nfull\n\n\n\n\n\n\n\n\nSessions Proxy\n\n\nXPath: /clientSettings/storeProxy/sessionsProxy\n\n\n\n\n\n\n\n\nAttribute\n\n\nValues (default in bold)\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nlistAvailableURL\n\n\nSessions/ListAvailable\n\n\nURL to enumerate the user's available sessions.\n\n\n\n\n\n\ndisconnectURL\n\n\nSessions/Disconnect\n\n\nURL to disconnect the user's sessions.\n\n\n\n\n\n\nlogoffURL\n\n\nSessions/Logoff\n\n\nURL to log off the user's sessions.\n\n\n\n\n\n\n\n\nPlugin Assistant\n\n\nXPath: /clientSettings/pluginAssistant\n\n\n\n\n\n\n\n\nAttribute\n\n\nValues\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nenabled\n\n\ntrue\n\n\nfalse\n\n\n\n\n\n\nupgradeAtLogin\n\n\ntrue\n\n\nfalse\n\n\n\n\n\n\n\n\nXPath: /configuration/citrix.deliveryservices/webReceiver/clientSettings/ pluginAssistant/win32\n\n\n\n\n\n\n\n\nAttribute\n\n\nValues\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\npath\n\n\nRelative or absolute url\n\n\nThe location for downloading Citrix Receiver for Windows.\n\n\n\n\n\n\n\n\nXPath: /configuration/citrix.deliveryservices/webReceiver/clientSettings/ pluginAssistant/macOS\n\n\n\n\n\n\n\n\nAttribute\n\n\nValues\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\npath\n\n\nRelative or absolute url\n\n\nThe location for downloading Citrix Receiver for MacOS.\n\n\n\n\n\n\nminimumSupportedOSVersi on\n\n\nVersion number (\n10.6\n)\n\n\nThe minimum MacOS version required for Citrix Receiver for MacOS.\n\n\n\n\n\n\n\n\nXPath: /configuration/citrix.deliveryservices/webReceiver/clientSettings/ pluginAssistant/html5\n\n\n\n\n\n\n\n\nAttribute\n\n\nValues\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nenabled\n\n\nAlways/Fallback/Never\n\n\nWhether to enable Receiver for HTML5 or not.\n\n\n\n\n\n\nplatforms\n\n\nSemi-column separated list of regular expressions. \nFirefox;Chrome;Version/ ([6-9]\\d\\d).*Safari;MSIE \\d\\d;Trident; Android;iPad;iPhone;iPod\n ;\n\n\nRegular expressions to search the UserAgent string to identify supported browsers.\n\n\n\n\n\n\nlaunchURL\n\n\nRelative URL\n\n\nLocation of the Receiver for HTML5 launch page.\n\n\n\n\n\n\nsingleTabLaunch\n\n\ntrue / \nfalse\n\n\nWhether to launch applications on the same browser tab as the Citrix Receiver for Web home screen or not.\n\n\n\n\n\n\nchromeAppOrigins\n\n\nchrome-extension:// bgiigkppjadidglloadcadeih lnbpagp\n\n\nList of origin URLs identifying official releases of the Citrix Chrome App in the Google Chrome web store. Each URL is separated by a pipe (\n\n\n\n\n\n\n\n\nUser Interface\n\n\nXPath: /configuration/citrix.deliveryservices/webReceiver/clientSettings/userInterface\n\n\n\n\n\n\n\n\nAttribute\n\n\nValues\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nframeOptions\n\n\nallow/deny/sameorigin\n\n\nWhether or not to allow Citrix Receiver for Web to be displayed in a frame/ iframe.\n\n\n\n\n\n\nautoLaunchDesktop\n\n\ntrue/false\n\n\nWhether or not to auto- launch desktop at logon if there is only one desktop available for the user.\n\n\n\n\n\n\n\n\nXPath: /configuration/citrix.deliveryservices/webReceiver/clientSettings/ userInterface/workspaceControl\n\n\n\n\n\n\n\n\nAttribute\n\n\nValues\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nenabled\n\n\ntrue/false\n\n\nWhether to enable workspace control or not.\n\n\n\n\n\n\nautoReconnectAtLogon\n\n\ntrue/false\n\n\nWhether to perform auto- reconnect at logon or not.\n\n\n\n\n\n\nlogoffAction\n\n\ndisconnect/terminate/none\n\n\nWhether to disconnect or terminate HDX sessions when actively logging off Citrix Receiver for Web.\n\n\n\n\n\n\nshowReconnectButton\n\n\ntrue/false\n\n\nWhether to show the reconnect button/link or not.\n\n\n\n\n\n\nshowDisconnectButton\n\n\ntrue/false\n\n\nWhether to show the disconnect button/link or not.\n\n\n\n\n\n\n\n\nXPath: /configuration/citrix.deliveryservices/webReceiver/clientSettings/ userInterface/receiverConfiguration\n\n\n\n\n\n\n\n\nAttribute\n\n\nValues\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nenabled\n\n\ntrue/false\n\n\nWhether to enable Receiver provisioning file download or not.\n\n\n\n\n\n\n\n\nXPath: /configuration/citrix.deliveryservices/webReceiver/clientSettings/ userInterface/appShortcuts\n\n\n\n\n\n\n\n\nAttribute\n\n\nValues\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nenabled\n\n\ntrue/false\n\n\nWhether to enable app shortcuts or not.\n\n\n\n\n\n\nallowSessionReconnect\n\n\ntrue/false\n\n\nWhether to enable session reconnect or not when Citrix Receiver for Web is launched by an app shortcut.", 
            "title": "Using configuration elements"
        }, 
        {
            "location": "/using-configuration-elements/#using-configuration-elements", 
            "text": "This topic describes the elements and attributes of the XML document that is returned following a successful request to /Home/Configuration. These settings specify the behavior of the client and provide Web Proxy URLs for subsequent operations.   Note  Default values appear in bold.", 
            "title": "Using configuration elements"
        }, 
        {
            "location": "/using-configuration-elements/#session", 
            "text": "XPath: /clientSettings/session     Attribute  Values  Description      timeout  Time in minutes ( 20 )  The number of minutes of idle time before the web session times out and the user must re-authenticate.    userLanguages  The value of the Accept-Language header sent by the browser  The list of languages supported by the client (typically browser).", 
            "title": "Session"
        }, 
        {
            "location": "/using-configuration-elements/#authentication-manager", 
            "text": "XPath: /clientSettings/authManager     Attribute  Values  Description      getUsernameURL  Authentication/ GetUserName  URL to obtain the full user name.    changeCredentialsURL  ExplicitAuth/ GetChangeCredentialFor m  URL to initiate a change password operation.    logoffURL  Authentication/Logoff  URL to log off the Citrix Receiver for Web session.    loginFormTimeout  Time in minutes ( 5 )  How long Citrix Receiver for Web displays the logon form for.", 
            "title": "Authentication Manager"
        }, 
        {
            "location": "/using-configuration-elements/#store-proxy", 
            "text": "XPath: /clientSettings/storeProxy     Attribute  Values (default in bold)  Description      keepAliveURL  Home/KeepAlive  URL to keep the session alive.", 
            "title": "Store Proxy"
        }, 
        {
            "location": "/using-configuration-elements/#resources-proxy", 
            "text": "XPath: /clientSettings/storeProxy/resourcesProxy     Attribute  Values (default in bold)  Description      listURL  Resources/List  URL to enumerate the user's available resources.    resourceDetails  default  full", 
            "title": "Resources Proxy"
        }, 
        {
            "location": "/using-configuration-elements/#sessions-proxy", 
            "text": "XPath: /clientSettings/storeProxy/sessionsProxy     Attribute  Values (default in bold)  Description      listAvailableURL  Sessions/ListAvailable  URL to enumerate the user's available sessions.    disconnectURL  Sessions/Disconnect  URL to disconnect the user's sessions.    logoffURL  Sessions/Logoff  URL to log off the user's sessions.", 
            "title": "Sessions Proxy"
        }, 
        {
            "location": "/using-configuration-elements/#plugin-assistant", 
            "text": "XPath: /clientSettings/pluginAssistant     Attribute  Values  Description      enabled  true  false    upgradeAtLogin  true  false     XPath: /configuration/citrix.deliveryservices/webReceiver/clientSettings/ pluginAssistant/win32     Attribute  Values  Description      path  Relative or absolute url  The location for downloading Citrix Receiver for Windows.     XPath: /configuration/citrix.deliveryservices/webReceiver/clientSettings/ pluginAssistant/macOS     Attribute  Values  Description      path  Relative or absolute url  The location for downloading Citrix Receiver for MacOS.    minimumSupportedOSVersi on  Version number ( 10.6 )  The minimum MacOS version required for Citrix Receiver for MacOS.     XPath: /configuration/citrix.deliveryservices/webReceiver/clientSettings/ pluginAssistant/html5     Attribute  Values  Description      enabled  Always/Fallback/Never  Whether to enable Receiver for HTML5 or not.    platforms  Semi-column separated list of regular expressions.  Firefox;Chrome;Version/ ([6-9]\\d\\d).*Safari;MSIE \\d\\d;Trident; Android;iPad;iPhone;iPod  ;  Regular expressions to search the UserAgent string to identify supported browsers.    launchURL  Relative URL  Location of the Receiver for HTML5 launch page.    singleTabLaunch  true /  false  Whether to launch applications on the same browser tab as the Citrix Receiver for Web home screen or not.    chromeAppOrigins  chrome-extension:// bgiigkppjadidglloadcadeih lnbpagp  List of origin URLs identifying official releases of the Citrix Chrome App in the Google Chrome web store. Each URL is separated by a pipe (", 
            "title": "Plugin Assistant"
        }, 
        {
            "location": "/using-configuration-elements/#user-interface", 
            "text": "XPath: /configuration/citrix.deliveryservices/webReceiver/clientSettings/userInterface     Attribute  Values  Description      frameOptions  allow/deny/sameorigin  Whether or not to allow Citrix Receiver for Web to be displayed in a frame/ iframe.    autoLaunchDesktop  true/false  Whether or not to auto- launch desktop at logon if there is only one desktop available for the user.     XPath: /configuration/citrix.deliveryservices/webReceiver/clientSettings/ userInterface/workspaceControl     Attribute  Values  Description      enabled  true/false  Whether to enable workspace control or not.    autoReconnectAtLogon  true/false  Whether to perform auto- reconnect at logon or not.    logoffAction  disconnect/terminate/none  Whether to disconnect or terminate HDX sessions when actively logging off Citrix Receiver for Web.    showReconnectButton  true/false  Whether to show the reconnect button/link or not.    showDisconnectButton  true/false  Whether to show the disconnect button/link or not.     XPath: /configuration/citrix.deliveryservices/webReceiver/clientSettings/ userInterface/receiverConfiguration     Attribute  Values  Description      enabled  true/false  Whether to enable Receiver provisioning file download or not.     XPath: /configuration/citrix.deliveryservices/webReceiver/clientSettings/ userInterface/appShortcuts     Attribute  Values  Description      enabled  true/false  Whether to enable app shortcuts or not.    allowSessionReconnect  true/false  Whether to enable session reconnect or not when Citrix Receiver for Web is launched by an app shortcut.", 
            "title": "User Interface"
        }, 
        {
            "location": "/customization-sdk/", 
            "text": "About StoreFront Store Customization SDK\n\n\nThese topics introduce the Citrix StoreFront Store Customization SDK (the \"StoreCustomization SDK\"), describe what interfaces are available and how to use them. Additional resources that are available, such as scripts and examples, are also detailed. These topics are aimed at experienced administrators and software developers who have programming skills and are familiar with using SDKs.\n\n\nThe Store Customization SDK allows you to perform more advanced filtering and customization than the simple filtering by resource type or keywords available in Citrix StoreFront. If you only want to configure simple filtering on stores, such as preventing some users from seeing specific applications, there's no need to use the SDK; see the StoreFront documentation for more information about configuring filtering using PowerShell cmdlets.\n\n\nThe Store Customization SDK allows you to apply custom logic to the process of displaying resources to users and to adjust launch parameters. For example, you can use the SDK to control which apps and desktops are displayed to users, to change ICA virtual channel parameters, or to modify access conditions through XenApp and XenDesktop policy selection.\n\n\nThe following illustration shows the main points where you can apply customizations using the SDK.\n\n\nThese customization points are:\n\n\n\n\nPost-Enumeration\u2014use this to modify the results of resource enumeration. This lets you alter a   resource's properties, and provides more advanced filtering than the simple filtering by resource type/keywords available using PowerShell cmdlets.\n\n\n\n\n\n\n\n\n\n\nPost-Launch ICA file\u2014use this to modify the generated ICA file. For example, use this to change ICA virtual channel parameters and prevent users accessing their clipboard.\n\n\n\n\n\n\nPost-Session Enumeration\u2014use this to modify the result of session enumeration; for example, to filter out unwanted sessions.\n\n\n\n\n\n\nAccess conditions (pre-launch and pre-enumeration)\u2014use this to modify the access conditions affecting resource visibility and ability to launch resources.\n\n\n\n\n\n\nProvider list\u2014use this to modify the list of servers for Delivery Controllers before the XML services are contacted.\n\n\n\n\n\n\nDevice information\u2014use this to modify the device information supplied by the client, including the ClientName and DeviceId. \n\n\n\n\n\n\nAdditional resources\n\n\nThe following resources are also provided with this SDK:\n\n\n\n\n\n\nStore Service Customization API file\u2014this is an MSDN-style library for the interfaces and classes used in the Customization contract.\n\n\n\n\n\n\nVisual Studio sample solution\u2014a sample solution containing typical customization examples.\n\n\n\n\n\n\nTracing script\u2014a PowerShell script is supplied with the SDK which you can use to enable tracing. This is useful when testing and troubleshooting customizations.", 
            "title": "StoreFront Customization SDK"
        }, 
        {
            "location": "/customization-sdk/#about-storefront-store-customization-sdk", 
            "text": "These topics introduce the Citrix StoreFront Store Customization SDK (the \"StoreCustomization SDK\"), describe what interfaces are available and how to use them. Additional resources that are available, such as scripts and examples, are also detailed. These topics are aimed at experienced administrators and software developers who have programming skills and are familiar with using SDKs.  The Store Customization SDK allows you to perform more advanced filtering and customization than the simple filtering by resource type or keywords available in Citrix StoreFront. If you only want to configure simple filtering on stores, such as preventing some users from seeing specific applications, there's no need to use the SDK; see the StoreFront documentation for more information about configuring filtering using PowerShell cmdlets.  The Store Customization SDK allows you to apply custom logic to the process of displaying resources to users and to adjust launch parameters. For example, you can use the SDK to control which apps and desktops are displayed to users, to change ICA virtual channel parameters, or to modify access conditions through XenApp and XenDesktop policy selection.  The following illustration shows the main points where you can apply customizations using the SDK.  These customization points are:   Post-Enumeration\u2014use this to modify the results of resource enumeration. This lets you alter a   resource's properties, and provides more advanced filtering than the simple filtering by resource type/keywords available using PowerShell cmdlets.      Post-Launch ICA file\u2014use this to modify the generated ICA file. For example, use this to change ICA virtual channel parameters and prevent users accessing their clipboard.    Post-Session Enumeration\u2014use this to modify the result of session enumeration; for example, to filter out unwanted sessions.    Access conditions (pre-launch and pre-enumeration)\u2014use this to modify the access conditions affecting resource visibility and ability to launch resources.    Provider list\u2014use this to modify the list of servers for Delivery Controllers before the XML services are contacted.    Device information\u2014use this to modify the device information supplied by the client, including the ClientName and DeviceId.", 
            "title": "About StoreFront Store Customization SDK"
        }, 
        {
            "location": "/customization-sdk/#additional-resources", 
            "text": "The following resources are also provided with this SDK:    Store Service Customization API file\u2014this is an MSDN-style library for the interfaces and classes used in the Customization contract.    Visual Studio sample solution\u2014a sample solution containing typical customization examples.    Tracing script\u2014a PowerShell script is supplied with the SDK which you can use to enable tracing. This is useful when testing and troubleshooting customizations.", 
            "title": "Additional resources"
        }, 
        {
            "location": "/getting-started-with-the-sdk/", 
            "text": "Getting started with the SDK\n\n\nThis topic explains how to apply customizations using the Store Customization SDK. A list of minimum requirements is provided, and an overview of the main steps you must perform.\n\n\nAll the customizations follow the same pattern: the method in the particular interface is called with the StoreFront computed value and a context parameter. The customized code alters the original value and returns a new value. This new value is then used for further processing by StoreFront. Implementing classes use the context parameter to compute the returned value.\n\n\nSupplied with the SDK are typical customization examples (see the Examples folder) and \"template files\". These are simple files you can use as a starting point and add your own logic to. Simply populate the template files with your own code to implement your customizations, as described in the steps below. See the sample solution for more information about the template files.\n\n\nBefore you begin, review the Known issues section.\n\n\nRequirements\n\n\nUsing the Store Customization SDK requires moderate programming skills, preferably in C# 4.0 or later.\nMinimum system requirements\n\n\n\n\nOS Requirement: Windows 7\n\n\nVisual Studio 2012\n\n\n.NET Framework 4.5\n\n\n\n\nOverview of the steps\n\n\nThis section provides an overview of the main steps you perform when using the Store Customization SDK. The steps are:\n\n\n\n\nIn Visual Studio, identify the interface you want to use; for example \"Resources customization\". See Customization interfaces on page 8 for more information.\n\n\nSelect the relevant template file. See the sample solution for more information about the template files.\n\n\nAdd your custom logic to the template file.\n\n\nBuild the solution.\n\n\nDeploy your customization. See Deploy customizations on page 12 for more information.\n\n\nRestart services. See Restart services on page 13 for more information.\n\n\nTest and debug your customizations. See Test and debug on page 13 for more information.\nThe following topics describe these steps in more detail.\n\n\n\n\nIf you upgrade StoreFront\n\n\nNote that customizations are not persisted during an upgrade. After upgrading, you must redeploy your customized assembles and test these before rolling out to the production environment.\n\n\nRemoving customizations\n\n\nProvided you backed-up the original assemblies, as described in Deploying Customizations, you can restore the original behavior of StoreFront.\n\n\nTo remove customizations:\n\n\n\n\nCopy the backed-up assembles in the Store's bin folder onto one of the StoreFront servers.\n\n\nOnce the assemblies are successfully copied, perform the propagation action on the StoreFront server on \nwhich the assemblies are copied. This pushes the original assemblies onto other members of the StoreFront cluster.\n\n\n\n\n\n\nTip\n\n\nYou can also remove customizations by removing the dlls and performing the propagation  action; the dlls are removed from all machines in the server group.", 
            "title": "Getting started with the SDK"
        }, 
        {
            "location": "/getting-started-with-the-sdk/#getting-started-with-the-sdk", 
            "text": "This topic explains how to apply customizations using the Store Customization SDK. A list of minimum requirements is provided, and an overview of the main steps you must perform.  All the customizations follow the same pattern: the method in the particular interface is called with the StoreFront computed value and a context parameter. The customized code alters the original value and returns a new value. This new value is then used for further processing by StoreFront. Implementing classes use the context parameter to compute the returned value.  Supplied with the SDK are typical customization examples (see the Examples folder) and \"template files\". These are simple files you can use as a starting point and add your own logic to. Simply populate the template files with your own code to implement your customizations, as described in the steps below. See the sample solution for more information about the template files.  Before you begin, review the Known issues section.", 
            "title": "Getting started with the SDK"
        }, 
        {
            "location": "/getting-started-with-the-sdk/#requirements", 
            "text": "Using the Store Customization SDK requires moderate programming skills, preferably in C# 4.0 or later.\nMinimum system requirements   OS Requirement: Windows 7  Visual Studio 2012  .NET Framework 4.5", 
            "title": "Requirements"
        }, 
        {
            "location": "/getting-started-with-the-sdk/#overview-of-the-steps", 
            "text": "This section provides an overview of the main steps you perform when using the Store Customization SDK. The steps are:   In Visual Studio, identify the interface you want to use; for example \"Resources customization\". See Customization interfaces on page 8 for more information.  Select the relevant template file. See the sample solution for more information about the template files.  Add your custom logic to the template file.  Build the solution.  Deploy your customization. See Deploy customizations on page 12 for more information.  Restart services. See Restart services on page 13 for more information.  Test and debug your customizations. See Test and debug on page 13 for more information.\nThe following topics describe these steps in more detail.", 
            "title": "Overview of the steps"
        }, 
        {
            "location": "/getting-started-with-the-sdk/#if-you-upgrade-storefront", 
            "text": "Note that customizations are not persisted during an upgrade. After upgrading, you must redeploy your customized assembles and test these before rolling out to the production environment.", 
            "title": "If you upgrade StoreFront"
        }, 
        {
            "location": "/getting-started-with-the-sdk/#removing-customizations", 
            "text": "Provided you backed-up the original assemblies, as described in Deploying Customizations, you can restore the original behavior of StoreFront.  To remove customizations:   Copy the backed-up assembles in the Store's bin folder onto one of the StoreFront servers.  Once the assemblies are successfully copied, perform the propagation action on the StoreFront server on \nwhich the assemblies are copied. This pushes the original assemblies onto other members of the StoreFront cluster.    Tip  You can also remove customizations by removing the dlls and performing the propagation  action; the dlls are removed from all machines in the server group.", 
            "title": "Removing customizations"
        }, 
        {
            "location": "/customization-interfaces/", 
            "text": "Customization interfaces\n\n\nThis topic details the interfaces exposed by StoreFront and explains how to use these to apply customizations.\nThere are four main types of customization:\n\n\n\n\nResources customization\u2014uses the IEnumerationResultModifier interface\n\n\nSessions customization\u2014uses the ISessionListModifier interface\n\n\nICA file customization\u2014uses the ILaunchResultModifier interface\n\n\nRequest customization\u2014uses the IInputModifier interface\n\n\n\n\nThe interfaces are bundled in the\n\nCitrix.DeliveryServices.ResourcesCommon.Customization.Contract\n assembly.\n\n\nThe implementing assembly must target .NET Framework 4.5.\nEach interface exposes the following members (see the appropriate interface for more details), unless specified otherwise:\n\n\n\n\nModify\n: This virtual method is the calling point of the interface. To customize, the implementing class must override this method. The signature of this method is detailed in the appropriate interface section below.\n\n\nRunExtendedValidation\n: This property indicates whether or not StoreFront validates the returned value to ensure it is of the correct form. Because there is a performance impact associated with extended validation, only set this on during development and debugging, and ensure that extended validation is set to off in the production environment.\n\n\nReturnOriginalValueOnFailure\n: This property indicates whether or not StoreFront returns the original computed value, whenever there's an error in the customized value returned by the method. We recommend you set this property to true.\n\n\n\n\nResources customization\n\n\nUse this type of customization to modify the resource enumeration, as computed by\nStoreFront, before it is sent to the client. StoreFront calls the Modify method of the\nIEnumerationResultModifier interface with the computed resource enumeration result and a context parameter. The implementing class must override the method, modify the enumeration result and return it back to StoreFront. StoreFront then sends the modified result to the client for further processing.\n\n\nRefer to the Store Service Customization API file and the sample solution supplied with the SDK for examples of how to use this interface.\n\n\n\n\nNote\n\n\nResources customizations only take effect for Receivers using the native protocols;     customizations do not take effect for clients that access the store using legacy    protocols, such as Program Neighbourhood Agent.\n\n\n\n\nInterface\n\n\nThe custom class must implement the \nIEnumerationResultModifier\n interface.\n\n\nClass Name\n\n\nName the custom class \nEnumerationResultModifier\n.\n\n\nAssembly Name\n\n\nPlace the custom class in the \nStoreCustomization_Enumeration\n assembly.\n\n\nMethod Signature\n\n\nString \nModify\n (\nCustomizationContextData\n context, string \nvalueToModify\n)\n\n\nUse this method when you want to modify the entire resource enumeration result. All the code to customize the resource enumeration must be contained within this method.\n\n\nMethod Signature\n\n\nString \nModifySingleApp\n (\nCustomizationContextData\n context, string \nvalueToModify\n)\n\n\nUse this method when you want to modify a single resource. All the code to customize the resource enumeration must be contained within this method.\n\n\nParameters\n\n\n\n\n\n\ncontext\n: This parameter is of type \nCustomizationContextData\n and contains a set of context data, such as device information, \nHttpContext\n, user identity, access conditions, farm details and any user access preferences. See the Store Service Customization API file for details about this type; use this as a reference to base the customization logic on.\n\n\n\n\n\n\nvalueToModify\n: This parameter is of type string and contains the resource enumeration result, as computed by StoreFront. This string adheres to the resource enumeration result, as specified in the Store Service Customization API file.\n\n\n\n\n\n\nReturn Value\n\n\nThis method returns a string containing the resource enumeration result, as specified in the StoreFront Service API.\nThe implementing class must run all the validations against the resource enumeration result before returning it from the method.\n\n\nSessions customization\n\n\nUse this interface to modify the ICA sessions enumeration, as computed by StoreFront, before it is sent to the client. StoreFront calls the Modify method of the ISessionListModifier interface with the computed session enumeration result and a context parameter. The implementing class must override the method, modify the enumeration result, and return it back to StoreFront. StoreFront then sends the modified result to the client for further processing.\n\n\nRefer to the Store Service Customization API file and the sample solution supplied with the SDK for examples of how to use this interface.\n\n\n\n\nNote\n\n\n\n\nSessions customizations only take effect for Receivers using the native protocols; customizations do not take effect for clients that access the store using legacy protocols, such as Program Neighbourhood Agent.\n\n\n\n\nInterface\n: the custom class must implement the \nISessionListModifier\n interface.\n\n\nClass Name\n: name the custom class \nSessionListModifier\n.\n\n\nAssembly Name\n: place the custom class in the \nStoreCustomization_SessionEnumeration\n assembly.\n\n\nMethod Signature\n: string \nModify\n(\nCustomizationContextData\n context, string \nvalueToModify\n)\n\n\n\n\nUse this method to modify the session enumeration result. All the code to customize the session enumeration must be contained within this method.\n\n\nParameters\n\n\n\n\n\n\ncontext\n: This parameter is of type CustomizationContextData. It contains a set of context data, such as device information, HttpContext, user identity, access conditions, farm details and any user access preferences. See the Store Service Customization API file for details about this type; use this as a reference on which to base customization logic.\n\n\n\n\n\n\nvalueToModify\n: This parameter is of type string and contains the session enumeration result, as computed by StoreFront; see the Store Service Customization API file.\n\n\n\n\n\n\nReturn Value\n\n\nThis method returns a string containing the session enumeration result, as specified in the StoreFront Service API. The implementing class must run all validations against the session enumeration before returning it from the method.\n\n\nICA File customization\n\n\nUse this interface to modify the content of an ICA file, as computed by StoreFront, before it is sent to the client. StoreFront calls the Modify method of the ILaunchResultModifier interface with the computed ICA file and a context parameter. The implementing class must override the method, modify the ICA file, and return it back to StoreFront. StoreFront then sends the modified file to the client for further processing.\n\n\nRefer to the Store Service Customization API file and the sample solution supplied with the SDK for examples of how to use this interface.\n\n\n\n\nInterface\n:the custom class must implement the \nILaunchResultModifier\n interface.\n\n\nClass Name\n: name the custom class \nLaunchResultModifier\n.\n\n\nAssembly Name\n: place the custom class in the \nStoreCustomization_Launch\n assembly.\n\n\nMethod Signature\n: string \nModify\n(\nCustomizationContextData\n context, string \nvalueToModify\n)\n\n\n\n\nUse this method to modify the content of the ICA file. All the code to customize the ICA file must be contained within this method.\n\n\nParameters\n\n\n-\ncontext\n: This parameter is of type \nCustomizationContextData\n and contains a set of context data, such as device information, \nHttpContext\n, user identity, access conditions, farm details and any user access preferences. See the Store Service Customization API file for details about this type; use this as a reference on which to base the customization logic.\n-\nvalueToModify\n: This parameter is of type string and contains the content of ICA file as computed by StoreFront.\n\n\nReturn Value\n\n\nThis method returns a string, which forms the content of the ICA file. The implementing class must run all validations against the modified file content before returning it from the method.\n\n\nRequest customization\n\n\nUse this interface to modify a request before it is forwarded to the back-end XML services, such as the XenDesktop Delivery Controller.\n\n\nUnlike other customization points where the custom code is called after StoreFront computes the result, this customization code is called before the request is sent to the back-end XML services, after partial request processing by StoreFront. StoreFront calls the Modify method of the IInputModifier interface with a set of request parameters and a context parameter. The implementing class must override this method and can alter the value of the properties of the request parameters. StoreFront uses the modified request parameters when contacting the back-end XML services.\n\n\n\n\nNote\n\n\nThe Request Customization interface cannot be used if the site is configured with multi-    site farms (configured using the \nuserFarmMappings\n configuration element or \nSet-  DSUserMappings\n cmdlet).\n\n\n\n\nRefer to the Store Service Customization API file and the sample solution supplied with the SDK for examples of how to use this interface.\n\n\n\n\nInterface\n: the custom class must implement the \nIInputModifier\n interface.\n\n\nClass Name\n: name the custom class \nIInputModifier\n.\n\n\nAssembly Name\n: place the custom class in the \nStoreCustomization_Input\n assembly.\n\n\nMethod Signature\n: void \nModify\n (\nCustomizationContextData\n context, out \nFarmSetsContext farmSetsContext\n, out \nDeviceInfo deviceInfo\n, out \nAccessConditions accessConditions\n)\n\n\n\n\nUse this method to modify the request. All the code to modify the request must be contained within this method.\n\n\nRefer to the Store Service Customization API file and the sample solution supplied with the SDK for examples of how to use this interface.\n\n\n\n\nInterface\n: the custom class must implement the IInputModifier interface.\n\n\nClass Name\n: name the custom class IInputModifier.\n\n\nAssembly Name\n: place the custom class in the StoreCustomization_Input assembly.\n\n\nMethod Signature\n: void Modify (CustomizationContextData context, out FarmSetsContext farmSetsContext, out DeviceInfo deviceInfo, out AccessConditions accessConditions)\n\n\n\n\nUse this method to modify the request. All the code to modify the request must be contained within this method.\n\n\nParameters\n\n\n\n\ncontext\n: This parameter is of type \nCustomizationContextData\n. It contains a set of context data, such as device information, \nHttpContext\n, user identity, access conditions, farm details and any user access preferences.\n\n\nfarmSetsContext\n: This parameter is of type \nFarmSetsContext\n and contains the list of farms which will be contacted by StoreFront. The customization modifies this list. StoreFront contacts each farm in the modified list.\n\n\ndeviceInfo\n: This parameter is of type \nDeviceInfo\n and contains the client device information as sent by the client. Use this customization to modify this information before StoreFront sends it to the back-end XML services.\n\n\naccessConditions\n: This parameter is of type \nAccessConditions\n. It contains the access conditions sent by the client and computed by StoreFront. Use this customization to modify these conditions before StoreFront sends this information to the back-end XML services.\n\n\n\n\nFor more information about the parameters, see the Store Service Customization API file.\n\n\nDeploy customizations\n\n\nThis topic explains how to deploy your customizations. Customization modules must be contained within their respective assemblies. To deploy customizations:\n\n\n\n\nBack up the original assemblies\n\n\nDeploy customizations\n\n\n\n\nThese steps are explained in more detail below.\n\n\nBack up the original assemblies\n\n\nCitrix recommends you back up the original assemblies before replacing them with the new customized assemblies. Original assemblies are required for restoring the default behavior. Ensure you back up the following:\n\n\n\n\nStoreCustomization_Enumeration.dll\n\n\nStoreCustomization_Input.dll\n\n\nStoreCustomization_Launch.dll\n\n\nStoreCustomization_SessionEnumeration.dll\n\n\n\n\nDeploy customizations\n\n\nTo deploy customizations, manually copy the new customized assemblies to the Store's bin folder on the appropriate StoreFront server. This replaces the existing assemblies.\n\n\nIf the StoreFront server is part of a cluster deployment, perform the propagation action to push the new assemblies to other members of the cluster.\n\n\n\n\nNote\n\n\nOnly these files, and accompanying pdbs, are propagated using the propagation action. If    there are additional files, these must be copied manually to all machines in the cluster.\n\n\n\n\nExample\n\n\nThe following example shows how to locate the Store's bin folder on the StoreFront Server.\n\n\nIn this example, the home directory for the website is \nC:\\inetpub\\wwwroot\n.\n\n\nStoreFront is configured on this website with a store named \"Store\". The valid full directory path you copy new customized assemblies to is:\n\n\nC:\\inetpub\\wwwroot\\Citrix\\Store\\bin\n\n\nRestart services\n\n\nAfter deploying your customizations, restart the following services. Restarting forces the services to clear any cached data from previous implementations of the assemblies.\n\n\n\n\nNote\n\n\nServices should restart automatically when customizations are deployed, but Citrix  recommend you check that this has occurred.\n\n\n\n\n\n\nInternet Information Service: this is the IIS service running on the StoreFront Server.\n\n\nCitrixSubscriptionsStore\n: this is a Windows service running on the StoreFront Server.\n\n\n\n\nTest and debug\n\n\nThis topic explains how to test and debug your customizations. It explains how to enable tracing, and attach the debugger so that you can debug within Visual Studio.\n\n\nTo troubleshoot your implementation, first look in the event log. You can also consult the trace which provides more information than in the event log. During testing, set the trace level to \"verbose\"; in production, set it to Error or Warning\u2014see the section below for details of how to enable tracing.\n\n\nFor information on debugging your implementation within Visual Studio, see the section below.\n\n\nYou can also configure StoreFront to run extended validation against returned values during development and testing. To do this, set RunExtendedValidation to true; for more information see \nCustomization interfaces\n. However, because there is a performance impact when running extended validation, ensure you set this off in the production environment.\n\n\nEnable tracing\n\n\nThe tracing feature writes detailed information to the trace. The default location for trace dumps is \nC:\\Program Files\\Citrix\\Receiver StoreFront\\Admin\\trace\n.\n\n\nTo enable tracing and set the trace level, use the PowerShell script \nSetDSStoreCustomizationTraceLevel.ps1\n which is supplied with the SDK. This script takes the following parameters:\n\n\n\n\nSiteId\n: the IIS Site Id where the store is deployed\n\n\nVirtualPath\n: the virtual path of the store\n\n\nTraceLevel\n: use to set the following trace levels:\n    a.  \nError\n\n    b.  \nInfo\n\n    c.  \nOff\n\n    d.  \nVerbose\n\n    e.  \nWarning\n\n\n\n\n\n\nNote\n\n\nCitrix recommend you set the trace level to \nVerbose\n during development, and to \nError\n or     \nWarning\n in theproduction environment.\n\n\n\n\n\n\nNote\n\n\nIf you do not know the SiteId and VirtualPath of the Store, run the following PowerShell    commands:\n\n\n\n\ncd 'c:\\program files\\Citrix\\Receiver Storefront\\Scripts'. \n.\\ImportModules.ps1\nGet-DSStoreFeatureInstances\n\n\n\n\nWrite to the trace\n\n\nThe Store Customization SDK includes a tracing class named \nTracer\n. This class has the following methods which allow you to output to the trace from the Store Customization SDK:\n- \nTraceWarning\n: writes a warning trace message at \nTraceEventType.Warning\n\n- \nTraceInfo\n: writes an informational trace message at \nTraceEventType.Information\n\n- \nTraceError\n: writes an error trace message at \nTraceEventType.Error\n\n- \nTrace Method\n: writes a trace message at \nTraceEventType.Verbose\n\n\nDebugging\n\n\nThis section explains how to attach the debugger so that you can debug your implementation line-by-line within Visual Studio, and specify breakpoints where execution of the code pauses.\n\n\n\n\nOpen your customized solution in Visual Studio 2012.\n\n\nAttach to process w3wp.exe which has the user name \nIIS APPPOOL\\Citrix Delivery Services Resources\n.\n\n\n\n\nSubsequent requests for resources using the preferred client will hit a breakpoint in Visual Studio.\n\n\nTo set up remote debugging, see Enabling Remote Debugging. You need to do this if the development machine running Visual Studio is different from the StoreFront deployment machine running your customizations.", 
            "title": "Customization interfaces"
        }, 
        {
            "location": "/customization-interfaces/#customization-interfaces", 
            "text": "This topic details the interfaces exposed by StoreFront and explains how to use these to apply customizations.\nThere are four main types of customization:   Resources customization\u2014uses the IEnumerationResultModifier interface  Sessions customization\u2014uses the ISessionListModifier interface  ICA file customization\u2014uses the ILaunchResultModifier interface  Request customization\u2014uses the IInputModifier interface   The interfaces are bundled in the Citrix.DeliveryServices.ResourcesCommon.Customization.Contract  assembly.  The implementing assembly must target .NET Framework 4.5.\nEach interface exposes the following members (see the appropriate interface for more details), unless specified otherwise:   Modify : This virtual method is the calling point of the interface. To customize, the implementing class must override this method. The signature of this method is detailed in the appropriate interface section below.  RunExtendedValidation : This property indicates whether or not StoreFront validates the returned value to ensure it is of the correct form. Because there is a performance impact associated with extended validation, only set this on during development and debugging, and ensure that extended validation is set to off in the production environment.  ReturnOriginalValueOnFailure : This property indicates whether or not StoreFront returns the original computed value, whenever there's an error in the customized value returned by the method. We recommend you set this property to true.", 
            "title": "Customization interfaces"
        }, 
        {
            "location": "/customization-interfaces/#resources-customization", 
            "text": "Use this type of customization to modify the resource enumeration, as computed by\nStoreFront, before it is sent to the client. StoreFront calls the Modify method of the\nIEnumerationResultModifier interface with the computed resource enumeration result and a context parameter. The implementing class must override the method, modify the enumeration result and return it back to StoreFront. StoreFront then sends the modified result to the client for further processing.  Refer to the Store Service Customization API file and the sample solution supplied with the SDK for examples of how to use this interface.   Note  Resources customizations only take effect for Receivers using the native protocols;     customizations do not take effect for clients that access the store using legacy    protocols, such as Program Neighbourhood Agent.", 
            "title": "Resources customization"
        }, 
        {
            "location": "/customization-interfaces/#interface", 
            "text": "The custom class must implement the  IEnumerationResultModifier  interface.", 
            "title": "Interface"
        }, 
        {
            "location": "/customization-interfaces/#class-name", 
            "text": "Name the custom class  EnumerationResultModifier .", 
            "title": "Class Name"
        }, 
        {
            "location": "/customization-interfaces/#assembly-name", 
            "text": "Place the custom class in the  StoreCustomization_Enumeration  assembly.", 
            "title": "Assembly Name"
        }, 
        {
            "location": "/customization-interfaces/#method-signature", 
            "text": "String  Modify  ( CustomizationContextData  context, string  valueToModify )  Use this method when you want to modify the entire resource enumeration result. All the code to customize the resource enumeration must be contained within this method.", 
            "title": "Method Signature"
        }, 
        {
            "location": "/customization-interfaces/#method-signature_1", 
            "text": "String  ModifySingleApp  ( CustomizationContextData  context, string  valueToModify )  Use this method when you want to modify a single resource. All the code to customize the resource enumeration must be contained within this method.", 
            "title": "Method Signature"
        }, 
        {
            "location": "/customization-interfaces/#parameters", 
            "text": "context : This parameter is of type  CustomizationContextData  and contains a set of context data, such as device information,  HttpContext , user identity, access conditions, farm details and any user access preferences. See the Store Service Customization API file for details about this type; use this as a reference to base the customization logic on.    valueToModify : This parameter is of type string and contains the resource enumeration result, as computed by StoreFront. This string adheres to the resource enumeration result, as specified in the Store Service Customization API file.", 
            "title": "Parameters"
        }, 
        {
            "location": "/customization-interfaces/#return-value", 
            "text": "This method returns a string containing the resource enumeration result, as specified in the StoreFront Service API.\nThe implementing class must run all the validations against the resource enumeration result before returning it from the method.", 
            "title": "Return Value"
        }, 
        {
            "location": "/customization-interfaces/#sessions-customization", 
            "text": "Use this interface to modify the ICA sessions enumeration, as computed by StoreFront, before it is sent to the client. StoreFront calls the Modify method of the ISessionListModifier interface with the computed session enumeration result and a context parameter. The implementing class must override the method, modify the enumeration result, and return it back to StoreFront. StoreFront then sends the modified result to the client for further processing.  Refer to the Store Service Customization API file and the sample solution supplied with the SDK for examples of how to use this interface.   Note   Sessions customizations only take effect for Receivers using the native protocols; customizations do not take effect for clients that access the store using legacy protocols, such as Program Neighbourhood Agent.   Interface : the custom class must implement the  ISessionListModifier  interface.  Class Name : name the custom class  SessionListModifier .  Assembly Name : place the custom class in the  StoreCustomization_SessionEnumeration  assembly.  Method Signature : string  Modify ( CustomizationContextData  context, string  valueToModify )   Use this method to modify the session enumeration result. All the code to customize the session enumeration must be contained within this method.", 
            "title": "Sessions customization"
        }, 
        {
            "location": "/customization-interfaces/#parameters_1", 
            "text": "context : This parameter is of type CustomizationContextData. It contains a set of context data, such as device information, HttpContext, user identity, access conditions, farm details and any user access preferences. See the Store Service Customization API file for details about this type; use this as a reference on which to base customization logic.    valueToModify : This parameter is of type string and contains the session enumeration result, as computed by StoreFront; see the Store Service Customization API file.", 
            "title": "Parameters"
        }, 
        {
            "location": "/customization-interfaces/#return-value_1", 
            "text": "This method returns a string containing the session enumeration result, as specified in the StoreFront Service API. The implementing class must run all validations against the session enumeration before returning it from the method.", 
            "title": "Return Value"
        }, 
        {
            "location": "/customization-interfaces/#ica-file-customization", 
            "text": "Use this interface to modify the content of an ICA file, as computed by StoreFront, before it is sent to the client. StoreFront calls the Modify method of the ILaunchResultModifier interface with the computed ICA file and a context parameter. The implementing class must override the method, modify the ICA file, and return it back to StoreFront. StoreFront then sends the modified file to the client for further processing.  Refer to the Store Service Customization API file and the sample solution supplied with the SDK for examples of how to use this interface.   Interface :the custom class must implement the  ILaunchResultModifier  interface.  Class Name : name the custom class  LaunchResultModifier .  Assembly Name : place the custom class in the  StoreCustomization_Launch  assembly.  Method Signature : string  Modify ( CustomizationContextData  context, string  valueToModify )   Use this method to modify the content of the ICA file. All the code to customize the ICA file must be contained within this method.", 
            "title": "ICA File customization"
        }, 
        {
            "location": "/customization-interfaces/#parameters_2", 
            "text": "- context : This parameter is of type  CustomizationContextData  and contains a set of context data, such as device information,  HttpContext , user identity, access conditions, farm details and any user access preferences. See the Store Service Customization API file for details about this type; use this as a reference on which to base the customization logic.\n- valueToModify : This parameter is of type string and contains the content of ICA file as computed by StoreFront.", 
            "title": "Parameters"
        }, 
        {
            "location": "/customization-interfaces/#return-value_2", 
            "text": "This method returns a string, which forms the content of the ICA file. The implementing class must run all validations against the modified file content before returning it from the method.", 
            "title": "Return Value"
        }, 
        {
            "location": "/customization-interfaces/#request-customization", 
            "text": "Use this interface to modify a request before it is forwarded to the back-end XML services, such as the XenDesktop Delivery Controller.  Unlike other customization points where the custom code is called after StoreFront computes the result, this customization code is called before the request is sent to the back-end XML services, after partial request processing by StoreFront. StoreFront calls the Modify method of the IInputModifier interface with a set of request parameters and a context parameter. The implementing class must override this method and can alter the value of the properties of the request parameters. StoreFront uses the modified request parameters when contacting the back-end XML services.   Note  The Request Customization interface cannot be used if the site is configured with multi-    site farms (configured using the  userFarmMappings  configuration element or  Set-  DSUserMappings  cmdlet).   Refer to the Store Service Customization API file and the sample solution supplied with the SDK for examples of how to use this interface.   Interface : the custom class must implement the  IInputModifier  interface.  Class Name : name the custom class  IInputModifier .  Assembly Name : place the custom class in the  StoreCustomization_Input  assembly.  Method Signature : void  Modify  ( CustomizationContextData  context, out  FarmSetsContext farmSetsContext , out  DeviceInfo deviceInfo , out  AccessConditions accessConditions )   Use this method to modify the request. All the code to modify the request must be contained within this method.  Refer to the Store Service Customization API file and the sample solution supplied with the SDK for examples of how to use this interface.   Interface : the custom class must implement the IInputModifier interface.  Class Name : name the custom class IInputModifier.  Assembly Name : place the custom class in the StoreCustomization_Input assembly.  Method Signature : void Modify (CustomizationContextData context, out FarmSetsContext farmSetsContext, out DeviceInfo deviceInfo, out AccessConditions accessConditions)   Use this method to modify the request. All the code to modify the request must be contained within this method.", 
            "title": "Request customization"
        }, 
        {
            "location": "/customization-interfaces/#parameters_3", 
            "text": "context : This parameter is of type  CustomizationContextData . It contains a set of context data, such as device information,  HttpContext , user identity, access conditions, farm details and any user access preferences.  farmSetsContext : This parameter is of type  FarmSetsContext  and contains the list of farms which will be contacted by StoreFront. The customization modifies this list. StoreFront contacts each farm in the modified list.  deviceInfo : This parameter is of type  DeviceInfo  and contains the client device information as sent by the client. Use this customization to modify this information before StoreFront sends it to the back-end XML services.  accessConditions : This parameter is of type  AccessConditions . It contains the access conditions sent by the client and computed by StoreFront. Use this customization to modify these conditions before StoreFront sends this information to the back-end XML services.   For more information about the parameters, see the Store Service Customization API file.", 
            "title": "Parameters"
        }, 
        {
            "location": "/customization-interfaces/#deploy-customizations", 
            "text": "This topic explains how to deploy your customizations. Customization modules must be contained within their respective assemblies. To deploy customizations:   Back up the original assemblies  Deploy customizations   These steps are explained in more detail below.", 
            "title": "Deploy customizations"
        }, 
        {
            "location": "/customization-interfaces/#back-up-the-original-assemblies", 
            "text": "Citrix recommends you back up the original assemblies before replacing them with the new customized assemblies. Original assemblies are required for restoring the default behavior. Ensure you back up the following:   StoreCustomization_Enumeration.dll  StoreCustomization_Input.dll  StoreCustomization_Launch.dll  StoreCustomization_SessionEnumeration.dll", 
            "title": "Back up the original assemblies"
        }, 
        {
            "location": "/customization-interfaces/#deploy-customizations_1", 
            "text": "To deploy customizations, manually copy the new customized assemblies to the Store's bin folder on the appropriate StoreFront server. This replaces the existing assemblies.  If the StoreFront server is part of a cluster deployment, perform the propagation action to push the new assemblies to other members of the cluster.   Note  Only these files, and accompanying pdbs, are propagated using the propagation action. If    there are additional files, these must be copied manually to all machines in the cluster.", 
            "title": "Deploy customizations"
        }, 
        {
            "location": "/customization-interfaces/#example", 
            "text": "The following example shows how to locate the Store's bin folder on the StoreFront Server.  In this example, the home directory for the website is  C:\\inetpub\\wwwroot .  StoreFront is configured on this website with a store named \"Store\". The valid full directory path you copy new customized assemblies to is:  C:\\inetpub\\wwwroot\\Citrix\\Store\\bin", 
            "title": "Example"
        }, 
        {
            "location": "/customization-interfaces/#restart-services", 
            "text": "After deploying your customizations, restart the following services. Restarting forces the services to clear any cached data from previous implementations of the assemblies.   Note  Services should restart automatically when customizations are deployed, but Citrix  recommend you check that this has occurred.    Internet Information Service: this is the IIS service running on the StoreFront Server.  CitrixSubscriptionsStore : this is a Windows service running on the StoreFront Server.", 
            "title": "Restart services"
        }, 
        {
            "location": "/customization-interfaces/#test-and-debug", 
            "text": "This topic explains how to test and debug your customizations. It explains how to enable tracing, and attach the debugger so that you can debug within Visual Studio.  To troubleshoot your implementation, first look in the event log. You can also consult the trace which provides more information than in the event log. During testing, set the trace level to \"verbose\"; in production, set it to Error or Warning\u2014see the section below for details of how to enable tracing.  For information on debugging your implementation within Visual Studio, see the section below.  You can also configure StoreFront to run extended validation against returned values during development and testing. To do this, set RunExtendedValidation to true; for more information see  Customization interfaces . However, because there is a performance impact when running extended validation, ensure you set this off in the production environment.", 
            "title": "Test and debug"
        }, 
        {
            "location": "/customization-interfaces/#enable-tracing", 
            "text": "The tracing feature writes detailed information to the trace. The default location for trace dumps is  C:\\Program Files\\Citrix\\Receiver StoreFront\\Admin\\trace .  To enable tracing and set the trace level, use the PowerShell script  SetDSStoreCustomizationTraceLevel.ps1  which is supplied with the SDK. This script takes the following parameters:   SiteId : the IIS Site Id where the store is deployed  VirtualPath : the virtual path of the store  TraceLevel : use to set the following trace levels:\n    a.   Error \n    b.   Info \n    c.   Off \n    d.   Verbose \n    e.   Warning    Note  Citrix recommend you set the trace level to  Verbose  during development, and to  Error  or      Warning  in theproduction environment.    Note  If you do not know the SiteId and VirtualPath of the Store, run the following PowerShell    commands:   cd 'c:\\program files\\Citrix\\Receiver Storefront\\Scripts'. \n.\\ImportModules.ps1\nGet-DSStoreFeatureInstances", 
            "title": "Enable tracing"
        }, 
        {
            "location": "/customization-interfaces/#write-to-the-trace", 
            "text": "The Store Customization SDK includes a tracing class named  Tracer . This class has the following methods which allow you to output to the trace from the Store Customization SDK:\n-  TraceWarning : writes a warning trace message at  TraceEventType.Warning \n-  TraceInfo : writes an informational trace message at  TraceEventType.Information \n-  TraceError : writes an error trace message at  TraceEventType.Error \n-  Trace Method : writes a trace message at  TraceEventType.Verbose", 
            "title": "Write to the trace"
        }, 
        {
            "location": "/customization-interfaces/#debugging", 
            "text": "This section explains how to attach the debugger so that you can debug your implementation line-by-line within Visual Studio, and specify breakpoints where execution of the code pauses.   Open your customized solution in Visual Studio 2012.  Attach to process w3wp.exe which has the user name  IIS APPPOOL\\Citrix Delivery Services Resources .   Subsequent requests for resources using the preferred client will hit a breakpoint in Visual Studio.  To set up remote debugging, see Enabling Remote Debugging. You need to do this if the development machine running Visual Studio is different from the StoreFront deployment machine running your customizations.", 
            "title": "Debugging"
        }, 
        {
            "location": "/known-issues/", 
            "text": "Known issues in the SDK\n\n\nThis topic lists any known issues specific to this SDK; review this carefully before you begin using the SDK.\n\n\n\n\n\n\nWhen a user logs onto StoreFront using credentials in User Principal Name (UPN) format, the AuthenticationType field of the UserIdentity object stored in CustomizationContextData is set to an empty string and Name is set to the UPN name used when logging on.\n\n\n\n\n\n\nWhen extended validation is enabled and StoreFront experiences high usage, some requests may fail the validation process despite these requests being valid. This issue occurs intermittently, and the following error may appear: \n\n\n\n\n\n\nCitrix.DeliveryServices.ResourcesCommon.Customization.ValidationException: XML validation against schema failed\n. Ensure extended validation is set to off in the production environment.", 
            "title": "Known issues"
        }, 
        {
            "location": "/known-issues/#known-issues-in-the-sdk", 
            "text": "This topic lists any known issues specific to this SDK; review this carefully before you begin using the SDK.    When a user logs onto StoreFront using credentials in User Principal Name (UPN) format, the AuthenticationType field of the UserIdentity object stored in CustomizationContextData is set to an empty string and Name is set to the UPN name used when logging on.    When extended validation is enabled and StoreFront experiences high usage, some requests may fail the validation process despite these requests being valid. This issue occurs intermittently, and the following error may appear:     Citrix.DeliveryServices.ResourcesCommon.Customization.ValidationException: XML validation against schema failed . Ensure extended validation is set to off in the production environment.", 
            "title": "Known issues in the SDK"
        }, 
        {
            "location": "/samples/", 
            "text": "Samples\n\n\nIEnumrationResultModifier\n\n\nThis example demonstrates how to use \nIEnumrationResultModifier\n interface to disable the resources based upon the time of the request.\n\n\nusing System;\nusing System.Xml.Linq;\nusing Citrix.DeliveryServices.ResourcesCommon.Customization.Contract;\nnamespace StoreCustomization_Enumeration\n{\n    public class EnumerationResultModifier : IEnumerationResultModifier\n    {\n        public string Modify(CustomizationContextData context, string valueToModify)\n        {\n            if (context != null \n !IsTimeAcceptable(context.HttpContext.Timestamp))\n            {\n                var document = XDocument.Parse(valueToModify);\n                if (document.Root != null)\n                {\n                    XNamespace ns = \nhttp://citrix.com/delivery-services/2-0/resources\n;\n                    var resources = document.Root.Descendants(ns + \nresource\n);\n                    foreach (var enabledElement in resources)\n                    {\n                        enabledElement.SetElementValue(ns + \nenabled\n, \nfalse\n);\n                    }\n                    return document.ToString();\n                }\n            }\n            return valueToModify;\n        }\n        public bool RunExtendedValidation { get { return false; } }\n        public bool ReturnOriginalValueOnFailure { get { return true; } }\n    }\n}\n\n\n\n\nIInputModifier\n\n\nThis example demonstrates how to use \nIInputModifier\n interface to add a new \nAccessConditions\n based on \nAuthenticationType\n.\n\n\nusing System;\nusing System.Collections.Generic;\nusing Citrix.DeliveryServices.ResourcesCommon.Customization.Contract;\nnamespace StoreCustomization_Input\n{\n    public class InputModifier : IInputModifier\n    {\n        public bool RunExtendedValidation { get { return false; } }\n        public bool ReturnOriginalValueOnFailure { get { return false; } }\n        public void Modify(CustomizationContextData context, out FarmSetsContext farmSetsContext, out DeviceInfo deviceInfo, out AccessConditions accessConditions)\n        {\n            farmSetsContext = context.FarmSetsContext;\n            deviceInfo = context.DeviceInfo;\n            accessConditions = context.AccessConditions;\n            if (context.UserIdentity.IsAuthenticated)\n            {\n                accessConditions = new AccessConditions(new List\nstring\n { @\nNew_Apps_Access\n }, @\nAGFarm\n);\n            }\n        }\n    }\n}\n\n\n\n\nILaunchResultModifier\n\n\nThis example demonstrates how to use \nILaunchResultModifier\n interface to modify a property in ICAfile based upon Device Info.\n\n\nusing System;\nusing Citrix.DeliveryServices.ResourcesCommon.Customization.Contract;\nnamespace StoreCustomization_Launch\n{\npublic class LaunchResultModifier : ILaunchResultModifier\n{\n        public string Modify(CustomizationContextData context, string valueToModify)\n        {\n            const string colorKey = \nDesiredColor\n;\n            const string newValue = \n16\n;\n            if (context.DeviceInfo.DisplayWidth \n 1024 \n !string.IsNullOrEmpty(valueToModify))\n            {\n                var indexOfKey = valueToModify.IndexOf(colorKey, StringComparison.OrdinalIgnoreCase);\n                if (indexOfKey \n 0)\n                {\n                    var indexOfEndOfLine = valueToModify.IndexOf(Environment.NewLine, indexOfKey, StringComparison.OrdinalIgnoreCase);\n                    var oldKeyValuePair = valueToModify.Substring(indexOfKey, (indexOfEndOfLine - indexOfKey));\n                    var newKeyValuePair = string.Format(\n{0}={1}\n, colorKey, newValue);\n                    valueToModify = valueToModify.Replace(oldKeyValuePair, newKeyValuePair);\n                }\n            }\n            return valueToModify;\n        }\n        public bool RunExtendedValidation { get { return false; } }\n        public bool ReturnOriginalValueOnFailure { get { return true; } }\n    }\n}", 
            "title": "Samples"
        }, 
        {
            "location": "/samples/#samples", 
            "text": "", 
            "title": "Samples"
        }, 
        {
            "location": "/samples/#ienumrationresultmodifier", 
            "text": "This example demonstrates how to use  IEnumrationResultModifier  interface to disable the resources based upon the time of the request.  using System;\nusing System.Xml.Linq;\nusing Citrix.DeliveryServices.ResourcesCommon.Customization.Contract;\nnamespace StoreCustomization_Enumeration\n{\n    public class EnumerationResultModifier : IEnumerationResultModifier\n    {\n        public string Modify(CustomizationContextData context, string valueToModify)\n        {\n            if (context != null   !IsTimeAcceptable(context.HttpContext.Timestamp))\n            {\n                var document = XDocument.Parse(valueToModify);\n                if (document.Root != null)\n                {\n                    XNamespace ns =  http://citrix.com/delivery-services/2-0/resources ;\n                    var resources = document.Root.Descendants(ns +  resource );\n                    foreach (var enabledElement in resources)\n                    {\n                        enabledElement.SetElementValue(ns +  enabled ,  false );\n                    }\n                    return document.ToString();\n                }\n            }\n            return valueToModify;\n        }\n        public bool RunExtendedValidation { get { return false; } }\n        public bool ReturnOriginalValueOnFailure { get { return true; } }\n    }\n}", 
            "title": "IEnumrationResultModifier"
        }, 
        {
            "location": "/samples/#iinputmodifier", 
            "text": "This example demonstrates how to use  IInputModifier  interface to add a new  AccessConditions  based on  AuthenticationType .  using System;\nusing System.Collections.Generic;\nusing Citrix.DeliveryServices.ResourcesCommon.Customization.Contract;\nnamespace StoreCustomization_Input\n{\n    public class InputModifier : IInputModifier\n    {\n        public bool RunExtendedValidation { get { return false; } }\n        public bool ReturnOriginalValueOnFailure { get { return false; } }\n        public void Modify(CustomizationContextData context, out FarmSetsContext farmSetsContext, out DeviceInfo deviceInfo, out AccessConditions accessConditions)\n        {\n            farmSetsContext = context.FarmSetsContext;\n            deviceInfo = context.DeviceInfo;\n            accessConditions = context.AccessConditions;\n            if (context.UserIdentity.IsAuthenticated)\n            {\n                accessConditions = new AccessConditions(new List string  { @ New_Apps_Access  }, @ AGFarm );\n            }\n        }\n    }\n}", 
            "title": "IInputModifier"
        }, 
        {
            "location": "/samples/#ilaunchresultmodifier", 
            "text": "This example demonstrates how to use  ILaunchResultModifier  interface to modify a property in ICAfile based upon Device Info.  using System;\nusing Citrix.DeliveryServices.ResourcesCommon.Customization.Contract;\nnamespace StoreCustomization_Launch\n{\npublic class LaunchResultModifier : ILaunchResultModifier\n{\n        public string Modify(CustomizationContextData context, string valueToModify)\n        {\n            const string colorKey =  DesiredColor ;\n            const string newValue =  16 ;\n            if (context.DeviceInfo.DisplayWidth   1024   !string.IsNullOrEmpty(valueToModify))\n            {\n                var indexOfKey = valueToModify.IndexOf(colorKey, StringComparison.OrdinalIgnoreCase);\n                if (indexOfKey   0)\n                {\n                    var indexOfEndOfLine = valueToModify.IndexOf(Environment.NewLine, indexOfKey, StringComparison.OrdinalIgnoreCase);\n                    var oldKeyValuePair = valueToModify.Substring(indexOfKey, (indexOfEndOfLine - indexOfKey));\n                    var newKeyValuePair = string.Format( {0}={1} , colorKey, newValue);\n                    valueToModify = valueToModify.Replace(oldKeyValuePair, newKeyValuePair);\n                }\n            }\n            return valueToModify;\n        }\n        public bool RunExtendedValidation { get { return false; } }\n        public bool ReturnOriginalValueOnFailure { get { return true; } }\n    }\n}", 
            "title": "ILaunchResultModifier"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/", 
            "text": "Authentication Software Development Kit\n\n\n1. Introduction\n\n\n1.1  Scope\n\n\nThis document describes the StoreFront Services v2.6 Authentication Software Development Kit. It describes how to use the SDK to develop new custom forms-based authentication methods, or new authentication protocols. This document also describes how the customizations can be delivered and deployed on existing servers running StoreFront Services v2.6.\n\n\nThe SDK requires a working knowledge of the Microsoft .NET Framework (http://msdn.microsoft.com/en-US/vstudio/aa496123 ) and in particular the C# programming language (http://msdn.microsoft.com/en-us/library/vstudio/z1zx9t92(v=vs.100).aspx ). \n\n\n1.2  Deliverables\n\n\nThis SDK contains the following deliverables, packaged into a single compressed archive:\n\n\n\n\nAssemblies: The external and StoreFront assemblies referenced by the samples, including any associated xml documentation files\n\n\nDocumentation: This document and its supporting documentation\n\n\nInstallers: Pre-built installers for the samples\n\n\nMerge: Files used by the sample unittests\n\n\nTools: The tools used to build the samples and run the unit tests\n\n\nMagic Word Sample: A simple authentication form that demonstrates a full implementation\n\n\nTest Forms: A sample to demonstrate the use of User Interface Elements in a series of custom forms\n\n\nCertificateIdentityDeclaration: A sample to illustrate a new authentication protocol\n\n\n\n\nThe samples contain Visual Studio 2012 solutions, C# source code that builds msi installers that can be used to deploy the sample to a StoreFront 2.6 deployment. The samples also contain unit tests focussed around testing the form implementation, or the authentication protocol.\n\n\n1.2.1   PREREQUISITES\n\n\nThe following prerequisites are required, installed in the following order:\n\n\n\n\n\n\nVisual Studio (2012 or later)\n\n\n\n\nOn Windows Server 2012 and later .NET 3.5 SP1 will need to be installed in order to be able to target .Net 3.5 SP1 as required for some project types.\n\n\nTo run the unit tests, the NUnit Test Adapter for Visual Studio 2012 and 2013 is required. See the following for installation and usage instructions: http://nunit.org/index.php?p=vsTestAdapter\nr=2.6.2 \n\n\n\n\n\n\n\n\nWix v3.6.3303.0: http://wix.codeplex.com/releases/view/93929 \n\n\n\n\n\n\n1.3  References\n\n\n[1] RFC 2617 HTTP Authentication: Basic and Digest Access Authentication: http://tools.ietf.org/html/rfc2617 \n\n\n[2] CitrixAuth Authentication Scheme v2.0\n\n\n[3] Security Token Services API v2.0\n\n\n[4] Citrix Receiver Common Authentication Forms Language v2.6\n\n\n[5] ASP.Net MVC 4: http://www.asp.net/mvc/mvc4 \n\n\n[6] The Service Locator Pattern: http://msdn.microsoft.com/en-us/library/ff648968.aspx \n\n\n[7] Authenticode: http://msdn.microsoft.com/en-us/library/ms537359(v=vs.85).aspx\n\n\n[8] Time Stamping Authenticode Signatures: http://msdn.microsoft.com/en-us/library/windows/desktop/bb931395(v=vs.85).aspx \n\n\n[9] StoreFront Authentication Form Generation v2.6\n\n\n2  StoreFront Services Authentication Overview\n\n\n2.1   Identity Management Systems\n\n\nTraditional systems have centralized identity management systems where each application is responsible for authenticating the user and establishing their identity. This has led to multiple implementations of authentication and authorization systems and applications with differing levels of support for different authentication methods. \nIn federated systems the user authenticates once, to an appropriate authentication service, which gathers information about the user. This information often takes the form of assertions or claims regarding the user. The claims are then marshalled to other applications or services that rely on the authentication service. These \"relying parties\" have been configured to trust the assertions/claims issued by the authentication service, or \"trusted issuer\" and this is commonly enforced by strong cryptographic means such as digital signing and encipherment. The assertions/claims are marshalled as security tokens that are issued by the trusted issuer, held by the application, and presented to other services to gain access to data and services.\n\n\n\n2.2  The Authentication Service\n\n\nThe StoreFront Authentication Service is a web application, hosted in IIS, which makes extensive use of the ASP.NET MVC Framework 4.0 [5]. The service is usually hosted at the relative URL: /Citrix/Authentication of the chosen IIS web site. HTTP requests are routed by IIS, ASP.NET and the MVC framework to Controllers for processing.\n\n\nNew authentication methods are added by adding new ASP.NET Routes into the web application and mapping them to new Controllers. For forms based authentication, the forms are rendered using a custom mechanism based on ASP.Net Razor templates [9].\nConfiguration data is stored in the associated web.config file. When the web application starts, a configured set of start-up modules are run, which parse the configuration into settings objects that are stored in a Service Locator [6], along with other long-lived objects.\n\n\n\n\nThe StoreFront Administration Console utilizes a PowerShell layer to configure the solution. The PowerShell layer makes extensive use of a custom configuration provider that allows certain portions of the web.config file to be accessed as if it were a mounted drive; see Section 3.4.3. This simplifies accessing the configuration data using standard PowerShell commands.\n\n\n2.3  Authentication Support Services\n\n\nIn addition to the Authentication web application, there are additional Windows services that provide functionality requiring higher levels of privilege. The Authentication web application communicates with these WCF services utilizing named pipes for the communication channel. Access to these services is controlled through membership of local Windows groups.\n\n\nCredential Wallet\n\nThe Credential Wallet is a WCF service hosted in a Windows service called Citrix Credential Wallet, or its localized variant. The hosted Credential Wallet service is an in-memory hash table that securely stores encrypted passwords.\nThe samples demonstrate how to store passwords in the Credential Wallet by utilizing the existing functionality in one of the specialized claims.\n\n\nDomain Services\n\nThe Domain Services host WCF services that provide the functionality to authenticate a user by using explicit credentials  (user name and password), or utilizing Kerberos Service-for-User for both user principal names and certificates.\n\n\nThe default is to create one Domain Services called Citrix Default Domain Services, or the localized variant, which provides authentication and LDAP services for the domain that the server is currently a member of, or an associated trust scope.\nThe samples demonstrate how to delegate credential validation to the most appropriate service described above.\n\n\n2.4  Relying Party Authentication: CitrixAuth\n\n\nAs described above, a relying party, such as the Store service, can challenge for authentication at any point. This challenge takes the form of an RFC2617 [1] extension. It uses the standard HTTP WWW-Authenticate header for the challenge and the Authorization HTTP header as the response. Further information can be found in the CitrixAuth Scheme document [2].\n\n\nWhen a client receives a challenge, it must respond by constructing and sending a Request Security Token (RST) to the location specified in the challenge. The details of how to construct the RST can be found in the CitrixAuth Authentication Scheme document [2]. The client should expect to receive a Request Security Token Response (RSTR) message in response to the RST message. The location to which the RST is sent, will be the Token Issuing Service. The RSTR that is returned will contain the security token that can be used to access the required resource in the response to the challenge, plus additional information to assist the client with caching the token.\nFor more information on the endpoints and expected messages, see the Security Token Services API document [3].\n\n\n2.5  Primary Authentication\n\n\nThe Token Issuing Service is itself a relying party that issues challenges if an appropriate security token is not present. The location associated with the challenge is the protocol choices endpoint that allows a negotiation between the client and the authentication service regarding which authentication method should be used.\n\n\n\n\nThe following protocols are supported in this version:\n- User name and password: A user is required to explicitly provide their domain-qualified user name and password\n\n\n\n\nDomain pass-through: Use the desktop session credentials to authenticate\n\n\nSmart card: Smart card authentication\n\n\nHttp Basic: This is used by third-party client integrations and web portals, where an external user interface has been used to capture a domain-qualified user name and password\n\n\nPass-through from Citrix Access Gateway: This allows single sign-on from Citrix NetScaler Gateway\n\n\nCitrix Federation: This is an internal authentication mechanism to StoreFront\n\n\n\n\nThe \u201cUser name and password\u201d authentication method shares a common mechanism with Access Gateway to render a form for the collection of user credentials. Further details can be found in the Common Authentication Forms Language document [4].\n\n\n2.6  Common Forms\n\n\nThe samples illustrate developing custom forms-based protocols that are based on the Common Authentication Forms Language. The flow of forms and responses constitutes a conversation that can have state associated with the overall conversation. For maximum interoperability, the protocol is a REST API (XML Forms transmitted over HTTPS) and is described in [4].\n\n\nIn this version of the SDK, a new protocol identifier is defined: CustomForms. The clients are required to recognize this protocol identifier and map it to their existing Common Forms rendering. Clients will give preference to this new protocol over the existing ExplicitForms protocol, should both be available. The expectation is that any organization will only implement, or purchase, a single custom authentication mechanism for their organization, so multiple vendors advertising their customizations in this way should not be an issue.\n\n\n2.7  Delegated Forms Authentication\n\n\nIn order to extend the reach of any customization to include NetScaler Gateway, Citrix has defined a protocol for delegating forms authentication to a customized StoreFront deployment. In this release, the StoreFront Authentication Service provides an endpoint for NetScaler to delegate the rendering and handling of forms authentication to StoreFront.\n\n\nIt is possible to configure the Delegated Forms Server to use customized forms conversations created with this SDK, allowing both internal and external clients to share the customized experience.\nIn this release, the delegated forms functionality is configured from PowerShell only. A description of the high-level commands can be found in the document installed on the StoreFront server at the following location:\n%PROGRAMFILES%\\Citrix\\Receiver StoreFront\\Management\\Cmdlets\\DFAServerFPReadMe.rtf\nIt is expected that the PowerShell required to configure the delegated forms to use the specific customization shall be wrapped in a simple PowerShell command by the customization author and provided as part of the customization.\n\n\n3  StoreFront Management Overview\n\n\nThe deployment and management of StoreFront is based around PowerShell and a Microsoft Management Console (MMC) snap-in that orchestrates the PowerShell commands. The following sections describe where management data is stored and managed.\n\n\n3.1  Registry\n\n\nThe Windows registry is used to store the following information:\n\n\nKey\n: HKLM\\SOFTWARE\\Citrix\\DeliveryServices\n\n\nValues\n\n\n\n\nAdminConsoleOperationMode: This controls the operational mode of the StoreFront Administration Console\n\n\nCertificateStoreName: The name of the private machine certificate store used by StoreFront\n\n\nClockSkew: The amount of clock skew allowed when comparing validity periods for authentication tokens\n\n\nConfigurationLevel: This value is used to compare two servers when replicating data\n\n\nFrameworkControllerAssemblyPath: The path of an assembly that implements the StoreFront framework controller\n\n\nFrameworkControllerType: The type of the class that implements the framework controller in the assembly at: FrameworkControllerAssemblyPath\n\n\nIISAssemblyPath: The path of an assembly that implements the IIS manager\n\n\nIISManagerType: The type of the class that implements the IIS manager in the assembly at: IISAssemblyPath\n\n\nInstallDir: The path where StoreFront is installed, which is usually: %PROGRAMFILES%\\Citrix\\Receiver StoreFront\n\n\nWindowsInstallerAssemblyPath: The path of an assembly that implements the StoreFront Windows installer functionality\n\n\nWindowsInstallerType: The type of the class that implements the Windows installer functionality in the assembly at: WindowsInstallerAssemblyPath\n\n\n\n\nKey\n: HKLM\\SOFTWARE\\Citrix\\DeliveryServices\\FrameworkControllerData\n\n\nValues\n\n- DirectoryPath: The path to the directory that stores the StoreFront framework controller data\n\n\nKey\n: HKLM\\SOFTWARE\\Citrix\\DeliveryServicesManagement\n\n\nValues\n\n\n\n\nAdminMscFileLocation: The StoreFront Management Console snap-in configuration file\n\n\nInstallDir: The StoreFront management installation directory, which is usually: %PROGRAMFILES%\\Citrix\\Receiver StoreFront\\Management\n\n\n\n\nThe following key contains sub-keys that control the scope nodes in the StoreFront Administration Console (see Section 3.5):\n\n\nHKLM\\SOFTWARE\\Citrix\\DeliveryServicesManagement\\Plugins\n\n\nEach key can contain the following values:\n\n\n\n\nIsEnabled: This controls whether the associated scope node is displayed\n\n\nIsFirstUsePlugin: Determines whether the associated node participates in the First-Time Use experience\n\n\nOrderingHint: This controls the order in which the scope nodes are displayed in the StoreFront Administration Console\n\n\nParent: This specifies the parent of the associated scope node\n\n\n\n\nThe Windows registry is also used by the Authentication SDK. The following key contains two sub-keys: Extensions and ViewExtensions:\nHKLM\\SOFTWARE\\Citrix\\DeliveryServicesManagement\\Plugins\\Authentication\nEvery authentication method should add a sub-key to the Extensions key, with a default value that specifies the assembly that contains the implementation of the Authentication SDK management plug-in as described in Section 3.5.\nIf an authentication method has configuration actions, then it should also add a sub-key to the ViewExtensions key, with a default value that specifies the assembly that contains the implementation of the Authentication SDK view extension as described in Section 3.5.3.\nThe assemblies described above should be located at the path specified by the InstallDir value of the key:\nHKLM\\SOFTWARE\\Citrix\\DeliveryServicesManagement.\n\n\n3.2  Framework Controller Data\n\n\nThe StoreFront framework controller data for this release is stored in an XML file at the path specified by the DirectoryPath value of the key: \nHKLM\\SOFTWARE\\Citrix\\DeliveryServices\\FrameworkControllerData.\n\n\nThis file contains the information about which features are currently deployed, including Windows Services, web applications etc, and is used by the StoreFront Framework controller for deployment management.\nThe data stored here is managed by the PowerShell API and should not be manually updated.\n\n\n3.3  Configuration Data\n\n\nMost of the configuration data for individual StoreFront components is stored in the web.config file of the associated web application, or in the application.config file for Windows services.\n\n\nThese configuration settings are managed by the StoreFront Configuration Provider (see Section 3.4.3) . In order for the configuration provider to read and write the settings a configuration section is required; see: http://msdn.microsoft.com/en-us/library/vstudio/2tw134k3(v=vs.100).aspx.\n\n\n3.3.1   SERVICE LOCATOR\n\n\nThe basic idea behind a service locator is to have an object that knows how to get hold of all of the services that an application might need. StoreFront makes extensive use of service location and inversion-of-control (IoC) containers; see http://martinfowler.com/articles/injection.html for more details of this software pattern.For the StoreFront services to access the configuration data the following procedure is often followed:\n1.Create a configuration section.\n2.Create a simple data class that holds all the required settings.\n3.Create a parser class that takes a configuration sections and creates a settings data object.\n4.Create a start-up module that uses the parser to create an instance of the settings object in the service locator.\n5.Obtain access to the settings objects, where required, through the service locator.\n\n\n3.3.2   START-UP MODULES\n\n\nA start-up module for a web application is a class that implements the following interface:\n\n\nnamespace Citrix.DeliveryServices.Mvc\n{\n    /// \nsummary\n\n    /// Interface implemented by modules for executing code during the\n    /// application startup.\n    /// \n/summary\n\n    public interface IStartupModule\n    {\n        /// \nsummary\n\n        /// The Initialize method of each registered component is called\n        /// at application startup (MvcCoreWebApplication).\n        /// Throwing an exception stop the application startup.\n        /// \n/summary\n \n        void Initialize();\n\n        /// \nsummary\n\n        /// Registers components (put all registration here unless a component                  \n        /// requires registering before/after other components).\n        /// \n/summary\n\n        void RegisterComponents();\n\n        /// \nsummary\n\n        /// Registers components (pre call to allow for components that must\n        /// be registered first).\n        /// \n/summary\n\n        void PreRegisterComponents();\n\n        /// \nsummary\n\n        /// Registers components (pre call to allow for components that must\n        /// be registered last, don't use unless required).\n        /// \n/summary\n\n        void PostRegisterComponents();\n    }\n}\n\n\n\n\nThis interface is defined in the assembly: AuthSDK.zip/Assemblies/StoreFront/ Citrix.DeliveryServices.Mvc.dll.\nStart-up modules are registered with the service locator through the configuration in the configuration file. The following illustrates registering the forms protocol start-up module:\n\n\nconfiguration\n\n  \ncontainer\n\n    \ncomponents\n\n      \ncomponent id=\nformsProtocolStartupModule\n\n                 type=\nCitrix.DeliveryServices.Authentication.\n                       FormsProtocol.Startup.FormsProtocolStartupModule,\n                       Citrix.DeliveryServices.Authentication.FormsProtocol\n\n                 service=\nCitrix.DeliveryServices.Mvc.IStartupModule,\n                          Citrix.DeliveryServices.Mvc\n /\n\n    \n/components\n\n  \n/container\n\n  \ncitrix.deliveryservices\n\n  \n/citrix.deliveryservices\n\n\n/configuration\n\n\n\n\nDuring the start-up of the web application, all the start-up modules are discovered. The Initialize() is called first on all the modules, followed by: PreRegisterComponents(), then RegisterComponents(), and finally PostRegisterComponents().\nDuring an appropriate phase, settings and other objects can be added to the IoC container. See the samples for examples of how start-up modules are created and used.\n\n\n3.4  PowerShell Scripting\n\n\nThe StoreFront Administration Console internally uses PowerShell to perform its tasks, and administrators can use the PowerShell commands directly from a PowerShell command window or in scripts. The PowerShell support is divided into three parts: utility scripts, PowerShell modules, and the StoreFront configuration provider.\n\n\n3.4.1   UTILITY SCRIPTS\n\n\nThe StoreFront utility scripts can be found at:\n\n\n%PROGRAMFILES%\\Citrix\\Receiver StoreFront\\Scripts\n\n\nThe scripts include:\n- ImportModules.ps1: This performs the following tasks, to facilitate calling the StoreFront PowerShell API\n    - Adds all registered PowerShell snap-ins, with names matching the pattern: Citrix.DeliveryServices.\n, except for the StoreFront Configuration Provider\n    - Adds all PowerShell modules (\n.psm1) found in the directory specified by the InstallDir value of the registry key: HKLM:\\SOFTWARE\\Citrix\\DeliveryServicesManagement\n- ClearUp_1.ps1: This removes all the StoreFront Feature instances, and can be used to cleanup after a failed uninstall of StoreFront\n- ClearUp_2.ps1: This removes all the StoreFront Feature classes, and must be called after ClearUp_1. After successfully running ClearUp_1 and ClearUp_2, StoreFront can be uninstalled using the Add/Remove Programs.\n\n\n3.4.2   POWERSHELL MODULES\n\n\nThe StoreFront PowerShell modules can be found at:\n\n\n%PROGRAMFILES%\\Citrix\\Receiver StoreFront\\Management\\Cmdlets\n\n\nThe commands relating to authentication are in the AuthenticationModule.psm1 module, and include the following:\n\n\n\n\nGet-DSAuthenticationProtocolsAvailable: Get the current list of available authentication protocols.\n\n\nGet-DSAuthenticationProtocolsDeployed: Get the list of protocols deployed for the Authentication service, specified by the IIS site identifier and virtual path of the associated web application.\n\n\nSet-DSAuthenticationProtocolsDeployed: Update the protocols deployed for the Authentication service, specified by the IIS site identifier and virtual path of the associated web application. The required protocols are specified in a list. Protocols not currently deployed are added, and protocols that are currently deployed but not included in the list are removed.\n\n\nAdd-DSAuthenticationProtocolsDeployed: Add the specified list of protocols to the Authentication service, specified by the IIS site identifier and virtual path of the associated web application. \n\n\nRemove-DSAuthenticationProtocolsDeployed: Remove the specified list of protocols from the Authentication service, specified by the IIS site identifier and virtual path of the associated web application.\n\n\n\n\nFull help for the commands can be obtained using the standard Get-Help command as described here: http://technet.microsoft.com/en-us/library/ee176848.aspx.\n\n\n3.4.3   STOREFRONT CONFIGURATION PROVIDER\n\n\nThe actual getting and setting of configuration properties is achieved using the StoreFront Configuration Provider. The provider exposes parts of configuration files as hierarchical namespaces, in the same way that file systems are hierarchical namespaces, comprised of directories that contain files and other directories. This is available for all web.config and service.config files.\nIn general examples of how to modify the configuration settings can be found in the StoreFront PowerShell modules described in Section 3.4.2 Alternatively a namespace can be opened and browsed, as described below, to find appropriate settings.\n\n\nThe five steps in using the StoreFront Configuration Provider are:\n\n\n1 Open a web application configuration file\n\n\nThe following illustrates how to open a drive for the authentication service in the default tenant:\n\n\n# Load the StoreFront snap-ins and modules\n\n \n$Env:PROGRAMFILES\\Citrix\\Receiver StoreFront\\Scripts\\ImportModules.ps1\n\n# Get the authentication service web app for the default tenant\n$authWebApp = Get-DSAuthenticationServiceWebApp\n# Get the configuration for the web app\n$appPath = GetAppPathWeb -SiteId $authWebApp.SiteId `\n                         \u2013VirtualPath $authWebApp.VirtualPath -Name \nDSAuth\n\n$appConfig = Get-Item $appPath\ncd $appPath\n\n\n\n\n2 Open a Windows service configuration file\n\n\nConfiguring Windows services is unlikely to be necessary. However, if required, then the site name is needed to identify the service to be configured. The following site names are valid for the specified Windows service name:\n- Citrix Credential Wallet: CredentialWallet\n- Citrix Subscriptions Store: SubscriptionsStoreService\n- Citrix Default Domain Services: DefaultDomainService\n- Citrix Peer Resolution Service: PNRS\n- Citrix StoreFront Protocol Transition: ProtocolTransitionService\n\n\nThe following illustrates how to open a drive for the Credential Wallet.\n\n\n# Load the StoreFront snap-ins and modules\n\n \n$Env:PROGRAMFILES\\Citrix\\Receiver StoreFront\\Scripts\\ImportModules.ps1\n\n$driveName = \nCW\n\n$siteName = \nCredentialWallet\n\n$cwDrive = GetAppPath -AppPath $siteName -Name $driveName\n$cwAppConfig = Get-Item $cwDrive\ncd $cwDrive\n\n\n\n\n3 Access data\n\n\nThe majority of the settings are in the /DeliveryServices namespace, which can be navigated and explored using the standard dir, or ls alias. For example, the following enumerates all the namespaces in a default authentication service:\n\n\nPS DSAuth:\\DeliveryServices\n ls | select { $_.PSPath }\n $_.PSPath\n-----------\nDeliveryServices::DSAuth:\\DeliveryServices\\explicitAuthentication\nDeliveryServices::DSAuth:\\DeliveryServices\\citrixFederationAuthentication\nDeliveryServices::DSAuth:\\DeliveryServices\\formsProtocol\nDeliveryServices::DSAuth:\\DeliveryServices\\authentication\nDeliveryServices::DSAuth:\\DeliveryServices\\routing\nDeliveryServices::DSAuth:\\DeliveryServices\\delegatedKerberosAuthentication\nDeliveryServices::DSAuth:\\DeliveryServices\\defaultRoutes\nDeliveryServices::DSAuth:\\DeliveryServices\\explicitBL\nDeliveryServices::DSAuth:\\DeliveryServices\\delegatedExplicitAuthentication\nDeliveryServices::DSAuth:\\DeliveryServices\\commonExplicitEndpoints\nDeliveryServices::DSAuth:\\DeliveryServices\\certificateManager\nDeliveryServices::DSAuth:\\DeliveryServices\\authenticationService\nDeliveryServices::DSAuth:\\DeliveryServices\\cryptography\nDeliveryServices::DSAuth:\\DeliveryServices\\tokenManager\nDeliveryServices::DSAuth:\\DeliveryServices\\windowsEventLogger\nDeliveryServices::DSAuth:\\DeliveryServices\\logger\nDeliveryServices::DSAuth:\\DeliveryServices\\credentialWalletClient\nDeliveryServices::DSAuth:\\DeliveryServices\\delegatedDirectoryClaimFactory\nDeliveryServices::DSAuth:\\DeliveryServices\\localisation\n\n\n\n\nThe standard Get-Item and Get-ItemProperty commands can be used to access the properties. For example, the following illustrates displaying the explicit business logic settings:\n\n\nPS DSAuth:\\DeliveryServices\n Get-ItemProperty DSAuth:\\DeliveryServices\\explicitBL\nPSPath                      : DeliveryServices::DSAuth:\\DeliveryServices\\explicitBL\nPSParentPath                : DeliveryServices::DSAuth:\\DeliveryServices\nPSChildName                 : explicitBL\nPSDrive                     : DSAuth\nPSProvider                  : DeliveryServices\nAuthenticatorName           : defaultDelegatedAuthenticator\nRequireAccountSIDs          : True\nHideDomainField             : True\nAllowUserPasswordChange     : Never\nShowPasswordExpiryWarning   : Windows\nPasswordExpiryWarningPeriod : 10\nAllowZeroLengthPassword     : False\n\n\n\n\nThe following illustrates how to set a variable to determine whether or not the domain field is displayed in the explicit logon form:\n\n\nPS DSAuth:\\DeliveryServices\n $showDomainField = -not` \n                          (Get-Item DSAuth:\\DeliveryServices\\explicitBL\\HideDomainField)\nPS DSAuth:\\DeliveryServices\n $showDomainField\nFalse\n\n\n\n\n4 Set data\n\n\nThe configuration settings can be modified using the standard Set-Item and Set-ItemProperty commands. However, StoreFront also has a command to set multiple properties simultaneously. For example, the following sets the password expiry warning notice to be five days irrespective of any Windows policy:\n\n\nSetItemProperties `\n   -Path ${appPath}DeliveryServices\\explicitBL `\n   -Values @{ \nShowPasswordExpiryWarning\n = \nCustom\n; `\n              \nPasswordExpiryWarningPeriod\n = 5 }\n\n\n\n\n5 Save and close a configuration file\n\n\nThe setting of properties above does not commit the changes to the configuration file. The following demonstrates how to save the modified configuration, and to close the associated namespace.\n\n\n# Save the modified configuration\n$appConfig.Save()\n# Close the associated namespace\nRemoveDeliveryServicesDrive -Name \nDSAuth\n\n\n\n\n\n\nNote\n\n\n\n\nIt is important to close the associated namespace when managing the associated configuration is complete.\n\n\nFor web applications, saving the configuration will result in the configuration being automatically reloaded. However, for Windows services, the associated service must be manually restarted, using the Restart-DSService command.\n\n\n\n\n\n\n3.5  Authentication Management SDK\n\n\nThe Authentication SDK also contains mechanisms for extending the StoreFront Administration Console. The programming elements associated with the Microsoft Management Console can be found here: http://msdn.microsoft.com/en-us/library/ms692747(v=vs.85).aspx.\nThe StoreFront Administration console is composed of extensible scope nodes, one of which represents the Authentication Service. The authentication scope node has a number of extension points that are described below. In order for the StoreFront Administration Console to find the extension assemblies, the installation process should update the StoreFront registry as described in Section 3.1.\n\n\n3.5.1   DISPLAY STATUS MESSAGES\n\n\nThe Authentication scope node has an API that is used to obtain status messages from each of the authentication protocols, and each authentication method must contain an implementation of the following interface.\n\n\nnamespace Citrix.DeliveryServices.Admin.Authentication.Extensions.Interfaces\n{\n    /// \nsummary\n\n    /// The authentication extension interface\n    /// \n/summary\n\n    public interface IAuthenticationExtension\n    {\n        /// \nsummary\n\n        /// Get the status messages associated with this authentication method,\n        /// to be displayed in the StoreFront administration console.\n        /// \n/summary\n\n        /// \nreturns\nThe list of status messages.\n/returns\n\n        IList\nStatusMessage\n GetStatusMessages();\n    }\n}\n\n\n\n\nThis interface is defined in the assembly: AuthSDK.zip/Assemblies/StoreFront/ Citrix.DeliveryServices.Admin.Authentication.Extensions.Interfaces.dll.\nAny installation process should place the assembly implementing this interface in the following directory:\n%PROGRAMFILES%\\Citrix\\Receiver StoreFront\\Management\n\n\n3.5.2   INCLUDE CUSTOMIZATION IN ADD/REMOVE METHODS\n\n\nIn order for the Authentication node \u201cAdd/Remove methods\u201d action to display the custom authentication method, several steps are required. The Feature package definition file must contain the authProtocol properties as described in Section 4.2. In particular, the authProtocolLocalizer must define an object that implements the following interface, which allows the StoreFront Administration Console to display a localized name for the authentication method:\n\n\nnamespace Citrix.DeliveryServices.Admin.Authentication.Extensions.Interfaces\n{\n    /// \nsummary\n\n    /// This interface defines an object to allow external objects to\n    /// localise authentication strings\n    /// \n/summary\n\n    public interface IAuthenticationLocalizer\n    {\n        /// \nsummary\n\n        /// Get the string with the specified key from the authentication localizer\n        /// \n/summary\n\n        /// \nparam name=\nkey\nThe key to the string\n/param\n\n        /// \nparam name=\ncultureInfo\nThe current UI culture\n/param\n\n        /// \nreturns\nThe specified string, or the key\n/returns\n\n        string GetResource(string key, CultureInfo cultureInfo);\n    }\n}\n\n\n\n\nThis interface is defined in the assembly: AuthSDK.zip/Assemblies/StoreFront/ Citrix.DeliveryServices.Admin.Authentication.Extensions.Interfaces.dll.\n\n\n3.5.3   ADD ACTIONS\n\n\nIf an authentication protocol requires to add Actions or Overview items to the StoreFront Administration Console user interface, then a class implementing the following interface is required.\n\n\nnamespace Citrix.DeliveryServices.Admin.SnapIn.Interfaces.Plugin\n{\n    public interface IPluggableScopeNodeViewExtension\n    {\n        /// \nsummary\n\n        /// In dervied classes, initializes the object state\n        /// \n/summary\n\n        void InitializeViewExtension(IPluggableScopeNodeView scopeNodeView);\n\n        /// \nsummary\n\n        /// In derived classes, gets a list of the actions pertinent to\n        /// the selected view Context\n        /// \n/summary\n\n        IList\nActionsPaneItemWrapper\n GetViewExtensionActions();\n\n        /// \nsummary\n\n        /// In derived classes, gets a list of the items to be\n        /// displayed under overview list\n        /// \n/summary\n\n        IList\nKeyValueListItem\n GetExtensionOverviewItems();\n    }\n}\n\n\n\n\nThis interface is defined in the assembly: AuthSDK.zip/Assemblies/StoreFront/ Citrix.DeliveryServices.Admin.SnapIn.Interfaces.dll.\nActions are usually implemented by a wrapper invoking a PowerShell command that is part of a PowerShell module supplied as part of the customization. Any installation process should place the PowerShell module in the following directory, where it will be automatically loaded during the StoreFront Administration Console initialization procedure:\n%PROGRAMFILES%\\Citrix\\Receiver StoreFront\\Management\\Cmdlets\n\n\n\n\nNote\n\n\n\n\nAny issues with the PowerShell module can prevent the StoreFront Administration Console from loading\n\n\nThe PowerShell module must be digitally signed by a trusted publisher\n\n\n\n\n\n\nWhen an authentication method has been updated as a result of an Action, then it must signal this by issuing a  Citrix.DeliveryServices.Admin.Authentication.Extensions.Interfaces.Events. ExtensionChangedEvent event so that the Authentication scope node can be refreshed to reflect any changes.\n\n\n3.6  Diagnostics\n\n\n3.6.1   TRACING\n\n\nStoreFront uses the standard .NET tracing mechanism; for more information see: http://msdn.microsoft.com/en-us/library/system.diagnostics.trace(v=vs.110).aspx.\nStoreFront uses standard .NET trace sources; for more information see: http://msdn.microsoft.com/en-us/library/ms228984(v=vs.110).aspx.\nThe trace sources are configured in the associated configuration file, for example:\n\n\n  \nsystem.diagnostics\n\n\n    \n!\u2014Trace sources --\n\n    \nsources\n\n      \nsource name=\nCitrix.DeliveryServices.FormsProtocol\n\n        \nlisteners\n\n          \nadd name=\ncitrixTraceListener\n /\n\n        \n/listeners\n\n      \n/source\n\n      \nsource name=\nCitrix.DeliveryServices.FormsEngine\n\n        \nlisteners\n\n          \nadd name=\ncitrixTraceListener\n /\n\n        \n/listeners\n\n      \n/source\n\n\n    \n!\u2014Trace switches --\n\n    \nswitches\n\n      \nadd name=\nCitrix.DeliveryServices.FormsProtocol\n value=\nError\n /\n\n      \nadd name=\nCitrix.DeliveryServices.FormsEngine\n value=\nError\n /\n\n    \n/switches\n\n\n    \n!\u2014Listeners --\n\n    \nsharedListeners\n\n      \nadd name=\ncitrixTraceListener\n type=\nCitrix.DeliveryServices.Diagnostics.CircularTraceListener,Citrix.DeliveryServices.Diagnostics, Version=2.6.0.0, Culture=neutral, PublicKeyToken=e8b77d454fa2a856\n \n           initializeData=\nC:\\Program Files\\Citrix\\Receiver StoreFront\\Admin\\trace\\Authentication.svclog\n\n           maxFileSizeKB=\n5000\n /\n\n    \n/sharedListeners\n\n    \ntrace autoflush=\nfalse\n /\n\n  \n/system.diagnostics\n \n\n\n\n\nTo configure tracing, use the Set-DSTraceLevel PowerShell command. For example, to enable verbose tracing for all components use the following: \n\n\n# Load the StoreFront snap-ins and modules\n\n \n$Env:PROGRAMFILES\\Citrix\\Receiver StoreFront\\Scripts\\ImportModules.ps1\n\n# Set the trace level to be verbose for all components\nSet-DSTraceLevel -All -TraceLevel Verbose\nHelp for the Set-DSTraceLevel command can be obtained by using the standard Get-Help command,  for example: \nGet-Help Set-DSTraceLevel\n\n\n\n\n\n\nNote\n\n\n\n\nTracing information is written to a circular trace log at:\n\n\n%PROGRAMFILES%\\Citrix\\Receiver StoreFront\\Admin\\trace\n\n\n\n\n\n\nStoreFront automatically captures Error trace messages. Due to the large amount of data that can potentially be generated, tracing may significantly impact the performance of StoreFront, so it is recommended that the Info or Verbose levels are not used unless specifically required for troubleshooting. \n\n\n\n\n\n\nThe following illustrates how to programmatically access an event source named MyTraceSource:\n\n\npublic static class MyTraceSourceHelper \n{\n    static MyTraceSourceHelper()\n    {\n        Tracer = TracerManager.GetTracer(\nMyTraceSource\n);\n    }\n\n    public static Tracer Tracer { get; private set; }\n}\nThis is used as follows:\nMyTraceSourceHelper.Tracer.WriteError(\nAn error occurred.\n);\nA trace source must be defined in the containing application configuration as illustrated below:\n\nconfiguration\n  \n  \nsystem.diagnostics\n\n    \nsources\n\n      \nsource name=\nMyTraceSource\n\n        \nlisteners\n\n          \nadd name=\ncitrixTraceListener\n /\n\n        \n/listeners\n\n      \n/source\n\n    \n/sources\n\n    \nswitches\n\n      \nadd name=\nMyTraceSource\n value=\nError\n /\n\n    \n/switches\n\n    \nsharedListeners\n\n      \nadd name=\ncitrixTraceListener\n    \n           type=\nCitrix.DeliveryServices.Diagnostics.CircularTraceListener,\n                 Citrix.DeliveryServices.Diagnostics, Version=2.6.0.0, Culture=neutral,\n                 PublicKeyToken=e8b77d454fa2a856\n\ninitializeData=\nC:\\Program Files\\Citrix\\Receiver StoreFront\\Admin\\trace\\Store.svclog\n              \n           maxFileSizeKB=\n5000\n /\n\n    \n/sharedListeners\n\n    \ntrace autoflush=\nfalse\n /\n\n  \n/system.diagnostics\n\n\n/configuration\n\n\n\n\nWhere appropriate, it is possible to use the built-in StoreFront trace sources. The following illustrates how to write to the Forms Protocol trace source:\n\n\nusing Citrix.DeliveryServices.Authentication.FormsProtocol.Diagnostics;\nTraceHelper.Tracer.WriteError(\nAn error occurred.\n);\n\n\n\n\n3.6.2   WRITING TO THE EVENT LOG\n\n\nStoreFront contains a static helper class for writing to the event log at:\nEvent viewer \n Applications and Services Logs \n Citrix Delivery Services\nThe interface for Citrix.DeliveryServices.Logging.Common.Logger is detailed at:\nAuthSDK.zip/Assemblies/StoreFront/Citrix.DeliveryServices.Logging.Interfaces.XML\n\n\nAn event log entry requires:\n\n\n\n\nMessage type, which is one of: Success, Information, Warning or Error\n\n\nA source that defines the component where the message originated\n\n\nAn event identifier that uniquely identifies the event\n\n\nA task category\n\n\n\n\nFor example:\n\n\n            Logger.LogMessage(\n                1,\n                30000,\n                MessageType.ERROR,\n                null,\n                Resources.AuthenticateUnexpectedErrorText\n                );\n\n\n\n\nFor StoreFront, custom implementations should use a Task Category value between 30000 and 31000.\n\n\n4  StoreFront Services Feature Packaging and Deployment\n\n\nThe StoreFront Authentication Service and Administration Console have extension points for adding new authentication protocols to the solution without modifying either container. There is a pattern for creating a new authentication protocol that results in a StoreFront Feature Package, described here, that can be deployed using existing StoreFront deployment mechanisms. All the existing authentication methods utilize these extension points, and the samples document demonstrate how third parties can take advantage of these mechanisms.\n\n\n4.1  StoreFront Package\n\n\nA StoreFront Package is a compressed archive of the files required for the feature, along with meta-data to describe how the files should be added to the system.\n\n\nThe Packages should be placed in the directory: FeaturePackages at the path specified by the InstallDir value of the key:\n\n\nHKLM\\SOFTWARE\\Citrix\\DeliveryServicesManagement\n\n\nWhen a package is deployed, the files are extracted to a directory with the same name as the package in the directory: Features at the path specified by the InstallDir value of the key:\n\n\nHKLM\\SOFTWARE\\Citrix\\DeliveryServicesManagement\n\n\nWhen the package has been expanded by the StoreFront Framework, it should contain the following directories:\n- _rels and package are used by the packaging mechanism and will not be described here\n- admin: This directory contains the files required for administration of the feature, including: PowerShell assemblies, the files used to merge the feature into an existing web application or service, and the files used to transform the configuration during upgrade.\n- GAC: This directory contains the assemblies that will have been added to the .Net Global Assembly Cache.\n- template: This directory contains the files that will be used to create an instance of the feature. For a web application feature, it will contain the files that will be added to the App_Data and bin directories. For a Windows Service it will contain all the files required for that service.\nAn msbuild task is provided to create a package from a package definition file and its usage is described in Section 5.4.9.\n\n\n4.2  Package Definition Language\n\n\nA StoreFront Feature Package is defined by an XML document that contains the following sections relevant to this discussion:\n- PackageFileName defines the name of the package file to be created\n- MetadataProperties contain information about the package that can be used to deploy the package\n- Files describe the files that are to be deployed to the system\n\n\nMetadata Properties\n\n\n\n\n allows a description name to be given to the feature.\n\n\n is the feature identifier and must be changed with a new Guid for any new Authentication method. Any Guid specified here also has to match the Feature Identifier specified in the: Feature Installer (if required), the custom actions, and Console extension.\n\n\n specifies the features parent, and should be unchanged from the samples, that is, the parent should be AuthenticationCore.\n\n\n list the other features that the feature depends on. For custom forms methods this should be unchanged from the forms samples, that is, the dependencies should include FormsProtocol and ExplicitCommon if Active Directory credential validation is required.\n\n\n describe any local groups used by this feature. In general, this will be empty for custom Forms.\n\n\n, \n \n \n are deprecated and should be empty.\n\n\n describes how many times a feature can be added to its parent, for custom forms and new authentication methods this should be 1.\n\n\n describes the class type to be used to create a feature instance.\n\n\n is the path to the assembly containing the Feature instance factory. If the factory is in the Global Assembly Cache, then this can be empty.\n\n\n and \n are deprecated, and should not be used.\n\n\n are name-value pairs of properties. For Authentication methods, there are certain mandatory properties, that must have the export attribute set to be true:\n\n\nauthProtocol must be \u201ctrue\u201d.\n\n\nauthProtocolDisplayNameKey defines the resource key for the authentication method display name in the StoreFront Administration Console. By convention this value is usually \u201cDisplayName\u201d.\n\n\nauthProtocolLocalizer defines the object that implements the interface: Citrix.DeliveryServices.Admin.Authentication.Extensions.Interfaces.IAuthenticationLocalizer: see Section 3.5.\n\n\nauthProtocolDisplayIndex defines the display order of authentication methods in the Add/Remove Authentication Methods in the StoreFront Administration Console. A good value for this is \u201c5000\u201d.\n\n\nauthProtocolDeployDefault defines whether the authentication method should be deployed by default when the authentication service is created, and should be \u201cfalse\u201d.\n\n\nprotocolChoice defines the protocol name in the choices and must be \u201cCustomForms\u201d for forms customizations.\n\n\n\n\n\n\n\n\nFiles\n\n\nThe files deployed to the system are one of two categories: runtime files or administration files.\n- Runtime files are placed in a template directory when the package is expanded (installed), and then copied to the Authentication Service when the feature is deployed.\n- Administration files are used in the administration of the feature and include the following categories:\n    - Files that are to be placed in the Global Assembly Cache, such as Configuration Sections\n    - PowerShell snap-ins\n    - Performance counters\n\n\nThe \n element contains other elements:\n- \n defines where the feature packager should get the file from.\n- \n is where the file should be placed when deployed. The location is relative to the expanded feature directory.\n- \n relate to IIS Authentication options and should be empty for custom forms.\n- \n specifies whether the file should be packaged for Debug and Release versions.\n\n\nThe \n element also has attributes:\n- addToGac. If \u201ctrue\u201d the file is added to the GAC.\n- installUtil. If \u201ctrue\u201d the InstallUtil program (http://msdn.microsoft.com/en-us/library/50614e95(v=vs.90).aspx ) is run on the specified file. This is used for features such as performance counters and PowerShell snap-ins, where the assembly has to be registered with the system.\n- Register. If true then the regsvr32 program (http://technet.microsoft.com/en-us/library/bb490985.aspx ) is run on the specified file. As an example, this can be used to register COM objects with the system.\n- includeInManifest. If \u201ctrue\u201d, then include in the package manifest. This is used for files that will be part of the template.\n- replicate. If \u201ctrue\u201d this file will be copied to all members of a StoreFront cluster as part of a propagation action.\n\n\n5  Code Samples\n\n\n5.1  Introduction\n\n\nThe Authentication SDK contains two form customization samples: Test Forms and Magic Word Authentication. In addition, the Certificate Identity Declaration sample demonstrates how to add a completely new authentication method, although this also requires adding a customization to the Citrix Receivers. The SDK also contains pre-built installers for all the samples.\nBefore attempting to deploy the pre-built sample installers, you must add the following certificate to the Third-Party Root Certification Authorities store of the Local Computer account where StoreFront is installed: AuthSDK.zip/Certificates/YourCompany.cer\nThis is mandatory for each server in a StoreFront Server Group. This is not mandatory for the development machine.\nThe installers deploy StoreFront Feature packages and add-ins to the StoreFront Administration Console. To actually deploy and enable a sample, use the Add/Remove Methods action from the Authentication node of the Administration Console.\nBefore attempting to uninstall a sample, you must remove the associated authentication method using the Add/Remove Methods action. The sample can then be removed using the standard Add/Remove Programs control panel applet.\n\n\n5.2  Getting Started\n\n\nIn order to open and build the samples, you must first provision a development environment. This requires the following components to be installed on a suitable Windows machine, as described in the prerequisites (see Section 1.2.1).\nAll the other tools and components required to build the samples are included in the SDK.\nA temporary code-signing certificate for test purposes has been provided in the following location:\nAuthSDK.zip/Certificates/YourCompany.pfx\n\n\n\n\nNote\n\n\nThe private key is not password protected.\n\n\n\n\nThe following certificate is the accompanying public certificate that can be added to the Trusted Root certificates for testing:\nAuthSDK.zip/Certificates/YourCompany.cer\nBefore releasing your integration, you should purchase a code-signing certificate, backed by a public certificate authority.\nOnce the above steps have been completed, you can open the sample Visual Studio solution file (*.sln) and successfully build the samples.\n\n\n5.3  Code Security\n\n\nBest practice is to use a code-signing certificate (that is, a certificate marked with the Extended Key Usage object id: 1.3.6.1.5.5.7.3.3) to digitally sign executing code to provide assurance as to the source of the code. For more information see [7]. The StoreFront Administration Console expects all PowerShell Scripts and extension assemblies to have Authenticode signatures.\n\n\nWhilst best practice is to use a code-signing certificate issued by a public certificate authority, the samples use a self-signed certificate for this purpose, which leads to the following:\n\n\n\n\nIf you are using the pre-built sample installers, then it is required to add the certificate at AuthSDK.zip/Certificates/YourCompany.cer to the Third-Party Root Certification Authorities store of the Computer, before installing the sample msi.\n\n\nNote that the samples have not been time stamped, see [8].\n\n\nWhen creating a real authentication method, the post build tasks should include the signing task as demonstrated in the samples, but using a code-signing certificate for your company, and the files should be time stamped.\n\n\n\n\n5.4  Visual Studio Solution Layout\n\n\nThe StoreFront assemblies referenced by the samples, along with other third-party assemblies, are in the Assemblies directory. The Assemblies directory also contains the StoreFront XML documentation files. The tools used to build and unit test the solutions are in the Tools directory. The documentation, including the third party notices, is in the Documentation directory.\nIn order to add assemblies to the Global Assembly Cache, the assemblies must be strongly named. The Authentication SDK provides a strong-name key pair, but it is recommended that developers create a new strong-name key pair for their customization.\nThe samples follow the same basic layout and can be composed of the following projects:\n\n\n5.4.1   CONFIGURATION\n\n\nIf the authentication customization requires configuration, then a C# class library project should be added.\n\n\n\n\nNote\n\n\n\n\nThe Microsoft Management Console for Windows Server 2008 R2 only supports the .NET 2.0 runtime, see http://msdn.microsoft.com/en-us/library/gg983006(v=vs.85).aspx. As a result, all assemblies that are loaded by the MMC must target the .NET 3.5 run time in Visual Studio. This includes configuration assemblies as they are loaded by reflection from the StoreFront Configuration Provider in the PowerShell modules. Assemblies that target .NET 3.5 SP1 can be loaded into the .NET 4 runtime, so these assemblies can still be loaded in the StoreFront Management Console running on Windows Server 2012 and 2012 R2 operating systems.\n\n\nIn order for the StoreFront Configuration Provider to be able to load the configuration sections, the associated assembly must be stored in the Global Assembly Cache. Hence the configuration assembly must be strongly named.\n\n\n\n\n\n\nIn general, this project shouldcontain the following:\n- Configuration Section and Elements: These define standard .NET configuration elements.\n- Settings: This is a data object that contains the configuration.\n- Configuration Parser: This object uses the configuration section to create the Settings object.\n\n\n5.4.2   CONSOLE.EXTENSION\n\n\nThis C# class library project should always be present, because it contains the Authentication Management Extension for this customization that is used by the StoreFront Administration Console for adding and removing the customization.\nThis will contain:\n= A Localizer that provides the localized strings for the StoreFront Administration Console.\n- The implementation of IAuthenticationExtension to provide any required status messages\n\n\nIf the customization has a configuration that is managed by the StoreFront Administration Console, then this project will also contain the view extension that may contain:\n- Dialogs\n- Data Models and Business Logic\n= Powershell commands\n\n\n5.4.3   FEATURE\n\n\nThis C# class library project contains the code to be added to the Authentication web application to perform the customized authentication.\nIf the customization is a forms customization it may contain the following:\n- Templates: The forms templates used by the customization\n- Forms: The associated forms objects\n- Conversation: Controls the flow of forms that make up the authentication conversation\n- Diagnostics: Any tracing or event log messages\n- StartupModule: This is a start-up module that is used to populate the Service locator with objects required by the system. This may include a settings object defined in the configuration project.\n\n\nIf the customization is a new authentication protocol, then it may contain the following:\n- Controllers: ASP.NET MVC controller that manages the authentication protocol\n- Diagnostics: Any tracing or event log messages\n\n\n5.4.4   FEATUREINSTALLER\n\n\nThis is an optional C# class library project that is required if:\n- The customization requires specialized behavior to be run during deployment of the feature\n- The customization requires specialized PowerShell commands\n\n\nAdditional Deployment Steps\n\n\nThe StoreFront features are deployed as a series of steps which are orchestrated by a deployer. A base class is provided, Citrix.DeliveryServices.Authentication.Framework.Admin.ProtocolFeatureInstanceBase, which performs the steps required for the deployment of a standard authentication feature.\nIf additional steps are required, then a sub-class can be created to add additional steps. The full list of built-in deployment steps can be found at:\nAuthSDK.zip/Assemblies/StoreFront/Citrix.DeliveryServices.Framework.Deployment.Steps.XML\n\n\n\n\nNote\n\n\nThe feature instance class used for deployment is controlled by the InstanceFactoryType element in the feature package definition file; see Section 4.\n\n\n\n\nPowerShell Commands\n\n\nIt is not expected that many PowerShell commands will be required by customizations. However, the samples illustrate how commands can be written.\nA base class is provided from which all PowerShell commands should be derived. This provides a tracing and auditing facility by creating output in the following directory every time that the command is run:\n%PROGRAMFILES%\\Citrix\\Receiver StoreFront\\Admin\\logs\nThe commands are contained within a PowerShell snap-in. The Microsoft documentation for creating a snap-in can be found here:\nhttp://msdn.microsoft.com/en-us/library/ms714450(v=vs.85).aspx.\nThe PowerShell snap-in is registered with the system when the associated Feature class is installed. This is controlled by setting the installUtil attribute to be true on the associated assembly in the Feature package definition file, see Section 4.2, for more details.\n\n\n5.4.5   FEATURETEMPLATE\n\n\nThis directory may contain the following:\n- web.merge.config or web.merge.xslt: This file describes the configuration entries that are merged into the Authentication Service web application\u2019s web.config file during deployment of the customization.\n- web.unmerge.config or web.unmerge.xslt: This file describes the configuration entries that are removed from the Authentication Service web application\u2019s web.config file during the removal of the customization.\n- App_Data/resources/*.resx: These are the end-user facing strings that are used by the customization.\n\n\n5.4.6   INSTALLER\n\n\nThis Wix installer project is used to deploy the customization.\n\n\nThe installer has the following responsibilities during deployment:\n- Run the VerifyProtocolNotInstalled and WarnIfAdminConsoleOpen custom actions described  in Section 5.4.7\n- Copy the Feature package to the StoreFront FeaturePackages directory\n- Deploy the Administration Console Extension assemblies to the management InstallDir and to configure the registry, as described in Section 3.1, so that they are loaded by the console when it starts\n\n\nThe installer has the following responsibilities during uninstall:\n- Run the RemoveInstalledClass custom action, described  in Section 5.4.7\n- Remove the Feature package and registry entries added during install\n\n\nThis project also contains the Feature Package definition, as described in Section 4.1, and runs the FeaturePackager msbuild task in the post-build step to build the Feature Package.\n\n\n5.4.7   INSTALLER.CUSTOMACTIONS\n\n\nThis C# class library project contains the custom actions required by the installer in section 5.4.6.\n\n\n\n\nNote\n\n\nThe custom actions must be targeted at the x64 Platform and not AnyCPU. This is to force the Windows Installer to run the actions as x64, which is required to gain access to the correct registry entries.\n\n\n\n\nIn general there are three custom actions:\n- RemoveInstalledClass: This removes the installed Feature class. If there are any existing instances of the Feature, the action will display an error message that tells  the administrator what to do. The uninstall will then exit without uninstalling the customization.\n- WarnIfAdminConsoleOpen: This checks whether the StoreFront Administration Console is open. If it is open, the action displays a warning message tellinging the administrator to close and re-open the console before deploying the customization.\n- VerifyProtocolNotInstalled: This verifies whether there is another feature that implements the target authentication method. If there is an existing method, the action displays an error message and exits without installing the customization.\n\n\nIn general, the code can be copied from an existing sample, and only the Feature identifier and Authentication Protocol Name  need to be changed.\n\n\n5.4.8   UNITTESTS\n\n\nThis C# class library project contains unit tests for the customizations. This may contain tests for the following:\n- Merge Tests: Verify the merge and unmerge of entries into the Authentication Service web application\u2019s web.config.\n- Route Tests: Verify that the MVC routes have been configured correctly.\n- Service Locator Tests: Verify that required objects have been added to the IoC container.\n- Authentication Tests: Verify the custom authentication.\n\n\n5.4.9   BUILD TASKS\n\n\nPackageFeature\nThis task is used to generate the feature package from the feature package definition file (see Section 4), and is usually part of the Installer project.\n\n\nThe task has the following properties:\n- PackageDefinitionFile: The path of the package definition file to process.\n- Configuration: The configuration to build, one of: Debug or Release.\n\n\nExample:\n\n\nConfiguration Condition=\n '$(Configuration)' == '' \nDebug\n/Configuration\n\n\nPackageFeature PackageDefinitionFile=\nPackage\\Feature.pkg\n Configuration=\n$(Configuration)\n /\n\n\n\n\nMsiLocaliser\n\n\nThis task is used to generate a multilingual installer and is usually part of the installer project.\n\n\nThe task has the following properties:\n- Cultures: A \u2018;\u2019 separated list of language codes.\n- TargetName: The file name of the created multi-lingual installer.\n= TargetFolder: This folder should contain all the folders corresponding to the individual localized installers.\n\n\nExample:\n\n\n \nConfiguration Condition=\n '$(Configuration)' == '' \nDebug\n/Configuration\n\n\nCultures Condition=\n '$(Cultures)' == '' \nen-US;de-DE;es-ES;fr-FR;ja-JP;zh-CN\n/Cultures\n\n\nMsiLocaliser Cultures=\n$(Cultures)\n TargetFolder=\nbin\\x64\\$(Configuration)\n \n                          TargetName=\nInstaller-x64.msi\n /", 
            "title": "Authentication Software Development Kit"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#authentication-software-development-kit", 
            "text": "", 
            "title": "Authentication Software Development Kit"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#1-introduction", 
            "text": "", 
            "title": "1. Introduction"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#11-scope", 
            "text": "This document describes the StoreFront Services v2.6 Authentication Software Development Kit. It describes how to use the SDK to develop new custom forms-based authentication methods, or new authentication protocols. This document also describes how the customizations can be delivered and deployed on existing servers running StoreFront Services v2.6.  The SDK requires a working knowledge of the Microsoft .NET Framework (http://msdn.microsoft.com/en-US/vstudio/aa496123 ) and in particular the C# programming language (http://msdn.microsoft.com/en-us/library/vstudio/z1zx9t92(v=vs.100).aspx ).", 
            "title": "1.1  Scope"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#12-deliverables", 
            "text": "This SDK contains the following deliverables, packaged into a single compressed archive:   Assemblies: The external and StoreFront assemblies referenced by the samples, including any associated xml documentation files  Documentation: This document and its supporting documentation  Installers: Pre-built installers for the samples  Merge: Files used by the sample unittests  Tools: The tools used to build the samples and run the unit tests  Magic Word Sample: A simple authentication form that demonstrates a full implementation  Test Forms: A sample to demonstrate the use of User Interface Elements in a series of custom forms  CertificateIdentityDeclaration: A sample to illustrate a new authentication protocol   The samples contain Visual Studio 2012 solutions, C# source code that builds msi installers that can be used to deploy the sample to a StoreFront 2.6 deployment. The samples also contain unit tests focussed around testing the form implementation, or the authentication protocol.", 
            "title": "1.2  Deliverables"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#121-prerequisites", 
            "text": "The following prerequisites are required, installed in the following order:    Visual Studio (2012 or later)   On Windows Server 2012 and later .NET 3.5 SP1 will need to be installed in order to be able to target .Net 3.5 SP1 as required for some project types.  To run the unit tests, the NUnit Test Adapter for Visual Studio 2012 and 2013 is required. See the following for installation and usage instructions: http://nunit.org/index.php?p=vsTestAdapter r=2.6.2      Wix v3.6.3303.0: http://wix.codeplex.com/releases/view/93929", 
            "title": "1.2.1   PREREQUISITES"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#13-references", 
            "text": "[1] RFC 2617 HTTP Authentication: Basic and Digest Access Authentication: http://tools.ietf.org/html/rfc2617   [2] CitrixAuth Authentication Scheme v2.0  [3] Security Token Services API v2.0  [4] Citrix Receiver Common Authentication Forms Language v2.6  [5] ASP.Net MVC 4: http://www.asp.net/mvc/mvc4   [6] The Service Locator Pattern: http://msdn.microsoft.com/en-us/library/ff648968.aspx   [7] Authenticode: http://msdn.microsoft.com/en-us/library/ms537359(v=vs.85).aspx  [8] Time Stamping Authenticode Signatures: http://msdn.microsoft.com/en-us/library/windows/desktop/bb931395(v=vs.85).aspx   [9] StoreFront Authentication Form Generation v2.6", 
            "title": "1.3  References"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#2-storefront-services-authentication-overview", 
            "text": "", 
            "title": "2  StoreFront Services Authentication Overview"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#21-identity-management-systems", 
            "text": "Traditional systems have centralized identity management systems where each application is responsible for authenticating the user and establishing their identity. This has led to multiple implementations of authentication and authorization systems and applications with differing levels of support for different authentication methods. \nIn federated systems the user authenticates once, to an appropriate authentication service, which gathers information about the user. This information often takes the form of assertions or claims regarding the user. The claims are then marshalled to other applications or services that rely on the authentication service. These \"relying parties\" have been configured to trust the assertions/claims issued by the authentication service, or \"trusted issuer\" and this is commonly enforced by strong cryptographic means such as digital signing and encipherment. The assertions/claims are marshalled as security tokens that are issued by the trusted issuer, held by the application, and presented to other services to gain access to data and services.", 
            "title": "2.1   Identity Management Systems"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#22-the-authentication-service", 
            "text": "The StoreFront Authentication Service is a web application, hosted in IIS, which makes extensive use of the ASP.NET MVC Framework 4.0 [5]. The service is usually hosted at the relative URL: /Citrix/Authentication of the chosen IIS web site. HTTP requests are routed by IIS, ASP.NET and the MVC framework to Controllers for processing.  New authentication methods are added by adding new ASP.NET Routes into the web application and mapping them to new Controllers. For forms based authentication, the forms are rendered using a custom mechanism based on ASP.Net Razor templates [9].\nConfiguration data is stored in the associated web.config file. When the web application starts, a configured set of start-up modules are run, which parse the configuration into settings objects that are stored in a Service Locator [6], along with other long-lived objects.   The StoreFront Administration Console utilizes a PowerShell layer to configure the solution. The PowerShell layer makes extensive use of a custom configuration provider that allows certain portions of the web.config file to be accessed as if it were a mounted drive; see Section 3.4.3. This simplifies accessing the configuration data using standard PowerShell commands.", 
            "title": "2.2  The Authentication Service"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#23-authentication-support-services", 
            "text": "In addition to the Authentication web application, there are additional Windows services that provide functionality requiring higher levels of privilege. The Authentication web application communicates with these WCF services utilizing named pipes for the communication channel. Access to these services is controlled through membership of local Windows groups.  Credential Wallet \nThe Credential Wallet is a WCF service hosted in a Windows service called Citrix Credential Wallet, or its localized variant. The hosted Credential Wallet service is an in-memory hash table that securely stores encrypted passwords.\nThe samples demonstrate how to store passwords in the Credential Wallet by utilizing the existing functionality in one of the specialized claims.  Domain Services \nThe Domain Services host WCF services that provide the functionality to authenticate a user by using explicit credentials  (user name and password), or utilizing Kerberos Service-for-User for both user principal names and certificates.  The default is to create one Domain Services called Citrix Default Domain Services, or the localized variant, which provides authentication and LDAP services for the domain that the server is currently a member of, or an associated trust scope.\nThe samples demonstrate how to delegate credential validation to the most appropriate service described above.", 
            "title": "2.3  Authentication Support Services"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#24-relying-party-authentication-citrixauth", 
            "text": "As described above, a relying party, such as the Store service, can challenge for authentication at any point. This challenge takes the form of an RFC2617 [1] extension. It uses the standard HTTP WWW-Authenticate header for the challenge and the Authorization HTTP header as the response. Further information can be found in the CitrixAuth Scheme document [2].  When a client receives a challenge, it must respond by constructing and sending a Request Security Token (RST) to the location specified in the challenge. The details of how to construct the RST can be found in the CitrixAuth Authentication Scheme document [2]. The client should expect to receive a Request Security Token Response (RSTR) message in response to the RST message. The location to which the RST is sent, will be the Token Issuing Service. The RSTR that is returned will contain the security token that can be used to access the required resource in the response to the challenge, plus additional information to assist the client with caching the token.\nFor more information on the endpoints and expected messages, see the Security Token Services API document [3].", 
            "title": "2.4  Relying Party Authentication: CitrixAuth"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#25-primary-authentication", 
            "text": "The Token Issuing Service is itself a relying party that issues challenges if an appropriate security token is not present. The location associated with the challenge is the protocol choices endpoint that allows a negotiation between the client and the authentication service regarding which authentication method should be used.   The following protocols are supported in this version:\n- User name and password: A user is required to explicitly provide their domain-qualified user name and password   Domain pass-through: Use the desktop session credentials to authenticate  Smart card: Smart card authentication  Http Basic: This is used by third-party client integrations and web portals, where an external user interface has been used to capture a domain-qualified user name and password  Pass-through from Citrix Access Gateway: This allows single sign-on from Citrix NetScaler Gateway  Citrix Federation: This is an internal authentication mechanism to StoreFront   The \u201cUser name and password\u201d authentication method shares a common mechanism with Access Gateway to render a form for the collection of user credentials. Further details can be found in the Common Authentication Forms Language document [4].", 
            "title": "2.5  Primary Authentication"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#26-common-forms", 
            "text": "The samples illustrate developing custom forms-based protocols that are based on the Common Authentication Forms Language. The flow of forms and responses constitutes a conversation that can have state associated with the overall conversation. For maximum interoperability, the protocol is a REST API (XML Forms transmitted over HTTPS) and is described in [4].  In this version of the SDK, a new protocol identifier is defined: CustomForms. The clients are required to recognize this protocol identifier and map it to their existing Common Forms rendering. Clients will give preference to this new protocol over the existing ExplicitForms protocol, should both be available. The expectation is that any organization will only implement, or purchase, a single custom authentication mechanism for their organization, so multiple vendors advertising their customizations in this way should not be an issue.", 
            "title": "2.6  Common Forms"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#27-delegated-forms-authentication", 
            "text": "In order to extend the reach of any customization to include NetScaler Gateway, Citrix has defined a protocol for delegating forms authentication to a customized StoreFront deployment. In this release, the StoreFront Authentication Service provides an endpoint for NetScaler to delegate the rendering and handling of forms authentication to StoreFront.  It is possible to configure the Delegated Forms Server to use customized forms conversations created with this SDK, allowing both internal and external clients to share the customized experience.\nIn this release, the delegated forms functionality is configured from PowerShell only. A description of the high-level commands can be found in the document installed on the StoreFront server at the following location:\n%PROGRAMFILES%\\Citrix\\Receiver StoreFront\\Management\\Cmdlets\\DFAServerFPReadMe.rtf\nIt is expected that the PowerShell required to configure the delegated forms to use the specific customization shall be wrapped in a simple PowerShell command by the customization author and provided as part of the customization.", 
            "title": "2.7  Delegated Forms Authentication"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#3-storefront-management-overview", 
            "text": "The deployment and management of StoreFront is based around PowerShell and a Microsoft Management Console (MMC) snap-in that orchestrates the PowerShell commands. The following sections describe where management data is stored and managed.", 
            "title": "3  StoreFront Management Overview"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#31-registry", 
            "text": "The Windows registry is used to store the following information:  Key : HKLM\\SOFTWARE\\Citrix\\DeliveryServices  Values   AdminConsoleOperationMode: This controls the operational mode of the StoreFront Administration Console  CertificateStoreName: The name of the private machine certificate store used by StoreFront  ClockSkew: The amount of clock skew allowed when comparing validity periods for authentication tokens  ConfigurationLevel: This value is used to compare two servers when replicating data  FrameworkControllerAssemblyPath: The path of an assembly that implements the StoreFront framework controller  FrameworkControllerType: The type of the class that implements the framework controller in the assembly at: FrameworkControllerAssemblyPath  IISAssemblyPath: The path of an assembly that implements the IIS manager  IISManagerType: The type of the class that implements the IIS manager in the assembly at: IISAssemblyPath  InstallDir: The path where StoreFront is installed, which is usually: %PROGRAMFILES%\\Citrix\\Receiver StoreFront  WindowsInstallerAssemblyPath: The path of an assembly that implements the StoreFront Windows installer functionality  WindowsInstallerType: The type of the class that implements the Windows installer functionality in the assembly at: WindowsInstallerAssemblyPath   Key : HKLM\\SOFTWARE\\Citrix\\DeliveryServices\\FrameworkControllerData  Values \n- DirectoryPath: The path to the directory that stores the StoreFront framework controller data  Key : HKLM\\SOFTWARE\\Citrix\\DeliveryServicesManagement  Values   AdminMscFileLocation: The StoreFront Management Console snap-in configuration file  InstallDir: The StoreFront management installation directory, which is usually: %PROGRAMFILES%\\Citrix\\Receiver StoreFront\\Management   The following key contains sub-keys that control the scope nodes in the StoreFront Administration Console (see Section 3.5):  HKLM\\SOFTWARE\\Citrix\\DeliveryServicesManagement\\Plugins  Each key can contain the following values:   IsEnabled: This controls whether the associated scope node is displayed  IsFirstUsePlugin: Determines whether the associated node participates in the First-Time Use experience  OrderingHint: This controls the order in which the scope nodes are displayed in the StoreFront Administration Console  Parent: This specifies the parent of the associated scope node   The Windows registry is also used by the Authentication SDK. The following key contains two sub-keys: Extensions and ViewExtensions:\nHKLM\\SOFTWARE\\Citrix\\DeliveryServicesManagement\\Plugins\\Authentication\nEvery authentication method should add a sub-key to the Extensions key, with a default value that specifies the assembly that contains the implementation of the Authentication SDK management plug-in as described in Section 3.5.\nIf an authentication method has configuration actions, then it should also add a sub-key to the ViewExtensions key, with a default value that specifies the assembly that contains the implementation of the Authentication SDK view extension as described in Section 3.5.3.\nThe assemblies described above should be located at the path specified by the InstallDir value of the key:\nHKLM\\SOFTWARE\\Citrix\\DeliveryServicesManagement.", 
            "title": "3.1  Registry"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#32-framework-controller-data", 
            "text": "The StoreFront framework controller data for this release is stored in an XML file at the path specified by the DirectoryPath value of the key: \nHKLM\\SOFTWARE\\Citrix\\DeliveryServices\\FrameworkControllerData.  This file contains the information about which features are currently deployed, including Windows Services, web applications etc, and is used by the StoreFront Framework controller for deployment management.\nThe data stored here is managed by the PowerShell API and should not be manually updated.", 
            "title": "3.2  Framework Controller Data"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#33-configuration-data", 
            "text": "Most of the configuration data for individual StoreFront components is stored in the web.config file of the associated web application, or in the application.config file for Windows services.  These configuration settings are managed by the StoreFront Configuration Provider (see Section 3.4.3) . In order for the configuration provider to read and write the settings a configuration section is required; see: http://msdn.microsoft.com/en-us/library/vstudio/2tw134k3(v=vs.100).aspx.", 
            "title": "3.3  Configuration Data"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#331-service-locator", 
            "text": "The basic idea behind a service locator is to have an object that knows how to get hold of all of the services that an application might need. StoreFront makes extensive use of service location and inversion-of-control (IoC) containers; see http://martinfowler.com/articles/injection.html for more details of this software pattern.For the StoreFront services to access the configuration data the following procedure is often followed:\n1.Create a configuration section.\n2.Create a simple data class that holds all the required settings.\n3.Create a parser class that takes a configuration sections and creates a settings data object.\n4.Create a start-up module that uses the parser to create an instance of the settings object in the service locator.\n5.Obtain access to the settings objects, where required, through the service locator.", 
            "title": "3.3.1   SERVICE LOCATOR"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#332-start-up-modules", 
            "text": "A start-up module for a web application is a class that implements the following interface:  namespace Citrix.DeliveryServices.Mvc\n{\n    ///  summary \n    /// Interface implemented by modules for executing code during the\n    /// application startup.\n    ///  /summary \n    public interface IStartupModule\n    {\n        ///  summary \n        /// The Initialize method of each registered component is called\n        /// at application startup (MvcCoreWebApplication).\n        /// Throwing an exception stop the application startup.\n        ///  /summary  \n        void Initialize();\n\n        ///  summary \n        /// Registers components (put all registration here unless a component                  \n        /// requires registering before/after other components).\n        ///  /summary \n        void RegisterComponents();\n\n        ///  summary \n        /// Registers components (pre call to allow for components that must\n        /// be registered first).\n        ///  /summary \n        void PreRegisterComponents();\n\n        ///  summary \n        /// Registers components (pre call to allow for components that must\n        /// be registered last, don't use unless required).\n        ///  /summary \n        void PostRegisterComponents();\n    }\n}  This interface is defined in the assembly: AuthSDK.zip/Assemblies/StoreFront/ Citrix.DeliveryServices.Mvc.dll.\nStart-up modules are registered with the service locator through the configuration in the configuration file. The following illustrates registering the forms protocol start-up module:  configuration \n   container \n     components \n       component id= formsProtocolStartupModule \n                 type= Citrix.DeliveryServices.Authentication.\n                       FormsProtocol.Startup.FormsProtocolStartupModule,\n                       Citrix.DeliveryServices.Authentication.FormsProtocol \n                 service= Citrix.DeliveryServices.Mvc.IStartupModule,\n                          Citrix.DeliveryServices.Mvc  / \n     /components \n   /container \n   citrix.deliveryservices \n   /citrix.deliveryservices  /configuration  During the start-up of the web application, all the start-up modules are discovered. The Initialize() is called first on all the modules, followed by: PreRegisterComponents(), then RegisterComponents(), and finally PostRegisterComponents().\nDuring an appropriate phase, settings and other objects can be added to the IoC container. See the samples for examples of how start-up modules are created and used.", 
            "title": "3.3.2   START-UP MODULES"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#34-powershell-scripting", 
            "text": "The StoreFront Administration Console internally uses PowerShell to perform its tasks, and administrators can use the PowerShell commands directly from a PowerShell command window or in scripts. The PowerShell support is divided into three parts: utility scripts, PowerShell modules, and the StoreFront configuration provider.", 
            "title": "3.4  PowerShell Scripting"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#341-utility-scripts", 
            "text": "The StoreFront utility scripts can be found at:  %PROGRAMFILES%\\Citrix\\Receiver StoreFront\\Scripts  The scripts include:\n- ImportModules.ps1: This performs the following tasks, to facilitate calling the StoreFront PowerShell API\n    - Adds all registered PowerShell snap-ins, with names matching the pattern: Citrix.DeliveryServices. , except for the StoreFront Configuration Provider\n    - Adds all PowerShell modules ( .psm1) found in the directory specified by the InstallDir value of the registry key: HKLM:\\SOFTWARE\\Citrix\\DeliveryServicesManagement\n- ClearUp_1.ps1: This removes all the StoreFront Feature instances, and can be used to cleanup after a failed uninstall of StoreFront\n- ClearUp_2.ps1: This removes all the StoreFront Feature classes, and must be called after ClearUp_1. After successfully running ClearUp_1 and ClearUp_2, StoreFront can be uninstalled using the Add/Remove Programs.", 
            "title": "3.4.1   UTILITY SCRIPTS"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#342-powershell-modules", 
            "text": "The StoreFront PowerShell modules can be found at:  %PROGRAMFILES%\\Citrix\\Receiver StoreFront\\Management\\Cmdlets  The commands relating to authentication are in the AuthenticationModule.psm1 module, and include the following:   Get-DSAuthenticationProtocolsAvailable: Get the current list of available authentication protocols.  Get-DSAuthenticationProtocolsDeployed: Get the list of protocols deployed for the Authentication service, specified by the IIS site identifier and virtual path of the associated web application.  Set-DSAuthenticationProtocolsDeployed: Update the protocols deployed for the Authentication service, specified by the IIS site identifier and virtual path of the associated web application. The required protocols are specified in a list. Protocols not currently deployed are added, and protocols that are currently deployed but not included in the list are removed.  Add-DSAuthenticationProtocolsDeployed: Add the specified list of protocols to the Authentication service, specified by the IIS site identifier and virtual path of the associated web application.   Remove-DSAuthenticationProtocolsDeployed: Remove the specified list of protocols from the Authentication service, specified by the IIS site identifier and virtual path of the associated web application.   Full help for the commands can be obtained using the standard Get-Help command as described here: http://technet.microsoft.com/en-us/library/ee176848.aspx.", 
            "title": "3.4.2   POWERSHELL MODULES"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#343-storefront-configuration-provider", 
            "text": "The actual getting and setting of configuration properties is achieved using the StoreFront Configuration Provider. The provider exposes parts of configuration files as hierarchical namespaces, in the same way that file systems are hierarchical namespaces, comprised of directories that contain files and other directories. This is available for all web.config and service.config files.\nIn general examples of how to modify the configuration settings can be found in the StoreFront PowerShell modules described in Section 3.4.2 Alternatively a namespace can be opened and browsed, as described below, to find appropriate settings.  The five steps in using the StoreFront Configuration Provider are:  1 Open a web application configuration file  The following illustrates how to open a drive for the authentication service in the default tenant:  # Load the StoreFront snap-ins and modules   $Env:PROGRAMFILES\\Citrix\\Receiver StoreFront\\Scripts\\ImportModules.ps1 \n# Get the authentication service web app for the default tenant\n$authWebApp = Get-DSAuthenticationServiceWebApp\n# Get the configuration for the web app\n$appPath = GetAppPathWeb -SiteId $authWebApp.SiteId `\n                         \u2013VirtualPath $authWebApp.VirtualPath -Name  DSAuth \n$appConfig = Get-Item $appPath\ncd $appPath  2 Open a Windows service configuration file  Configuring Windows services is unlikely to be necessary. However, if required, then the site name is needed to identify the service to be configured. The following site names are valid for the specified Windows service name:\n- Citrix Credential Wallet: CredentialWallet\n- Citrix Subscriptions Store: SubscriptionsStoreService\n- Citrix Default Domain Services: DefaultDomainService\n- Citrix Peer Resolution Service: PNRS\n- Citrix StoreFront Protocol Transition: ProtocolTransitionService  The following illustrates how to open a drive for the Credential Wallet.  # Load the StoreFront snap-ins and modules   $Env:PROGRAMFILES\\Citrix\\Receiver StoreFront\\Scripts\\ImportModules.ps1 \n$driveName =  CW \n$siteName =  CredentialWallet \n$cwDrive = GetAppPath -AppPath $siteName -Name $driveName\n$cwAppConfig = Get-Item $cwDrive\ncd $cwDrive  3 Access data  The majority of the settings are in the /DeliveryServices namespace, which can be navigated and explored using the standard dir, or ls alias. For example, the following enumerates all the namespaces in a default authentication service:  PS DSAuth:\\DeliveryServices  ls | select { $_.PSPath }\n $_.PSPath\n-----------\nDeliveryServices::DSAuth:\\DeliveryServices\\explicitAuthentication\nDeliveryServices::DSAuth:\\DeliveryServices\\citrixFederationAuthentication\nDeliveryServices::DSAuth:\\DeliveryServices\\formsProtocol\nDeliveryServices::DSAuth:\\DeliveryServices\\authentication\nDeliveryServices::DSAuth:\\DeliveryServices\\routing\nDeliveryServices::DSAuth:\\DeliveryServices\\delegatedKerberosAuthentication\nDeliveryServices::DSAuth:\\DeliveryServices\\defaultRoutes\nDeliveryServices::DSAuth:\\DeliveryServices\\explicitBL\nDeliveryServices::DSAuth:\\DeliveryServices\\delegatedExplicitAuthentication\nDeliveryServices::DSAuth:\\DeliveryServices\\commonExplicitEndpoints\nDeliveryServices::DSAuth:\\DeliveryServices\\certificateManager\nDeliveryServices::DSAuth:\\DeliveryServices\\authenticationService\nDeliveryServices::DSAuth:\\DeliveryServices\\cryptography\nDeliveryServices::DSAuth:\\DeliveryServices\\tokenManager\nDeliveryServices::DSAuth:\\DeliveryServices\\windowsEventLogger\nDeliveryServices::DSAuth:\\DeliveryServices\\logger\nDeliveryServices::DSAuth:\\DeliveryServices\\credentialWalletClient\nDeliveryServices::DSAuth:\\DeliveryServices\\delegatedDirectoryClaimFactory\nDeliveryServices::DSAuth:\\DeliveryServices\\localisation  The standard Get-Item and Get-ItemProperty commands can be used to access the properties. For example, the following illustrates displaying the explicit business logic settings:  PS DSAuth:\\DeliveryServices  Get-ItemProperty DSAuth:\\DeliveryServices\\explicitBL\nPSPath                      : DeliveryServices::DSAuth:\\DeliveryServices\\explicitBL\nPSParentPath                : DeliveryServices::DSAuth:\\DeliveryServices\nPSChildName                 : explicitBL\nPSDrive                     : DSAuth\nPSProvider                  : DeliveryServices\nAuthenticatorName           : defaultDelegatedAuthenticator\nRequireAccountSIDs          : True\nHideDomainField             : True\nAllowUserPasswordChange     : Never\nShowPasswordExpiryWarning   : Windows\nPasswordExpiryWarningPeriod : 10\nAllowZeroLengthPassword     : False  The following illustrates how to set a variable to determine whether or not the domain field is displayed in the explicit logon form:  PS DSAuth:\\DeliveryServices  $showDomainField = -not` \n                          (Get-Item DSAuth:\\DeliveryServices\\explicitBL\\HideDomainField)\nPS DSAuth:\\DeliveryServices  $showDomainField\nFalse  4 Set data  The configuration settings can be modified using the standard Set-Item and Set-ItemProperty commands. However, StoreFront also has a command to set multiple properties simultaneously. For example, the following sets the password expiry warning notice to be five days irrespective of any Windows policy:  SetItemProperties `\n   -Path ${appPath}DeliveryServices\\explicitBL `\n   -Values @{  ShowPasswordExpiryWarning  =  Custom ; `\n               PasswordExpiryWarningPeriod  = 5 }  5 Save and close a configuration file  The setting of properties above does not commit the changes to the configuration file. The following demonstrates how to save the modified configuration, and to close the associated namespace.  # Save the modified configuration\n$appConfig.Save()\n# Close the associated namespace\nRemoveDeliveryServicesDrive -Name  DSAuth   Note   It is important to close the associated namespace when managing the associated configuration is complete.  For web applications, saving the configuration will result in the configuration being automatically reloaded. However, for Windows services, the associated service must be manually restarted, using the Restart-DSService command.", 
            "title": "3.4.3   STOREFRONT CONFIGURATION PROVIDER"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#35-authentication-management-sdk", 
            "text": "The Authentication SDK also contains mechanisms for extending the StoreFront Administration Console. The programming elements associated with the Microsoft Management Console can be found here: http://msdn.microsoft.com/en-us/library/ms692747(v=vs.85).aspx.\nThe StoreFront Administration console is composed of extensible scope nodes, one of which represents the Authentication Service. The authentication scope node has a number of extension points that are described below. In order for the StoreFront Administration Console to find the extension assemblies, the installation process should update the StoreFront registry as described in Section 3.1.", 
            "title": "3.5  Authentication Management SDK"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#351-display-status-messages", 
            "text": "The Authentication scope node has an API that is used to obtain status messages from each of the authentication protocols, and each authentication method must contain an implementation of the following interface.  namespace Citrix.DeliveryServices.Admin.Authentication.Extensions.Interfaces\n{\n    ///  summary \n    /// The authentication extension interface\n    ///  /summary \n    public interface IAuthenticationExtension\n    {\n        ///  summary \n        /// Get the status messages associated with this authentication method,\n        /// to be displayed in the StoreFront administration console.\n        ///  /summary \n        ///  returns The list of status messages. /returns \n        IList StatusMessage  GetStatusMessages();\n    }\n}  This interface is defined in the assembly: AuthSDK.zip/Assemblies/StoreFront/ Citrix.DeliveryServices.Admin.Authentication.Extensions.Interfaces.dll.\nAny installation process should place the assembly implementing this interface in the following directory:\n%PROGRAMFILES%\\Citrix\\Receiver StoreFront\\Management", 
            "title": "3.5.1   DISPLAY STATUS MESSAGES"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#352-include-customization-in-addremove-methods", 
            "text": "In order for the Authentication node \u201cAdd/Remove methods\u201d action to display the custom authentication method, several steps are required. The Feature package definition file must contain the authProtocol properties as described in Section 4.2. In particular, the authProtocolLocalizer must define an object that implements the following interface, which allows the StoreFront Administration Console to display a localized name for the authentication method:  namespace Citrix.DeliveryServices.Admin.Authentication.Extensions.Interfaces\n{\n    ///  summary \n    /// This interface defines an object to allow external objects to\n    /// localise authentication strings\n    ///  /summary \n    public interface IAuthenticationLocalizer\n    {\n        ///  summary \n        /// Get the string with the specified key from the authentication localizer\n        ///  /summary \n        ///  param name= key The key to the string /param \n        ///  param name= cultureInfo The current UI culture /param \n        ///  returns The specified string, or the key /returns \n        string GetResource(string key, CultureInfo cultureInfo);\n    }\n}  This interface is defined in the assembly: AuthSDK.zip/Assemblies/StoreFront/ Citrix.DeliveryServices.Admin.Authentication.Extensions.Interfaces.dll.", 
            "title": "3.5.2   INCLUDE CUSTOMIZATION IN ADD/REMOVE METHODS"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#353-add-actions", 
            "text": "If an authentication protocol requires to add Actions or Overview items to the StoreFront Administration Console user interface, then a class implementing the following interface is required.  namespace Citrix.DeliveryServices.Admin.SnapIn.Interfaces.Plugin\n{\n    public interface IPluggableScopeNodeViewExtension\n    {\n        ///  summary \n        /// In dervied classes, initializes the object state\n        ///  /summary \n        void InitializeViewExtension(IPluggableScopeNodeView scopeNodeView);\n\n        ///  summary \n        /// In derived classes, gets a list of the actions pertinent to\n        /// the selected view Context\n        ///  /summary \n        IList ActionsPaneItemWrapper  GetViewExtensionActions();\n\n        ///  summary \n        /// In derived classes, gets a list of the items to be\n        /// displayed under overview list\n        ///  /summary \n        IList KeyValueListItem  GetExtensionOverviewItems();\n    }\n}  This interface is defined in the assembly: AuthSDK.zip/Assemblies/StoreFront/ Citrix.DeliveryServices.Admin.SnapIn.Interfaces.dll.\nActions are usually implemented by a wrapper invoking a PowerShell command that is part of a PowerShell module supplied as part of the customization. Any installation process should place the PowerShell module in the following directory, where it will be automatically loaded during the StoreFront Administration Console initialization procedure:\n%PROGRAMFILES%\\Citrix\\Receiver StoreFront\\Management\\Cmdlets   Note   Any issues with the PowerShell module can prevent the StoreFront Administration Console from loading  The PowerShell module must be digitally signed by a trusted publisher    When an authentication method has been updated as a result of an Action, then it must signal this by issuing a  Citrix.DeliveryServices.Admin.Authentication.Extensions.Interfaces.Events. ExtensionChangedEvent event so that the Authentication scope node can be refreshed to reflect any changes.", 
            "title": "3.5.3   ADD ACTIONS"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#36-diagnostics", 
            "text": "", 
            "title": "3.6  Diagnostics"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#361-tracing", 
            "text": "StoreFront uses the standard .NET tracing mechanism; for more information see: http://msdn.microsoft.com/en-us/library/system.diagnostics.trace(v=vs.110).aspx.\nStoreFront uses standard .NET trace sources; for more information see: http://msdn.microsoft.com/en-us/library/ms228984(v=vs.110).aspx.\nThe trace sources are configured in the associated configuration file, for example:     system.diagnostics \n\n     !\u2014Trace sources -- \n     sources \n       source name= Citrix.DeliveryServices.FormsProtocol \n         listeners \n           add name= citrixTraceListener  / \n         /listeners \n       /source \n       source name= Citrix.DeliveryServices.FormsEngine \n         listeners \n           add name= citrixTraceListener  / \n         /listeners \n       /source \n\n     !\u2014Trace switches -- \n     switches \n       add name= Citrix.DeliveryServices.FormsProtocol  value= Error  / \n       add name= Citrix.DeliveryServices.FormsEngine  value= Error  / \n     /switches \n\n     !\u2014Listeners -- \n     sharedListeners \n       add name= citrixTraceListener  type= Citrix.DeliveryServices.Diagnostics.CircularTraceListener,Citrix.DeliveryServices.Diagnostics, Version=2.6.0.0, Culture=neutral, PublicKeyToken=e8b77d454fa2a856  \n           initializeData= C:\\Program Files\\Citrix\\Receiver StoreFront\\Admin\\trace\\Authentication.svclog \n           maxFileSizeKB= 5000  / \n     /sharedListeners \n     trace autoflush= false  / \n   /system.diagnostics    To configure tracing, use the Set-DSTraceLevel PowerShell command. For example, to enable verbose tracing for all components use the following:   # Load the StoreFront snap-ins and modules   $Env:PROGRAMFILES\\Citrix\\Receiver StoreFront\\Scripts\\ImportModules.ps1 \n# Set the trace level to be verbose for all components\nSet-DSTraceLevel -All -TraceLevel Verbose\nHelp for the Set-DSTraceLevel command can be obtained by using the standard Get-Help command,  for example: \nGet-Help Set-DSTraceLevel   Note   Tracing information is written to a circular trace log at:  %PROGRAMFILES%\\Citrix\\Receiver StoreFront\\Admin\\trace    StoreFront automatically captures Error trace messages. Due to the large amount of data that can potentially be generated, tracing may significantly impact the performance of StoreFront, so it is recommended that the Info or Verbose levels are not used unless specifically required for troubleshooting.     The following illustrates how to programmatically access an event source named MyTraceSource:  public static class MyTraceSourceHelper \n{\n    static MyTraceSourceHelper()\n    {\n        Tracer = TracerManager.GetTracer( MyTraceSource );\n    }\n\n    public static Tracer Tracer { get; private set; }\n}\nThis is used as follows:\nMyTraceSourceHelper.Tracer.WriteError( An error occurred. );\nA trace source must be defined in the containing application configuration as illustrated below: configuration   \n   system.diagnostics \n     sources \n       source name= MyTraceSource \n         listeners \n           add name= citrixTraceListener  / \n         /listeners \n       /source \n     /sources \n     switches \n       add name= MyTraceSource  value= Error  / \n     /switches \n     sharedListeners \n       add name= citrixTraceListener     \n           type= Citrix.DeliveryServices.Diagnostics.CircularTraceListener,\n                 Citrix.DeliveryServices.Diagnostics, Version=2.6.0.0, Culture=neutral,\n                 PublicKeyToken=e8b77d454fa2a856 \ninitializeData= C:\\Program Files\\Citrix\\Receiver StoreFront\\Admin\\trace\\Store.svclog               \n           maxFileSizeKB= 5000  / \n     /sharedListeners \n     trace autoflush= false  / \n   /system.diagnostics  /configuration  Where appropriate, it is possible to use the built-in StoreFront trace sources. The following illustrates how to write to the Forms Protocol trace source:  using Citrix.DeliveryServices.Authentication.FormsProtocol.Diagnostics;\nTraceHelper.Tracer.WriteError( An error occurred. );", 
            "title": "3.6.1   TRACING"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#362-writing-to-the-event-log", 
            "text": "StoreFront contains a static helper class for writing to the event log at:\nEvent viewer   Applications and Services Logs   Citrix Delivery Services\nThe interface for Citrix.DeliveryServices.Logging.Common.Logger is detailed at:\nAuthSDK.zip/Assemblies/StoreFront/Citrix.DeliveryServices.Logging.Interfaces.XML  An event log entry requires:   Message type, which is one of: Success, Information, Warning or Error  A source that defines the component where the message originated  An event identifier that uniquely identifies the event  A task category   For example:              Logger.LogMessage(\n                1,\n                30000,\n                MessageType.ERROR,\n                null,\n                Resources.AuthenticateUnexpectedErrorText\n                );  For StoreFront, custom implementations should use a Task Category value between 30000 and 31000.", 
            "title": "3.6.2   WRITING TO THE EVENT LOG"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#4-storefront-services-feature-packaging-and-deployment", 
            "text": "The StoreFront Authentication Service and Administration Console have extension points for adding new authentication protocols to the solution without modifying either container. There is a pattern for creating a new authentication protocol that results in a StoreFront Feature Package, described here, that can be deployed using existing StoreFront deployment mechanisms. All the existing authentication methods utilize these extension points, and the samples document demonstrate how third parties can take advantage of these mechanisms.", 
            "title": "4  StoreFront Services Feature Packaging and Deployment"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#41-storefront-package", 
            "text": "A StoreFront Package is a compressed archive of the files required for the feature, along with meta-data to describe how the files should be added to the system.  The Packages should be placed in the directory: FeaturePackages at the path specified by the InstallDir value of the key:  HKLM\\SOFTWARE\\Citrix\\DeliveryServicesManagement  When a package is deployed, the files are extracted to a directory with the same name as the package in the directory: Features at the path specified by the InstallDir value of the key:  HKLM\\SOFTWARE\\Citrix\\DeliveryServicesManagement  When the package has been expanded by the StoreFront Framework, it should contain the following directories:\n- _rels and package are used by the packaging mechanism and will not be described here\n- admin: This directory contains the files required for administration of the feature, including: PowerShell assemblies, the files used to merge the feature into an existing web application or service, and the files used to transform the configuration during upgrade.\n- GAC: This directory contains the assemblies that will have been added to the .Net Global Assembly Cache.\n- template: This directory contains the files that will be used to create an instance of the feature. For a web application feature, it will contain the files that will be added to the App_Data and bin directories. For a Windows Service it will contain all the files required for that service.\nAn msbuild task is provided to create a package from a package definition file and its usage is described in Section 5.4.9.", 
            "title": "4.1  StoreFront Package"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#42-package-definition-language", 
            "text": "A StoreFront Feature Package is defined by an XML document that contains the following sections relevant to this discussion:\n- PackageFileName defines the name of the package file to be created\n- MetadataProperties contain information about the package that can be used to deploy the package\n- Files describe the files that are to be deployed to the system  Metadata Properties    allows a description name to be given to the feature.   is the feature identifier and must be changed with a new Guid for any new Authentication method. Any Guid specified here also has to match the Feature Identifier specified in the: Feature Installer (if required), the custom actions, and Console extension.   specifies the features parent, and should be unchanged from the samples, that is, the parent should be AuthenticationCore.   list the other features that the feature depends on. For custom forms methods this should be unchanged from the forms samples, that is, the dependencies should include FormsProtocol and ExplicitCommon if Active Directory credential validation is required.   describe any local groups used by this feature. In general, this will be empty for custom Forms.  ,       are deprecated and should be empty.   describes how many times a feature can be added to its parent, for custom forms and new authentication methods this should be 1.   describes the class type to be used to create a feature instance.   is the path to the assembly containing the Feature instance factory. If the factory is in the Global Assembly Cache, then this can be empty.   and   are deprecated, and should not be used.   are name-value pairs of properties. For Authentication methods, there are certain mandatory properties, that must have the export attribute set to be true:  authProtocol must be \u201ctrue\u201d.  authProtocolDisplayNameKey defines the resource key for the authentication method display name in the StoreFront Administration Console. By convention this value is usually \u201cDisplayName\u201d.  authProtocolLocalizer defines the object that implements the interface: Citrix.DeliveryServices.Admin.Authentication.Extensions.Interfaces.IAuthenticationLocalizer: see Section 3.5.  authProtocolDisplayIndex defines the display order of authentication methods in the Add/Remove Authentication Methods in the StoreFront Administration Console. A good value for this is \u201c5000\u201d.  authProtocolDeployDefault defines whether the authentication method should be deployed by default when the authentication service is created, and should be \u201cfalse\u201d.  protocolChoice defines the protocol name in the choices and must be \u201cCustomForms\u201d for forms customizations.     Files  The files deployed to the system are one of two categories: runtime files or administration files.\n- Runtime files are placed in a template directory when the package is expanded (installed), and then copied to the Authentication Service when the feature is deployed.\n- Administration files are used in the administration of the feature and include the following categories:\n    - Files that are to be placed in the Global Assembly Cache, such as Configuration Sections\n    - PowerShell snap-ins\n    - Performance counters  The   element contains other elements:\n-   defines where the feature packager should get the file from.\n-   is where the file should be placed when deployed. The location is relative to the expanded feature directory.\n-   relate to IIS Authentication options and should be empty for custom forms.\n-   specifies whether the file should be packaged for Debug and Release versions.  The   element also has attributes:\n- addToGac. If \u201ctrue\u201d the file is added to the GAC.\n- installUtil. If \u201ctrue\u201d the InstallUtil program (http://msdn.microsoft.com/en-us/library/50614e95(v=vs.90).aspx ) is run on the specified file. This is used for features such as performance counters and PowerShell snap-ins, where the assembly has to be registered with the system.\n- Register. If true then the regsvr32 program (http://technet.microsoft.com/en-us/library/bb490985.aspx ) is run on the specified file. As an example, this can be used to register COM objects with the system.\n- includeInManifest. If \u201ctrue\u201d, then include in the package manifest. This is used for files that will be part of the template.\n- replicate. If \u201ctrue\u201d this file will be copied to all members of a StoreFront cluster as part of a propagation action.", 
            "title": "4.2  Package Definition Language"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#5-code-samples", 
            "text": "", 
            "title": "5  Code Samples"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#51-introduction", 
            "text": "The Authentication SDK contains two form customization samples: Test Forms and Magic Word Authentication. In addition, the Certificate Identity Declaration sample demonstrates how to add a completely new authentication method, although this also requires adding a customization to the Citrix Receivers. The SDK also contains pre-built installers for all the samples.\nBefore attempting to deploy the pre-built sample installers, you must add the following certificate to the Third-Party Root Certification Authorities store of the Local Computer account where StoreFront is installed: AuthSDK.zip/Certificates/YourCompany.cer\nThis is mandatory for each server in a StoreFront Server Group. This is not mandatory for the development machine.\nThe installers deploy StoreFront Feature packages and add-ins to the StoreFront Administration Console. To actually deploy and enable a sample, use the Add/Remove Methods action from the Authentication node of the Administration Console.\nBefore attempting to uninstall a sample, you must remove the associated authentication method using the Add/Remove Methods action. The sample can then be removed using the standard Add/Remove Programs control panel applet.", 
            "title": "5.1  Introduction"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#52-getting-started", 
            "text": "In order to open and build the samples, you must first provision a development environment. This requires the following components to be installed on a suitable Windows machine, as described in the prerequisites (see Section 1.2.1).\nAll the other tools and components required to build the samples are included in the SDK.\nA temporary code-signing certificate for test purposes has been provided in the following location:\nAuthSDK.zip/Certificates/YourCompany.pfx   Note  The private key is not password protected.   The following certificate is the accompanying public certificate that can be added to the Trusted Root certificates for testing:\nAuthSDK.zip/Certificates/YourCompany.cer\nBefore releasing your integration, you should purchase a code-signing certificate, backed by a public certificate authority.\nOnce the above steps have been completed, you can open the sample Visual Studio solution file (*.sln) and successfully build the samples.", 
            "title": "5.2  Getting Started"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#53-code-security", 
            "text": "Best practice is to use a code-signing certificate (that is, a certificate marked with the Extended Key Usage object id: 1.3.6.1.5.5.7.3.3) to digitally sign executing code to provide assurance as to the source of the code. For more information see [7]. The StoreFront Administration Console expects all PowerShell Scripts and extension assemblies to have Authenticode signatures.  Whilst best practice is to use a code-signing certificate issued by a public certificate authority, the samples use a self-signed certificate for this purpose, which leads to the following:   If you are using the pre-built sample installers, then it is required to add the certificate at AuthSDK.zip/Certificates/YourCompany.cer to the Third-Party Root Certification Authorities store of the Computer, before installing the sample msi.  Note that the samples have not been time stamped, see [8].  When creating a real authentication method, the post build tasks should include the signing task as demonstrated in the samples, but using a code-signing certificate for your company, and the files should be time stamped.", 
            "title": "5.3  Code Security"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#54-visual-studio-solution-layout", 
            "text": "The StoreFront assemblies referenced by the samples, along with other third-party assemblies, are in the Assemblies directory. The Assemblies directory also contains the StoreFront XML documentation files. The tools used to build and unit test the solutions are in the Tools directory. The documentation, including the third party notices, is in the Documentation directory.\nIn order to add assemblies to the Global Assembly Cache, the assemblies must be strongly named. The Authentication SDK provides a strong-name key pair, but it is recommended that developers create a new strong-name key pair for their customization.\nThe samples follow the same basic layout and can be composed of the following projects:", 
            "title": "5.4  Visual Studio Solution Layout"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#541-configuration", 
            "text": "If the authentication customization requires configuration, then a C# class library project should be added.   Note   The Microsoft Management Console for Windows Server 2008 R2 only supports the .NET 2.0 runtime, see http://msdn.microsoft.com/en-us/library/gg983006(v=vs.85).aspx. As a result, all assemblies that are loaded by the MMC must target the .NET 3.5 run time in Visual Studio. This includes configuration assemblies as they are loaded by reflection from the StoreFront Configuration Provider in the PowerShell modules. Assemblies that target .NET 3.5 SP1 can be loaded into the .NET 4 runtime, so these assemblies can still be loaded in the StoreFront Management Console running on Windows Server 2012 and 2012 R2 operating systems.  In order for the StoreFront Configuration Provider to be able to load the configuration sections, the associated assembly must be stored in the Global Assembly Cache. Hence the configuration assembly must be strongly named.    In general, this project shouldcontain the following:\n- Configuration Section and Elements: These define standard .NET configuration elements.\n- Settings: This is a data object that contains the configuration.\n- Configuration Parser: This object uses the configuration section to create the Settings object.", 
            "title": "5.4.1   CONFIGURATION"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#542-consoleextension", 
            "text": "This C# class library project should always be present, because it contains the Authentication Management Extension for this customization that is used by the StoreFront Administration Console for adding and removing the customization.\nThis will contain:\n= A Localizer that provides the localized strings for the StoreFront Administration Console.\n- The implementation of IAuthenticationExtension to provide any required status messages  If the customization has a configuration that is managed by the StoreFront Administration Console, then this project will also contain the view extension that may contain:\n- Dialogs\n- Data Models and Business Logic\n= Powershell commands", 
            "title": "5.4.2   CONSOLE.EXTENSION"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#543-feature", 
            "text": "This C# class library project contains the code to be added to the Authentication web application to perform the customized authentication.\nIf the customization is a forms customization it may contain the following:\n- Templates: The forms templates used by the customization\n- Forms: The associated forms objects\n- Conversation: Controls the flow of forms that make up the authentication conversation\n- Diagnostics: Any tracing or event log messages\n- StartupModule: This is a start-up module that is used to populate the Service locator with objects required by the system. This may include a settings object defined in the configuration project.  If the customization is a new authentication protocol, then it may contain the following:\n- Controllers: ASP.NET MVC controller that manages the authentication protocol\n- Diagnostics: Any tracing or event log messages", 
            "title": "5.4.3   FEATURE"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#544-featureinstaller", 
            "text": "This is an optional C# class library project that is required if:\n- The customization requires specialized behavior to be run during deployment of the feature\n- The customization requires specialized PowerShell commands  Additional Deployment Steps  The StoreFront features are deployed as a series of steps which are orchestrated by a deployer. A base class is provided, Citrix.DeliveryServices.Authentication.Framework.Admin.ProtocolFeatureInstanceBase, which performs the steps required for the deployment of a standard authentication feature.\nIf additional steps are required, then a sub-class can be created to add additional steps. The full list of built-in deployment steps can be found at:\nAuthSDK.zip/Assemblies/StoreFront/Citrix.DeliveryServices.Framework.Deployment.Steps.XML   Note  The feature instance class used for deployment is controlled by the InstanceFactoryType element in the feature package definition file; see Section 4.   PowerShell Commands  It is not expected that many PowerShell commands will be required by customizations. However, the samples illustrate how commands can be written.\nA base class is provided from which all PowerShell commands should be derived. This provides a tracing and auditing facility by creating output in the following directory every time that the command is run:\n%PROGRAMFILES%\\Citrix\\Receiver StoreFront\\Admin\\logs\nThe commands are contained within a PowerShell snap-in. The Microsoft documentation for creating a snap-in can be found here:\nhttp://msdn.microsoft.com/en-us/library/ms714450(v=vs.85).aspx.\nThe PowerShell snap-in is registered with the system when the associated Feature class is installed. This is controlled by setting the installUtil attribute to be true on the associated assembly in the Feature package definition file, see Section 4.2, for more details.", 
            "title": "5.4.4   FEATUREINSTALLER"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#545-featuretemplate", 
            "text": "This directory may contain the following:\n- web.merge.config or web.merge.xslt: This file describes the configuration entries that are merged into the Authentication Service web application\u2019s web.config file during deployment of the customization.\n- web.unmerge.config or web.unmerge.xslt: This file describes the configuration entries that are removed from the Authentication Service web application\u2019s web.config file during the removal of the customization.\n- App_Data/resources/*.resx: These are the end-user facing strings that are used by the customization.", 
            "title": "5.4.5   FEATURETEMPLATE"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#546-installer", 
            "text": "This Wix installer project is used to deploy the customization.  The installer has the following responsibilities during deployment:\n- Run the VerifyProtocolNotInstalled and WarnIfAdminConsoleOpen custom actions described  in Section 5.4.7\n- Copy the Feature package to the StoreFront FeaturePackages directory\n- Deploy the Administration Console Extension assemblies to the management InstallDir and to configure the registry, as described in Section 3.1, so that they are loaded by the console when it starts  The installer has the following responsibilities during uninstall:\n- Run the RemoveInstalledClass custom action, described  in Section 5.4.7\n- Remove the Feature package and registry entries added during install  This project also contains the Feature Package definition, as described in Section 4.1, and runs the FeaturePackager msbuild task in the post-build step to build the Feature Package.", 
            "title": "5.4.6   INSTALLER"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#547-installercustomactions", 
            "text": "This C# class library project contains the custom actions required by the installer in section 5.4.6.   Note  The custom actions must be targeted at the x64 Platform and not AnyCPU. This is to force the Windows Installer to run the actions as x64, which is required to gain access to the correct registry entries.   In general there are three custom actions:\n- RemoveInstalledClass: This removes the installed Feature class. If there are any existing instances of the Feature, the action will display an error message that tells  the administrator what to do. The uninstall will then exit without uninstalling the customization.\n- WarnIfAdminConsoleOpen: This checks whether the StoreFront Administration Console is open. If it is open, the action displays a warning message tellinging the administrator to close and re-open the console before deploying the customization.\n- VerifyProtocolNotInstalled: This verifies whether there is another feature that implements the target authentication method. If there is an existing method, the action displays an error message and exits without installing the customization.  In general, the code can be copied from an existing sample, and only the Feature identifier and Authentication Protocol Name  need to be changed.", 
            "title": "5.4.7   INSTALLER.CUSTOMACTIONS"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#548-unittests", 
            "text": "This C# class library project contains unit tests for the customizations. This may contain tests for the following:\n- Merge Tests: Verify the merge and unmerge of entries into the Authentication Service web application\u2019s web.config.\n- Route Tests: Verify that the MVC routes have been configured correctly.\n- Service Locator Tests: Verify that required objects have been added to the IoC container.\n- Authentication Tests: Verify the custom authentication.", 
            "title": "5.4.8   UNITTESTS"
        }, 
        {
            "location": "/storefront-services-authentication-sdk/#549-build-tasks", 
            "text": "PackageFeature\nThis task is used to generate the feature package from the feature package definition file (see Section 4), and is usually part of the Installer project.  The task has the following properties:\n- PackageDefinitionFile: The path of the package definition file to process.\n- Configuration: The configuration to build, one of: Debug or Release.  Example:  Configuration Condition=  '$(Configuration)' == ''  Debug /Configuration  PackageFeature PackageDefinitionFile= Package\\Feature.pkg  Configuration= $(Configuration)  /  MsiLocaliser  This task is used to generate a multilingual installer and is usually part of the installer project.  The task has the following properties:\n- Cultures: A \u2018;\u2019 separated list of language codes.\n- TargetName: The file name of the created multi-lingual installer.\n= TargetFolder: This folder should contain all the folders corresponding to the individual localized installers.  Example:    Configuration Condition=  '$(Configuration)' == ''  Debug /Configuration  Cultures Condition=  '$(Cultures)' == ''  en-US;de-DE;es-ES;fr-FR;ja-JP;zh-CN /Cultures  MsiLocaliser Cultures= $(Cultures)  TargetFolder= bin\\x64\\$(Configuration)  \n                          TargetName= Installer-x64.msi  /", 
            "title": "5.4.9   BUILD TASKS"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/", 
            "text": "Citrix Common Forms Authentication API\n\n\nIntroduction\n\n\nScope\n\n\nThe purpose of this document is to describe the StoreFront Common Forms Authentication Application Programming Interface.\n\n\nBackground\n\n\nCitrix has devised a common authentication protocol that is implemented by its next generation services and gateway platforms, referred to here as StoreFront Services and NetScaler Gateway. Citrix is implementing client support, in Receiver and Worx, for this common authentication protocol in native user agents for the major device platforms, notably Windows, Mac, iOS, Android, Linux, and in Receiver for Web for browser user agents. See StoreFront Token Services v2.0 [1] for more details.\n\n\nAn important part of the common authentication protocol is a generic forms language, designed to allow third parties to express a wide range of authentication forms using a set of user interface constructs that are similar to basic HTML forms; see RFC 1867 [http://www.ietf.org/rfc/rfc1867.txt] and 2388 [http://www.ietf.org/rfc/rfc2388.txt] for more details.\n\n\nThird parties are able to extend the authentication methods supported by StoreFront Services and NetScaler Gateway by implementing server logic that emits and consumes the Common Forms language; see StoreFront Services Authentication SDK v2.6 [2] for more details.\n\n\nThe Common Forms protocol represents a secure conversation between the server and the user agent on the client, where forms are generated by the server, rendered by the useragent, completed by the user, and returned to the server by the user agent. Whilst the forms generated may be the same, the start and end of the conversations differ between StoreFront Service and NetScaler Gateway, representing their different needs. \n\n\nThe form generation and handling can be delegated from NetScaler Gateway to a StoreFront server by means of the Delegated Forms Authentication Protocol [3]. This allows a third party to create one customization that can be used in both StoreFront and NetScaler Gateway.\n\n\nThis document details the StoreFront Services v2.6 conversation, specifying the messages at the HTTP level.\n\n\nReferences\n\n\n1.StoreFront Token Services v2.0\n\n\n2.StoreFront Services Authentication SDK v2.6\n\n\n3.Delegated Forms Authentication Protocol\n\n\n4.Receiver Common Authentication Forms Language v2.6\n\n\nStoreFront Conversation\n\n\nFor maximum interoperability, the protocol is a REST API, that is, XML forms transmitted over HTTPS. The flow of forms and responses constitutes a conversation that can have state associated with the overall conversation through the use of HTTP sessions.\n\n\nThe convesations require HTTP state management, as described by RFC 2109 [http://www.ietf.org/rfc/rfc2109.txt], in particular correct handling of cookies.\n\n\nNote: In the following sections, the definition of HTTP headers uses the notation defined in RFC 2616 [http://tools.ietf.org/html/rfc2616].\n\n\nNote to client implementors: Implementors of long-lived clients should ensure that the session cookie is cleared at the end of the conversation.\n\n\nThe conversation contains sensitive information, such as passwords, so confidentiality and integrity are required. The expectation is that SS/TLS will be used between the client and the server to both maintain confidentiality and also for server identification, to ensure that the user agent sends confidential information only to trusted servers.\n\n\nFor StoreFront, the conversation starts with a Request Security Token (RST) message [1] to an endpoint obtained from the client as part of the Protocol Choices message [1]. A successful conversation ends with a Request Security Token Response (RSTR) message [1]. The conversation can also end with a failure form, an HTTP status code other than 200, or a network failure.\n\n\nFor the rest of the conversation the server returns authentication forms described in Receiver Common Authentication Forms Language v2.0 [4].\n\n\nNote to client implementors: Because a client does not know when a conversation will end, it should always set the HTTP Accept header to include both the Form and RSTR types.\n\n\nConversation Start\n\n\n\n\nURL: Usually obtained from the Protocol Choices data\n\n\nHTTP Method: POST\n\n\nAuthentication: None\n\n\nRequest Content-Type: application/vnd.citrix.requesttoken+xml\n\n\nAccept:\n\n\napplication/vnd.citrix.requesttokenresponse+xml, \n\n\napplication/vnd.citrix.authenticateresponse-1+xml\n\n\n\n\n\n\n\n\nBecause the conversation persists over several HTTP requests, the initial conversation start may include a Set-Cookie header. The usual HTTP semantics apply to this cookie, as described above. In addition, various aspects of the conversation are negotiated at the start of the conversation through the use of HTTP headers, as discussed below:\n\n\nCredential Type Negotiation\n\n\nThe Common Forms Language [4] contains a \u201csoft\u201d enumeration for the credential types, which means that new credential types can be added without breaking the schema. The behavior of user agents is to reject forms with unknown credential types. Hence credential types need to be negotiated between the client and server using the following HTTP header:\n\n\ncredential-Types-Header = \nX-Citrix-AM-CredentialTypes\n \n:\n field-value\nfield-value = *LWS credential-types-value *LWS\ncredential-types-value = 1#( credential-type-value )\ncredential-type-value = *TEXT\n\n\n\n\nThe credential types header is a comma-separated list of credential types that the client supports.\n\n\nExample: \n       X-Citrix-AM-CredentialTypes: none, username, domain, password, newpassword,\n                                passcode, savecredentials, textcredential\n\n\n\n\nNew clients will use the above HTTP header to signal the credential types that are known in a comma-separated list. Older clients do not set this header, so if the header is missing then the following credential types will be assumed: none, username, domain, password, newpassword, passcode, savecredentials, textcredential.\nIf a client does not support a required credential type, then the behavior is defined by the form implementation on the server, which may choose to terminate the conversation, or supply a simplified form that the client can process.\n\n\nLabel Type Negotiation\n\n\nThe Common Forms Language [4] contains a \u201csoft\u201d enumeration for the label types, which means that new label types can be added without breaking the schema. Label types can be negotiated between the client and server using the following HTTP header:\n\n\nlabel-Types-Header = \nX-Citrix-AM-LabelTypes\n \n:\n field-value\nfield-value = *LWS label-types-value *LWS\nlabel-types-value = 1#( label-type )\nlabel-type = *TEXT\n\n\n\n\nThe label types header is a comma-separated list of label values that the client supports.\n\n\nExample: \n\n\n       X-Citrix-AM-LabelTypes: none, plain, heading, information, warning,\n                           error, confirmation\n\n\n\n\nNew clients will use the above HTTP header to signal the label types that are known in a comma-separated list. Older clients do not set this header, so if the header is missing then the following label types shall be assumed: none, plain, heading, information, warning, error, confirmation.\nIf a client does not support a required label type, then the behavior is defined by the form implementation on the server, which may choose to terminate the conversation, or supply a simplified form that the client can process.\nNotes regarding images:\n\n\n\n\nThe default list of label types does not contain image. This is because none of the known legacy clients supported rendering images.\n\n\nImages are intended for authentication purposes, such as captcha images, and are not intended for generic branding.\n\n\nThe image data supplied in the form is to be interpreted as a Data URI as defined by RFC 2397, [http://tools.ietf.org/html/rfc2397]\n\n\n\n\nLanguage Negotiation\n\n\nThe textual data displayed in the form is defined by the StoreFront Server. In order to supply text in the appropriate language for the user, the server supports the standard HTTP language negotiation mechanism through the use of the Accept-Language header as described in RFC 2616 [http://tools.ietf.org/html/rfc2616].\n\n\nAccept-Language-Header = \nAccept-Language\n \n:\n field-value\nfield-value = *LWS accept-language-value *LWS\naccept-language-value = 1#( language-range [ \n;\n \nq\n \n=\n qvalue ] )\nlanguage-range  = ( ( 1*8ALPHA *( \n-\n 1*8ALPHA ) ) | \n*\n )\n\n\n\n\nThe header value may include a comma-separated list of language ranges. Each language range may be given an associated quality value that represents an estimate of the user's preference for the languages specified by that range. The quality value defaults to \"q=1\"\nExample:\n\n\n       Accept-Language: da, en-gb;q=0.8, en;q=0.7\n\n\n\n\nShould be interpreted as: \"I prefer Danish, but will accept British English and other types of English.\"\n\n\nIf a language cannot be negotiated, then a default language will be used, typically English.\n\n\nClient Response to a Form\n\n\n\n\nURL: Obtained from the current form\n\n\nHTTP Method: POST\n\n\nAuthentication: None\n\n\nRequest Content-Type: application/x-www-form-urlencoded\n\n\nAccept:\n\n\napplication/vnd.citrix.requesttokenresponse+xml, \n\n\napplication/vnd.citrix.authenticateresponse-1+xml\n\n\n\n\n\n\n\n\nIn response to a form the client will post back the requested information in the same format as for HTML forms [http://www.w3.org/TR/html401/interact/forms.html], and must be appropriately encoded.\nNote to server implementors: Existing clients may encode incorrectly, using \u2018%20\u2019 instead of \u2018+\u2019 to encode spaces, and may use UTF-8 encoding for extended multilingual characters that server implementations must be able to cope with.\nA detailed discussion of how to form the client response for each user input type is discussed in the section named: Client Responses for Form Input.\n\n\nWire-level Example\n\n\nForm from StoreFront\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache; private; no-store; must-revalidate; max-stale=0; post-check=0; pre-check=0; max-age=0\nPragma: no-cache\nContent-Type: application/vnd.citrix.authenticateresponse-1+xml; charset=utf-8\nExpires: Mon, 26 Jul 1997 05:00:00 GMT\nSet-Cookie: ASP.NET_SessionId=ixepmqu3dh1kxu30mv1una3y; path=/; HttpOnly\nDate: Mon, 07 Apr 2014 13:08:47 GMT\nContent-Length: 1552\n\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/response/1\n\n  \nStatus\nsuccess\n/Status\n\n  \nResult\nmore-info\n/Result\n\n  \nStateContext /\n\n  \nAuthenticationRequirements\n\n    \nPostBack\n/Citrix/Authentication/ExplicitForms\n/PostBack\n\n    \nCancelPostBack\n/Citrix/Authentication/ExplicitForms/Cancel\n/CancelPostBack\n\n    \nCancelButtonText\nCancel\n/CancelButtonText\n\n    \nRequirements\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\nusername\n/ID\n\n          \nSaveID\nExplicitForms-Username\n/SaveID\n\n          \nType\nusername\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nUser name:\n/Text\n\n          \nType\nplain\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nAssistiveText\ndomain\\user or user@domain\n/AssistiveText\n    \n          \nText\n\n            \nSecret\nfalse\n/Secret\n    \n            \nReadOnly\nfalse\n/ReadOnly\n\n            \nInitialValue\n/InitialValue\n\n            \nConstraint\n.+\n/Constraint\n\n          \n/Text\n\n        \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\npassword\n/ID\n\n          \nSaveID\nExplicitForms-Password\n/SaveID\n\n          \nType\npassword\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nPassword:\n/Text\n\n          \nType\nplain\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nText\nSecret\ntrue\n/Secret\n\n            \nReadOnly\nfalse\n/ReadOnly\n\n            \nInitialValue\n/InitialValue\n\n            \nConstraint\n.+\n/Constraint\n\n          \n/Text\n\n        \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\nsaveCredentials\n/ID\n\n          \nType\nsavecredentials\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nRemember my password\n/Text\n\n          \nType\nplain\n/Type\n          \n        \n/Label\n\n        \nInput\n\n          \nCheckBox\n\n            \nInitialValue\nfalse\n/InitialValue\n\n          \n/CheckBox\n\n        \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\nloginBtn\n/ID\n\n          \nType\nnone\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nType\nnone\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nButton\nLog On\n/Button\n\n        \n/Input\n\n      \n/Requirement\n\n    \n/Requirements\n\n  \n/AuthenticationRequirements\n\n\n/AuthenticateResponse\n\n\n\n\nClient Request\n\n\nPOST https://storefront.local/Citrix/Authentication/ExplicitForms HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\nAccept: application/vnd.citrix.requesttokenresponse+xml, application/vnd.citrix.authenticateresponse-1+xml\nHost: storefront.local\nCookie: ASP.NET_SessionId=ixepmqu3dh1kxu30mv1una3y\nContent-Length: 83\nExpect: 100-continue\nStateContext=\nloginBtn=Log+On\nusername=animaniacs%5ctestuser0\npassword=testuser\nsaveCredentials=false\n\n\n\n\nConversation Cancel\n\n\n\n\nURL: Obtained from the current form\n\n\nHTTP Method: POST\n\n\nAuthentication: None\n\n\nRequest Content-Type: application/x-www-form-urlencoded\n\n\nAccept:\n\n\napplication/vnd.citrix.authenticateresponse-1+xml\n\n\n\n\n\n\nResponse Content-Type: application/vnd.citrix.authenticateresponse-1+xml\n\n\n\n\nThe client should POST the StateContext back to the server, to the Cancel Url obtained from the current form: e.g. to cancel the form above, the following should be POSTed:\n\n\nStateContext=\n\n\nNote to server implementors: The state associated with the conversation should be discarded on the server when a cancel message is received, and any attempt to re-use the existing Http session state should result in a failure form.\n\n\nNotes to client implementors:\n\n\n\n\nImplementors of long-lived clients should ensure that the session cookie is cleared after the conversation has been cancelled.\n\n\nThe assumption is that forms shall normally have a cancel button, positioned in the natural location for each client platform, relative to the other buttons. However, the cancel button should only be shown if the element is present at: /AuthenticateResponse/AuthenticationRequirements/CancelButtonText in the supplied form.\n\n\n\n\nWire-level Example\n\n\nCancel Request from Client\n\n\nPOST https://storefront.local/Citrix/Authentication/ExplicitForms/Cancel HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\nAccept: application/vnd.citrix.authenticateresponse-1+xml\nHost: storefront.local\nCookie: ASP.NET_SessionId=ixepmqu3dh1kxu30mv1una3y\nContent-Length: 14\n\nStateContext=\n\n\n\n\nResponse from StoreFront\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache; private; no-store; must-revalidate; max-stale=0; post-check=0; pre-check=0; max-age=0\nPragma: no-cache\nContent-Type: application/vnd.citrix.authenticateresponse-1+xml; charset=utf-8\nExpires: Mon, 26 Jul 1997 05:00:00 GMT\nServer: Microsoft-IIS/8.0\nDate: Mon, 07 Apr 2014 14:33:50 GMT\nContent-Length: 201\n\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/response/1\n\n  \nStatus\nsuccess\n/Status\n\n  \nResult\ncancelled\n/Result\n\n  \nStateContext /\n\n\n/AuthenticateResponse\n\n\n\n\nConversation End\n\n\n\n\nURL: Obtained from the current form\n\n\nHTTP Method: POST\n\n\nAuthentication: None\n\n\nRequest Content-Type: application/x-www-form-urlencoded\n\n\nAccept:\n\n\napplication/vnd.citrix.requesttokenresponse+xml, \n\n\napplication/vnd.citrix.authenticateresponse-1+xml\n\n\n\n\n\n\nResponse Content-Type: application/vnd.citrix.requesttokenresponse+xml\n\n\n\n\nNote to server implementors: The state associated with the conversation should be discarded on the server when the RSTR message has been sent, and any attempt to re-use the existing HTTP session state should result in a failure form.\n\n\nNote to client implementors: Implementors of long-lived clients should ensure that the session cookie is cleared after the conversation has been completed.\n\n\nWire-level Example\n\n\nAuthentication Request from Client\n\n\nPOST https://storefront.local/Citrix/Authentication/ExplicitForms HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\nAccept: application/vnd.citrix.requesttokenresponse+xml, application/vnd.citrix.authenticateresponse-1+xml\nHost: storefront.local\nCookie: ASP.NET_SessionId=ixepmqu3dh1kxu30mv1una3y\nContent-Length: 83\nExpect: 100-continue\n\nStateContext=\nloginBtn=Log+On\nusername=animaniacs%5ctestuser0\npassword=testuser\nsaveCredentials=false\n\n\n\n\nResponse from StoreFront\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache; private; no-store; must-revalidate; max-stale=0; post-check=0; pre-check=0; max-age=0\nPragma: no-cache\nContent-Type: application/vnd.citrix.requesttokenresponse+xml\nExpires: Mon, 26 Jul 1997 05:00:00 GMT\nServer: Microsoft-IIS/8.0\nDate: Mon, 07 Apr 2014 14:25:52 GMT\nContent-Length: 3408\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n?\n\n\nrequesttokenresponse xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/requesttokenresponse\n\n  \nfor-service\n73003cf4-dc21-4bef-9138-af0ec600dba3\n/for-service\n\n  \nissued\n2014-04-07T14:25:51.7525144Z\n/issued\n\n  \nexpiry\n2014-04-08T10:25:51.7525144Z\n/expiry\n\n  \nlifetime\n0.20:00:00\n/lifetime\n\n  \ntoken-template /\n\n  \ntoken\nH4sIAAAAAAAEAK1XaY+\u2026ANAAA=\n/token\n\n  \nCredentialUpdateInformationList xmlns=\nhttp://citrix.com/authentication/response/1\n\n    \nCredentialUpdateInformation\n\n      \nCredentialDisplayName\nanimaniacs\n/CredentialDisplayName\n\n      \nAuthenticationInfoId\nCitrix Common Forms 1.0\n/AuthenticationInfoId\n\n      \nCredentialUpdateService /\n\n    \n/CredentialUpdateInformation\n\n  \n/CredentialUpdateInformationList\n\n\n/requesttokenresponse\n\n\n\n\nClient Persistent Storage\n\n\nClient persistent storage is needed by third parties using the Citrix Authentication SDK to implement authentication methods that currently rely on persistent browser cookies, e.g. for assigning a unique ID to user agents.\n\n\nAn authentication service specifies a value for the client to store by sending a header during a forms authentication conversation. Given a value to store, the client adds the same header to all further requests in the current and subsequent Common Forms authentication conversations with that authentication service.\n\n\nHeader syntax and semantics\n\n\nThe same header, defined below, is used in both HTTP requests and responses.\n\n\nStorage-Header = \nX-Citrix-AM-Storage\n \n:\n field-value\nfield-value = *LWS storage-value *LWS\nstorage-value = *TEXT\n\n\n\n\nThe header value may include leading and trailing whitespace, which should be ignored, and the storage value is a plain text string. The storage value may be omitted entirely, leaving a header with an empty value.\n\n\nEach X-Citrix-AM-Storage header represents a value stored by the user agent on behalf of the specific authentication service. Each authentication service may store only one value, but a client that interacts with multiple authentication services must be able store one value for each service. An authentication service is identified by the start URL of a forms conversation, including scheme, hostname, port number and path, but excluding query strings and fragments. The URLs of subsequent requests in a forms auth conversation are likely to differ from the start URL so clients must be careful not to simply use the current request URL in making decisions about storage.\n\n\nClients must compare URLs in accordance with the URI comparison rules defined in RFC 2616 [http://tools.ietf.org/html/rfc2616]. \n\n\nNote: a client may authenticate against a third party authentication service through Delegated Forms Authentication using different start URLs, for example one URL for NetScaler Gateway and one URL for StoreFront. In this case the third authentication service will end up setting two storage values on the client. This is conceptually not ideal but it should be sufficient because the main goal is parity with HTTP cookie-based authentication methods.\n\n\nThe X-Citrix-AM-Storage header is only valid during a forms-based authentication conversation. Clients should not update storage or send a storage value outside the authentication conversation. Clients should update the storage value if the header is received on any valid forms response during the conversation, including: failure forms (for example a \u2018fail\u2019 or \u2018cancel\u2019 result, or failure status) and Request Token Responses.\nThere is no mechanism for a client to advertise that it supports persistent storage, other than by returning a previously stored value.\n\n\nNotes to server implementors:\n- It is the server implementor\u2019s responsibility to appropriately protect the data stored on the client, for example using HMACs if data origin and integrity are important, or encryption if privacy is also required.\n- The maximum size of the storage header on an HTTP response is 5016 bytes, including the header name and whitespace around the value.\n\n\nNote to client implementors: Clients should treat a storage value as an opaque string and should not attempt to interpret the value. The content of a storage value is meaningful only to the originating server.\n\n\nServer-to-Client HTTP Responses\n\n\nAn X-Citrix-AM-Storage header on a response is a directive for the client to persistently and securely store the value on behalf of the sending authentication service. Clients should store the received value immediately and not wait until the end of the authentication conversation, such that if an authentication attempt is abandoned the client will be able to send the last seen value on starting the next authentication attempt.\n\n\nIf the X-Citrix-AM-Storage response header has an empty value, then clients should delete the storage value for the sending authentication service; subsequently clients do not need to send the empty X-Citrix-AM-Storage header.\n\n\nIf a forms response does not include an X-Citrix-AM-Storage header, clients must assume that there is no change required, and must keep the current storage value unchanged, and continue to send the last seen value.\n\n\nIf the response is not a valid forms response or is otherwise not understood by the client, the client must ignore any X-Citrix-AM-Storage header and not update the storage value.\n\n\nServers should not include more than one X-Citrix-AM-Storage header in the same response. If multiple storage headers are received, clients should process the first one only.\n\n\nStorage values do not have an explicit or implicit expiry date and potentially may be retained indefinitely. However, clients should delete all stored values if the user uninstalls or otherwise resets the client software, for example using the \u201cReset\u201d feature in Receiver.\n\n\nClient-to-Server HTTP Requests\n\n\nIf an authentication service has previously set a storage value on the client, the client must send the value to the authentication service using the X-Citrix-AM-Storage header on every request during a forms authentication attempt, starting with the request for the initial form.\n\n\nClients may omit the header if they have no value stored for the authentication service.\n\n\nWire Example\n\n\nMessage\nCommentary\nClient internal storage table\nOrigin service start URL\nStorage value\nnone>\nA first time use scenario, so there are, no stored values.\nRequest\nPOST https://example.com/Citrix/Authentication/CustomForms/Authenticate HTTP/1.1\nContent-Type: application/vnd.citrix.requesttoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml,application/vnd.citrix.authenticateresponse-1+xml,text/xml\nContent-Length: xxx\n?xml version=\"1.0\"?>\nrequesttoken xmlns=\"http://citrix.com/delivery-services/1-0/auth/requesttoken\">\nfor-service>32a290eb-7521-cd92-1394-475927c3a239\n/for-service>\nfor-service-url>https:// example.com /Citrix/Authentication/auth/v1/token\n/for-service-url>\nreqtokentemplate>\n/reqtokentemplate>\nrequested-lifetime>0.08:00:00\n/requested-lifetime>\n/requesttoken>\nThere\u2019s no stored value, so no o X-Citrix-AM-Storage header needs to be sent.\nResponse\nHTTP/1.1 200 OK\nContent-Type: application/vnd.citrix.authenticateresponse-1+xml\nX-Citrix-AM-Storage: FTU\nContent-Length: xxx\n?xml version=\"1.0\" encoding=\"UTF-8\"?>\nAuthenticateResponse xmlns=\"http://citrix.com/authentication/response/1\">\nStatus>success\n/Status>\nResult>more-info\n/Result>\nStateContext>f8d463c0\n/StateContext>\nAuthenticationRequirements>\nPostBack>Citrix/Authentication/CustomForms/SendForm\n/PostBack>\nCancelPostBack>Citrix/Authentication/CustomForms /CancelForm\n/CancelPostBack>\nCancelButtonText>Cancel\n/CancelButtonText>\nRequirements>\nRequirement>\nCredential>\nID>username\n/ID>\nType>username\n/Type>\n/Credential>\nLabel>\nText>User name:\n/Text>\nType>plain\n/Type>\n/Label>\nInput>\nText />\n/Input>\n/Requirement>\nRequirement>\nCredential>\nID>password\n/ID>\nType>password\n/Type>\n/Credential>\nLabel>\nText>Password:\n/Text>\nType>plain\n/Type>\n/Label>\nInput>\nText>\nSecret>true\n/Secret>\n/Text>\n/Input>\n/Requirement>\nRequirement>\nCredential>\nID>nextBtn\n/ID>\nType>none\n/Type>\n/Credential>\nLabel>\nType>none\n/Type>\n/Label>\nInput>\nButton>Sign On\n/Button>\n/Input>\n/Requirement>\n/Requirements>\n/AuthenticationRequirements>\n/AuthenticateResponse>\nThe authentication service sets\u00a0 a value for the first time.\nClient internal storage table\nOrigin service start URL\nStorage value\nhttps://example.com:443/Citrix/Authentication/CustomForms/Authenticate\nFTU\nThe client stores the value against the authentication service start URL\nPOST https://example.com/Citrix/Authentication/CustomForms/SendForm HTTP/1.1\nAccept: application/vnd.citrix.requesttokenresponse+xml,application/vnd.citrix.authenticateresponse-1+xml,text/xml\nContent-Type: application/x-www-form-urlencoded\nContent-Length: xxx\nX-Citrix-AM-Storage: FTU\nStateContext=f8d463c0\n=user\n=pass\n=Sign%20On\nThe client posts back credentials, also sending the latest storage value. Note that the URL for this request is different from the start URL.\nHTTP/1.1 200 OK\nContent-Type: application/vnd.citrix.requesttokenresponse+xml\nContent-Length: xxx\nX-Citrix-AM-Storage: FTUDone\n?xml version=\"1.0\" encoding=\"utf-8\"?>\nrequesttokenresponse xmlns=\"http://citrix.com/delivery-services/1-0/auth/requesttokenresponse\">\nfor-service>73003cf4-dc21-4bef-9138-af0ec600dba3\n/for-service>\nissued>2014-04-07T14:25:51.7525144Z\n/issued>\nexpiry>2014-04-08T10:25:51.7525144Z\n/expiry>\nlifetime>0.20:00:00\n/lifetime>\ntoken-template />\ntoken>H4sIAAAAAAAEAK1XaY+\u2026ANAAA=\n/token>\nCredentialUpdateInformationList xmlns=\"http://citrix.com/authentication/response/1\">\nCredentialUpdateInformation>\nCredentialDisplayName>user\n/CredentialDisplayName>\nAuthenticationInfoId>Citrix Common Forms 1.0\n/AuthenticationInfoId>\nCredentialUpdateService />\n/CredentialUpdateInformation>\n/CredentialUpdateInformationList>\n/requesttokenresponse>\nAuthentication completes successfully and the authentication service updates the storage value using the Request Token Response.\nClient internal storage table\nOrigin service start URL\nStorage value\nhttps://example.com:443/Citrix/Authentication/CustomForms/Authenticate\nFTUDone\nThe client stores the updated value against the authentication service forms start URL.\n\n\n\nClient Responses for Form Input\n\n\nGeneral User Agent Processing\n\n\nWhen the user submits a form (for example. by activating a logon button), the user agent on the client should process it as follows:\n\n\n1.Identify the \u201csuccessful\u201d controls.\n\n\n2.Build a form data set, which is a sequence of control-id=current-value pairs from successful controls separated by the \u2018\n\u2019 character. Any value containing a \u2018\n\u2019 character should be correctly encoded as %26.\n\n\n3.Encode the data set to comply with the application/x-www-form-urlencoded content type.\n\n\n4.POST the data to the host-relative URL specified by the supplied form.\n\n\nThe form contains a \n element at XPath: /AuthenticateResponse/StateContext. The text value of this element should be returned to the server in the form set data with control-id: StateContext.\n\n\nThe user agent should identify the button activated by adding the button controlId=localized-button-text to the data set to be returned.\n\n\nFinally the user agent should append to the data set the credential id and current value for all /AuthenticateResponse/AuthenticationRequirements/Requirements/Requirement elements where the following applies:\n\n\n\n\nThe ./Credential/ID element is present, and not empty.\n\n\nThe requirement is not read-only.\n\n\nThe ./Input element has a control associated with it.\n\n\n\n\nOnce the data set is complete it should be encoded as forms data as described at: http://www.w3.org/TR/html4/interact/forms.html#form-content-type and then sent to the server using a HTTP POST to the host relative URL specified by the /AuthenticateResponse/AuthenticationRequirements/PostBack element. The POST should also set the appropriate cookie header.\n\n\nNote to client implementors: Elements that are marked as read-only should not be returned to the server\n\n\nButtons\n\n\nWhere there are multiple buttons defined, only the button selected by the user should be sent in the form response in the form: \ncontrolId=localized-button-text\n\n\nConsider a form containing two buttons:\n\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\nbackButtonId\n/ID\n\n          \nType\nnone\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nType\nnone\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nButton\nBack\n/Button\n\n        \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\nnextButtonId\n/ID\n\n          \nType\nnone\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nType\nnone\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nButton\nNext\n/Button\n\n        \n/Input\n\n      \n/Requirement\n\n\n\n\nIf the Back button is selected, then the POST should contain the back button as follows:\n\n\nbackButtonId=Back\n\n\nHowever, if the Next button is selected, then the POST should contain the following:\n\nnextButtonId=Next\n\n\nText-Based Input\n\n\nFor text-based input, the text supplied by the user should be sent, appropriately encoded, in the form response in the form:  credentialID=user-supplied-text\n\n\nConsider the form containing the following text credential:\n\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\ntextId\n/ID\n\n          \nType\ntextcredential\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nGeneric text\n/Text\n\n          \nType\nplain\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nText\n\n            \nConstraint\n.+\n/Constraint\n\n          \n/Text\n\n        \n/Input\n\n      \n/Requirement\n\n\n\n\nThe following demonstrates the form response that should be returned for various text inputs:\n\n\n\n\ndomain\\user: textId=domain%5cuser\n\n\n\u00e1\u00e2\u00e4\u00e7\u00e8\u00e9: textId=%c3%a1%c3%a2%c3%a4%c3%a7%c3%a8%c3%a9\n\n\n: textId=\n\n\n\n\nCheck box\n\n\nFor check boxes, the value returned by the client should be true if the check box is selected and false if not.\n\n\nNote for client implementors: The true and false values are case-sensitive.\n\n\nConsider the form containing the following check box:\n\n\nRequirement\n\n  \nCredential\n\n    \nID\ncheckboxId\n/ID\n\n    \nType\nnone\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nDo you consent to this operation?\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nCheckBox\n\n      \nInitialValue\ntrue\n/InitialValue\n\n    \n/CheckBox\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nIf the checkbox is selected, then the POST should contain the following:\n\n\ncheckboxId=true\n\n\nIf the check box is not selected, then the POST should contain the following:\n\n\ncheckboxId=false\n\n\nSave Credentials Control\n\n\nBecause this has important semantic obligations for the client, there is a distinguished credential type to specify when the client can offer the user the option to save credentials. This allows the server to control whether the option is presented, and to specify the appropriate localized description.\n\n\nNotes for client implementors:\n\n\n\n\nOnly credentials with a SaveID tag are permitted to be saved.\n\n\nClients that don\u2019t support saving credentials should omit the requirement element from display.\n\n\n\n\nConsider the form containing the following save credentials check box.\n\n\nRequirement\n\n  \nCredential\n\n    \nID\nsaveCredentials\n/ID\n\n    \nType\nsavecredentials\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nRemember my password\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nCheckBox\n\n      \nInitialValue\nfalse\n/InitialValue\n\n    \n/CheckBox\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nIf the check box is selected, then the POST should contain the following, as for a normal check box defined above:\n\n\nsaveCredentials=true\n\n\nNotes for client implementors:\n\n\nClear Saved Credential\n\n\nIf during the authentication conversation the client receives a form with result code \u201cmore-info\u201d, which contains the SaveID of a credential that has already been submitted to the server, the client should infer that the credential was not valid. The client should immediately erase the saved credential set. Saved credentials should also be erased if a request to a StoreFront service URL results in a CitrixAuth challenge with reason: badpassword\n\n\nUpdate Saved Credential\n\n\nDuring an authentication conversation, the client may receive a form with result code \u201cupdate-credentials\u201d. This indicates that the user is updating a credential (for example changing a password). If the SaveID of the credential matches that of a saved credential, the new value of the credential should be saved if authentication succeeds.\n\n\nRadio Buttons\n\n\nFor radio buttons, individual items contain localized display text and a non-localized value. Radio buttons should return the value associated with the currently selected item.\n\n\nConsider the form containing the following radio buttons:\n\n\nRequirement\n\n  \nCredential\n\n    \nID\nradioButtonId\n/ID\n\n    \nType\ntextcredential\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nChoose one\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nRadioButton\n\n      \nInitialSelection\nChoice1\n/InitialSelection\n\n      \nDisplayValues\n\n        \nDisplayValue\n\n          \nDisplay\nChoice One Display Text\n/Display\n\n          \nValue\nChoice1\n/Value\n\n        \n/DisplayValue\n\n        \nDisplayValue\n\n          \nDisplay\nChoice Two Display Text\n/Display\n\n          \nValue\nChoice2\n/Value\n\n        \n/DisplayValue\n\n        \nDisplayValue\n\n          \nDisplay\nChoice Three Display Text\n/Display\n\n          \nValue\nChoice3\n/Value\n\n        \n/DisplayValue\n\n      \n/DisplayValues\n\n    \n/RadioButton\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nIf the second item (Display Text Two) is selected, then the POST should contain the following:\n\n\nradioButtonId=Choice2\n\n\nNote for client implementors: The initial selection element is optional; the client implementor must decide what to do if there is no initial value.\n\n\nNote for server implementors: It is acceptable for clients to indicate that there is no selection by returning:\n\n\nradioButtonId=\n\n\nCombo Boxes\n\n\nA combo box allows a single item to be selected. For combo boxes, individual items contain localized display text and a non-localized value. Combo boxes should return the value associated with the currently selected item.\n\n\nConsider the form containing the following combo box:\n\n\nRequirement\n\n  \nCredential\n\n    \nID\ncomboId\n/ID\n\n    \nType\ntextcredential\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nCombo-box\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nComboBox\n\n      \nInitialSelection\nValue2\n/InitialSelection\n\n      \nDisplayValues\n\n        \nDisplayValue\n\n          \nDisplay\nDisplay Text One\n/Display\n\n          \nValue\nValue1\n/Value\n\n        \n/DisplayValue\n\n        \nDisplayValue\n\n          \nDisplay\nDisplay Text Two\n/Display\n\n          \nValue\nValue2\n/Value\n\n        \n/DisplayValue\n\n        \nDisplayValue\n\n          \nDisplay\nDisplay Text Three\n/Display\n\n          \nValue\nValue3\n/Value\n\n        \n/DisplayValue\n\n      \n/DisplayValues\n\n    \n/ComboBox\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nIf the second item (Display Text Two) is selected, then the POST should contain the following:\n\n\ncomboId=Value2\n\n\nNote for client implementors:\n\n\n\n\nThe initial selection element is optional, and it is the client implementor\u2019s choice how this should be handled.\n\n\n\n\nNotes for server implementors:\n\n\n\n\nForm implementors should ensure that all display text items and values are unique and not empty.\n\n\nIt is acceptable for clients to indicate that there is no selection by returning: comboId=\n\n\nServers must be robust against invalid values being returned.\n\n\nIf the values are changed, it is suggested that any saved credential identifier is also changed to avoid the client sending back invalid saved credentials.\n\n\n\n\nMulti-Combo Boxes\n\n\nA multi-combo box allows multiple items to be selected. For multi-combo boxes, individual items contain localized display text, a non-localized value, and a flag indicating whether the item is selected. Multi-combo boxes should return an entry for each selected item of the form: itemID=value.\n\n\nConsider the form containing the following multi-combo box, where the second item is initially selected:\n\n\nRequirement\n\n  \nCredential\n\n    \nID\nmultiComboId\n/ID\n\n    \nType\ntextcredential\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nMulti-select Combo\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nMultiComboBox\n\n      \nDisplayValues\n\n        \nDisplayValue\n\n          \nDisplay\nAlice\n/Display\n\n          \nValue\nValue1\n/Value\n\n        \n/DisplayValue\n\n        \nDisplayValue\n\n          \nDisplay\nBob\n/Display\n\n          \nValue\nValue2\n/Value\n\n          \nSelect\ntrue\n/Select\n\n        \n/DisplayValue\n\n        \nDisplayValue\n\n          \nDisplay\nEve\n/Display\n\n          \nValue\nValue3\n/Value\n\n          \nSelect\nfalse\n/Select\n\n        \n/DisplayValue\n\n      \n/DisplayValues\n\n    \n/MultiComboBox\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nIf the second item and third items (Bob and Eve) are selected, then the POST should contain the following:\n\n\nmultiComboId=Value2\nmultiComboId=Value3\n\n\nIf no items are selected, then the POST should contain the following:\n\n\nmultiComboId=\n\n\nNote for client implementors:\n- It is acceptable for clients to only return selected values that are unique.\n\n\nNotes for server implementors:\n- Form implementors should ensure that all display text items and values are unique\n- Servers must be robust against invalid values being returned.\n- If the values are changed, it is suggested that any saved credential identifier is also changed to avoid the client sending back invalid saved credentials.\n- Multi-combo boxes are not suitable for user name or domain credentials.\n\n\nX509 Certificates\n\n\nA multi-combo box allows multiple items to be selected. For multi-combo boxes, individual items contain localized display text, a non-localized value, and a flag indicating whether the item is selected. Multi-combo boxes should return an entry for each selected item of the form: itemID=value.\n\n\nConsider the form containing the following multi-combo box, where the second item is initially selected:\n\n\nRequirement\n\n  \nCredential\n\n    \nID\nmultiComboId\n/ID\n\n    \nType\ntextcredential\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nMulti-select Combo\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nMultiComboBox\n\n      \nDisplayValues\n\n        \nDisplayValue\n\n          \nDisplay\nAlice\n/Display\n\n          \nValue\nValue1\n/Value\n\n        \n/DisplayValue\n\n        \nDisplayValue\n\n          \nDisplay\nBob\n/Display\n\n          \nValue\nValue2\n/Value\n\n          \nSelect\ntrue\n/Select\n\n        \n/DisplayValue\n\n        \nDisplayValue\n\n          \nDisplay\nEve\n/Display\n\n          \nValue\nValue3\n/Value\n\n          \nSelect\nfalse\n/Select\n\n        \n/DisplayValue\n\n      \n/DisplayValues\n\n    \n/MultiComboBox\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nIf the second item and third items (Bob and Eve) are selected, then the POST should contain the following:\n\n\nmultiComboId=Value2\nmultiComboId=Value3\n\n\nIf no items are selected, then the POST should contain the following:\n\n\nmultiComboId=", 
            "title": "Citrix Common Forms Authentication API"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#citrix-common-forms-authentication-api", 
            "text": "", 
            "title": "Citrix Common Forms Authentication API"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#introduction", 
            "text": "", 
            "title": "Introduction"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#scope", 
            "text": "The purpose of this document is to describe the StoreFront Common Forms Authentication Application Programming Interface.", 
            "title": "Scope"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#background", 
            "text": "Citrix has devised a common authentication protocol that is implemented by its next generation services and gateway platforms, referred to here as StoreFront Services and NetScaler Gateway. Citrix is implementing client support, in Receiver and Worx, for this common authentication protocol in native user agents for the major device platforms, notably Windows, Mac, iOS, Android, Linux, and in Receiver for Web for browser user agents. See StoreFront Token Services v2.0 [1] for more details.  An important part of the common authentication protocol is a generic forms language, designed to allow third parties to express a wide range of authentication forms using a set of user interface constructs that are similar to basic HTML forms; see RFC 1867 [http://www.ietf.org/rfc/rfc1867.txt] and 2388 [http://www.ietf.org/rfc/rfc2388.txt] for more details.  Third parties are able to extend the authentication methods supported by StoreFront Services and NetScaler Gateway by implementing server logic that emits and consumes the Common Forms language; see StoreFront Services Authentication SDK v2.6 [2] for more details.  The Common Forms protocol represents a secure conversation between the server and the user agent on the client, where forms are generated by the server, rendered by the useragent, completed by the user, and returned to the server by the user agent. Whilst the forms generated may be the same, the start and end of the conversations differ between StoreFront Service and NetScaler Gateway, representing their different needs.   The form generation and handling can be delegated from NetScaler Gateway to a StoreFront server by means of the Delegated Forms Authentication Protocol [3]. This allows a third party to create one customization that can be used in both StoreFront and NetScaler Gateway.  This document details the StoreFront Services v2.6 conversation, specifying the messages at the HTTP level.", 
            "title": "Background"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#references", 
            "text": "1.StoreFront Token Services v2.0  2.StoreFront Services Authentication SDK v2.6  3.Delegated Forms Authentication Protocol  4.Receiver Common Authentication Forms Language v2.6", 
            "title": "References"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#storefront-conversation", 
            "text": "For maximum interoperability, the protocol is a REST API, that is, XML forms transmitted over HTTPS. The flow of forms and responses constitutes a conversation that can have state associated with the overall conversation through the use of HTTP sessions.  The convesations require HTTP state management, as described by RFC 2109 [http://www.ietf.org/rfc/rfc2109.txt], in particular correct handling of cookies.  Note: In the following sections, the definition of HTTP headers uses the notation defined in RFC 2616 [http://tools.ietf.org/html/rfc2616].  Note to client implementors: Implementors of long-lived clients should ensure that the session cookie is cleared at the end of the conversation.  The conversation contains sensitive information, such as passwords, so confidentiality and integrity are required. The expectation is that SS/TLS will be used between the client and the server to both maintain confidentiality and also for server identification, to ensure that the user agent sends confidential information only to trusted servers.  For StoreFront, the conversation starts with a Request Security Token (RST) message [1] to an endpoint obtained from the client as part of the Protocol Choices message [1]. A successful conversation ends with a Request Security Token Response (RSTR) message [1]. The conversation can also end with a failure form, an HTTP status code other than 200, or a network failure.  For the rest of the conversation the server returns authentication forms described in Receiver Common Authentication Forms Language v2.0 [4].  Note to client implementors: Because a client does not know when a conversation will end, it should always set the HTTP Accept header to include both the Form and RSTR types.", 
            "title": "StoreFront Conversation"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#conversation-start", 
            "text": "URL: Usually obtained from the Protocol Choices data  HTTP Method: POST  Authentication: None  Request Content-Type: application/vnd.citrix.requesttoken+xml  Accept:  application/vnd.citrix.requesttokenresponse+xml,   application/vnd.citrix.authenticateresponse-1+xml     Because the conversation persists over several HTTP requests, the initial conversation start may include a Set-Cookie header. The usual HTTP semantics apply to this cookie, as described above. In addition, various aspects of the conversation are negotiated at the start of the conversation through the use of HTTP headers, as discussed below:  Credential Type Negotiation  The Common Forms Language [4] contains a \u201csoft\u201d enumeration for the credential types, which means that new credential types can be added without breaking the schema. The behavior of user agents is to reject forms with unknown credential types. Hence credential types need to be negotiated between the client and server using the following HTTP header:  credential-Types-Header =  X-Citrix-AM-CredentialTypes   :  field-value\nfield-value = *LWS credential-types-value *LWS\ncredential-types-value = 1#( credential-type-value )\ncredential-type-value = *TEXT  The credential types header is a comma-separated list of credential types that the client supports.  Example: \n       X-Citrix-AM-CredentialTypes: none, username, domain, password, newpassword,\n                                passcode, savecredentials, textcredential  New clients will use the above HTTP header to signal the credential types that are known in a comma-separated list. Older clients do not set this header, so if the header is missing then the following credential types will be assumed: none, username, domain, password, newpassword, passcode, savecredentials, textcredential.\nIf a client does not support a required credential type, then the behavior is defined by the form implementation on the server, which may choose to terminate the conversation, or supply a simplified form that the client can process.  Label Type Negotiation  The Common Forms Language [4] contains a \u201csoft\u201d enumeration for the label types, which means that new label types can be added without breaking the schema. Label types can be negotiated between the client and server using the following HTTP header:  label-Types-Header =  X-Citrix-AM-LabelTypes   :  field-value\nfield-value = *LWS label-types-value *LWS\nlabel-types-value = 1#( label-type )\nlabel-type = *TEXT  The label types header is a comma-separated list of label values that the client supports.  Example:          X-Citrix-AM-LabelTypes: none, plain, heading, information, warning,\n                           error, confirmation  New clients will use the above HTTP header to signal the label types that are known in a comma-separated list. Older clients do not set this header, so if the header is missing then the following label types shall be assumed: none, plain, heading, information, warning, error, confirmation.\nIf a client does not support a required label type, then the behavior is defined by the form implementation on the server, which may choose to terminate the conversation, or supply a simplified form that the client can process.\nNotes regarding images:   The default list of label types does not contain image. This is because none of the known legacy clients supported rendering images.  Images are intended for authentication purposes, such as captcha images, and are not intended for generic branding.  The image data supplied in the form is to be interpreted as a Data URI as defined by RFC 2397, [http://tools.ietf.org/html/rfc2397]   Language Negotiation  The textual data displayed in the form is defined by the StoreFront Server. In order to supply text in the appropriate language for the user, the server supports the standard HTTP language negotiation mechanism through the use of the Accept-Language header as described in RFC 2616 [http://tools.ietf.org/html/rfc2616].  Accept-Language-Header =  Accept-Language   :  field-value\nfield-value = *LWS accept-language-value *LWS\naccept-language-value = 1#( language-range [  ;   q   =  qvalue ] )\nlanguage-range  = ( ( 1*8ALPHA *(  -  1*8ALPHA ) ) |  *  )  The header value may include a comma-separated list of language ranges. Each language range may be given an associated quality value that represents an estimate of the user's preference for the languages specified by that range. The quality value defaults to \"q=1\"\nExample:         Accept-Language: da, en-gb;q=0.8, en;q=0.7  Should be interpreted as: \"I prefer Danish, but will accept British English and other types of English.\"  If a language cannot be negotiated, then a default language will be used, typically English.", 
            "title": "Conversation Start"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#client-response-to-a-form", 
            "text": "URL: Obtained from the current form  HTTP Method: POST  Authentication: None  Request Content-Type: application/x-www-form-urlencoded  Accept:  application/vnd.citrix.requesttokenresponse+xml,   application/vnd.citrix.authenticateresponse-1+xml     In response to a form the client will post back the requested information in the same format as for HTML forms [http://www.w3.org/TR/html401/interact/forms.html], and must be appropriately encoded.\nNote to server implementors: Existing clients may encode incorrectly, using \u2018%20\u2019 instead of \u2018+\u2019 to encode spaces, and may use UTF-8 encoding for extended multilingual characters that server implementations must be able to cope with.\nA detailed discussion of how to form the client response for each user input type is discussed in the section named: Client Responses for Form Input.", 
            "title": "Client Response to a Form"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#wire-level-example", 
            "text": "Form from StoreFront  HTTP/1.1 200 OK\nCache-Control: no-cache; private; no-store; must-revalidate; max-stale=0; post-check=0; pre-check=0; max-age=0\nPragma: no-cache\nContent-Type: application/vnd.citrix.authenticateresponse-1+xml; charset=utf-8\nExpires: Mon, 26 Jul 1997 05:00:00 GMT\nSet-Cookie: ASP.NET_SessionId=ixepmqu3dh1kxu30mv1una3y; path=/; HttpOnly\nDate: Mon, 07 Apr 2014 13:08:47 GMT\nContent-Length: 1552 ?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/response/1 \n   Status success /Status \n   Result more-info /Result \n   StateContext / \n   AuthenticationRequirements \n     PostBack /Citrix/Authentication/ExplicitForms /PostBack \n     CancelPostBack /Citrix/Authentication/ExplicitForms/Cancel /CancelPostBack \n     CancelButtonText Cancel /CancelButtonText \n     Requirements \n       Requirement \n         Credential \n           ID username /ID \n           SaveID ExplicitForms-Username /SaveID \n           Type username /Type \n         /Credential \n         Label \n           Text User name: /Text \n           Type plain /Type \n         /Label \n         Input \n           AssistiveText domain\\user or user@domain /AssistiveText     \n           Text \n             Secret false /Secret     \n             ReadOnly false /ReadOnly \n             InitialValue /InitialValue \n             Constraint .+ /Constraint \n           /Text \n         /Input \n       /Requirement \n       Requirement \n         Credential \n           ID password /ID \n           SaveID ExplicitForms-Password /SaveID \n           Type password /Type \n         /Credential \n         Label \n           Text Password: /Text \n           Type plain /Type \n         /Label \n         Input \n           Text Secret true /Secret \n             ReadOnly false /ReadOnly \n             InitialValue /InitialValue \n             Constraint .+ /Constraint \n           /Text \n         /Input \n       /Requirement \n       Requirement \n         Credential \n           ID saveCredentials /ID \n           Type savecredentials /Type \n         /Credential \n         Label \n           Text Remember my password /Text \n           Type plain /Type           \n         /Label \n         Input \n           CheckBox \n             InitialValue false /InitialValue \n           /CheckBox \n         /Input \n       /Requirement \n       Requirement \n         Credential \n           ID loginBtn /ID \n           Type none /Type \n         /Credential \n         Label \n           Type none /Type \n         /Label \n         Input \n           Button Log On /Button \n         /Input \n       /Requirement \n     /Requirements \n   /AuthenticationRequirements  /AuthenticateResponse  Client Request  POST https://storefront.local/Citrix/Authentication/ExplicitForms HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\nAccept: application/vnd.citrix.requesttokenresponse+xml, application/vnd.citrix.authenticateresponse-1+xml\nHost: storefront.local\nCookie: ASP.NET_SessionId=ixepmqu3dh1kxu30mv1una3y\nContent-Length: 83\nExpect: 100-continue\nStateContext= loginBtn=Log+On username=animaniacs%5ctestuser0 password=testuser saveCredentials=false", 
            "title": "Wire-level Example"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#conversation-cancel", 
            "text": "URL: Obtained from the current form  HTTP Method: POST  Authentication: None  Request Content-Type: application/x-www-form-urlencoded  Accept:  application/vnd.citrix.authenticateresponse-1+xml    Response Content-Type: application/vnd.citrix.authenticateresponse-1+xml   The client should POST the StateContext back to the server, to the Cancel Url obtained from the current form: e.g. to cancel the form above, the following should be POSTed:  StateContext=  Note to server implementors: The state associated with the conversation should be discarded on the server when a cancel message is received, and any attempt to re-use the existing Http session state should result in a failure form.  Notes to client implementors:   Implementors of long-lived clients should ensure that the session cookie is cleared after the conversation has been cancelled.  The assumption is that forms shall normally have a cancel button, positioned in the natural location for each client platform, relative to the other buttons. However, the cancel button should only be shown if the element is present at: /AuthenticateResponse/AuthenticationRequirements/CancelButtonText in the supplied form.", 
            "title": "Conversation Cancel"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#wire-level-example_1", 
            "text": "Cancel Request from Client  POST https://storefront.local/Citrix/Authentication/ExplicitForms/Cancel HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\nAccept: application/vnd.citrix.authenticateresponse-1+xml\nHost: storefront.local\nCookie: ASP.NET_SessionId=ixepmqu3dh1kxu30mv1una3y\nContent-Length: 14\n\nStateContext=  Response from StoreFront  HTTP/1.1 200 OK\nCache-Control: no-cache; private; no-store; must-revalidate; max-stale=0; post-check=0; pre-check=0; max-age=0\nPragma: no-cache\nContent-Type: application/vnd.citrix.authenticateresponse-1+xml; charset=utf-8\nExpires: Mon, 26 Jul 1997 05:00:00 GMT\nServer: Microsoft-IIS/8.0\nDate: Mon, 07 Apr 2014 14:33:50 GMT\nContent-Length: 201 ?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/response/1 \n   Status success /Status \n   Result cancelled /Result \n   StateContext /  /AuthenticateResponse", 
            "title": "Wire-level Example"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#conversation-end", 
            "text": "URL: Obtained from the current form  HTTP Method: POST  Authentication: None  Request Content-Type: application/x-www-form-urlencoded  Accept:  application/vnd.citrix.requesttokenresponse+xml,   application/vnd.citrix.authenticateresponse-1+xml    Response Content-Type: application/vnd.citrix.requesttokenresponse+xml   Note to server implementors: The state associated with the conversation should be discarded on the server when the RSTR message has been sent, and any attempt to re-use the existing HTTP session state should result in a failure form.  Note to client implementors: Implementors of long-lived clients should ensure that the session cookie is cleared after the conversation has been completed.", 
            "title": "Conversation End"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#wire-level-example_2", 
            "text": "Authentication Request from Client  POST https://storefront.local/Citrix/Authentication/ExplicitForms HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\nAccept: application/vnd.citrix.requesttokenresponse+xml, application/vnd.citrix.authenticateresponse-1+xml\nHost: storefront.local\nCookie: ASP.NET_SessionId=ixepmqu3dh1kxu30mv1una3y\nContent-Length: 83\nExpect: 100-continue\n\nStateContext= loginBtn=Log+On username=animaniacs%5ctestuser0 password=testuser saveCredentials=false  Response from StoreFront  HTTP/1.1 200 OK\nCache-Control: no-cache; private; no-store; must-revalidate; max-stale=0; post-check=0; pre-check=0; max-age=0\nPragma: no-cache\nContent-Type: application/vnd.citrix.requesttokenresponse+xml\nExpires: Mon, 26 Jul 1997 05:00:00 GMT\nServer: Microsoft-IIS/8.0\nDate: Mon, 07 Apr 2014 14:25:52 GMT\nContent-Length: 3408 ?xml version= 1.0  encoding= utf-8 ?  requesttokenresponse xmlns= http://citrix.com/delivery-services/1-0/auth/requesttokenresponse \n   for-service 73003cf4-dc21-4bef-9138-af0ec600dba3 /for-service \n   issued 2014-04-07T14:25:51.7525144Z /issued \n   expiry 2014-04-08T10:25:51.7525144Z /expiry \n   lifetime 0.20:00:00 /lifetime \n   token-template / \n   token H4sIAAAAAAAEAK1XaY+\u2026ANAAA= /token \n   CredentialUpdateInformationList xmlns= http://citrix.com/authentication/response/1 \n     CredentialUpdateInformation \n       CredentialDisplayName animaniacs /CredentialDisplayName \n       AuthenticationInfoId Citrix Common Forms 1.0 /AuthenticationInfoId \n       CredentialUpdateService / \n     /CredentialUpdateInformation \n   /CredentialUpdateInformationList  /requesttokenresponse", 
            "title": "Wire-level Example"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#client-persistent-storage", 
            "text": "Client persistent storage is needed by third parties using the Citrix Authentication SDK to implement authentication methods that currently rely on persistent browser cookies, e.g. for assigning a unique ID to user agents.  An authentication service specifies a value for the client to store by sending a header during a forms authentication conversation. Given a value to store, the client adds the same header to all further requests in the current and subsequent Common Forms authentication conversations with that authentication service.", 
            "title": "Client Persistent Storage"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#header-syntax-and-semantics", 
            "text": "The same header, defined below, is used in both HTTP requests and responses.  Storage-Header =  X-Citrix-AM-Storage   :  field-value\nfield-value = *LWS storage-value *LWS\nstorage-value = *TEXT  The header value may include leading and trailing whitespace, which should be ignored, and the storage value is a plain text string. The storage value may be omitted entirely, leaving a header with an empty value.  Each X-Citrix-AM-Storage header represents a value stored by the user agent on behalf of the specific authentication service. Each authentication service may store only one value, but a client that interacts with multiple authentication services must be able store one value for each service. An authentication service is identified by the start URL of a forms conversation, including scheme, hostname, port number and path, but excluding query strings and fragments. The URLs of subsequent requests in a forms auth conversation are likely to differ from the start URL so clients must be careful not to simply use the current request URL in making decisions about storage.  Clients must compare URLs in accordance with the URI comparison rules defined in RFC 2616 [http://tools.ietf.org/html/rfc2616].   Note: a client may authenticate against a third party authentication service through Delegated Forms Authentication using different start URLs, for example one URL for NetScaler Gateway and one URL for StoreFront. In this case the third authentication service will end up setting two storage values on the client. This is conceptually not ideal but it should be sufficient because the main goal is parity with HTTP cookie-based authentication methods.  The X-Citrix-AM-Storage header is only valid during a forms-based authentication conversation. Clients should not update storage or send a storage value outside the authentication conversation. Clients should update the storage value if the header is received on any valid forms response during the conversation, including: failure forms (for example a \u2018fail\u2019 or \u2018cancel\u2019 result, or failure status) and Request Token Responses.\nThere is no mechanism for a client to advertise that it supports persistent storage, other than by returning a previously stored value.  Notes to server implementors:\n- It is the server implementor\u2019s responsibility to appropriately protect the data stored on the client, for example using HMACs if data origin and integrity are important, or encryption if privacy is also required.\n- The maximum size of the storage header on an HTTP response is 5016 bytes, including the header name and whitespace around the value.  Note to client implementors: Clients should treat a storage value as an opaque string and should not attempt to interpret the value. The content of a storage value is meaningful only to the originating server.", 
            "title": "Header syntax and semantics"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#server-to-client-http-responses", 
            "text": "An X-Citrix-AM-Storage header on a response is a directive for the client to persistently and securely store the value on behalf of the sending authentication service. Clients should store the received value immediately and not wait until the end of the authentication conversation, such that if an authentication attempt is abandoned the client will be able to send the last seen value on starting the next authentication attempt.  If the X-Citrix-AM-Storage response header has an empty value, then clients should delete the storage value for the sending authentication service; subsequently clients do not need to send the empty X-Citrix-AM-Storage header.  If a forms response does not include an X-Citrix-AM-Storage header, clients must assume that there is no change required, and must keep the current storage value unchanged, and continue to send the last seen value.  If the response is not a valid forms response or is otherwise not understood by the client, the client must ignore any X-Citrix-AM-Storage header and not update the storage value.  Servers should not include more than one X-Citrix-AM-Storage header in the same response. If multiple storage headers are received, clients should process the first one only.  Storage values do not have an explicit or implicit expiry date and potentially may be retained indefinitely. However, clients should delete all stored values if the user uninstalls or otherwise resets the client software, for example using the \u201cReset\u201d feature in Receiver.", 
            "title": "Server-to-Client HTTP Responses"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#client-to-server-http-requests", 
            "text": "If an authentication service has previously set a storage value on the client, the client must send the value to the authentication service using the X-Citrix-AM-Storage header on every request during a forms authentication attempt, starting with the request for the initial form.  Clients may omit the header if they have no value stored for the authentication service.", 
            "title": "Client-to-Server HTTP Requests"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#wire-example", 
            "text": "Message Commentary Client internal storage table Origin service start URL Storage value none> A first time use scenario, so there are, no stored values. Request POST https://example.com/Citrix/Authentication/CustomForms/Authenticate HTTP/1.1 Content-Type: application/vnd.citrix.requesttoken+xml Accept: application/vnd.citrix.requesttokenresponse+xml,application/vnd.citrix.authenticateresponse-1+xml,text/xml Content-Length: xxx ?xml version=\"1.0\"?> requesttoken xmlns=\"http://citrix.com/delivery-services/1-0/auth/requesttoken\"> for-service>32a290eb-7521-cd92-1394-475927c3a239 /for-service> for-service-url>https:// example.com /Citrix/Authentication/auth/v1/token /for-service-url> reqtokentemplate> /reqtokentemplate> requested-lifetime>0.08:00:00 /requested-lifetime> /requesttoken> There\u2019s no stored value, so no o X-Citrix-AM-Storage header needs to be sent. Response HTTP/1.1 200 OK Content-Type: application/vnd.citrix.authenticateresponse-1+xml X-Citrix-AM-Storage: FTU Content-Length: xxx ?xml version=\"1.0\" encoding=\"UTF-8\"?> AuthenticateResponse xmlns=\"http://citrix.com/authentication/response/1\"> Status>success /Status> Result>more-info /Result> StateContext>f8d463c0 /StateContext> AuthenticationRequirements> PostBack>Citrix/Authentication/CustomForms/SendForm /PostBack> CancelPostBack>Citrix/Authentication/CustomForms /CancelForm /CancelPostBack> CancelButtonText>Cancel /CancelButtonText> Requirements> Requirement> Credential> ID>username /ID> Type>username /Type> /Credential> Label> Text>User name: /Text> Type>plain /Type> /Label> Input> Text /> /Input> /Requirement> Requirement> Credential> ID>password /ID> Type>password /Type> /Credential> Label> Text>Password: /Text> Type>plain /Type> /Label> Input> Text> Secret>true /Secret> /Text> /Input> /Requirement> Requirement> Credential> ID>nextBtn /ID> Type>none /Type> /Credential> Label> Type>none /Type> /Label> Input> Button>Sign On /Button> /Input> /Requirement> /Requirements> /AuthenticationRequirements> /AuthenticateResponse> The authentication service sets\u00a0 a value for the first time. Client internal storage table Origin service start URL Storage value https://example.com:443/Citrix/Authentication/CustomForms/Authenticate FTU The client stores the value against the authentication service start URL POST https://example.com/Citrix/Authentication/CustomForms/SendForm HTTP/1.1 Accept: application/vnd.citrix.requesttokenresponse+xml,application/vnd.citrix.authenticateresponse-1+xml,text/xml Content-Type: application/x-www-form-urlencoded Content-Length: xxx X-Citrix-AM-Storage: FTU StateContext=f8d463c0 =user =pass =Sign%20On The client posts back credentials, also sending the latest storage value. Note that the URL for this request is different from the start URL. HTTP/1.1 200 OK Content-Type: application/vnd.citrix.requesttokenresponse+xml Content-Length: xxx X-Citrix-AM-Storage: FTUDone ?xml version=\"1.0\" encoding=\"utf-8\"?> requesttokenresponse xmlns=\"http://citrix.com/delivery-services/1-0/auth/requesttokenresponse\"> for-service>73003cf4-dc21-4bef-9138-af0ec600dba3 /for-service> issued>2014-04-07T14:25:51.7525144Z /issued> expiry>2014-04-08T10:25:51.7525144Z /expiry> lifetime>0.20:00:00 /lifetime> token-template /> token>H4sIAAAAAAAEAK1XaY+\u2026ANAAA= /token> CredentialUpdateInformationList xmlns=\"http://citrix.com/authentication/response/1\"> CredentialUpdateInformation> CredentialDisplayName>user /CredentialDisplayName> AuthenticationInfoId>Citrix Common Forms 1.0 /AuthenticationInfoId> CredentialUpdateService /> /CredentialUpdateInformation> /CredentialUpdateInformationList> /requesttokenresponse> Authentication completes successfully and the authentication service updates the storage value using the Request Token Response. Client internal storage table Origin service start URL Storage value https://example.com:443/Citrix/Authentication/CustomForms/Authenticate FTUDone The client stores the updated value against the authentication service forms start URL.", 
            "title": "Wire Example"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#client-responses-for-form-input", 
            "text": "", 
            "title": "Client Responses for Form Input"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#general-user-agent-processing", 
            "text": "When the user submits a form (for example. by activating a logon button), the user agent on the client should process it as follows:  1.Identify the \u201csuccessful\u201d controls.  2.Build a form data set, which is a sequence of control-id=current-value pairs from successful controls separated by the \u2018 \u2019 character. Any value containing a \u2018 \u2019 character should be correctly encoded as %26.  3.Encode the data set to comply with the application/x-www-form-urlencoded content type.  4.POST the data to the host-relative URL specified by the supplied form.  The form contains a   element at XPath: /AuthenticateResponse/StateContext. The text value of this element should be returned to the server in the form set data with control-id: StateContext.  The user agent should identify the button activated by adding the button controlId=localized-button-text to the data set to be returned.  Finally the user agent should append to the data set the credential id and current value for all /AuthenticateResponse/AuthenticationRequirements/Requirements/Requirement elements where the following applies:   The ./Credential/ID element is present, and not empty.  The requirement is not read-only.  The ./Input element has a control associated with it.   Once the data set is complete it should be encoded as forms data as described at: http://www.w3.org/TR/html4/interact/forms.html#form-content-type and then sent to the server using a HTTP POST to the host relative URL specified by the /AuthenticateResponse/AuthenticationRequirements/PostBack element. The POST should also set the appropriate cookie header.  Note to client implementors: Elements that are marked as read-only should not be returned to the server", 
            "title": "General User Agent Processing"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#buttons", 
            "text": "Where there are multiple buttons defined, only the button selected by the user should be sent in the form response in the form:  controlId=localized-button-text  Consider a form containing two buttons:         Requirement \n         Credential \n           ID backButtonId /ID \n           Type none /Type \n         /Credential \n         Label \n           Type none /Type \n         /Label \n         Input \n           Button Back /Button \n         /Input \n       /Requirement \n       Requirement \n         Credential \n           ID nextButtonId /ID \n           Type none /Type \n         /Credential \n         Label \n           Type none /Type \n         /Label \n         Input \n           Button Next /Button \n         /Input \n       /Requirement  If the Back button is selected, then the POST should contain the back button as follows:  backButtonId=Back  However, if the Next button is selected, then the POST should contain the following: nextButtonId=Next", 
            "title": "Buttons"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#text-based-input", 
            "text": "For text-based input, the text supplied by the user should be sent, appropriately encoded, in the form response in the form:  credentialID=user-supplied-text  Consider the form containing the following text credential:         Requirement \n         Credential \n           ID textId /ID \n           Type textcredential /Type \n         /Credential \n         Label \n           Text Generic text /Text \n           Type plain /Type \n         /Label \n         Input \n           Text \n             Constraint .+ /Constraint \n           /Text \n         /Input \n       /Requirement  The following demonstrates the form response that should be returned for various text inputs:   domain\\user: textId=domain%5cuser  \u00e1\u00e2\u00e4\u00e7\u00e8\u00e9: textId=%c3%a1%c3%a2%c3%a4%c3%a7%c3%a8%c3%a9  : textId=", 
            "title": "Text-Based Input"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#check-box", 
            "text": "For check boxes, the value returned by the client should be true if the check box is selected and false if not.  Note for client implementors: The true and false values are case-sensitive.  Consider the form containing the following check box:  Requirement \n   Credential \n     ID checkboxId /ID \n     Type none /Type \n   /Credential \n   Label \n     Text Do you consent to this operation? /Text \n     Type plain /Type \n   /Label \n   Input \n     CheckBox \n       InitialValue true /InitialValue \n     /CheckBox \n   /Input  /Requirement  If the checkbox is selected, then the POST should contain the following:  checkboxId=true  If the check box is not selected, then the POST should contain the following:  checkboxId=false", 
            "title": "Check box"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#save-credentials-control", 
            "text": "Because this has important semantic obligations for the client, there is a distinguished credential type to specify when the client can offer the user the option to save credentials. This allows the server to control whether the option is presented, and to specify the appropriate localized description.  Notes for client implementors:   Only credentials with a SaveID tag are permitted to be saved.  Clients that don\u2019t support saving credentials should omit the requirement element from display.   Consider the form containing the following save credentials check box.  Requirement \n   Credential \n     ID saveCredentials /ID \n     Type savecredentials /Type \n   /Credential \n   Label \n     Text Remember my password /Text \n     Type plain /Type \n   /Label \n   Input \n     CheckBox \n       InitialValue false /InitialValue \n     /CheckBox \n   /Input  /Requirement  If the check box is selected, then the POST should contain the following, as for a normal check box defined above:  saveCredentials=true  Notes for client implementors:", 
            "title": "Save Credentials Control"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#clear-saved-credential", 
            "text": "If during the authentication conversation the client receives a form with result code \u201cmore-info\u201d, which contains the SaveID of a credential that has already been submitted to the server, the client should infer that the credential was not valid. The client should immediately erase the saved credential set. Saved credentials should also be erased if a request to a StoreFront service URL results in a CitrixAuth challenge with reason: badpassword", 
            "title": "Clear Saved Credential"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#update-saved-credential", 
            "text": "During an authentication conversation, the client may receive a form with result code \u201cupdate-credentials\u201d. This indicates that the user is updating a credential (for example changing a password). If the SaveID of the credential matches that of a saved credential, the new value of the credential should be saved if authentication succeeds.", 
            "title": "Update Saved Credential"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#radio-buttons", 
            "text": "For radio buttons, individual items contain localized display text and a non-localized value. Radio buttons should return the value associated with the currently selected item.  Consider the form containing the following radio buttons:  Requirement \n   Credential \n     ID radioButtonId /ID \n     Type textcredential /Type \n   /Credential \n   Label \n     Text Choose one /Text \n     Type plain /Type \n   /Label \n   Input \n     RadioButton \n       InitialSelection Choice1 /InitialSelection \n       DisplayValues \n         DisplayValue \n           Display Choice One Display Text /Display \n           Value Choice1 /Value \n         /DisplayValue \n         DisplayValue \n           Display Choice Two Display Text /Display \n           Value Choice2 /Value \n         /DisplayValue \n         DisplayValue \n           Display Choice Three Display Text /Display \n           Value Choice3 /Value \n         /DisplayValue \n       /DisplayValues \n     /RadioButton \n   /Input  /Requirement  If the second item (Display Text Two) is selected, then the POST should contain the following:  radioButtonId=Choice2  Note for client implementors: The initial selection element is optional; the client implementor must decide what to do if there is no initial value.  Note for server implementors: It is acceptable for clients to indicate that there is no selection by returning:  radioButtonId=", 
            "title": "Radio Buttons"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#combo-boxes", 
            "text": "A combo box allows a single item to be selected. For combo boxes, individual items contain localized display text and a non-localized value. Combo boxes should return the value associated with the currently selected item.  Consider the form containing the following combo box:  Requirement \n   Credential \n     ID comboId /ID \n     Type textcredential /Type \n   /Credential \n   Label \n     Text Combo-box /Text \n     Type plain /Type \n   /Label \n   Input \n     ComboBox \n       InitialSelection Value2 /InitialSelection \n       DisplayValues \n         DisplayValue \n           Display Display Text One /Display \n           Value Value1 /Value \n         /DisplayValue \n         DisplayValue \n           Display Display Text Two /Display \n           Value Value2 /Value \n         /DisplayValue \n         DisplayValue \n           Display Display Text Three /Display \n           Value Value3 /Value \n         /DisplayValue \n       /DisplayValues \n     /ComboBox \n   /Input  /Requirement  If the second item (Display Text Two) is selected, then the POST should contain the following:  comboId=Value2  Note for client implementors:   The initial selection element is optional, and it is the client implementor\u2019s choice how this should be handled.   Notes for server implementors:   Form implementors should ensure that all display text items and values are unique and not empty.  It is acceptable for clients to indicate that there is no selection by returning: comboId=  Servers must be robust against invalid values being returned.  If the values are changed, it is suggested that any saved credential identifier is also changed to avoid the client sending back invalid saved credentials.", 
            "title": "Combo Boxes"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#multi-combo-boxes", 
            "text": "A multi-combo box allows multiple items to be selected. For multi-combo boxes, individual items contain localized display text, a non-localized value, and a flag indicating whether the item is selected. Multi-combo boxes should return an entry for each selected item of the form: itemID=value.  Consider the form containing the following multi-combo box, where the second item is initially selected:  Requirement \n   Credential \n     ID multiComboId /ID \n     Type textcredential /Type \n   /Credential \n   Label \n     Text Multi-select Combo /Text \n     Type plain /Type \n   /Label \n   Input \n     MultiComboBox \n       DisplayValues \n         DisplayValue \n           Display Alice /Display \n           Value Value1 /Value \n         /DisplayValue \n         DisplayValue \n           Display Bob /Display \n           Value Value2 /Value \n           Select true /Select \n         /DisplayValue \n         DisplayValue \n           Display Eve /Display \n           Value Value3 /Value \n           Select false /Select \n         /DisplayValue \n       /DisplayValues \n     /MultiComboBox \n   /Input  /Requirement  If the second item and third items (Bob and Eve) are selected, then the POST should contain the following:  multiComboId=Value2 multiComboId=Value3  If no items are selected, then the POST should contain the following:  multiComboId=  Note for client implementors:\n- It is acceptable for clients to only return selected values that are unique.  Notes for server implementors:\n- Form implementors should ensure that all display text items and values are unique\n- Servers must be robust against invalid values being returned.\n- If the values are changed, it is suggested that any saved credential identifier is also changed to avoid the client sending back invalid saved credentials.\n- Multi-combo boxes are not suitable for user name or domain credentials.", 
            "title": "Multi-Combo Boxes"
        }, 
        {
            "location": "/citrix-common-forms-authentication-api/#x509-certificates", 
            "text": "A multi-combo box allows multiple items to be selected. For multi-combo boxes, individual items contain localized display text, a non-localized value, and a flag indicating whether the item is selected. Multi-combo boxes should return an entry for each selected item of the form: itemID=value.  Consider the form containing the following multi-combo box, where the second item is initially selected:  Requirement \n   Credential \n     ID multiComboId /ID \n     Type textcredential /Type \n   /Credential \n   Label \n     Text Multi-select Combo /Text \n     Type plain /Type \n   /Label \n   Input \n     MultiComboBox \n       DisplayValues \n         DisplayValue \n           Display Alice /Display \n           Value Value1 /Value \n         /DisplayValue \n         DisplayValue \n           Display Bob /Display \n           Value Value2 /Value \n           Select true /Select \n         /DisplayValue \n         DisplayValue \n           Display Eve /Display \n           Value Value3 /Value \n           Select false /Select \n         /DisplayValue \n       /DisplayValues \n     /MultiComboBox \n   /Input  /Requirement  If the second item and third items (Bob and Eve) are selected, then the POST should contain the following:  multiComboId=Value2 multiComboId=Value3  If no items are selected, then the POST should contain the following:  multiComboId=", 
            "title": "X509 Certificates"
        }, 
        {
            "location": "/citrixauth-authentication-scheme/", 
            "text": "Relying Party Authentication\n\n\nScope\n\n\nThe purpose of this document is to describe the CitrixAuth authentication scheme used by the StoreFront Services Relying Parties to obtain user identity information.\n\n\nCitrixAuth Scheme\n\n\nThis section defines an RFC2617 [1] extension to support authentication to StoreFront Services Relying Parties, such as the resources service. The extension auth-scheme is CitrixAuth and is case-sensitive. It uses the standard HTTP Authorization and WWW-Authenticate HTTP headers as defined in RFC2617.\n\n\nThe headers have the following formats, in conformance with RFC2617:\n\n\nAuthorization: CitrixAuth {security-token}\n\n\nIf no valid Authorization header for the CitrixAuth scheme is found for the realm of the service it is sent to, then a challenge shall be issued as follows:\n\n\nWWW-Authenticate: CitrixAuth realm=\n{service-id}\n , reqtokentemplate=\n{template}\n, \n                             reason=\n{reason-description}\n,locations=\n{url-list}\n,\n                             serviceroot-hint=\u201d{service-root}\u201d\n\n\n\n\nThe parameters are defined by the following:\n\n\n\n\n\n\n\n\nParameter\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\n{service-id}\n\n\nThe unique identifier of the consuming service. With the hostname of the service being accessed it defines a Protection Space as per RFC2617 section 1.2\n\n\n\n\n\n\n{security-token}\n\n\nThe serialized security token used to authenticate the user\n\n\n\n\n\n\n{template}\n\n\nThis is a string that shall be passed by the client to the server when requesting a token for a specific service. The server can use this value to determine the token format to use. This value should be empty for current implementations, but must still be passed to the server.\n\n\n\n\n\n\n{reason-description}\n\n\nThe reason why a challenge has been issued. This is to assist the client with managing cached tokens.\n\n\n\n\n\n\n{url-list}\n\n\nAn ordered list of URLs separated by the \u2018\n\n\n\n\n\n\n{serviceroot}\n\n\nA hint for the client as to the root URL for the protection space associated with the current request. This simplifies the client decision-making regarding sending cached tokens to respond to the challenge.\n\n\n\n\n\n\n\n\nThe reason-description may be one of the following values:\n\n\n\n\nnotoken: No authentication token was supplied.\n\n\nexpired: The supplied token is no longer valid.\n\n\nnotforthisservice: The token is valid, but was not issued for the service trying to consume it.\n\n\nnottrusted: A valid token has been issued by a service that the consumer does not trust.\n\n\ninvalidtoken: The token extracted from the Authorization header was invalid, for example it may be badly formed.\n\n\npasswordClaimNotFound: A required password claim was not found.\n\n\nbadpassword: For a password-based token, the password has been changed or has expired since the token was issued and is no longer valid.\n\n\nbadaccount: The account associated with the subject was invalid, for example it may be locked out.\n\n\ninvalidAudience: The original token was not requested for a valid audience (see below).\n\n\ntokenSignatureNotVerified: The signature of the token could not be verified.\n\n\nwrongclaims: The token does not contain the required claims.\n\n\ngatewayclaimsinconsistent: The gateway identified in the supplied token does not match the gateway discovered by the relying party.\n\n\n\n\nProtection Space\n\n\nRFC2617 section 1.2 defines a Protection Space as the domain over which credentials can be automatically applied. If a prior request has been authorized, the same credentials may be reused for all other requests within that protection space for a period of time determined by the authentication scheme, parameters, and/or user preference. The CitrixAuth scheme is consistent with other schemes in that a single protection space cannot extend outside the scope of its server. The CitrixAuth scheme uses both the service-id (Realm) and the audience to which the request is to be sent, to define a protection space, and the client should not automatically send credentials to services outside of the protection space defined for a particular credential. In this context, the audience is defined by the scheme, host name, and port associated with the original request.\nThe serviceroot-hint in the challenge provides the client with the root of the protection space for the current request. This enables a better caching strategy in the client, if the initial request is not to the root of the protection space.\n\n\nExample\n\n\nThe following illustrates a CitrixAuth challenge and response:\n\n\nRequest to the Relying Party\n\n\nGET https://www.example.com/Citrix/Store/resources/v2/T2VvUndOMEZMM1VBK2NpYzY4PQ--/image/16 HTTP/1.1\nHost: www.example.com\nAccept: image/png\n\n\n\n\nResponse from the Relying Party\n\n\nHTTP/1.1 401 Unauthorized\nWWW-Authenticate: CitrixAuth realm=\n6b78ab94-a709-4e3a-8b9b-a49ca317c70c\n,\n                             reqtokentemplate=\n, reason=\nnotoken\n, \n                             locations=\nhttps://www.example.com/Citrix/Authentication/auth/v1/token\n,\n                             serviceroot-hint=\nhttps://www.example.com/Citrix/Store2/resources/v2\n\n\n\n\nThe client uses the information in the challenge to obtain an appropriate security token for the Service Provider, and then resends the original request with an attached Authorization header, as follows:\n\n\nGET https://www.example.com/Citrix/Store/resources/v2/T2VvUndOMEZMM1VBK2NpYzY4PQ--/image/16 HTTP/1.1\nHost: www.example.com\nAccept: image/png\nAuthorization: CitrixAuth H4sIAAAAAAAEAO29B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMk2JBAEOzBiM3mku\u2026\n\n\n\n\nResponse from the Relying Party\n\n\nHTTP/1.1 200 OK\nContent-Type: image/png\nCache-Control: public, no-store, max-age=0\nContent-Length: 773\n\n\nbinary data\n\n\n\n\nClient Processing of a Challenge\n\n\nWhen a client receives a CitrixAuth challenge, it must respond by sending a Request Security Token message to the location specified in the challenge. For more information on the Request Security Token message see the StoreFront Security Token Services API document [2].\nConsider the following example. The client has tried to access the URL: https://storefront.enterprise.com/Citrix/Store/resources/v2/launch\nand received the following challenge:\n\n\nWWW-Authenticate: CitrixAuth realm=\nd5c937a6-a09d-4805-adbb-ff92208f7466\n,\n               reqtokentemplate=\n, reason=\nnotoken\n,\n               locations=\nhttps://storefront.enterprise.com/Citrix/Authentication/auth/v1/token\n\n               serviceroot-hint=\nhttps://storefront.enterprise.com/Citrix/Store/resources/v2\n\n\n\n\nThe client should respond by sending the following message to the location specified in the challenge, that is https://storefront.enterprise.com/Citrix/Authentication/auth/v1/token.\n\n\nPOST /Citrix/Authentication/auth/v1/token HTTP/1.1\nContent-Type: application/vnd.citrix.requesttoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml, application/vnd.citrix.requesttokenchoices+xml\nContent-Encoding: utf-8\nHost: storefront.enterprise.com\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n ?\n\n\nrequesttoken xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/requesttoken\n\n    \nfor-service\nd5c937a6-a09d-4805-adbb-ff92208f7466\n/for-service\n\n    \nfor-service-url\n\n      https://storefront.enterprise.com/Citrix/Store/resources/v2/launch\n    \n/for-service-url\n\n    \nreqtokentemplate\n/reqtokentemplate\n\n    \nrequested-lifetime\n01:00:00\n/requested-lifetime\n\n\n/requesttoken\n\n\n\n\n\n\nNotes\n\n\n1.The request is sent to the value specified by the locations part of the challenge. \n\n\n2.The \n element value is extracted from the realm value of the challenge.\n\n\n3.The \n element value is extracted from the reqtokentemplate value of the challenge. For current versions this is always empty.\n\n\n4.The \n element value should be the URL that the client originally called. This should NOT be the value of the serviceroot-hint from the challenge.\n\n\n\n\nReferences\n\n\n[1] HTTP Authentication: Basic and Digest Access Authentication: http://www.ietf.org/rfc/rfc2617.txt \n\n\n[2] StoreFront Security Token Services API v2.0", 
            "title": "CitrixAuth Authentication Scheme"
        }, 
        {
            "location": "/citrixauth-authentication-scheme/#relying-party-authentication", 
            "text": "", 
            "title": "Relying Party Authentication"
        }, 
        {
            "location": "/citrixauth-authentication-scheme/#scope", 
            "text": "The purpose of this document is to describe the CitrixAuth authentication scheme used by the StoreFront Services Relying Parties to obtain user identity information.", 
            "title": "Scope"
        }, 
        {
            "location": "/citrixauth-authentication-scheme/#citrixauth-scheme", 
            "text": "This section defines an RFC2617 [1] extension to support authentication to StoreFront Services Relying Parties, such as the resources service. The extension auth-scheme is CitrixAuth and is case-sensitive. It uses the standard HTTP Authorization and WWW-Authenticate HTTP headers as defined in RFC2617.  The headers have the following formats, in conformance with RFC2617:  Authorization: CitrixAuth {security-token}  If no valid Authorization header for the CitrixAuth scheme is found for the realm of the service it is sent to, then a challenge shall be issued as follows:  WWW-Authenticate: CitrixAuth realm= {service-id}  , reqtokentemplate= {template} , \n                             reason= {reason-description} ,locations= {url-list} ,\n                             serviceroot-hint=\u201d{service-root}\u201d  The parameters are defined by the following:     Parameter  Description      {service-id}  The unique identifier of the consuming service. With the hostname of the service being accessed it defines a Protection Space as per RFC2617 section 1.2    {security-token}  The serialized security token used to authenticate the user    {template}  This is a string that shall be passed by the client to the server when requesting a token for a specific service. The server can use this value to determine the token format to use. This value should be empty for current implementations, but must still be passed to the server.    {reason-description}  The reason why a challenge has been issued. This is to assist the client with managing cached tokens.    {url-list}  An ordered list of URLs separated by the \u2018    {serviceroot}  A hint for the client as to the root URL for the protection space associated with the current request. This simplifies the client decision-making regarding sending cached tokens to respond to the challenge.     The reason-description may be one of the following values:   notoken: No authentication token was supplied.  expired: The supplied token is no longer valid.  notforthisservice: The token is valid, but was not issued for the service trying to consume it.  nottrusted: A valid token has been issued by a service that the consumer does not trust.  invalidtoken: The token extracted from the Authorization header was invalid, for example it may be badly formed.  passwordClaimNotFound: A required password claim was not found.  badpassword: For a password-based token, the password has been changed or has expired since the token was issued and is no longer valid.  badaccount: The account associated with the subject was invalid, for example it may be locked out.  invalidAudience: The original token was not requested for a valid audience (see below).  tokenSignatureNotVerified: The signature of the token could not be verified.  wrongclaims: The token does not contain the required claims.  gatewayclaimsinconsistent: The gateway identified in the supplied token does not match the gateway discovered by the relying party.", 
            "title": "CitrixAuth Scheme"
        }, 
        {
            "location": "/citrixauth-authentication-scheme/#protection-space", 
            "text": "RFC2617 section 1.2 defines a Protection Space as the domain over which credentials can be automatically applied. If a prior request has been authorized, the same credentials may be reused for all other requests within that protection space for a period of time determined by the authentication scheme, parameters, and/or user preference. The CitrixAuth scheme is consistent with other schemes in that a single protection space cannot extend outside the scope of its server. The CitrixAuth scheme uses both the service-id (Realm) and the audience to which the request is to be sent, to define a protection space, and the client should not automatically send credentials to services outside of the protection space defined for a particular credential. In this context, the audience is defined by the scheme, host name, and port associated with the original request.\nThe serviceroot-hint in the challenge provides the client with the root of the protection space for the current request. This enables a better caching strategy in the client, if the initial request is not to the root of the protection space.", 
            "title": "Protection Space"
        }, 
        {
            "location": "/citrixauth-authentication-scheme/#example", 
            "text": "The following illustrates a CitrixAuth challenge and response:  Request to the Relying Party  GET https://www.example.com/Citrix/Store/resources/v2/T2VvUndOMEZMM1VBK2NpYzY4PQ--/image/16 HTTP/1.1\nHost: www.example.com\nAccept: image/png  Response from the Relying Party  HTTP/1.1 401 Unauthorized\nWWW-Authenticate: CitrixAuth realm= 6b78ab94-a709-4e3a-8b9b-a49ca317c70c ,\n                             reqtokentemplate= , reason= notoken , \n                             locations= https://www.example.com/Citrix/Authentication/auth/v1/token ,\n                             serviceroot-hint= https://www.example.com/Citrix/Store2/resources/v2  The client uses the information in the challenge to obtain an appropriate security token for the Service Provider, and then resends the original request with an attached Authorization header, as follows:  GET https://www.example.com/Citrix/Store/resources/v2/T2VvUndOMEZMM1VBK2NpYzY4PQ--/image/16 HTTP/1.1\nHost: www.example.com\nAccept: image/png\nAuthorization: CitrixAuth H4sIAAAAAAAEAO29B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMk2JBAEOzBiM3mku\u2026  Response from the Relying Party  HTTP/1.1 200 OK\nContent-Type: image/png\nCache-Control: public, no-store, max-age=0\nContent-Length: 773 binary data", 
            "title": "Example"
        }, 
        {
            "location": "/citrixauth-authentication-scheme/#client-processing-of-a-challenge", 
            "text": "When a client receives a CitrixAuth challenge, it must respond by sending a Request Security Token message to the location specified in the challenge. For more information on the Request Security Token message see the StoreFront Security Token Services API document [2].\nConsider the following example. The client has tried to access the URL: https://storefront.enterprise.com/Citrix/Store/resources/v2/launch\nand received the following challenge:  WWW-Authenticate: CitrixAuth realm= d5c937a6-a09d-4805-adbb-ff92208f7466 ,\n               reqtokentemplate= , reason= notoken ,\n               locations= https://storefront.enterprise.com/Citrix/Authentication/auth/v1/token \n               serviceroot-hint= https://storefront.enterprise.com/Citrix/Store/resources/v2  The client should respond by sending the following message to the location specified in the challenge, that is https://storefront.enterprise.com/Citrix/Authentication/auth/v1/token.  POST /Citrix/Authentication/auth/v1/token HTTP/1.1\nContent-Type: application/vnd.citrix.requesttoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml, application/vnd.citrix.requesttokenchoices+xml\nContent-Encoding: utf-8\nHost: storefront.enterprise.com ?xml version= 1.0  encoding= utf-8  ?  requesttoken xmlns= http://citrix.com/delivery-services/1-0/auth/requesttoken \n     for-service d5c937a6-a09d-4805-adbb-ff92208f7466 /for-service \n     for-service-url \n      https://storefront.enterprise.com/Citrix/Store/resources/v2/launch\n     /for-service-url \n     reqtokentemplate /reqtokentemplate \n     requested-lifetime 01:00:00 /requested-lifetime  /requesttoken   Notes  1.The request is sent to the value specified by the locations part of the challenge.   2.The   element value is extracted from the realm value of the challenge.  3.The   element value is extracted from the reqtokentemplate value of the challenge. For current versions this is always empty.  4.The   element value should be the URL that the client originally called. This should NOT be the value of the serviceroot-hint from the challenge.", 
            "title": "Client Processing of a Challenge"
        }, 
        {
            "location": "/citrixauth-authentication-scheme/#references", 
            "text": "[1] HTTP Authentication: Basic and Digest Access Authentication: http://www.ietf.org/rfc/rfc2617.txt   [2] StoreFront Security Token Services API v2.0", 
            "title": "References"
        }, 
        {
            "location": "/common-authentication-forms-language/", 
            "text": "Citrix Common Authentication Forms Language\n\n\nBackground\n\n\nCitrix has devised a common authentication protocol that is implemented by its next generation services and gateway platforms, referred to here as StoreFront Services and NetScaler Gateway. Citrix is implementing client support for this common authentication protocol in native user-agents, such as Receiver and Worx, for the major device platforms, notably: Windows, Mac, iOS, Android, Linux, and Receiver for Web for browser based user-agents.\n\n\nAn important part of the common authentication protocol is a generic forms language, designed to allow third parties to express a wide range of authentication forms using a set of user interface constructs that are similar to basic HTML forms, see RFC 1867 [http://www.ietf.org/rfc/rfc1867.txt] and 2388 [http://www.ietf.org/rfc/rfc2388.txt] for more details.\n\n\nThird parties can extend the authentication methods supported by StoreFront Services and NetScaler Gateway by implementing server logic that emits and consumes forms defined in the common forms language, see the Citrix Authentication Software Development Kit [1] for more details.\n\n\nThis document is intended for Citrix partners to understand the current expressivity of the common forms language, with the intent to allow them to customize the existing form definitions and to create new forms.\n\n\nReceiver Forms Language Overview\n\n\nAuthentication forms are logical forms expressed in Xml, the schema for which is located at: /Schemas/CommonFormsSchema.xsd.\n\n\nThe client controls the rendered form\u2019s layout with minimal hints from the server. These hints define the font size for different types of display text. Enough semantic information is contained in the form description to allow clients to handle credential types appropriately, and to enable credentials to be saved on client machines if permissible.\n\n\nForm Structure\n\n\nThe form is structured such that there is a control block, followed a section for authentication requirements.\n\n\nControl Block\n\n\nThe form contains the following control information:\n\n\n\n\n contains any state information that the server wishes the client to hold and pass back with the response to the form.\n\n\n represents the current state of the overall authentication process through a \u201csoft\u201d enumeration.\n\n\n represents a \"soft\" enumeration of status codes for the current request.\n\n\n  is an optional, localized, message from the server to be displayed, and/or logged by the client.\n\n\n\n\nThe following table describes the known result states:\n\n\nmore-info\nMore information is required by the server. The form contains authentication requirements that should be collected by the client and returned to the server.\nfail\nThe authentication conversation has failed. There may be a \nLogMessage> to indicate the issue.\nsuccess\nThe authentication conversation succeeded\ncancelled\nThe authentication conversation was cancelled directly by the user, or indirectly by the user-agent.\nupdate-credentials\nThe user is required to update a credential, such as a password. The form will contain authentication requirements that should be collected by the client and returned to the server.\n\n\n\nThe following table describes the known status states:\n\n\nsuccess\nThe last form POST was successfully processed.\nerror-service-unavailable\nThe service is unavailable\nerror-internal-failure\nAn internal error occurred.\nerror-params-not-expected\nOne or more of the parameters was unexpected.\nerror-logon-point-unknown\nThe logon point is unknown.\nerror-sessionid-invalid\nThe associated Http Session state is invalid.\nerror-sessionid-expired\nThe associated Http Session state has expired.\nerror-state-context-invalid\nThe session context value was invalid.\n\n\n\nAuthentication Requirements\n\n\nThe first part of the authentication requirements contains information regarding where to send the form response:\n\n\n\n\nThe Url to post the form response to\n\n\nThe Url to post a cancel request to\n\n\nThe optional text for the cancel button\n\n\n\n\nThe details of how to process the form and construct a form response, can be found in the document: Citrix Common Forms API [2].\n\n\nThe authentication requirements are expressed as an ordered collection of \n elements, which should generally be arranged in vertical order by the client when displayed. Each requirement element can define: a named credential value, an associated input field, a label, and assistive text. Where desired, the credential and input field can be omitted so the label is used for a heading, message or explanatory text. Common user interaction widgets are supported for input fields: single line clear text edit fields, single line obscured text edit fields, checkboxes, radio buttons, combo-boxes, and submit buttons.\n\n\nCredential Types\n\n\nThe credential types supported are a \u201csoft\u201d enumeration, which means that new credential types can be added without breaking the schema. The mechanism for how credential types are negotiated between the client and the server is described in the document: Citrix Common Forms API [2].\n\n\nThe default credential types are described below. Semantic information is implied for some credential types, to allow clients to provide enhanced handling and other functions.\n\n\nnone\nUsed for read-only and non-textual input controls.\nusername\nThe user name which may be qualified, e.g. an Active Directory user principal name such as \nuser@fully.qualified.domain\n or \u00a0legacy LAN Manager account such as domain\\username.\ndomain\nExpected to be an Active Directory domain name, examples include: the shorter legacy LAN Manager format, the fully qualified domain name, or an alternate domain name.\npassword\nTextual password or passphrase.\nnewpassword\nNew password in a change password form.\npin\nTextual password, likely a short numeric PIN.\ntextcredential\nGeneric text value with no implied semantics.\nsavecredentials\nControl flag for clients that support saving credentials locally.\nrealm\nSynonym for domain.\nrsa-passcode\nThe current RSA passcode.\nrsa-next-passcode\nThe next RSA passcode.\nrsa-next-tokencode\nSecondary RSA tokencode, triggered by one or more invalid tokencodes.\nrsa-pin\nThe RSA PIN, used during user generated PIN change.\n\n\n\nLabel Types\n\n\nThe label types supported are a \u201csoft\u201d enumeration, which means that new label types can be added without breaking the schema. The mechanism for how label types are negotiated between the client and the server is described in the document: Citrix Common Forms API [2].\n\n\nLabels can be textual or binary. The only built-in support for binary labels is for images [Label type: image]\n\n\nNotes regarding Images:\n\n\n\n\nImages are intended for authentication purposes, such as captcha images, and are not intended for generic branding\n\n\nThe image data supplied in the form is to be interpreted as a Data Uri as defined by RFC 2397, [https://www.ietf.org/rfc/rfc2397.txt]\n\n\n\n\nThe following describes the built-in text based labels:\n\n\nnone\nNo label is associated with the requirement\nplain\nNormal font.\nheading\nHeading font, with appropriate vertical spacing.\ninformation\nNormal font\nwarning\nWarning font\nerror\nError font\nconfirmation\nNormal font\n\n\n\nNotes regarding text based labels:\n\n\n\n\nIf a label type is: none, any textual or binary data specified for the associate label shall be ignored.\n\n\nClient implementors may use the label type to decorate messages with icons for visual effect.\n\n\nA limited set of inline font markup is supported, within text labels, using standard HTML tags such as: \nb\n for bold, \ni\n for italic, and \nu\n for underline. Note: these style tags must be XML encoded or contained within a CDATA section.\n\n\nMessages will flow across multiple lines of display if necessary.\n\n\nClient implementations may strip trailing \u2018:\u2019 if specified by the form author\n\n\nIf a label corresponds to an error message, then optionally, the label can also contain a list of credential identifier for requirements associated with the error, that the client can use to highlight the requirements for the users attention.\n\n\n\n\nError Highlight Example\n\n\nConsider a change password form with a requirement for the user to re-enter their existing password:\n\n\nRequirement\n\n  \nCredential\n\n    \nID\noldPassword\n/ID\n\n    \nType\npassword\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nOld password:\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nText\n\n      \nSecret\ntrue\n/Secret\n\n      \nReadOnly\nfalse\n/ReadOnly\n\n      \nInitialValue\n/InitialValue\n\n      \nConstraint\n.+\n/Constraint\n\n    \n/Text\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nIf the user enters an invalid value, then an error label is returned that specifies the oldpassword requirement to be highlighted:\n\n\nRequirement\n\n  \nCredential\n\n    \nType\nnone\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nHighlightFields\n\n      \nCredentialID\noldPassword\n/CredentialID\n\n    \n/HighlightFields\n\n    \nText\nOld password incorrect\n/Text\n\n    \nType\nerror\n/Type\n\n  \n/Label\n\n  \nInput /\n\n\n/Requirement\n\n\n\n\n\n\nThis is displayed in Receiver for Windows as:\n\n\nRequirement Element Idioms\n\n\nExamples of the common types of Requirement elements are shown below. Element values that are highlighted identify variable names or user-visible labels that are controlled by the author of the authentication form. Element values that are bolded and underscored indicate field enumeration types defined in this document.\n\n\nCancel Button\n\n\nThe assumption is that forms shall normally have a cancel button, positioned in the natural location for each client platform, relative to the other buttons. However, the cancel button will only be shown if the element is present at: /AuthenticateResponse/AuthenticationRequirements/CancelButtonText.\n\n\nNotes:\n- If a form author specifies CancelButtonText, client implementors may still not show a cancel button if it is not appropriate for the device.\n- The absence of CancelButtonText doesn\u2019t preclude the user-agent sending a cancellation request.\n\n\nHeading\n\n\nThis example is for a change password form. If a heading is not included as the first requirement element in a form, Receiver clients may provide a default heading that is tailored according to the user action that initiated the authentication process.  \n\n\nRequirement\n\n  \nCredential\n\n    \nType\nnone\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nChange Password\n/Text\n\n    \nType\nheading\n/Type\n\n  \n/Label\n\n  \nInput /\n\n\n/Requirement\n\n\n\n\nMessage\n\n\nThis example is for an expired password message, added to a change password form for explanation. \n\n\nRequirement\n\n  \nCredential\n\n    \nType\nnone\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nYour password has \nlt;b\ngt;expired\nlt;/b\ngt; and must be changed\n/Text\n\n    \nType\ninformation\n/Type\n\n  \n/Label\n\n  \nInput /\n\n\n/Requirement\n\n\n\n\nClear Text Credential\n\n\nThis example is for a user name credential type, but could be for a domain or generic value.\n\n\nRequirement\n\n  \nCredential\n\n    \nID\nusername\n/ID\n\n    \nSaveID\nExplicitForms-Username\n/SaveID\n\n    \nType\nusername\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nUsername:\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nText\n\n      \nSecret\nfalse\n/Secret\n\n      \nReadOnly\nfalse\n/ReadOnly\n\n      \nInitialValue\n/InitialValue\n\n      \nConstraint\n.+\n/Constraint\n\n    \n/Text\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nNote: Client implementations may ignore the constraints specified by the form author.\n\n\nSecret Text Credential\n\n\nThis credential must keep what the user types a secret, like an \ninput\n field of type password in Html.\n\n\nRequirement\n\n  \nCredential\n\n    \nID\npassword\n/ID\n\n    \nSaveID\nExplicitForms-Password\n/SaveID\n\n    \nType\npassword\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nPassword:\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nText\n\n      \nSecret\ntrue\n/Secret\n\n      \nReadOnly\nfalse\n/ReadOnly\n\n      \nInitialValue\n/InitialValue\n\n      \nConstraint\n.+\n/Constraint\n\n    \n/Text\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nCheckbox\n\n\nThis is one of several input types that typically uses the credential type: none.\n\n\nRequirement\n\n  \nCredential\n\n    \nID\nuserConsent\n/ID\n\n    \nType\nnone\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nAccept terms and conditions\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nCheckBox\n\n      \nInitialValue\nfalse\n/InitialValue\n\n    \n/CheckBox\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nRadio Button\n\n\nThe following demonstrates a series of radio buttons, for the user to select a single item from a set of choices. The \n element is typically localized, whereas the \n is fixed and is used for defining the initial selection and the value sent to the server.\n\n\nRequirement\n\n  \nCredential\n\n    \nID\nchangePINmode\n/ID\n\n    \nType\ntextcredential\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nPIN generation:\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nRadioButton\n\n      \nInitialSelection\n2\n/InitialSelection\n\n      \nDisplayValues\n\n        \nDisplayValue\n\n          \nDisplay\nCreate your own PIN\n/Display\n\n          \nValue\n1\n/Value\n\n        \n/DisplayValue\n\n        \nDisplayValue\n\n          \nDisplay\nRequest PIN from authentication system\n/Display\n\n          \nValue\n2\n/Value\n\n        \n/DisplayValue\n\n      \n/DisplayValues\n\n    \n/RadioButton\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nNote for form authors: The initial selection element is optional, and it is the client implementors choice how not having an initial value should be handled.\n\n\nCombo Box\n\n\nA combo-box is almost identical to Radio Button, in that it is used to select a single item. However the hint to the client is that it should be shown as a list control.\n\n\nRequirement\n\n  \nCredential\n\n    \nID\nRegion\n/ID\n\n    \nType\ntextcredential\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nRegion:\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nComboBox\n\n      \nInitialSelection\nunspecified\n/InitialSelection\n\n      \nDisplayValues\n\n        \nDisplayValue\n\n          \nDisplay\n(Select a region)\n/Display\n\n          \nValue\nunspecified\n/Value\n\n        \n/DisplayValue\n\n        \nDisplayValue\n\n          \nDisplay\nUnited States\n/Display\n\n          \nValue\nUS\n/Value\n\n        \n/DisplayValue\n\n        \nDisplayValue\n\n          \nDisplay\nEurope\n/Display\n\n          \nValue\nEU\n/Value\n\n        \n/DisplayValue\n\n      \n/DisplayValues\n\n    \n/ComboBox\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nNote for form authors: The initial selection element is optional, and it is the client implementors choice how not having an initial value should be handled.\n\n\nMulti-Combo box\n\n\nA multi-combo box is similar to a combo box, except multiple selections can be made.\n\n\nThe following multi-combo box, initially has the second item selected.\n\n\nRequirement\n\n  \nCredential\n\n    \nID\nmultiComboId\n/ID\n\n    \nType\ntextcredential\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nMulti-select Combo\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nMultiComboBox\n\n      \nDisplayValues\n\n        \nDisplayValue\n\n          \nDisplay\nAlice\n/Display\n\n          \nValue\nValue1\n/Value\n\n        \n/DisplayValue\n\n        \nDisplayValue\n\n          \nDisplay\nBob\n/Display\n\n          \nValue\nValue2\n/Value\n\n          \nSelect\ntrue\n/Select\n\n        \n/DisplayValue\n\n        \nDisplayValue\n\n          \nDisplay\nEve\n/Display\n\n          \nValue\nValue3\n/Value\n\n          \nSelect\nfalse\n/Select\n\n        \n/DisplayValue\n\n      \n/DisplayValues\n\n    \n/MultiComboBox\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nSave Credentials Control\n\n\nSaving credentials has important semantic obligations for the client, therefore a distinguished credential type is defined. This allows the form author to control whether the option is presented, and to specify the appropriate localized description.\n\n\nRequirement\n\n  \nCredential\n\n    \nID\nsaveCredentials\n/ID\n\n    \nType\nsavecredentials\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nRemember my password\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nCheckBox\n\n      \nInitialValue\nfalse\n/InitialValue\n\n    \n/CheckBox\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nSubmit Button\n\n\nMultiple buttons can appear in a form, all of them will invoke form submission.\n\n\n            \nRequirement\n\n                \nCredential\n\n                    \nID\nloginBtn\n/ID\n\n                    \nType\nnone\n/Type\n\n                \n/Credential\n\n                \nLabel\n\n                    \nType\nnone\n/Type\n\n                \n/Label\n\n                \nInput\n\n                    \nButton\nLog on\n/Button\n\n                \n/Input\n\n            \n/Requirement\n\n\n\n\nAssistive Text\n\n\nAssistive text is optional text to provide more information about an input element to the user. Assistive text may be shown using a tooltip or similar user interface element, but the mechanism for displaying the assistive text is at the discretion of the client. The following example is for a text input with assistive text describing the format required.\n\n\nRequirement\n\n  \nCredential\n\n    \nID\nusername\n/ID\n\n    \nSaveID\nExplicitForms-Username\n/SaveID\n\n    \nType\nusername\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nUsername:\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nAssistiveText\n\n      Please supply either domain\\user or user@fully.qualified.domain.name\n    \nAssistiveText\n\n    \nText\n\n      \nSecret\nfalse\n/Secret\n\n      \nReadOnly\nfalse\n/ReadOnly\n\n      \nInitialValue\n/InitialValue\n\n      \nConstraint\n.+\n/Constraint\n\n    \n/Text\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nDetailed Example Forms\n\n\nUsername, Password, Domain\n\n\nThe following form defines a user name and password form, with the ability to save credentials on the client, assistive text and a cancel button, that renders in Citrix Receiver for Windows as shown below:\n\n\n\n\nNote that the Secure connection marking is supplied by Receiver independently of the form description.\n\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/response/1\n\n  \nStatus\nsuccess\n/Status\n\n  \nResult\nmore-info\n/Result\n\n  \nStateContext /\n\n  \nAuthenticationRequirements\n\n    \nPostBack\n/Citrix/Authentication/ExplicitForms/AuthenticateAttempt\n/PostBack\n\n    \nCancelPostBack\n/Citrix/Authentication/ExplicitForms/CancelAuthenticate\n/CancelPostBack\n\n    \nCancelButtonText\nCancel\n/CancelButtonText\n\n    \nRequirements\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\nusername\n/ID\n\n          \nSaveID\nExplicitForms-Username\n/SaveID\n\n          \nType\nusername\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nUser name:\n/Text\n\n          \nType\nplain\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nAssistiveText\nPlease supply either domain\\username or user@fully.qualified.domain\n/AssistiveText\n\n          \nText\n\n            \nSecret\nfalse\n/Secret\n\n            \nReadOnly\nfalse\n/ReadOnly\n\n            \nInitialValue\n/InitialValue\n\n            \nConstraint\n.+\n/Constraint\n\n          \n/Text\n\n        \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\npassword\n/ID\n\n          \nSaveID\nExplicitForms-Password\n/SaveID\n\n          \nType\npassword\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nPassword:\n/Text\n\n          \nType\nplain\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nText\n\n            \nSecret\ntrue\n/Secret\n\n            \nReadOnly\nfalse\n/ReadOnly\n\n            \nInitialValue\n/InitialValue\n\n            \nConstraint\n.+\n/Constraint\n\n          \n/Text\n\n        \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\nsaveCredentials\n/ID\n\n          \nType\nsavecredentials\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nRemember my password\n/Text\n\n          \nType\nplain\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nCheckBox\n\n            \nInitialValue\nfalse\n/InitialValue\n\n          \n/CheckBox\n\n        \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n       \nCredential\n\n         \nID\nloginBtn\n/ID\n\n         \nType\nnone\n/Type\n\n       \n/Credential\n\n       \nLabel\n\n         \nType\nnone\n/Type\n\n       \n/Label\n\n       \nInput\n\n         \nButton\nLog On\n/Button\n\n       \n/Input\n\n      \n/Requirement\n\n    \n/Requirements\n\n  \n/AuthenticationRequirements\n\n\n/AuthenticateResponse\n\n\n\n\nUsername, Password with Inline Error Message\n\n\nIn the previous example, if the password supplied by the user was incorrect, then the server will return the following form:\n\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/response/1\n\n  \nStatus\nsuccess\n/Status\n\n  \nResult\nmore-info\n/Result\n\n  \nStateContext /\n\n  \nAuthenticationRequirements\n\n    \nPostBack\n/Citrix/Authentication/ExplicitForms/AuthenticateAttempt\n/PostBack\n\n    \nCancelPostBack\n/Citrix/Authentication/ExplicitForms/CancelAuthenticate\n/CancelPostBack\n\n    \nCancelButtonText\nCancel\n/CancelButtonText\n\n    \nRequirements\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\nusername\n/ID\n\n          \nSaveID\nExplicitForms-Username\n/SaveID\n\n          \nType\nusername\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nUser name\n/Text\n\n          \nType\nplain\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nAssistiveText\nPlease supply either domain\\username or user@fully.qualified.domain\n/AssistiveText\n\n          \nText\n\n            \nSecret\nfalse\n/Secret\n\n            \nReadOnly\nfalse\n/ReadOnly\n\n            \nInitialValue\ndomain\\user\n/InitialValue\n\n            \nConstraint\n.+\n/Constraint\n\n          \n/Text\n\n        \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\npassword\n/ID\n\n          \nSaveID\nExplicitForms-Password\n/SaveID\n\n          \nType\npassword\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nPassword:\n/Text\n\n          \nType\nplain\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nText\n\n            \nSecret\ntrue\n/Secret\n\n            \nReadOnly\nfalse\n/ReadOnly\n\n            \nInitialValue\n/InitialValue\n\n            \nConstraint\n.+\n/Constraint\n\n          \n/Text\n\n        \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nType\nnone\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nIncorrect user name or password\n/Text\n\n          \nType\nerror\n/Type\n\n        \n/Label\n\n        \nInput /\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\nsaveCredentials\n/ID\n\n          \nType\nsavecredentials\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nRemember my password\n/Text\n\n          \nType\nplain\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nCheckBox\n\n            \nInitialValue\nfalse\n/InitialValue\n\n          \n/CheckBox\n\n        \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\nloginBtn\n/ID\n\n          \nType\nnone\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nType\nnone\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nButton\nLog On\n/Button\n\n        \n/Input\n\n      \n/Requirement\n\n    \n/Requirements\n\n  \n/AuthenticationRequirements\n\n\n/AuthenticateResponse\n\n\n\n\nThis is rendered by Citrix Receiver for Windows as:\n\n\n\n\nUsername, Password, Domain Selection From List\n\n\nThe following form defines a user name and password form with domain selection from a list, with the ability to save credentials on the client, and a Cancel button, that renders as shown below:\n\n\n\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/response/1\n\n  \nStatus\nsuccess\n/Status\n\n  \nResult\nmore-info\n/Result\n\n  \nStateContext /\n\n  \nAuthenticationRequirements\n\n    \nPostBack\n/Citrix/Authentication/ExplicitForms/AuthenticateAttempt\n/PostBack\n\n    \nCancelPostBack\n/Citrix/Authentication/ExplicitForms/CancelAuthenticate\n/CancelPostBack\n\n    \nCancelButtonText\nCancel\n/CancelButtonText\n\n    \nRequirements\n\n    \nRequirement\n\n      \nCredential\n\n        \nType\nnone\n/Type\n\n      \n/Credential\n\n      \nLabel\n\n        \nText\nPlease log on\n/Text\n\n        \nType\nheading\n/Type\n\n      \n/Label\n\n      \nInput /\n\n    \n/Requirement\n\n    \nRequirement\n\n      \nCredential\n\n        \nID\nusername\n/ID\n\n        \nSaveID\nExplicitForms-Username\n/SaveID\n\n        \nType\nusername\n/Type\n\n      \n/Credential\n\n      \nLabel\n\n        \nText\nUser name:\n/Text\n\n        \nType\nplain\n/Type\n\n      \n/Label\n\n      \nInput\n\n        \nText\n\n          \nSecret\nfalse\n/Secret\n\n          \nReadOnly\nfalse\n/ReadOnly\n\n          \nInitialValue\n/InitialValue\n\n          \nConstraint\n.+\n/Constraint\n\n        \n/Text\n\n      \n/Input\n\n    \n/Requirement\n\n    \nRequirement\n\n      \nCredential\n\n        \nID\npassword\n/ID\n\n        \nSaveID\nExplicitForms-Password\n/SaveID\n\n        \nType\npassword\n/Type\n\n      \n/Credential\n\n      \nLabel\n\n        \nText\nPassword:\n/Text\n\n        \nType\nplain\n/Type\n\n      \n/Label\n\n        \nInput\n\n          \nText\n\n            \nSecret\ntrue\n/Secret\n\n            \nReadOnly\nfalse\n/ReadOnly\n\n            \nInitialValue\n/InitialValue\n\n            \nConstraint\n.+\n/Constraint\n\n          \n/Text\n\n        \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\ndomain\n/ID\n\n          \nSaveID\nExplicitForms-Domain\n/SaveID\n\n          \nType\ndomain\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nDomain:\n/Text\n\n          \nType\nplain\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nComboBox\n\n            \nInitialSelection\ndomain\n/InitialSelection\n\n            \nDisplayValues\n\n              \nDisplayValue\n\n                \nDisplay\ndomain\n/Display\n\n                \nValue\ndomain\n/Value\n\n              \n/DisplayValue\n\n              \nDisplayValue\n\n                \nDisplay\nother\n/Display\n\n                \nValue\nanimaniacs\n/Value\n\n              \n/DisplayValue\n\n            \n/DisplayValues\n\n          \n/ComboBox\n\n        \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\nsaveCredentials\n/ID\n\n          \nType\nsavecredentials\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nRemember my password\n/Text\n\n          \nType\nplain\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nCheckBox\n\n            \nInitialValue\nfalse\n/InitialValue\n\n          \n/CheckBox\n\n        \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\nloginBtn\n/ID\n\n          \nType\nnone\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nType\nnone\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nButton\nLog On\n/Button\n\n        \n/Input\n\n      \n/Requirement\n\n    \n/Requirements\n\n  \n/AuthenticationRequirements\n\n\n/AuthenticateResponse\n\n\n\n\nWhen the user fills in their user name and password, selects not to save their password on the client, and the Log On button is activated, then following is returned to the server: \n\n\nPOST https://server/Citrix/Authentication/ExplicitForms/AuthenticateAttempt HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\nAccept: application/vnd.citrix.authenticateresponse-1+xml, \n        application/vnd.citrix.requesttokenresponse+xml\nAccept-Language: en\nHost: server\nContent-Length: 96\nConnection: Keep-Alive\nCache-Control: no-cache\nCookie: ASP.NET_SessionId=abcdefg123456\n\nStateContext=\ndomain=mydomain\nloginBtn=Log+On\npassword=mypswd\nsaveCredentials=false\nusername=me\n\n\n\n\nChange Password\n\n\nThis form is carefully distinguished from other generic credential collection forms, by having a distinct \n code in the control block. This is needed so that Receivers which support saving credentials can react appropriately. It includes the user name value as a read-only credential input, and submit both password and newpassword credential values. This form also illustrates the ability to have pre-filled and read-only input fields.\n\n\n\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/response/1\n\n  \nStatus\nsuccess\n/Status\n\n  \nResult\nupdate-credentials\n/Result\n\n  \nStateContext/\n\n  \nAuthenticationRequirements\n\n    \nPostBack\n/Citrix/Authentication/ExplicitForms\n/PostBack\n\n    \nCancelPostBack\n/Citrix/Authentication/ExplicitForms/Cancel\n/CancelPostBack\n\n    \nCancelButtonText\nCancel\n/CancelButtonText\n\n    \nRequirements\n\n      \nRequirement\n\n        \nCredential\n\n          \nType\nnone\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nChange Expired Password\n/Text\n\n          \nType\nheading\n/Type\n\n        \n/Label\n\n        \nInput /\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nType\nusername\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nUser name:\n/Text\n\n          \nType\nplain\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nText\n\n            \nSecret\nfalse\n/Secret\n\n            \nReadOnly\ntrue\n/ReadOnly\n\n            \nInitialValue\nanimaniacs\\expiredpassword\n/InitialValue\n\n            \nConstraint\n.+\n/Constraint\n\n          \n/Text\n\n        \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\noldPassword\n/ID\n\n          \nType\npassword\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nOld password:\n/Text\n\n          \nType\nplain\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nText\n\n            \nSecret\ntrue\n/Secret\n\n            \nReadOnly\nfalse\n/ReadOnly\n\n            \nInitialValue\n/InitialValue\n\n            \nConstraint\n.+\n/Constraint\n\n          \n/Text\n\n        \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\nnewPassword\n/ID\n\n          \nSaveID\nExplicitForms-Password\n/SaveID\n\n          \nType\nnewpassword\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nNew password:\n/Text\n\n          \nType\nplain\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nText\n\n            \nSecret\ntrue\n/Secret\n\n            \nReadOnly\nfalse\n/ReadOnly\n\n            \nInitialValue\n/InitialValue\n\n            \nConstraint\n.+\n/Constraint\n\n          \n/Text\n\n        \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\nconfirmPassword\n/ID\n\n          \nType\nnewpassword\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nConfirm password:\n/Text\n\n          \nType\nplain\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nText\n\n            \nSecret\ntrue\n/Secret\n\n            \nReadOnly\nfalse\n/ReadOnly\n\n            \nInitialValue\n/InitialValue\n\n            \nConstraint\n.+\n/Constraint\n\n          \n/Text\n\n        \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\nchangePasswordBtn\n/ID\n\n          \nType\nnone\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nType\nnone\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nButton\nOK\n/Button\n\n        \n/Input\n\n      \n/Requirement\n\n    \n/Requirements\n\n  \n/AuthenticationRequirements\n\n\n/AuthenticateResponse\n\n\n\n\nConfirmation Message\n\n\n\n\nThis example illustrates a message display form that is used to provide important user feedback, such as when the users password has been changed in the example above. This form suppresses the Cancel button to indicate to the user that it is only requesting acknowledgement of a noteworthy state change. The user can still cancel the authentication process in other ways, such as pressing Esc key or using the window close control. Citrix Reciever renders the forms as follows:\n\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/response/1\n\n  \nStatus\nsuccess\n/Status\n\n  \nResult\nmore-info\n/Result\n\n  \nStateContext /\n\n  \nAuthenticationRequirements\n\n    \nPostBack\n/Citrix/Authentication/ExplicitForms/ChangePasswordConfirm\n/PostBack\n\n    \nCancelPostBack\n/CancelPostBack\n\n    \nRequirements\n\n      \nRequirement\n\n        \nCredential\n\n          \nType\nnone\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nYour password has been changed successfully.\n/Text\n\n          \nType\nconfirmation\n/Type\n\n        \n/Label\n\n        \nInput /\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\nchangePasswordConfirmBtn\n/ID\n\n          \nType\nnone\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nType\nnone\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nButton\nOK\n/Button\n\n        \n/Input\n\n      \n/Requirement\n\n    \n/Requirements\n\n  \n/AuthenticationRequirements\n\n\n/AuthenticateResponse\n\n\n\n\nGeneric Radius Challenge\n\n\n\n\nThis example illustrates the flexibility to have long descriptions and long input fields (without a preceding label), and to control line wrapping by using multiple labels.\n\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/response/1\n\n    \nStatus\nsuccess\n/Status\n\n    \nResult\nmore-info\n/Result\n\n    \nStateContext /\n\n    \nAuthenticationRequirements\n\n        \nPostBack\n/serviceLocationPath/ExplicitForms/AuthenticateAttempt\n/PostBack\n\n        \nCancelPostBack\n/serviceLocationPath/ExplicitForms/CancelAuthenticate\n/CancelPostBack\n         \nRequirements\n\n            \nRequirement\n\n                \nCredential\n\n                    \nType\nnone\n/Type\n\n                \n/Credential\n\n                \nLabel\n\n                    \nText\nTwo-Factor Authentication\n/Text\n\n                    \nType\nheading\n/Type\n\n                \n/Label\n\n                \nInput /\n\n            \n/Requirement\n\n            \nRequirement\n\n                \nCredential\n\n                    \nType\nnone\n/Type\n\n                \n/Credential\n\n                \nLabel\n\n                    \nText\nThe authentication system requires more information.\n/Text\n\n                    \nType\nplain\n/Type\n\n                \n/Label\n\n                \nInput /\n\n            \n/Requirement\n\n            \nRequirement\n\n                \nCredential\n\n                    \nType\nnone\n/Type\n\n                \n/Credential\n\n                \nLabel\n\n                    \nText\nPIN accepted. Wait for the tokencode to change then enter the new passcode.\n/Text\n\n                    \nType\nplain\n/Type\n\n                \n/Label\n\n                \nInput /\n\n            \n/Requirement\n\n            \nRequirement\n\n                \nCredential\n\n                    \nID\nchallengeResponse\n/ID\n\n                    \nType\ntextcredential\n/Type\n\n                \n/Credential\n\n                \nLabel\nType\nnone\n/Type\n/Label\n\n                \nInput\n\n                    \nText\n\n                        \nSecret\ntrue\n/Secret\n\n                        \nReadOnly\nfalse\n/ReadOnly\n\n                        \nInitialValue\n/InitialValue\n\n                        \nConstraint\n.+\n/Constraint\n\n                    \n/Text\n\n                \n/Input\n\n            \n/Requirement\n\n            \nRequirement\n\n                \nCredential\n\n                    \nID\nsubmitResponseBtn\n/ID\n\n                    \nType\nnone\n/Type\n\n                \n/Credential\n\n                \nLabel\n\n                    \nType\nnone\n/Type\n\n                \n/Label\n\n                \nInput\n\n                    \nButton\nNext\n/Button\n\n                \n/Input\n\n            \n/Requirement\n\n        \n/Requirements\n\n    \n/AuthenticationRequirements\n\n\n/AuthenticateResponse\n\n\n\n\nChange Expired PIN\n\n\nThis example illustrates radio buttons.\n\n\n\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/response/1\n\n    \nStatus\nsuccess\n/Status\n\n    \nResult\nmore-info\n/Result\n\n    \nStateContext /\n\n    \nAuthenticationRequirements\n\n        \nPostBack\n/serviceLocationPath/ExplicitForms/AuthenticateAttempt\n/PostBack\n\n        \nCancelPostBack\n/serviceLocationPath/ExplicitForms/CancelAuthenticate\n/CancelPostBack\n\n        \nRequirements\n\n            \nRequirement\n\n                \nCredential\n\n                    \nType\nnone\n/Type\n\n                \n/Credential\n\n                \nLabel\n\n                    \nText\nChange Expired PIN\n/Text\n\n                    \nType\nheading\n/Type\n\n                \n/Label\n\n                \nInput /\n\n            \n/Requirement\n\n            \nRequirement\n\n                \nCredential\n\n                    \nType\nnone\n/Type\n\n                \n/Credential\n\n                \nLabel\n\n                    \nText\nAfter changing your PIN, Receiver prompts you log on again.\n/Text\n\n                    \nType\nplain\n/Type\n\n                \n/Label\n\n                \nInput /\n\n            \n/Requirement\n\n            \nRequirement\n\n                \nCredential\n\n                    \nID\nchangePINmode\n/ID\n\n                    \nType\nnone\n/Type\n\n                \n/Credential\n\n                \nLabel\nType\nnone\n/Type\n/Label\n\n                \nInput\n\n                    \nRadioButton\n\n                \nInitialSelection\n1\n/InitialSelection\n\n                        \nDisplayValues\n\n                          \nDisplayValue\n\n                            \nDisplay\nCreate your own PIN\n/Display\n\n                            \nValue\n1\n/Value\n\n                          \n/DisplayValue\n\n                          \nDisplayValue\n\n                            \nDisplay\nRequest PIN from authentication system\n/Display\n\n                            \nValue\n2\n/Value\n\n                          \n/DisplayValue\n\n                        \n/DisplayValues\n\n                    \n/RadioButton\n\n                \n/Input\n\n            \n/Requirement\n\n            \nRequirement\n\n                \nCredential\n\n                    \nID\nsubmitResponseBtn\n/ID\n\n                    \nType\nnone\n/Type\n\n                \n/Credential\n\n                \nLabel\n\n                    \nType\nnone\n/Type\n\n                \n/Label\n\n                \nInput\n\n                    \nButton\nNext\n/Button\n\n                \n/Input\n\n            \n/Requirement\n\n        \n/Requirements\n\n    \n/AuthenticationRequirements\n\n\n/AuthenticateResponse", 
            "title": "Citrix Common Authentication Forms Language"
        }, 
        {
            "location": "/common-authentication-forms-language/#background", 
            "text": "Citrix has devised a common authentication protocol that is implemented by its next generation services and gateway platforms, referred to here as StoreFront Services and NetScaler Gateway. Citrix is implementing client support for this common authentication protocol in native user-agents, such as Receiver and Worx, for the major device platforms, notably: Windows, Mac, iOS, Android, Linux, and Receiver for Web for browser based user-agents.  An important part of the common authentication protocol is a generic forms language, designed to allow third parties to express a wide range of authentication forms using a set of user interface constructs that are similar to basic HTML forms, see RFC 1867 [http://www.ietf.org/rfc/rfc1867.txt] and 2388 [http://www.ietf.org/rfc/rfc2388.txt] for more details.  Third parties can extend the authentication methods supported by StoreFront Services and NetScaler Gateway by implementing server logic that emits and consumes forms defined in the common forms language, see the Citrix Authentication Software Development Kit [1] for more details.  This document is intended for Citrix partners to understand the current expressivity of the common forms language, with the intent to allow them to customize the existing form definitions and to create new forms.", 
            "title": "Background"
        }, 
        {
            "location": "/common-authentication-forms-language/#receiver-forms-language-overview", 
            "text": "Authentication forms are logical forms expressed in Xml, the schema for which is located at: /Schemas/CommonFormsSchema.xsd.  The client controls the rendered form\u2019s layout with minimal hints from the server. These hints define the font size for different types of display text. Enough semantic information is contained in the form description to allow clients to handle credential types appropriately, and to enable credentials to be saved on client machines if permissible.", 
            "title": "Receiver Forms Language Overview"
        }, 
        {
            "location": "/common-authentication-forms-language/#form-structure", 
            "text": "The form is structured such that there is a control block, followed a section for authentication requirements.", 
            "title": "Form Structure"
        }, 
        {
            "location": "/common-authentication-forms-language/#control-block", 
            "text": "The form contains the following control information:    contains any state information that the server wishes the client to hold and pass back with the response to the form.   represents the current state of the overall authentication process through a \u201csoft\u201d enumeration.   represents a \"soft\" enumeration of status codes for the current request.    is an optional, localized, message from the server to be displayed, and/or logged by the client.   The following table describes the known result states:  more-info More information is required by the server. The form contains authentication requirements that should be collected by the client and returned to the server. fail The authentication conversation has failed. There may be a  LogMessage> to indicate the issue. success The authentication conversation succeeded cancelled The authentication conversation was cancelled directly by the user, or indirectly by the user-agent. update-credentials The user is required to update a credential, such as a password. The form will contain authentication requirements that should be collected by the client and returned to the server.  The following table describes the known status states:  success The last form POST was successfully processed. error-service-unavailable The service is unavailable error-internal-failure An internal error occurred. error-params-not-expected One or more of the parameters was unexpected. error-logon-point-unknown The logon point is unknown. error-sessionid-invalid The associated Http Session state is invalid. error-sessionid-expired The associated Http Session state has expired. error-state-context-invalid The session context value was invalid.  Authentication Requirements  The first part of the authentication requirements contains information regarding where to send the form response:   The Url to post the form response to  The Url to post a cancel request to  The optional text for the cancel button   The details of how to process the form and construct a form response, can be found in the document: Citrix Common Forms API [2].  The authentication requirements are expressed as an ordered collection of   elements, which should generally be arranged in vertical order by the client when displayed. Each requirement element can define: a named credential value, an associated input field, a label, and assistive text. Where desired, the credential and input field can be omitted so the label is used for a heading, message or explanatory text. Common user interaction widgets are supported for input fields: single line clear text edit fields, single line obscured text edit fields, checkboxes, radio buttons, combo-boxes, and submit buttons.  Credential Types  The credential types supported are a \u201csoft\u201d enumeration, which means that new credential types can be added without breaking the schema. The mechanism for how credential types are negotiated between the client and the server is described in the document: Citrix Common Forms API [2].  The default credential types are described below. Semantic information is implied for some credential types, to allow clients to provide enhanced handling and other functions.  none Used for read-only and non-textual input controls. username The user name which may be qualified, e.g. an Active Directory user principal name such as  user@fully.qualified.domain  or \u00a0legacy LAN Manager account such as domain\\username. domain Expected to be an Active Directory domain name, examples include: the shorter legacy LAN Manager format, the fully qualified domain name, or an alternate domain name. password Textual password or passphrase. newpassword New password in a change password form. pin Textual password, likely a short numeric PIN. textcredential Generic text value with no implied semantics. savecredentials Control flag for clients that support saving credentials locally. realm Synonym for domain. rsa-passcode The current RSA passcode. rsa-next-passcode The next RSA passcode. rsa-next-tokencode Secondary RSA tokencode, triggered by one or more invalid tokencodes. rsa-pin The RSA PIN, used during user generated PIN change.", 
            "title": "Control Block"
        }, 
        {
            "location": "/common-authentication-forms-language/#label-types", 
            "text": "The label types supported are a \u201csoft\u201d enumeration, which means that new label types can be added without breaking the schema. The mechanism for how label types are negotiated between the client and the server is described in the document: Citrix Common Forms API [2].  Labels can be textual or binary. The only built-in support for binary labels is for images [Label type: image]  Notes regarding Images:   Images are intended for authentication purposes, such as captcha images, and are not intended for generic branding  The image data supplied in the form is to be interpreted as a Data Uri as defined by RFC 2397, [https://www.ietf.org/rfc/rfc2397.txt]   The following describes the built-in text based labels:  none No label is associated with the requirement plain Normal font. heading Heading font, with appropriate vertical spacing. information Normal font warning Warning font error Error font confirmation Normal font  Notes regarding text based labels:   If a label type is: none, any textual or binary data specified for the associate label shall be ignored.  Client implementors may use the label type to decorate messages with icons for visual effect.  A limited set of inline font markup is supported, within text labels, using standard HTML tags such as:  b  for bold,  i  for italic, and  u  for underline. Note: these style tags must be XML encoded or contained within a CDATA section.  Messages will flow across multiple lines of display if necessary.  Client implementations may strip trailing \u2018:\u2019 if specified by the form author  If a label corresponds to an error message, then optionally, the label can also contain a list of credential identifier for requirements associated with the error, that the client can use to highlight the requirements for the users attention.", 
            "title": "Label Types"
        }, 
        {
            "location": "/common-authentication-forms-language/#error-highlight-example", 
            "text": "Consider a change password form with a requirement for the user to re-enter their existing password:  Requirement \n   Credential \n     ID oldPassword /ID \n     Type password /Type \n   /Credential \n   Label \n     Text Old password: /Text \n     Type plain /Type \n   /Label \n   Input \n     Text \n       Secret true /Secret \n       ReadOnly false /ReadOnly \n       InitialValue /InitialValue \n       Constraint .+ /Constraint \n     /Text \n   /Input  /Requirement  If the user enters an invalid value, then an error label is returned that specifies the oldpassword requirement to be highlighted:  Requirement \n   Credential \n     Type none /Type \n   /Credential \n   Label \n     HighlightFields \n       CredentialID oldPassword /CredentialID \n     /HighlightFields \n     Text Old password incorrect /Text \n     Type error /Type \n   /Label \n   Input /  /Requirement   This is displayed in Receiver for Windows as:", 
            "title": "Error Highlight Example"
        }, 
        {
            "location": "/common-authentication-forms-language/#requirement-element-idioms", 
            "text": "Examples of the common types of Requirement elements are shown below. Element values that are highlighted identify variable names or user-visible labels that are controlled by the author of the authentication form. Element values that are bolded and underscored indicate field enumeration types defined in this document.", 
            "title": "Requirement Element Idioms"
        }, 
        {
            "location": "/common-authentication-forms-language/#cancel-button", 
            "text": "The assumption is that forms shall normally have a cancel button, positioned in the natural location for each client platform, relative to the other buttons. However, the cancel button will only be shown if the element is present at: /AuthenticateResponse/AuthenticationRequirements/CancelButtonText.  Notes:\n- If a form author specifies CancelButtonText, client implementors may still not show a cancel button if it is not appropriate for the device.\n- The absence of CancelButtonText doesn\u2019t preclude the user-agent sending a cancellation request.", 
            "title": "Cancel Button"
        }, 
        {
            "location": "/common-authentication-forms-language/#heading", 
            "text": "This example is for a change password form. If a heading is not included as the first requirement element in a form, Receiver clients may provide a default heading that is tailored according to the user action that initiated the authentication process.    Requirement \n   Credential \n     Type none /Type \n   /Credential \n   Label \n     Text Change Password /Text \n     Type heading /Type \n   /Label \n   Input /  /Requirement", 
            "title": "Heading"
        }, 
        {
            "location": "/common-authentication-forms-language/#message", 
            "text": "This example is for an expired password message, added to a change password form for explanation.   Requirement \n   Credential \n     Type none /Type \n   /Credential \n   Label \n     Text Your password has  lt;b gt;expired lt;/b gt; and must be changed /Text \n     Type information /Type \n   /Label \n   Input /  /Requirement", 
            "title": "Message"
        }, 
        {
            "location": "/common-authentication-forms-language/#clear-text-credential", 
            "text": "This example is for a user name credential type, but could be for a domain or generic value.  Requirement \n   Credential \n     ID username /ID \n     SaveID ExplicitForms-Username /SaveID \n     Type username /Type \n   /Credential \n   Label \n     Text Username: /Text \n     Type plain /Type \n   /Label \n   Input \n     Text \n       Secret false /Secret \n       ReadOnly false /ReadOnly \n       InitialValue /InitialValue \n       Constraint .+ /Constraint \n     /Text \n   /Input  /Requirement  Note: Client implementations may ignore the constraints specified by the form author.", 
            "title": "Clear Text Credential"
        }, 
        {
            "location": "/common-authentication-forms-language/#secret-text-credential", 
            "text": "This credential must keep what the user types a secret, like an  input  field of type password in Html.  Requirement \n   Credential \n     ID password /ID \n     SaveID ExplicitForms-Password /SaveID \n     Type password /Type \n   /Credential \n   Label \n     Text Password: /Text \n     Type plain /Type \n   /Label \n   Input \n     Text \n       Secret true /Secret \n       ReadOnly false /ReadOnly \n       InitialValue /InitialValue \n       Constraint .+ /Constraint \n     /Text \n   /Input  /Requirement", 
            "title": "Secret Text Credential"
        }, 
        {
            "location": "/common-authentication-forms-language/#checkbox", 
            "text": "This is one of several input types that typically uses the credential type: none.  Requirement \n   Credential \n     ID userConsent /ID \n     Type none /Type \n   /Credential \n   Label \n     Text Accept terms and conditions /Text \n     Type plain /Type \n   /Label \n   Input \n     CheckBox \n       InitialValue false /InitialValue \n     /CheckBox \n   /Input  /Requirement", 
            "title": "Checkbox"
        }, 
        {
            "location": "/common-authentication-forms-language/#radio-button", 
            "text": "The following demonstrates a series of radio buttons, for the user to select a single item from a set of choices. The   element is typically localized, whereas the   is fixed and is used for defining the initial selection and the value sent to the server.  Requirement \n   Credential \n     ID changePINmode /ID \n     Type textcredential /Type \n   /Credential \n   Label \n     Text PIN generation: /Text \n     Type plain /Type \n   /Label \n   Input \n     RadioButton \n       InitialSelection 2 /InitialSelection \n       DisplayValues \n         DisplayValue \n           Display Create your own PIN /Display \n           Value 1 /Value \n         /DisplayValue \n         DisplayValue \n           Display Request PIN from authentication system /Display \n           Value 2 /Value \n         /DisplayValue \n       /DisplayValues \n     /RadioButton \n   /Input  /Requirement  Note for form authors: The initial selection element is optional, and it is the client implementors choice how not having an initial value should be handled.", 
            "title": "Radio Button"
        }, 
        {
            "location": "/common-authentication-forms-language/#combo-box", 
            "text": "A combo-box is almost identical to Radio Button, in that it is used to select a single item. However the hint to the client is that it should be shown as a list control.  Requirement \n   Credential \n     ID Region /ID \n     Type textcredential /Type \n   /Credential \n   Label \n     Text Region: /Text \n     Type plain /Type \n   /Label \n   Input \n     ComboBox \n       InitialSelection unspecified /InitialSelection \n       DisplayValues \n         DisplayValue \n           Display (Select a region) /Display \n           Value unspecified /Value \n         /DisplayValue \n         DisplayValue \n           Display United States /Display \n           Value US /Value \n         /DisplayValue \n         DisplayValue \n           Display Europe /Display \n           Value EU /Value \n         /DisplayValue \n       /DisplayValues \n     /ComboBox \n   /Input  /Requirement  Note for form authors: The initial selection element is optional, and it is the client implementors choice how not having an initial value should be handled.", 
            "title": "Combo Box"
        }, 
        {
            "location": "/common-authentication-forms-language/#multi-combo-box", 
            "text": "A multi-combo box is similar to a combo box, except multiple selections can be made.  The following multi-combo box, initially has the second item selected.  Requirement \n   Credential \n     ID multiComboId /ID \n     Type textcredential /Type \n   /Credential \n   Label \n     Text Multi-select Combo /Text \n     Type plain /Type \n   /Label \n   Input \n     MultiComboBox \n       DisplayValues \n         DisplayValue \n           Display Alice /Display \n           Value Value1 /Value \n         /DisplayValue \n         DisplayValue \n           Display Bob /Display \n           Value Value2 /Value \n           Select true /Select \n         /DisplayValue \n         DisplayValue \n           Display Eve /Display \n           Value Value3 /Value \n           Select false /Select \n         /DisplayValue \n       /DisplayValues \n     /MultiComboBox \n   /Input  /Requirement", 
            "title": "Multi-Combo box"
        }, 
        {
            "location": "/common-authentication-forms-language/#save-credentials-control", 
            "text": "Saving credentials has important semantic obligations for the client, therefore a distinguished credential type is defined. This allows the form author to control whether the option is presented, and to specify the appropriate localized description.  Requirement \n   Credential \n     ID saveCredentials /ID \n     Type savecredentials /Type \n   /Credential \n   Label \n     Text Remember my password /Text \n     Type plain /Type \n   /Label \n   Input \n     CheckBox \n       InitialValue false /InitialValue \n     /CheckBox \n   /Input  /Requirement", 
            "title": "Save Credentials Control"
        }, 
        {
            "location": "/common-authentication-forms-language/#submit-button", 
            "text": "Multiple buttons can appear in a form, all of them will invoke form submission.               Requirement \n                 Credential \n                     ID loginBtn /ID \n                     Type none /Type \n                 /Credential \n                 Label \n                     Type none /Type \n                 /Label \n                 Input \n                     Button Log on /Button \n                 /Input \n             /Requirement", 
            "title": "Submit Button"
        }, 
        {
            "location": "/common-authentication-forms-language/#assistive-text", 
            "text": "Assistive text is optional text to provide more information about an input element to the user. Assistive text may be shown using a tooltip or similar user interface element, but the mechanism for displaying the assistive text is at the discretion of the client. The following example is for a text input with assistive text describing the format required.  Requirement \n   Credential \n     ID username /ID \n     SaveID ExplicitForms-Username /SaveID \n     Type username /Type \n   /Credential \n   Label \n     Text Username: /Text \n     Type plain /Type \n   /Label \n   Input \n     AssistiveText \n      Please supply either domain\\user or user@fully.qualified.domain.name\n     AssistiveText \n     Text \n       Secret false /Secret \n       ReadOnly false /ReadOnly \n       InitialValue /InitialValue \n       Constraint .+ /Constraint \n     /Text \n   /Input  /Requirement", 
            "title": "Assistive Text"
        }, 
        {
            "location": "/common-authentication-forms-language/#detailed-example-forms", 
            "text": "", 
            "title": "Detailed Example Forms"
        }, 
        {
            "location": "/common-authentication-forms-language/#username-password-domain", 
            "text": "The following form defines a user name and password form, with the ability to save credentials on the client, assistive text and a cancel button, that renders in Citrix Receiver for Windows as shown below:   Note that the Secure connection marking is supplied by Receiver independently of the form description.  ?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/response/1 \n   Status success /Status \n   Result more-info /Result \n   StateContext / \n   AuthenticationRequirements \n     PostBack /Citrix/Authentication/ExplicitForms/AuthenticateAttempt /PostBack \n     CancelPostBack /Citrix/Authentication/ExplicitForms/CancelAuthenticate /CancelPostBack \n     CancelButtonText Cancel /CancelButtonText \n     Requirements \n       Requirement \n         Credential \n           ID username /ID \n           SaveID ExplicitForms-Username /SaveID \n           Type username /Type \n         /Credential \n         Label \n           Text User name: /Text \n           Type plain /Type \n         /Label \n         Input \n           AssistiveText Please supply either domain\\username or user@fully.qualified.domain /AssistiveText \n           Text \n             Secret false /Secret \n             ReadOnly false /ReadOnly \n             InitialValue /InitialValue \n             Constraint .+ /Constraint \n           /Text \n         /Input \n       /Requirement \n       Requirement \n         Credential \n           ID password /ID \n           SaveID ExplicitForms-Password /SaveID \n           Type password /Type \n         /Credential \n         Label \n           Text Password: /Text \n           Type plain /Type \n         /Label \n         Input \n           Text \n             Secret true /Secret \n             ReadOnly false /ReadOnly \n             InitialValue /InitialValue \n             Constraint .+ /Constraint \n           /Text \n         /Input \n       /Requirement \n       Requirement \n         Credential \n           ID saveCredentials /ID \n           Type savecredentials /Type \n         /Credential \n         Label \n           Text Remember my password /Text \n           Type plain /Type \n         /Label \n         Input \n           CheckBox \n             InitialValue false /InitialValue \n           /CheckBox \n         /Input \n       /Requirement \n       Requirement \n        Credential \n          ID loginBtn /ID \n          Type none /Type \n        /Credential \n        Label \n          Type none /Type \n        /Label \n        Input \n          Button Log On /Button \n        /Input \n       /Requirement \n     /Requirements \n   /AuthenticationRequirements  /AuthenticateResponse", 
            "title": "Username, Password, Domain"
        }, 
        {
            "location": "/common-authentication-forms-language/#username-password-with-inline-error-message", 
            "text": "In the previous example, if the password supplied by the user was incorrect, then the server will return the following form:  ?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/response/1 \n   Status success /Status \n   Result more-info /Result \n   StateContext / \n   AuthenticationRequirements \n     PostBack /Citrix/Authentication/ExplicitForms/AuthenticateAttempt /PostBack \n     CancelPostBack /Citrix/Authentication/ExplicitForms/CancelAuthenticate /CancelPostBack \n     CancelButtonText Cancel /CancelButtonText \n     Requirements \n       Requirement \n         Credential \n           ID username /ID \n           SaveID ExplicitForms-Username /SaveID \n           Type username /Type \n         /Credential \n         Label \n           Text User name /Text \n           Type plain /Type \n         /Label \n         Input \n           AssistiveText Please supply either domain\\username or user@fully.qualified.domain /AssistiveText \n           Text \n             Secret false /Secret \n             ReadOnly false /ReadOnly \n             InitialValue domain\\user /InitialValue \n             Constraint .+ /Constraint \n           /Text \n         /Input \n       /Requirement \n       Requirement \n         Credential \n           ID password /ID \n           SaveID ExplicitForms-Password /SaveID \n           Type password /Type \n         /Credential \n         Label \n           Text Password: /Text \n           Type plain /Type \n         /Label \n         Input \n           Text \n             Secret true /Secret \n             ReadOnly false /ReadOnly \n             InitialValue /InitialValue \n             Constraint .+ /Constraint \n           /Text \n         /Input \n       /Requirement \n       Requirement \n         Credential \n           Type none /Type \n         /Credential \n         Label \n           Text Incorrect user name or password /Text \n           Type error /Type \n         /Label \n         Input / \n       /Requirement \n       Requirement \n         Credential \n           ID saveCredentials /ID \n           Type savecredentials /Type \n         /Credential \n         Label \n           Text Remember my password /Text \n           Type plain /Type \n         /Label \n         Input \n           CheckBox \n             InitialValue false /InitialValue \n           /CheckBox \n         /Input \n       /Requirement \n       Requirement \n         Credential \n           ID loginBtn /ID \n           Type none /Type \n         /Credential \n         Label \n           Type none /Type \n         /Label \n         Input \n           Button Log On /Button \n         /Input \n       /Requirement \n     /Requirements \n   /AuthenticationRequirements  /AuthenticateResponse  This is rendered by Citrix Receiver for Windows as:", 
            "title": "Username, Password with Inline Error Message"
        }, 
        {
            "location": "/common-authentication-forms-language/#username-password-domain-selection-from-list", 
            "text": "The following form defines a user name and password form with domain selection from a list, with the ability to save credentials on the client, and a Cancel button, that renders as shown below:   ?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/response/1 \n   Status success /Status \n   Result more-info /Result \n   StateContext / \n   AuthenticationRequirements \n     PostBack /Citrix/Authentication/ExplicitForms/AuthenticateAttempt /PostBack \n     CancelPostBack /Citrix/Authentication/ExplicitForms/CancelAuthenticate /CancelPostBack \n     CancelButtonText Cancel /CancelButtonText \n     Requirements \n     Requirement \n       Credential \n         Type none /Type \n       /Credential \n       Label \n         Text Please log on /Text \n         Type heading /Type \n       /Label \n       Input / \n     /Requirement \n     Requirement \n       Credential \n         ID username /ID \n         SaveID ExplicitForms-Username /SaveID \n         Type username /Type \n       /Credential \n       Label \n         Text User name: /Text \n         Type plain /Type \n       /Label \n       Input \n         Text \n           Secret false /Secret \n           ReadOnly false /ReadOnly \n           InitialValue /InitialValue \n           Constraint .+ /Constraint \n         /Text \n       /Input \n     /Requirement \n     Requirement \n       Credential \n         ID password /ID \n         SaveID ExplicitForms-Password /SaveID \n         Type password /Type \n       /Credential \n       Label \n         Text Password: /Text \n         Type plain /Type \n       /Label \n         Input \n           Text \n             Secret true /Secret \n             ReadOnly false /ReadOnly \n             InitialValue /InitialValue \n             Constraint .+ /Constraint \n           /Text \n         /Input \n       /Requirement \n       Requirement \n         Credential \n           ID domain /ID \n           SaveID ExplicitForms-Domain /SaveID \n           Type domain /Type \n         /Credential \n         Label \n           Text Domain: /Text \n           Type plain /Type \n         /Label \n         Input \n           ComboBox \n             InitialSelection domain /InitialSelection \n             DisplayValues \n               DisplayValue \n                 Display domain /Display \n                 Value domain /Value \n               /DisplayValue \n               DisplayValue \n                 Display other /Display \n                 Value animaniacs /Value \n               /DisplayValue \n             /DisplayValues \n           /ComboBox \n         /Input \n       /Requirement \n       Requirement \n         Credential \n           ID saveCredentials /ID \n           Type savecredentials /Type \n         /Credential \n         Label \n           Text Remember my password /Text \n           Type plain /Type \n         /Label \n         Input \n           CheckBox \n             InitialValue false /InitialValue \n           /CheckBox \n         /Input \n       /Requirement \n       Requirement \n         Credential \n           ID loginBtn /ID \n           Type none /Type \n         /Credential \n         Label \n           Type none /Type \n         /Label \n         Input \n           Button Log On /Button \n         /Input \n       /Requirement \n     /Requirements \n   /AuthenticationRequirements  /AuthenticateResponse  When the user fills in their user name and password, selects not to save their password on the client, and the Log On button is activated, then following is returned to the server:   POST https://server/Citrix/Authentication/ExplicitForms/AuthenticateAttempt HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\nAccept: application/vnd.citrix.authenticateresponse-1+xml, \n        application/vnd.citrix.requesttokenresponse+xml\nAccept-Language: en\nHost: server\nContent-Length: 96\nConnection: Keep-Alive\nCache-Control: no-cache\nCookie: ASP.NET_SessionId=abcdefg123456\n\nStateContext= domain=mydomain loginBtn=Log+On password=mypswd saveCredentials=false username=me", 
            "title": "Username, Password, Domain Selection From List"
        }, 
        {
            "location": "/common-authentication-forms-language/#change-password", 
            "text": "This form is carefully distinguished from other generic credential collection forms, by having a distinct   code in the control block. This is needed so that Receivers which support saving credentials can react appropriately. It includes the user name value as a read-only credential input, and submit both password and newpassword credential values. This form also illustrates the ability to have pre-filled and read-only input fields.   ?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/response/1 \n   Status success /Status \n   Result update-credentials /Result \n   StateContext/ \n   AuthenticationRequirements \n     PostBack /Citrix/Authentication/ExplicitForms /PostBack \n     CancelPostBack /Citrix/Authentication/ExplicitForms/Cancel /CancelPostBack \n     CancelButtonText Cancel /CancelButtonText \n     Requirements \n       Requirement \n         Credential \n           Type none /Type \n         /Credential \n         Label \n           Text Change Expired Password /Text \n           Type heading /Type \n         /Label \n         Input / \n       /Requirement \n       Requirement \n         Credential \n           Type username /Type \n         /Credential \n         Label \n           Text User name: /Text \n           Type plain /Type \n         /Label \n         Input \n           Text \n             Secret false /Secret \n             ReadOnly true /ReadOnly \n             InitialValue animaniacs\\expiredpassword /InitialValue \n             Constraint .+ /Constraint \n           /Text \n         /Input \n       /Requirement \n       Requirement \n         Credential \n           ID oldPassword /ID \n           Type password /Type \n         /Credential \n         Label \n           Text Old password: /Text \n           Type plain /Type \n         /Label \n         Input \n           Text \n             Secret true /Secret \n             ReadOnly false /ReadOnly \n             InitialValue /InitialValue \n             Constraint .+ /Constraint \n           /Text \n         /Input \n       /Requirement \n       Requirement \n         Credential \n           ID newPassword /ID \n           SaveID ExplicitForms-Password /SaveID \n           Type newpassword /Type \n         /Credential \n         Label \n           Text New password: /Text \n           Type plain /Type \n         /Label \n         Input \n           Text \n             Secret true /Secret \n             ReadOnly false /ReadOnly \n             InitialValue /InitialValue \n             Constraint .+ /Constraint \n           /Text \n         /Input \n       /Requirement \n       Requirement \n         Credential \n           ID confirmPassword /ID \n           Type newpassword /Type \n         /Credential \n         Label \n           Text Confirm password: /Text \n           Type plain /Type \n         /Label \n         Input \n           Text \n             Secret true /Secret \n             ReadOnly false /ReadOnly \n             InitialValue /InitialValue \n             Constraint .+ /Constraint \n           /Text \n         /Input \n       /Requirement \n       Requirement \n         Credential \n           ID changePasswordBtn /ID \n           Type none /Type \n         /Credential \n         Label \n           Type none /Type \n         /Label \n         Input \n           Button OK /Button \n         /Input \n       /Requirement \n     /Requirements \n   /AuthenticationRequirements  /AuthenticateResponse", 
            "title": "Change Password"
        }, 
        {
            "location": "/common-authentication-forms-language/#confirmation-message", 
            "text": "This example illustrates a message display form that is used to provide important user feedback, such as when the users password has been changed in the example above. This form suppresses the Cancel button to indicate to the user that it is only requesting acknowledgement of a noteworthy state change. The user can still cancel the authentication process in other ways, such as pressing Esc key or using the window close control. Citrix Reciever renders the forms as follows:  ?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/response/1 \n   Status success /Status \n   Result more-info /Result \n   StateContext / \n   AuthenticationRequirements \n     PostBack /Citrix/Authentication/ExplicitForms/ChangePasswordConfirm /PostBack \n     CancelPostBack /CancelPostBack \n     Requirements \n       Requirement \n         Credential \n           Type none /Type \n         /Credential \n         Label \n           Text Your password has been changed successfully. /Text \n           Type confirmation /Type \n         /Label \n         Input / \n       /Requirement \n       Requirement \n         Credential \n           ID changePasswordConfirmBtn /ID \n           Type none /Type \n         /Credential \n         Label \n           Type none /Type \n         /Label \n         Input \n           Button OK /Button \n         /Input \n       /Requirement \n     /Requirements \n   /AuthenticationRequirements  /AuthenticateResponse", 
            "title": "Confirmation Message"
        }, 
        {
            "location": "/common-authentication-forms-language/#generic-radius-challenge", 
            "text": "This example illustrates the flexibility to have long descriptions and long input fields (without a preceding label), and to control line wrapping by using multiple labels.  ?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/response/1 \n     Status success /Status \n     Result more-info /Result \n     StateContext / \n     AuthenticationRequirements \n         PostBack /serviceLocationPath/ExplicitForms/AuthenticateAttempt /PostBack \n         CancelPostBack /serviceLocationPath/ExplicitForms/CancelAuthenticate /CancelPostBack           Requirements \n             Requirement \n                 Credential \n                     Type none /Type \n                 /Credential \n                 Label \n                     Text Two-Factor Authentication /Text \n                     Type heading /Type \n                 /Label \n                 Input / \n             /Requirement \n             Requirement \n                 Credential \n                     Type none /Type \n                 /Credential \n                 Label \n                     Text The authentication system requires more information. /Text \n                     Type plain /Type \n                 /Label \n                 Input / \n             /Requirement \n             Requirement \n                 Credential \n                     Type none /Type \n                 /Credential \n                 Label \n                     Text PIN accepted. Wait for the tokencode to change then enter the new passcode. /Text \n                     Type plain /Type \n                 /Label \n                 Input / \n             /Requirement \n             Requirement \n                 Credential \n                     ID challengeResponse /ID \n                     Type textcredential /Type \n                 /Credential \n                 Label Type none /Type /Label \n                 Input \n                     Text \n                         Secret true /Secret \n                         ReadOnly false /ReadOnly \n                         InitialValue /InitialValue \n                         Constraint .+ /Constraint \n                     /Text \n                 /Input \n             /Requirement \n             Requirement \n                 Credential \n                     ID submitResponseBtn /ID \n                     Type none /Type \n                 /Credential \n                 Label \n                     Type none /Type \n                 /Label \n                 Input \n                     Button Next /Button \n                 /Input \n             /Requirement \n         /Requirements \n     /AuthenticationRequirements  /AuthenticateResponse", 
            "title": "Generic Radius Challenge"
        }, 
        {
            "location": "/common-authentication-forms-language/#change-expired-pin", 
            "text": "This example illustrates radio buttons.   ?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/response/1 \n     Status success /Status \n     Result more-info /Result \n     StateContext / \n     AuthenticationRequirements \n         PostBack /serviceLocationPath/ExplicitForms/AuthenticateAttempt /PostBack \n         CancelPostBack /serviceLocationPath/ExplicitForms/CancelAuthenticate /CancelPostBack \n         Requirements \n             Requirement \n                 Credential \n                     Type none /Type \n                 /Credential \n                 Label \n                     Text Change Expired PIN /Text \n                     Type heading /Type \n                 /Label \n                 Input / \n             /Requirement \n             Requirement \n                 Credential \n                     Type none /Type \n                 /Credential \n                 Label \n                     Text After changing your PIN, Receiver prompts you log on again. /Text \n                     Type plain /Type \n                 /Label \n                 Input / \n             /Requirement \n             Requirement \n                 Credential \n                     ID changePINmode /ID \n                     Type none /Type \n                 /Credential \n                 Label Type none /Type /Label \n                 Input \n                     RadioButton \n                 InitialSelection 1 /InitialSelection \n                         DisplayValues \n                           DisplayValue \n                             Display Create your own PIN /Display \n                             Value 1 /Value \n                           /DisplayValue \n                           DisplayValue \n                             Display Request PIN from authentication system /Display \n                             Value 2 /Value \n                           /DisplayValue \n                         /DisplayValues \n                     /RadioButton \n                 /Input \n             /Requirement \n             Requirement \n                 Credential \n                     ID submitResponseBtn /ID \n                     Type none /Type \n                 /Credential \n                 Label \n                     Type none /Type \n                 /Label \n                 Input \n                     Button Next /Button \n                 /Input \n             /Requirement \n         /Requirements \n     /AuthenticationRequirements  /AuthenticateResponse", 
            "title": "Change Expired PIN"
        }, 
        {
            "location": "/security-token-services-api/", 
            "text": "Security Token Services API\n\n\nIntroduction\n\n\nScope\n\n\nThe purpose of this document is to describe the StoreFront Security Token Services Application Programming Interface.\n\n\nIdentity Management Systems\n\n\nTraditional systems have centralized identity management systems and each application is responsible for authenticating the user and establishing their identity. This has led to multiple implementations of authentication and authorization systems and applications with differing levels of support for different protocols.\n\n\nIn federated systems the user authenticates once, to an appropriate authentication service, which gathers information regarding the user. This information often takes the form of assertions or claims regarding the user. The claims are then marshalled to other applications or services that rely on the authentication service by a defined set of messages. These \"relying parties\" have been configured to trust the assertions/claims issued by the authentication service, or \"trusted issuer\" and this is commonly enforced by strong cryptographic means such as digital signing and encipherment. The assertions/claims are marshalled as security tokens that are issued by the trusted issuer, held by the application, and presented to other services to gain access to data and services.\n\n\nThe security tokens should be considered to be an opaque blob from which the client should not expect to derive any information. The security tokens are sensitive because they can be used to gain access to resources on the user\u2019s behalf with no additional authentication and are commonly described as \u201cbearer tokens\u201d. Hence it is the client\u2019s responsibility to securely store the token and to not disclose it to inappropriate services.\n\n\nIn the general case, different services will require different security tokens. This is a result of the requirement for the authentication service to encipher the private data so that only the specified relying service can decipher it. This leads to a general interaction pattern where there are a set of authentication endpoints that issue a \u201cprimary\u201d security token to the client. The client can then use this primary authentication token to request specific tokens for specific services from a token-granting service. The client can then present this token to the required service to gain access to data and services.\n\n\nTo facilitate changing the token wire representations, a set of abstract interfaces have been defined, which individual \"Token Providers\" will be required to implement along with base implementations to reduce the amount of new code to be written. Note that although the wire representations are designed to be changeable, the final serialized form is expected to be a Base64 encoded string (see RFC 4648 [http://tools.ietf.org/html/rfc4648]), to enable easy transport within HTTP requests and responses.\n\n\nThe remainder of this document describes the various endpoints associated with the issuing of security tokens and the messages used to interact with security token services.\n\n\nGeneral Interaction Pattern\n\n\n\n\nThe following sequence diagram illustrates how the client and server interact to obtain and use the security tokens, through the exchange of strongly typed messages that are defined in this document.\n\n\nIn general, the sequence is triggered by a client accessing a protected URL and receiving a CitrixAuth challenge, which is further described in the CitrixAuth Authentication Scheme v1.2 document. The client should expect to be challenged at any time when accessing endpoints within the StoreFront or CloudGateway solution.\n\n\nIt is the clients\u2019 responsibility to parse this information and to create the Request Token message, which is described below. This message should then be sent to the authentication service URL to obtain the required security token by means of a HTTP POST. This token is returned as part of the Request Token Response, also described below.\n\n\nThe client may be directed to an URL to perform primary authentication at which time they may receive a HTTP Multiple choices response as a Request Token Choices message, defined below. It is the clients\u2019 responsibility to understand this data and to choose an authentication protocol and associated URL to authenticate to.\n\n\nSecurity Token Messages\n\n\nThe conversation between the client and services is a series, or conversation, of strongly typed messages, described below:\n\n\n\n\nRequest Token: This message is sent from the client to the authentication service to request a token for a specific service.\n\n\nRefresh Token: This message is sent from the client to the authentication service to request that a token be refreshed, that is, the token validity period is extended.\n\n\nRequest Token Response: This message is returned by the authentication service in response to a Request Token or a Refresh Token message, and returns a token to the client.\n\n\nDestroy Token: This message is sent by the client to the authentication service to tell the service to destroy any server-side state held by the service for a specific token.\n\n\nDestroy Token Response: This message is returned by the authentication service in response to a Destroy Token message and details the status of the token that was the subject of the Destroy Token message.\n\n\nRequest Token Choices: This message is returned by the authentication service in response to a Request Token message. It details the available choices for primary authentication in order to obtain a token.\n\n\n\n\nThe messages are now described in more detail.\n\n\nRequest Token\n\n\nThe following information is required by the authentication and token-for-service processes in order to be able to construct the correct security token. The data is sent as XML in the body of the POST, the schema for which can be found at: /Schemas/RequestToken.xsd\n\n\n\n\n\n\n\n\nParameter\n\n\nRequired\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nfor-service\n\n\nYes\n\n\nA string identifying the service for which the requested token is targeted.\n\n\n\n\n\n\nfor-service-url\n\n\nYes\n\n\nA string representing the URL of the service, from the client\u2019s perspective, for which the token is being requested\n\n\n\n\n\n\nreqtokentemplate\n\n\nYes\n\n\nThe required template for the claims in the token. This may be empty.\n\n\n\n\n\n\nrequested-lifetime\n\n\nOptional\n\n\nThe requested lifetime for the token. The format is that accepted by the System.TimeSpan.TryParse() method: \n .d.hh:mm:ss[.ff] \n where d = days, hh = hours, mm = minutes, ss = seconds, and ff = fractions of seconds.\n\n\n\n\n\n\nreason\n\n\nOptional\n\n\nIf a token has been rejected by a service, the reason gives a hint to the service as to how to resolve the issue.\n\n\n\n\n\n\n\n\n\n\nNotes\n\n\n\n\nRequest Token messages may require a valid Authorization header (see the CitrixAuth Authentication Scheme v1.2 document).\n\n\nIf the requested lifetime is not specified, then the default lifetime specified by the server administrator will be used.\n\n\nIf the requested lifetime is longer than the maximum token lifetime, the resulting token may have a shorter lifetime than that requested.\n\n\nIf the requested lifetime is longer than a lifetime associated with any state held on the server, the resulting token may again have a shorter lifetime than that requested.\n\n\n\n\n\n\nRequest Token Response\n\n\nThe following information is returned by the authentication and token-for-service processes in response to a request for a token. The data is sent as XML in the body of the POST, the schema for which can be found at: /Schemas/RequestTokenResponse.xsd\n\n\n\n\n\n\n\n\nParameter\n\n\nRequired\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nfor-service\n\n\nYes\n\n\nA string identifying the service for which the requested token is targeted.\n\n\n\n\n\n\nIssued\n\n\nYes\n\n\nThe issued time of token, expressed in ISO 8601 Utc format:YYYY-MM-DDThh:mm:ss.fZ\nWhere; YYYY is the year, MM the month, DD the day, hh the hour in the day, mm the minutes, ss the seconds, and f the optional decimel fraction of seconds.\n\n\n\n\n\n\nExpiry\n\n\nYes\n\n\nThe expiry time of the token, expressed in ISO 8601 Utc format.\n\n\n\n\n\n\nLifetime\n\n\nYes\n\n\nThe lifetime of the token in the format d.hh:mm:ss[.f] as above.\n\n\n\n\n\n\ntoken-template\n\n\nYes\n\n\nThe claim template, which may be empty.\n\n\n\n\n\n\ntoken\n\n\nYes\n\n\nThe serialized token as a Base64 encoded string (see RFC 4648 [http://tools.ietf.org/html/rfc4648]).\n\n\n\n\n\n\n\n\n\n\nNotes\n\n\nThe XML is \u201copen\u201d and extensible, allowing additional elements to appear in the XML. This is used by the Common Forms Protocol to provide additional information, such as password expiry warnings, as shown in the example below:\n\n\n\n\nExample:\n Request Security Token Response with password expiry warning\n\n\nRequest\n\n\nPOST https://www.example.com/Citrix/Authentication/auth/v1/token HTTP/1.1\nContent-Type: application/vnd.citrix.requesttoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml, application/vnd.citrix.requesttokenchoices+xml\nContent-Encoding: utf-8\nHost: www.example.com\nContent-Length: xxx\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n?\n\n\nrequesttoken xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/requesttoken\n\n  \nfor-service\n6b78ab94-a709-4e3a-8b9b-a49ca317c70c\n/for-service\n\n  \nfor-service-url\nhttps://www.example.com/Citrix/Store/resources/v2\n/for-service-url\n\n  \nreqtokentemplate /\n\n  \nrequested-lifetime\n1.00:00:00\n/requested-lifetime\n\n\n/requesttoken\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache; private; no-store; must-revalidate;\n               max-stale=0; post-check=0; pre-check=0; max-age=0\nPragma: no-cache\nContent-Type: application/vnd.citrix.requesttokenresponse+xml\nContent-Length: xxx\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n?\n\n\nrequesttokenresponse xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/requesttokenresponse\n\n  \nfor-service\n32f585f3-054d-4ee5-a714-b0e11e312308\n/for-service\n\n  \nissued\n2009-05-12T15:27:28.1550000Z\n/issued\n\n  \nexpiry\n2009-05-12T16:27:28.1550000Z\n/expiry\n\n  \nlifetime\n0.20:00:00\n/lifetime\n\n  \ntoken-template /\n\n  \ntoken\nH4sIAAAAAAAEAO29B2AcSZYlJi9tynt\n/token\n\n  \nCredentialUpdateInformationList xmlns=\nhttp://citrix.com/authentication/response/1\n\n    \nCredentialUpdateInformation\n\n      \nCredentialDisplayName\nACME\n/CredentialDisplayName\n\n      \nAuthenticationInfoId\n1\n/AuthenticationInfoId\n\n      \nExpiryTime\n2010-05-12T15:27:28.155Z\n/ExpiryTime\n\n      \nTimeRemaining\n10.05:33:09\n/TimeRemaining\n\n      \nCredentialUpdateService\n\n        /ExplicitForms/ChangePassword\n      \n/CredentialUpdateService\n\n    \n/CredentialUpdateInformation\n\n  \n/CredentialUpdateInformationList\n\n\n/requesttokenresponse\n\n\n\n\nRefresh Token\n\n\nThe following information is required by the token refresh service in order to be able to refresh a security token. The data is sent as XML in the body of the POST, the schema for which can be found at: /Schemas/RefreshToken.xsd\n\n\n\n\n\n\n\n\nParameter\n\n\nRequired\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\ntoken\n\n\nYes\n\n\nThe serialized token as a Base64 encoded string (see RFC 4648 [http://tools.ietf.org/html/rfc4648]).\n\n\n\n\n\n\nnew-requested-lifetime\n\n\nOptional\n\n\nThe requested lifetime for the token. The format is that accepted by the System.TimeSpan.TryParse() method:d\n\n\n\n\n\n\n\n\n\n\nNotes\n\n\n\n\nThe use of this service is deprecated.\n\n\nRefresh Token messages require a valid Authorization header (see the CitrixAuth Authentication Scheme v1.2 document).\n\n\nThe token being refreshed may be different to the token being used for authentication to the service.\n\n\n\n\n\n\nExample\n: Refresh a Security Token\n\n\nRequest\n\n\nPOST https://www.example.com/Citrix/Authentication/auth/v1/token HTTP/1.1\nContent-Type: application/vnd.citrix.refreshtoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml\nAuthorization: CitrixAuth H4Siaaaaaaabfecde12987\nHost: www.example.com\nContent-Length: xxx\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n?\n\n\nrefreshtoken xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/refreshtoken\n\n  \ntoken\nH4sIAAAAAAAEAO29B2\n/token\n\n  \nnew-requested-lifetime\n0.01:00:00\n/new-requested-lifetime\n\n\n/refreshtoken\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: public, no-store, max-age=0\nContent-Type: application/vnd.citrix.requesttokenresponse+xml\nContent-Length: 4182\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n?\n\n\nrequesttokenresponse xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/requesttokenresponse\n\n  \nfor-service\n32f585f3-054d-4ee5-a714-b0e11e312308\n/for-service\n\n  \nissued\n2012-06-12T09:29:11.5210000Z\n/issued\n\n  \nexpiry\n2012-06-12T10:29:30.2896039Z\n/expiry\n\n  \nlifetime\n0.01:00:18.768\n/lifetime\n\n  \ntoken-template /\n\n  \ntoken\nH4sIAAAAAAAEAO29B2AcSZYluwHT+bly1cvP/2pl7/XRXP+7uLb+2GALAEhmQ4AAA==\n/token\n\n\n/requesttokenresponse\n\n\n\n\nDestroy Token\n\n\nThe following information is required by the token service in order to be able to destroy any server-side state associated with the specified security token. The data is sent as XML in the body of the POST, the schema for which can be found at: /Schemas/DestroyToken.xsd\n\n\n\n\n\n\n\n\nParameter\n\n\nRequired\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\ntoken\n\n\nYes\n\n\nThe serialized token as a Base64 encoded string (see RFC 4648 [http://tools.ietf.org/html/rfc4648]).\n\n\n\n\n\n\n\n\n\n\nNotes\n\n\n\n\nDestroy Token messages require a valid Authorization header (see the CitrixAuth Authentication Scheme v1.2 document).\n\n\nThe token being destroyed may be different to the token being used for authentication to the service.\n\n\n\n\n\n\nDestroy Token Response\n\n\nThe following information is returned by the token service in response to a Destroy Token message. The response details the status of any server-side state associated with the specified token. The data is sent as XML in the body of the response. The schema for the XML can be found at: /Schemas/DestroyTokenResponse.xsd.\n\n\n\n\n\n\n\n\nParameter\n\n\nRequired\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nStatus\n\n\nYes\n\n\nThe status of the server-side state held for the specified token.\n\n\n\n\n\n\n\n\nExample\n: Destroy a security token\n\n\nRequest\n\n\nPOST https://www.example.com/Citrix/Authentication/auth/v1/token HTTP/1.1\nContent-Type: application/vnd.citrix.destroytoken+xml\nAccept: application/vnd.citrix.destroytokenresponse+xml\nAuthorization: CitrixAuth H4sIAAAAAAAEAO29B2AcSZYlJbNOZDgAA\nHost: www.example.com\nContent-Length: XXX\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n?\n\n\ndestroytoken xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/destroytoken\n\n  \ntoken\nH4sIAAAAAAAEAO29B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMk2JBAEOzBiM3mkuwdaUZbNOZDgAA\n/token\n\n\n/destroytoken\n\n\n\n\nResponse\n\n\nHTTP/1.1 200 OK\nCache-Control: public, no-store, max-age=0\nContent-Type: application/vnd.citrix.destroytokenresponse+xml\nContent-Length: 183\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n?\n\n\ndestroytokenresponse xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/destroytokenresponse\n\n  \nstatus\ndestroyed\n/status\n\n\n/destroytokenresponse\n\n\n\n\nRequest Token Choices\n\n\nThe following information is returned in response to some Request Token messages and enumerates the different choices of protocols available for authentication. The data is sent as XML in the body of the POST, the schema for which can be found at: /Schemas/RequestTokenChoices.xsd.\n\n\n\n\n\n\n\n\nParameter\n\n\nRequired\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nprotocol\n\n\nYes\n\n\nA unique identifier for the associated protocol.\n\n\n\n\n\n\nlocation\n\n\nYes\n\n\nThe URI to POST the Request Token message to, in order to start the authentication process.\n\n\n\n\n\n\n\n\n\n\nNotes\n\n\nRequest Token Choices are usually returned in response to unauthenticated Request Token messages.\u2003\n\n\n\n\nToken Service Endpoints\n\n\nThis section describes the API to be used to access the token services through simple HTTP requests.\n\n\nAuthentication Protocol Choices\n\n\n\n\nURL: /auth/v1/protocols/\n\n\nHTTP Method: POST\n\n\nAuthentication: None\n\n\nRequest Content-Type: application/vnd.citrix.requesttoken+xml\n\n\nResponse Content-Type: application/vnd.citrix.requesttokenchoices+xml\n\n\n\n\nThis service returns the authentication protocol choices.\n\n\nSpecific Authentication Protocol\n\n\n\n\nURL: Protocol-specific and usually obtained from the Protocol Choices\n\n\nHTTP Method: POST\n\n\nAuthentication: The authentication scheme associated with the route\n\n\nRequest Content-Type: application/vnd.citrix.requesttoken+xml\n\n\nResponse Content-Type: application/vnd.citrix.requesttokenresponse+xml\n\n\n\n\nAuthenticate the user using the authentication protocol specified, to return a Request Token Response.\n\n\n\n\nNotes\n\n\nBetween the POST of the Request Token and the receipt of the the Request Token Response, other HTTP messages may be exchanged as required by the specific protocol. Examples may be: SPNEGO negotiate challenge-responses, HTML forms for forms-based protocols. However, the conversation must always start with the client sending a Request Token Response message, and must always end with the server returning a Request Token Response message.\n\n\n\n\nRequest Security Token\n\n\n\n\nURL: /auth/v1/token\n\n\nHTTP Method: POST\n\n\nAuthentication: CitrixAuth\n\n\nRequest Content-Type: application/vnd.citrix.requesttoken+xml\n\n\nResponse Content-Type: application/vnd.citrix.requesttokenresponse+xml\n\n\n\n\nRequest a security token for the service specified in the Request Token. The token for the required service is returned in the Request Token Response.\n\n\nRefresh Security Token\n\n\n\n\nURL: /auth/v1/token\n\n\nHTTP Method: POST\n\n\nAuthentication: CitrixAuth\n\n\nRequest Content-Type: application/vnd.citrix.refreshtoken+xml\n\n\nResponse Content-Type: application/vnd.citrix.requesttokenresponse+xml\n\n\n\n\nRefresh the specified security token by extending its lifetime by the requested amount. A token can be refreshed up to the maximum lifetime period specified by the administrator. This request is protected by the CitrixAuth protocol, and the authorization token need not be the same as the token being refreshed. The refreshed token is returned in the Request Token Response.\n\n\nDestroy Security Token\n\n\n\n\nURL: /auth/v1/token\n\n\nHTTP Method: POST\n\n\nAuthentication: CitrixAuth\n\n\nRequest Content-Type: application/vnd.citrix.destroytoken+xml\n\n\nResponse Content-Type: application/vnd.citrix.destroytokenresponse+xml\n\n\n\n\nDestroy the server-side data associated with the specified token. This request is protected by the CitrixAuth protocol, and the authorization token need not be the same as the token being destroyed. Note: This doesn\u2019t revoke the security token, but just releases any server-held resources.\n\n\nToken Validation\n\n\n\n\nURL: /auth/v1/token/validate/{tokenValidationServiceId}\n\n\nHTTP Method: GET\n\n\nAuthentication: CitrixAuth\n\n\nResponse Content-Type: application/vnd.citrix.claimsidentity+xml\n\n\n\n\nReturn a filtered list of claims extracted from the CitrixAuth authorization token, if the the token is valid. The filtering of the claims is controlled by the administrator of the service.\n\n\n\n\nNotes\n\n\n{tokenValidationServiceId} denotes a parameter used to identify a particular token validation service. This parameter can be omitted, in which case the value default is used to identify the default token validation service. The default token validation service is utilised by Citrix Merchandising Servers to enable single sign-on. It can also be used to extract information regarding the claims in the primary token, if allowed by the server.\n\n\n\n\nCloudGateway AppControllers also utilize the token validation service. For AppControllers the {tokenValidationServiceId} parameter should be the fully qualified host name associated with the AppController.\n\n\nWire-Level Examples\n\n\nRequest to the Service Provider\n\n\nThe following  \u201cwire-level\u201d example shows all the HTTP requests and responses when a client attempts to access a protected service (the resources service) and has to obtain security tokens to be granted access.\n\n\nRequest to Service Provider\n\n\nGET https://www.example.com/resources/v2 HTTP/1.1\nHost: www.example.com\nAccept: application/vnd.citrix.resources+xml\nResponse from Service Provider\nHTTP/1.1 401 Unauthorized\nCache-Control: public, no-store, max-age=0\nWWW-Authenticate: CitrixAuth realm=\n6b78ab94-a709-4e3a-8b9b-a49ca317c70c\n,\n                             reqtokentemplate=\n, reason=\nnotoken\n,\n                             locations=\nhttps://www.example.com/Citrix/Authentication/auth/v1/token\n,\n                             serviceroot-hint=https://www.example.com/Citrix/Store/resources/v2\n\n\n\n\nAt this point the client has to take the information provided in the CitrixAuth challenge and construct a Request for Security Token message to be POSTed to the URL specified in the challenge.\n\n\nRequest to Authentication Service\n\n\nPOST https://www.example.com/Citrix/Authentication/auth/v1/token HTTP/1.1\nContent-Type: application/vnd.citrix.requesttoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml, application/vnd.citrix.requesttokenchoices+xml\nContent-Encoding: utf-8\nHost: www.example.com\nContent-Length: xxx\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n?\n\n\nrequesttoken xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/requesttoken\n\n  \nfor-service\n6b78ab94-a709-4e3a-8b9b-a49ca317c70c\n/for-service\n\n  \nfor-service-url\nhttps://www.example.com/Citrix/Store/resources/v2\n/for-service-url\n\n  \nreqtokentemplate /\n\n  \nrequested-lifetime\n1.06:00:00\n/requested-lifetime\n\n\n/requesttoken\n\n\n\n\nResponse from Service Provider\n\n\nHTTP/1.1 401 Unauthorized\nCache-Control: public, no-store, max-age=0\nWWW-Authenticate: CitrixAuth realm=\n32f585f3-054d-4ee5-a714-b0e11e312308\n,\n                     reqtokentemplate=\n, reason=\nnotoken\n   \n                     locations=\nhttps://www.example.com/Citrix/Authentication/auth/v1/protocols\n,\n                     serviceroot-hint=\nhttps://www.example.com/Citrix/Authentication/auth/v1/token\n\n\nHence, the result of this sequence is another challenge, because the client has not presented the security token required to access the token issuing service. The client must therefore parse the challenge again to construct another Request Security Token message and POST it to the indicated URI, as follows:\nRequest to Authentication Service\nPOST https://www.example.com/Citrix/Authentication/auth/v1/protocols HTTP/1.1\nContent-Type: application/vnd.citrix.requesttoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml, application/vnd.citrix.requesttokenchoices+xml\nContent-Encoding: utf-8\nHost: www.example.com\nContent-Length: xxx\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n?\n\n\nrequesttoken xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/requesttoken\n\n  \nfor-service\n32f585f3-054d-4ee5-a714-b0e11e312308\n/for-service\n\n  \nfor-service-url\nhttps://www.example.com/Citrix/Authentication/auth/v1/token\n/for-service-url\n\n  \nreqtokentemplate /\n\n  \nrequested-lifetime\n1.06:00:00\n/requested-lifetime\n\n\n/requesttoken\n\n\n\n\nResponse from Service Provider\n\n\nHTTP/1.1 300 Multiple Choices\nCache-Control: public, no-store, max-age=0\nContent-Type: application/vnd.citrix.requesttokenchoices+xml\nContent-Length: xxx\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n?\n\n\nrequesttokenchoices xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/requesttokenchoices\n\n  \nchoices\n\n    \nchoice\n\n      \nprotocol\nExplicitForms\n/protocol\n\n      \nlocation\nhttps://www.example.com/Citrix/Authentication/ExplicitForms/Authenticate\n/location\n\n    \n/choice\n\n  \n/choices\n\n\n/requesttokenchoices\n\n\n\n\nIn this case the authentication service has responded with a HTTP 300 (Multiple Choices) response, indicating that the security token can be obtained from a choice of URIs. In this case, each choice represents a different authentication protocol. It is the clients\u2019 responsibility to choose an appropriate protocol and endpoint to start the authentication process, by resending the Request Token message to the chosen endpoint, as illustrated below:\n\n\nRequest to Authentication Service\n\n\nPOST https://www.example.com/Citrix/Authentication/ExplicitForms/Authenticate HTTP/1.1\nContent-Type: application/vnd.citrix.requesttoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml, text/xml, application/vnd.citrix.authenticateresponse-1+xml\nHost: www.example.com\nContent-Length: xxx\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n?\n\n\nrequesttoken xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/requesttoken\n\n  \nfor-service\n32f585f3-054d-4ee5-a714-b0e11e312308\n/for-service\n\n  \nfor-service-url\nhttps://www.example.com/Citrix/Authentication/auth/v1/token\n/for-service-url\n\n  \nreqtokentemplate /\n\n  \nrequested-lifetime\n1.06:00:00\n/requested-lifetime\n\n\n/requesttoken\n\n\n\n\nThe server and client then participate in the authentication protocol sequence, until the server responds with a Request Token Response, as follows:\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache; private; no-store; must-revalidate; max-stale=0; post-check=0;\n               pre-check=0; max-age=0\nContent-Type: application/vnd.citrix.requesttokenresponse+xml\nContent-Length: xxx\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n?\n\n\nrequesttokenresponse xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/requesttokenresponse\n\n  \nfor-service\n32f585f3-054d-4ee5-a714-b0e11e312308\n/for-service\n\n  \nissued\n2012-06-12T09:50:53.8436039Z\n/issued\n\n  \nexpiry\n2012-06-13T05:50:53.8436039Z\n/expiry\n\n  \nlifetime\n0.20:00:00\n/lifetime\n\n  \ntoken-template /\n\n  \ntoken\nH4sIAAAAAAAEAO29B2AcSZYlJi9tynt/Sv8Id/T8DXarOsQ4AAA==\n/token\n\n  \nCredentialUpdateInformationList xmlns=\nhttp://citrix.com/authentication/response/1\n\n    \nCredentialUpdateInformation\n\n      \nCredentialDisplayName\nexample.com\n/CredentialDisplayName\n\n      \nAuthenticationInfoId\nCitrix Common Forms 1.0\n/AuthenticationInfoId\n\n      \nCredentialUpdateService /\n\n    \n/CredentialUpdateInformation\n\n  \n/CredentialUpdateInformationList\n\n\n/requesttokenresponse\n\n\n\n\nThe client can then use this data to request a token from the token issuing service as follows:\n\n\nRequest to Authentication Service\n\n\nPOST https://www.example.com/Citrix/Authentication/auth/v1/token HTTP/1.1\nContent-Type: application/vnd.citrix.requesttoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml, application/vnd.citrix.requesttokenchoices+xml\nContent-Encoding: utf-8\nAuthorization: CitrixAuth H4sIAAAAAAAEAO29B2AcSZYlJi9tynt/Sv8Id/T8DXarOsQ4AAA==\nHost: www.example.com\nContent-Length: xxx\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n?\n\n\nrequesttoken xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/requesttoken\n\n  \nfor-service\n6b78ab94-a709-4e3a-8b9b-a49ca317c70c\n/for-service\n\n  \nfor-service-url\nhttps://www.example.com/Citrix/Store/resources/v2\n/for-service-url\n\n  \nreqtokentemplate /\n\n  \nrequested-lifetime\n1.06:00:00\n/requested-lifetime\n\n\n/requesttoken\n\n\n\n\nResponse from Service Provider\n\n\nHTTP/1.1 200 OK\nCache-Control: public, no-store, max-age=0\nContent-Type: application/vnd.citrix.requesttokenresponse+xml\nContent-Length: xxx\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n?\n\n\nrequesttokenresponse xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/requesttokenresponse\n\n  \nfor-service\n6b78ab94-a709-4e3a-8b9b-a49ca317c70c\n/for-service\n\n  \nissued\n2012-06-12T09:50:53.9106039Z\n/issued\n\n  \nexpiry\n2012-06-12T10:50:53.9106039Z\n/expiry\n\n  \nlifetime\n0.01:00:00\n/lifetime\n\n  \ntoken-template /\n\n  \ntoken\nH4sIAAAAAAAEAO29B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMKioDgAA\n/token\n\n\n/requesttokenresponse\n\n\n\n\nThe client can then use this data to authorize the original request to the service provider to obtain the requested data, as follows:\n\n\nRequest to Service Provider (Resources)\n\n\nGET https://www.example.com/Citrix/Store/resources/v2 HTTP/1.1\nAccept: application/vnd.citrix.resources+xml\nAccept-Encoding: gzip, deflate,gzip, deflate\nAuthorization: CitrixAuth H4sIAAAAAAAEAO29B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMKioDgAA\nHost: www.example.com\nResponse from Service Provider (Resources)\nHTTP/1.1 200 OK\nCache-Control: public, no-store, max-age=0\nContent-Type: application/vnd.citrix.resources+xml\nContent-Length: xxx\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n?\n\n\nresources xmlns=\nhttp://citrix.com/delivery-services/2-0/resources\n\n           xmlns:a=\nhttp://citrix.com/delivery-services/2-0/subscriptions\n\n           enumeration=\nfull\n a:subscriptionsstatus=\nenabled\n\n  \nresource\n\n\u2026\n  \n/resource\n\n\n/resources\n\n\n\n\nToken Validation Service\n\n\nThe client of the token validation service, which may be Citrix Merchandising Server or CloudGateway AppController, initially sends the following request for the default token validation service:\n\n\nRequest to Authentication Service\n\n\nGET https://www.example.com/auth/V1/token/validate HTTP/1.1\nHost: www.example.com\nAccept: application/vnd.citrix.claimsidentity+xml\nResponse from Authentication Service\n\nServer: HTTP/1.1 401 Unauthorized\nWWW-Authenticate: CitrixAuth realm=\n 2deb9210-cb41-4b1f-a27e-93e4980b2e31\n,\n                             reqtokentemplate=\n,reason=\nnotoken\n,\n                             locations=\nhttps://www.example.com/auth/v1/token\n,\n                             serviceroot-hint=\nhttps://www.example.com/auth/v1/token\n\n\n\n\nThe client again uses the challenge to construct a Request Security Token message and obtains a security token. When a token has been obtained for the Token Validation Service, the client sends:\n\n\nRequest to Authentication Service\n\n\nGET https://www.example.com/auth/V1/token/validate HTTP/1.1\nHost: www.example.com\nAuthorization: CitrixAuth K5tIBBBBB\u2026cFADyBVAAA==\nAccept: application/vnd.citrix.claimsidentity+xml\nResponse from Authentication Service\n\nHTTP/1.1 200 OK\nContent-Type: application/vnd.citrix.claimsidentity+xml\nContent-Length: xxx\nCache-Control: no-store\n\n\n?xml version =\n1.0\n encoding=\nutf-8\n?\n\n\nclaimsPrincipal xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/claimsprincipal\n\n  \nidentity name='example\\user' isAuthenticated='true' authMethod='Citrix Common Forms 1.0' /\n\n    \nclaims\n\n    \nclaim type='http://schemas.xmlsoap.org/ws/2005/05/identity/claims/sid'\n\n           value='S-1-5-21-xxx-1128' valueType='string'\n           issuer='801e81a8-9d22-4163-bff6-3c9d41156f0e'\n           original='801e81a8-9d22-4163-bff6-3c9d41156f0e'\n\n      \nproperties\n\n        \nproperty name='groups'\n                  value='S-1-5-21-xxx-513,S-1-1-0,S-1-5-21-xxx-1011,\n                         S-1-5-21-xxx-1012,S-1-5-21-xxx-1018,\n                         S-1-5-32-555,\n                         S-1-5-32-545,\n                         S-1-5-14,\n                         S-1-5-4,\n                         S-1-5-11,\n                         S-1-5-15,\n                         S-1-2-0,S-1-5-21-xxx-2187,S-1-5-21-xxx-2233' /\n\n      \n/properties\n\n    \n/claim\n\n    \nclaim type=\nuri:citrix.deliveryservices.claim.directoryproperties\n value=\nuser\n \n           valueType=\nstring\n issuer=\n801e81a8-9d22-4163-bff6-3c9d41156f0e\n\n           original=\n801e81a8-9d22-4163-bff6-3c9d41156f0e\n\n      \nproperties\n\n        \nproperty name=\ndisplayName\n value=\nFull username\n/\n\n        \nproperty name=\nmail\n value=\nuser@example.com\n/\n\n      \n/properties\n\n \n/claim\n\n\n/claimsPrincipal", 
            "title": "Security Token Services API"
        }, 
        {
            "location": "/security-token-services-api/#security-token-services-api", 
            "text": "", 
            "title": "Security Token Services API"
        }, 
        {
            "location": "/security-token-services-api/#introduction", 
            "text": "", 
            "title": "Introduction"
        }, 
        {
            "location": "/security-token-services-api/#scope", 
            "text": "The purpose of this document is to describe the StoreFront Security Token Services Application Programming Interface.", 
            "title": "Scope"
        }, 
        {
            "location": "/security-token-services-api/#identity-management-systems", 
            "text": "Traditional systems have centralized identity management systems and each application is responsible for authenticating the user and establishing their identity. This has led to multiple implementations of authentication and authorization systems and applications with differing levels of support for different protocols.  In federated systems the user authenticates once, to an appropriate authentication service, which gathers information regarding the user. This information often takes the form of assertions or claims regarding the user. The claims are then marshalled to other applications or services that rely on the authentication service by a defined set of messages. These \"relying parties\" have been configured to trust the assertions/claims issued by the authentication service, or \"trusted issuer\" and this is commonly enforced by strong cryptographic means such as digital signing and encipherment. The assertions/claims are marshalled as security tokens that are issued by the trusted issuer, held by the application, and presented to other services to gain access to data and services.  The security tokens should be considered to be an opaque blob from which the client should not expect to derive any information. The security tokens are sensitive because they can be used to gain access to resources on the user\u2019s behalf with no additional authentication and are commonly described as \u201cbearer tokens\u201d. Hence it is the client\u2019s responsibility to securely store the token and to not disclose it to inappropriate services.  In the general case, different services will require different security tokens. This is a result of the requirement for the authentication service to encipher the private data so that only the specified relying service can decipher it. This leads to a general interaction pattern where there are a set of authentication endpoints that issue a \u201cprimary\u201d security token to the client. The client can then use this primary authentication token to request specific tokens for specific services from a token-granting service. The client can then present this token to the required service to gain access to data and services.  To facilitate changing the token wire representations, a set of abstract interfaces have been defined, which individual \"Token Providers\" will be required to implement along with base implementations to reduce the amount of new code to be written. Note that although the wire representations are designed to be changeable, the final serialized form is expected to be a Base64 encoded string (see RFC 4648 [http://tools.ietf.org/html/rfc4648]), to enable easy transport within HTTP requests and responses.  The remainder of this document describes the various endpoints associated with the issuing of security tokens and the messages used to interact with security token services.", 
            "title": "Identity Management Systems"
        }, 
        {
            "location": "/security-token-services-api/#general-interaction-pattern", 
            "text": "The following sequence diagram illustrates how the client and server interact to obtain and use the security tokens, through the exchange of strongly typed messages that are defined in this document.  In general, the sequence is triggered by a client accessing a protected URL and receiving a CitrixAuth challenge, which is further described in the CitrixAuth Authentication Scheme v1.2 document. The client should expect to be challenged at any time when accessing endpoints within the StoreFront or CloudGateway solution.  It is the clients\u2019 responsibility to parse this information and to create the Request Token message, which is described below. This message should then be sent to the authentication service URL to obtain the required security token by means of a HTTP POST. This token is returned as part of the Request Token Response, also described below.  The client may be directed to an URL to perform primary authentication at which time they may receive a HTTP Multiple choices response as a Request Token Choices message, defined below. It is the clients\u2019 responsibility to understand this data and to choose an authentication protocol and associated URL to authenticate to.", 
            "title": "General Interaction Pattern"
        }, 
        {
            "location": "/security-token-services-api/#security-token-messages", 
            "text": "The conversation between the client and services is a series, or conversation, of strongly typed messages, described below:   Request Token: This message is sent from the client to the authentication service to request a token for a specific service.  Refresh Token: This message is sent from the client to the authentication service to request that a token be refreshed, that is, the token validity period is extended.  Request Token Response: This message is returned by the authentication service in response to a Request Token or a Refresh Token message, and returns a token to the client.  Destroy Token: This message is sent by the client to the authentication service to tell the service to destroy any server-side state held by the service for a specific token.  Destroy Token Response: This message is returned by the authentication service in response to a Destroy Token message and details the status of the token that was the subject of the Destroy Token message.  Request Token Choices: This message is returned by the authentication service in response to a Request Token message. It details the available choices for primary authentication in order to obtain a token.   The messages are now described in more detail.", 
            "title": "Security Token Messages"
        }, 
        {
            "location": "/security-token-services-api/#request-token", 
            "text": "The following information is required by the authentication and token-for-service processes in order to be able to construct the correct security token. The data is sent as XML in the body of the POST, the schema for which can be found at: /Schemas/RequestToken.xsd     Parameter  Required  Description      for-service  Yes  A string identifying the service for which the requested token is targeted.    for-service-url  Yes  A string representing the URL of the service, from the client\u2019s perspective, for which the token is being requested    reqtokentemplate  Yes  The required template for the claims in the token. This may be empty.    requested-lifetime  Optional  The requested lifetime for the token. The format is that accepted by the System.TimeSpan.TryParse() method:   .d.hh:mm:ss[.ff]   where d = days, hh = hours, mm = minutes, ss = seconds, and ff = fractions of seconds.    reason  Optional  If a token has been rejected by a service, the reason gives a hint to the service as to how to resolve the issue.      Notes   Request Token messages may require a valid Authorization header (see the CitrixAuth Authentication Scheme v1.2 document).  If the requested lifetime is not specified, then the default lifetime specified by the server administrator will be used.  If the requested lifetime is longer than the maximum token lifetime, the resulting token may have a shorter lifetime than that requested.  If the requested lifetime is longer than a lifetime associated with any state held on the server, the resulting token may again have a shorter lifetime than that requested.", 
            "title": "Request Token"
        }, 
        {
            "location": "/security-token-services-api/#request-token-response", 
            "text": "The following information is returned by the authentication and token-for-service processes in response to a request for a token. The data is sent as XML in the body of the POST, the schema for which can be found at: /Schemas/RequestTokenResponse.xsd     Parameter  Required  Description      for-service  Yes  A string identifying the service for which the requested token is targeted.    Issued  Yes  The issued time of token, expressed in ISO 8601 Utc format:YYYY-MM-DDThh:mm:ss.fZ Where; YYYY is the year, MM the month, DD the day, hh the hour in the day, mm the minutes, ss the seconds, and f the optional decimel fraction of seconds.    Expiry  Yes  The expiry time of the token, expressed in ISO 8601 Utc format.    Lifetime  Yes  The lifetime of the token in the format d.hh:mm:ss[.f] as above.    token-template  Yes  The claim template, which may be empty.    token  Yes  The serialized token as a Base64 encoded string (see RFC 4648 [http://tools.ietf.org/html/rfc4648]).      Notes  The XML is \u201copen\u201d and extensible, allowing additional elements to appear in the XML. This is used by the Common Forms Protocol to provide additional information, such as password expiry warnings, as shown in the example below:   Example:  Request Security Token Response with password expiry warning  Request  POST https://www.example.com/Citrix/Authentication/auth/v1/token HTTP/1.1\nContent-Type: application/vnd.citrix.requesttoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml, application/vnd.citrix.requesttokenchoices+xml\nContent-Encoding: utf-8\nHost: www.example.com\nContent-Length: xxx ?xml version= 1.0  encoding= utf-8 ?  requesttoken xmlns= http://citrix.com/delivery-services/1-0/auth/requesttoken \n   for-service 6b78ab94-a709-4e3a-8b9b-a49ca317c70c /for-service \n   for-service-url https://www.example.com/Citrix/Store/resources/v2 /for-service-url \n   reqtokentemplate / \n   requested-lifetime 1.00:00:00 /requested-lifetime  /requesttoken  Response  HTTP/1.1 200 OK\nCache-Control: no-cache; private; no-store; must-revalidate;\n               max-stale=0; post-check=0; pre-check=0; max-age=0\nPragma: no-cache\nContent-Type: application/vnd.citrix.requesttokenresponse+xml\nContent-Length: xxx ?xml version= 1.0  encoding= utf-8 ?  requesttokenresponse xmlns= http://citrix.com/delivery-services/1-0/auth/requesttokenresponse \n   for-service 32f585f3-054d-4ee5-a714-b0e11e312308 /for-service \n   issued 2009-05-12T15:27:28.1550000Z /issued \n   expiry 2009-05-12T16:27:28.1550000Z /expiry \n   lifetime 0.20:00:00 /lifetime \n   token-template / \n   token H4sIAAAAAAAEAO29B2AcSZYlJi9tynt /token \n   CredentialUpdateInformationList xmlns= http://citrix.com/authentication/response/1 \n     CredentialUpdateInformation \n       CredentialDisplayName ACME /CredentialDisplayName \n       AuthenticationInfoId 1 /AuthenticationInfoId \n       ExpiryTime 2010-05-12T15:27:28.155Z /ExpiryTime \n       TimeRemaining 10.05:33:09 /TimeRemaining \n       CredentialUpdateService \n        /ExplicitForms/ChangePassword\n       /CredentialUpdateService \n     /CredentialUpdateInformation \n   /CredentialUpdateInformationList  /requesttokenresponse", 
            "title": "Request Token Response"
        }, 
        {
            "location": "/security-token-services-api/#refresh-token", 
            "text": "The following information is required by the token refresh service in order to be able to refresh a security token. The data is sent as XML in the body of the POST, the schema for which can be found at: /Schemas/RefreshToken.xsd     Parameter  Required  Description      token  Yes  The serialized token as a Base64 encoded string (see RFC 4648 [http://tools.ietf.org/html/rfc4648]).    new-requested-lifetime  Optional  The requested lifetime for the token. The format is that accepted by the System.TimeSpan.TryParse() method:d      Notes   The use of this service is deprecated.  Refresh Token messages require a valid Authorization header (see the CitrixAuth Authentication Scheme v1.2 document).  The token being refreshed may be different to the token being used for authentication to the service.    Example : Refresh a Security Token  Request  POST https://www.example.com/Citrix/Authentication/auth/v1/token HTTP/1.1\nContent-Type: application/vnd.citrix.refreshtoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml\nAuthorization: CitrixAuth H4Siaaaaaaabfecde12987\nHost: www.example.com\nContent-Length: xxx ?xml version= 1.0  encoding= utf-8 ?  refreshtoken xmlns= http://citrix.com/delivery-services/1-0/auth/refreshtoken \n   token H4sIAAAAAAAEAO29B2 /token \n   new-requested-lifetime 0.01:00:00 /new-requested-lifetime  /refreshtoken  Response  HTTP/1.1 200 OK\nCache-Control: public, no-store, max-age=0\nContent-Type: application/vnd.citrix.requesttokenresponse+xml\nContent-Length: 4182 ?xml version= 1.0  encoding= utf-8 ?  requesttokenresponse xmlns= http://citrix.com/delivery-services/1-0/auth/requesttokenresponse \n   for-service 32f585f3-054d-4ee5-a714-b0e11e312308 /for-service \n   issued 2012-06-12T09:29:11.5210000Z /issued \n   expiry 2012-06-12T10:29:30.2896039Z /expiry \n   lifetime 0.01:00:18.768 /lifetime \n   token-template / \n   token H4sIAAAAAAAEAO29B2AcSZYluwHT+bly1cvP/2pl7/XRXP+7uLb+2GALAEhmQ4AAA== /token  /requesttokenresponse", 
            "title": "Refresh Token"
        }, 
        {
            "location": "/security-token-services-api/#destroy-token", 
            "text": "The following information is required by the token service in order to be able to destroy any server-side state associated with the specified security token. The data is sent as XML in the body of the POST, the schema for which can be found at: /Schemas/DestroyToken.xsd     Parameter  Required  Description      token  Yes  The serialized token as a Base64 encoded string (see RFC 4648 [http://tools.ietf.org/html/rfc4648]).      Notes   Destroy Token messages require a valid Authorization header (see the CitrixAuth Authentication Scheme v1.2 document).  The token being destroyed may be different to the token being used for authentication to the service.", 
            "title": "Destroy Token"
        }, 
        {
            "location": "/security-token-services-api/#destroy-token-response", 
            "text": "The following information is returned by the token service in response to a Destroy Token message. The response details the status of any server-side state associated with the specified token. The data is sent as XML in the body of the response. The schema for the XML can be found at: /Schemas/DestroyTokenResponse.xsd.     Parameter  Required  Description      Status  Yes  The status of the server-side state held for the specified token.     Example : Destroy a security token  Request  POST https://www.example.com/Citrix/Authentication/auth/v1/token HTTP/1.1\nContent-Type: application/vnd.citrix.destroytoken+xml\nAccept: application/vnd.citrix.destroytokenresponse+xml\nAuthorization: CitrixAuth H4sIAAAAAAAEAO29B2AcSZYlJbNOZDgAA\nHost: www.example.com\nContent-Length: XXX ?xml version= 1.0  encoding= utf-8 ?  destroytoken xmlns= http://citrix.com/delivery-services/1-0/auth/destroytoken \n   token H4sIAAAAAAAEAO29B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMk2JBAEOzBiM3mkuwdaUZbNOZDgAA /token  /destroytoken  Response  HTTP/1.1 200 OK\nCache-Control: public, no-store, max-age=0\nContent-Type: application/vnd.citrix.destroytokenresponse+xml\nContent-Length: 183 ?xml version= 1.0  encoding= utf-8 ?  destroytokenresponse xmlns= http://citrix.com/delivery-services/1-0/auth/destroytokenresponse \n   status destroyed /status  /destroytokenresponse", 
            "title": "Destroy Token Response"
        }, 
        {
            "location": "/security-token-services-api/#request-token-choices", 
            "text": "The following information is returned in response to some Request Token messages and enumerates the different choices of protocols available for authentication. The data is sent as XML in the body of the POST, the schema for which can be found at: /Schemas/RequestTokenChoices.xsd.     Parameter  Required  Description      protocol  Yes  A unique identifier for the associated protocol.    location  Yes  The URI to POST the Request Token message to, in order to start the authentication process.      Notes  Request Token Choices are usually returned in response to unauthenticated Request Token messages.", 
            "title": "Request Token Choices"
        }, 
        {
            "location": "/security-token-services-api/#token-service-endpoints", 
            "text": "This section describes the API to be used to access the token services through simple HTTP requests.", 
            "title": "Token Service Endpoints"
        }, 
        {
            "location": "/security-token-services-api/#authentication-protocol-choices", 
            "text": "URL: /auth/v1/protocols/  HTTP Method: POST  Authentication: None  Request Content-Type: application/vnd.citrix.requesttoken+xml  Response Content-Type: application/vnd.citrix.requesttokenchoices+xml   This service returns the authentication protocol choices.", 
            "title": "Authentication Protocol Choices"
        }, 
        {
            "location": "/security-token-services-api/#specific-authentication-protocol", 
            "text": "URL: Protocol-specific and usually obtained from the Protocol Choices  HTTP Method: POST  Authentication: The authentication scheme associated with the route  Request Content-Type: application/vnd.citrix.requesttoken+xml  Response Content-Type: application/vnd.citrix.requesttokenresponse+xml   Authenticate the user using the authentication protocol specified, to return a Request Token Response.   Notes  Between the POST of the Request Token and the receipt of the the Request Token Response, other HTTP messages may be exchanged as required by the specific protocol. Examples may be: SPNEGO negotiate challenge-responses, HTML forms for forms-based protocols. However, the conversation must always start with the client sending a Request Token Response message, and must always end with the server returning a Request Token Response message.", 
            "title": "Specific Authentication Protocol"
        }, 
        {
            "location": "/security-token-services-api/#request-security-token", 
            "text": "URL: /auth/v1/token  HTTP Method: POST  Authentication: CitrixAuth  Request Content-Type: application/vnd.citrix.requesttoken+xml  Response Content-Type: application/vnd.citrix.requesttokenresponse+xml   Request a security token for the service specified in the Request Token. The token for the required service is returned in the Request Token Response.", 
            "title": "Request Security Token"
        }, 
        {
            "location": "/security-token-services-api/#refresh-security-token", 
            "text": "URL: /auth/v1/token  HTTP Method: POST  Authentication: CitrixAuth  Request Content-Type: application/vnd.citrix.refreshtoken+xml  Response Content-Type: application/vnd.citrix.requesttokenresponse+xml   Refresh the specified security token by extending its lifetime by the requested amount. A token can be refreshed up to the maximum lifetime period specified by the administrator. This request is protected by the CitrixAuth protocol, and the authorization token need not be the same as the token being refreshed. The refreshed token is returned in the Request Token Response.", 
            "title": "Refresh Security Token"
        }, 
        {
            "location": "/security-token-services-api/#destroy-security-token", 
            "text": "URL: /auth/v1/token  HTTP Method: POST  Authentication: CitrixAuth  Request Content-Type: application/vnd.citrix.destroytoken+xml  Response Content-Type: application/vnd.citrix.destroytokenresponse+xml   Destroy the server-side data associated with the specified token. This request is protected by the CitrixAuth protocol, and the authorization token need not be the same as the token being destroyed. Note: This doesn\u2019t revoke the security token, but just releases any server-held resources.", 
            "title": "Destroy Security Token"
        }, 
        {
            "location": "/security-token-services-api/#token-validation", 
            "text": "URL: /auth/v1/token/validate/{tokenValidationServiceId}  HTTP Method: GET  Authentication: CitrixAuth  Response Content-Type: application/vnd.citrix.claimsidentity+xml   Return a filtered list of claims extracted from the CitrixAuth authorization token, if the the token is valid. The filtering of the claims is controlled by the administrator of the service.   Notes  {tokenValidationServiceId} denotes a parameter used to identify a particular token validation service. This parameter can be omitted, in which case the value default is used to identify the default token validation service. The default token validation service is utilised by Citrix Merchandising Servers to enable single sign-on. It can also be used to extract information regarding the claims in the primary token, if allowed by the server.   CloudGateway AppControllers also utilize the token validation service. For AppControllers the {tokenValidationServiceId} parameter should be the fully qualified host name associated with the AppController.", 
            "title": "Token Validation"
        }, 
        {
            "location": "/security-token-services-api/#wire-level-examples", 
            "text": "", 
            "title": "Wire-Level Examples"
        }, 
        {
            "location": "/security-token-services-api/#request-to-the-service-provider", 
            "text": "The following  \u201cwire-level\u201d example shows all the HTTP requests and responses when a client attempts to access a protected service (the resources service) and has to obtain security tokens to be granted access.  Request to Service Provider  GET https://www.example.com/resources/v2 HTTP/1.1\nHost: www.example.com\nAccept: application/vnd.citrix.resources+xml\nResponse from Service Provider\nHTTP/1.1 401 Unauthorized\nCache-Control: public, no-store, max-age=0\nWWW-Authenticate: CitrixAuth realm= 6b78ab94-a709-4e3a-8b9b-a49ca317c70c ,\n                             reqtokentemplate= , reason= notoken ,\n                             locations= https://www.example.com/Citrix/Authentication/auth/v1/token ,\n                             serviceroot-hint=https://www.example.com/Citrix/Store/resources/v2  At this point the client has to take the information provided in the CitrixAuth challenge and construct a Request for Security Token message to be POSTed to the URL specified in the challenge.  Request to Authentication Service  POST https://www.example.com/Citrix/Authentication/auth/v1/token HTTP/1.1\nContent-Type: application/vnd.citrix.requesttoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml, application/vnd.citrix.requesttokenchoices+xml\nContent-Encoding: utf-8\nHost: www.example.com\nContent-Length: xxx ?xml version= 1.0  encoding= utf-8 ?  requesttoken xmlns= http://citrix.com/delivery-services/1-0/auth/requesttoken \n   for-service 6b78ab94-a709-4e3a-8b9b-a49ca317c70c /for-service \n   for-service-url https://www.example.com/Citrix/Store/resources/v2 /for-service-url \n   reqtokentemplate / \n   requested-lifetime 1.06:00:00 /requested-lifetime  /requesttoken  Response from Service Provider  HTTP/1.1 401 Unauthorized\nCache-Control: public, no-store, max-age=0\nWWW-Authenticate: CitrixAuth realm= 32f585f3-054d-4ee5-a714-b0e11e312308 ,\n                     reqtokentemplate= , reason= notoken    \n                     locations= https://www.example.com/Citrix/Authentication/auth/v1/protocols ,\n                     serviceroot-hint= https://www.example.com/Citrix/Authentication/auth/v1/token \n\nHence, the result of this sequence is another challenge, because the client has not presented the security token required to access the token issuing service. The client must therefore parse the challenge again to construct another Request Security Token message and POST it to the indicated URI, as follows:\nRequest to Authentication Service\nPOST https://www.example.com/Citrix/Authentication/auth/v1/protocols HTTP/1.1\nContent-Type: application/vnd.citrix.requesttoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml, application/vnd.citrix.requesttokenchoices+xml\nContent-Encoding: utf-8\nHost: www.example.com\nContent-Length: xxx ?xml version= 1.0  encoding= utf-8 ?  requesttoken xmlns= http://citrix.com/delivery-services/1-0/auth/requesttoken \n   for-service 32f585f3-054d-4ee5-a714-b0e11e312308 /for-service \n   for-service-url https://www.example.com/Citrix/Authentication/auth/v1/token /for-service-url \n   reqtokentemplate / \n   requested-lifetime 1.06:00:00 /requested-lifetime  /requesttoken  Response from Service Provider  HTTP/1.1 300 Multiple Choices\nCache-Control: public, no-store, max-age=0\nContent-Type: application/vnd.citrix.requesttokenchoices+xml\nContent-Length: xxx ?xml version= 1.0  encoding= utf-8 ?  requesttokenchoices xmlns= http://citrix.com/delivery-services/1-0/auth/requesttokenchoices \n   choices \n     choice \n       protocol ExplicitForms /protocol \n       location https://www.example.com/Citrix/Authentication/ExplicitForms/Authenticate /location \n     /choice \n   /choices  /requesttokenchoices  In this case the authentication service has responded with a HTTP 300 (Multiple Choices) response, indicating that the security token can be obtained from a choice of URIs. In this case, each choice represents a different authentication protocol. It is the clients\u2019 responsibility to choose an appropriate protocol and endpoint to start the authentication process, by resending the Request Token message to the chosen endpoint, as illustrated below:  Request to Authentication Service  POST https://www.example.com/Citrix/Authentication/ExplicitForms/Authenticate HTTP/1.1\nContent-Type: application/vnd.citrix.requesttoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml, text/xml, application/vnd.citrix.authenticateresponse-1+xml\nHost: www.example.com\nContent-Length: xxx ?xml version= 1.0  encoding= utf-8 ?  requesttoken xmlns= http://citrix.com/delivery-services/1-0/auth/requesttoken \n   for-service 32f585f3-054d-4ee5-a714-b0e11e312308 /for-service \n   for-service-url https://www.example.com/Citrix/Authentication/auth/v1/token /for-service-url \n   reqtokentemplate / \n   requested-lifetime 1.06:00:00 /requested-lifetime  /requesttoken  The server and client then participate in the authentication protocol sequence, until the server responds with a Request Token Response, as follows:  HTTP/1.1 200 OK\nCache-Control: no-cache; private; no-store; must-revalidate; max-stale=0; post-check=0;\n               pre-check=0; max-age=0\nContent-Type: application/vnd.citrix.requesttokenresponse+xml\nContent-Length: xxx ?xml version= 1.0  encoding= utf-8 ?  requesttokenresponse xmlns= http://citrix.com/delivery-services/1-0/auth/requesttokenresponse \n   for-service 32f585f3-054d-4ee5-a714-b0e11e312308 /for-service \n   issued 2012-06-12T09:50:53.8436039Z /issued \n   expiry 2012-06-13T05:50:53.8436039Z /expiry \n   lifetime 0.20:00:00 /lifetime \n   token-template / \n   token H4sIAAAAAAAEAO29B2AcSZYlJi9tynt/Sv8Id/T8DXarOsQ4AAA== /token \n   CredentialUpdateInformationList xmlns= http://citrix.com/authentication/response/1 \n     CredentialUpdateInformation \n       CredentialDisplayName example.com /CredentialDisplayName \n       AuthenticationInfoId Citrix Common Forms 1.0 /AuthenticationInfoId \n       CredentialUpdateService / \n     /CredentialUpdateInformation \n   /CredentialUpdateInformationList  /requesttokenresponse  The client can then use this data to request a token from the token issuing service as follows:  Request to Authentication Service  POST https://www.example.com/Citrix/Authentication/auth/v1/token HTTP/1.1\nContent-Type: application/vnd.citrix.requesttoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml, application/vnd.citrix.requesttokenchoices+xml\nContent-Encoding: utf-8\nAuthorization: CitrixAuth H4sIAAAAAAAEAO29B2AcSZYlJi9tynt/Sv8Id/T8DXarOsQ4AAA==\nHost: www.example.com\nContent-Length: xxx ?xml version= 1.0  encoding= utf-8 ?  requesttoken xmlns= http://citrix.com/delivery-services/1-0/auth/requesttoken \n   for-service 6b78ab94-a709-4e3a-8b9b-a49ca317c70c /for-service \n   for-service-url https://www.example.com/Citrix/Store/resources/v2 /for-service-url \n   reqtokentemplate / \n   requested-lifetime 1.06:00:00 /requested-lifetime  /requesttoken  Response from Service Provider  HTTP/1.1 200 OK\nCache-Control: public, no-store, max-age=0\nContent-Type: application/vnd.citrix.requesttokenresponse+xml\nContent-Length: xxx ?xml version= 1.0  encoding= utf-8 ?  requesttokenresponse xmlns= http://citrix.com/delivery-services/1-0/auth/requesttokenresponse \n   for-service 6b78ab94-a709-4e3a-8b9b-a49ca317c70c /for-service \n   issued 2012-06-12T09:50:53.9106039Z /issued \n   expiry 2012-06-12T10:50:53.9106039Z /expiry \n   lifetime 0.01:00:00 /lifetime \n   token-template / \n   token H4sIAAAAAAAEAO29B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMKioDgAA /token  /requesttokenresponse  The client can then use this data to authorize the original request to the service provider to obtain the requested data, as follows:  Request to Service Provider (Resources)  GET https://www.example.com/Citrix/Store/resources/v2 HTTP/1.1\nAccept: application/vnd.citrix.resources+xml\nAccept-Encoding: gzip, deflate,gzip, deflate\nAuthorization: CitrixAuth H4sIAAAAAAAEAO29B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMKioDgAA\nHost: www.example.com\nResponse from Service Provider (Resources)\nHTTP/1.1 200 OK\nCache-Control: public, no-store, max-age=0\nContent-Type: application/vnd.citrix.resources+xml\nContent-Length: xxx ?xml version= 1.0  encoding= utf-8 ?  resources xmlns= http://citrix.com/delivery-services/2-0/resources \n           xmlns:a= http://citrix.com/delivery-services/2-0/subscriptions \n           enumeration= full  a:subscriptionsstatus= enabled \n   resource \n\u2026\n   /resource  /resources", 
            "title": "Request to the Service Provider"
        }, 
        {
            "location": "/security-token-services-api/#token-validation-service", 
            "text": "The client of the token validation service, which may be Citrix Merchandising Server or CloudGateway AppController, initially sends the following request for the default token validation service:  Request to Authentication Service  GET https://www.example.com/auth/V1/token/validate HTTP/1.1\nHost: www.example.com\nAccept: application/vnd.citrix.claimsidentity+xml\nResponse from Authentication Service\n\nServer: HTTP/1.1 401 Unauthorized\nWWW-Authenticate: CitrixAuth realm=  2deb9210-cb41-4b1f-a27e-93e4980b2e31 ,\n                             reqtokentemplate= ,reason= notoken ,\n                             locations= https://www.example.com/auth/v1/token ,\n                             serviceroot-hint= https://www.example.com/auth/v1/token  The client again uses the challenge to construct a Request Security Token message and obtains a security token. When a token has been obtained for the Token Validation Service, the client sends:  Request to Authentication Service  GET https://www.example.com/auth/V1/token/validate HTTP/1.1\nHost: www.example.com\nAuthorization: CitrixAuth K5tIBBBBB\u2026cFADyBVAAA==\nAccept: application/vnd.citrix.claimsidentity+xml\nResponse from Authentication Service\n\nHTTP/1.1 200 OK\nContent-Type: application/vnd.citrix.claimsidentity+xml\nContent-Length: xxx\nCache-Control: no-store ?xml version = 1.0  encoding= utf-8 ?  claimsPrincipal xmlns= http://citrix.com/delivery-services/1-0/auth/claimsprincipal \n   identity name='example\\user' isAuthenticated='true' authMethod='Citrix Common Forms 1.0' / \n     claims \n     claim type='http://schemas.xmlsoap.org/ws/2005/05/identity/claims/sid'\n\n           value='S-1-5-21-xxx-1128' valueType='string'\n           issuer='801e81a8-9d22-4163-bff6-3c9d41156f0e'\n           original='801e81a8-9d22-4163-bff6-3c9d41156f0e' \n       properties \n         property name='groups'\n                  value='S-1-5-21-xxx-513,S-1-1-0,S-1-5-21-xxx-1011,\n                         S-1-5-21-xxx-1012,S-1-5-21-xxx-1018,\n                         S-1-5-32-555,\n                         S-1-5-32-545,\n                         S-1-5-14,\n                         S-1-5-4,\n                         S-1-5-11,\n                         S-1-5-15,\n                         S-1-2-0,S-1-5-21-xxx-2187,S-1-5-21-xxx-2233' / \n       /properties \n     /claim \n     claim type= uri:citrix.deliveryservices.claim.directoryproperties  value= user  \n           valueType= string  issuer= 801e81a8-9d22-4163-bff6-3c9d41156f0e \n           original= 801e81a8-9d22-4163-bff6-3c9d41156f0e \n       properties \n         property name= displayName  value= Full username / \n         property name= mail  value= user@example.com / \n       /properties \n  /claim  /claimsPrincipal", 
            "title": "Token Validation Service"
        }, 
        {
            "location": "/authentication-form-generation/", 
            "text": "Introduction\n\n\nCitrix has devised a common authentication protocol that is implemented by its next generation services and gateway platforms, referred to here as StoreFront Services and NetScaler Gateway. Citrix has implemented client support for this common authentication protocol in native user agents, such as Receiver and Worx, for the major device platforms, notably Windows, Mac, iOS, Android, Linux, and Receiver for Web for browser-based user agents.\n\n\nAn important part of the common authentication protocol is a generic forms language, which is described in the Receiver Common Authentication Forms Language document [2]. This language is designed to allow third parties to express a wide range of authentication forms using a set of user interface constructs that are similar to basic HTML forms; see RFC 1867 [http://www.ietf.org/rfc/rfc1867.txt] and 2388 [http://www.ietf.org/rfc/rfc2388.txt] for more details.\n\n\nThird parties can extend the authentication methods supported by StoreFront Services and NetScaler Gateway by implementing server logic that emits and consumes forms defined in the common forms language; see the Citrix Authentication Software Development Kit [1] for more details.\n\n\nThis document aims to enable Citrix partners to understand how StoreFront generates the formsand to enable them to customize the existing form definitions, create new forms, and new sequences of forms to create new authentication conversations.\n\n\nOverview\n\n\nForms-based authentication is a conversation using the HTTP protocol where the client responds to a series of forms generated by the server to establish an identity on the server. The HTTP API is described in the Citrix Common Forms API document [3]. There are several StoreFront components that interact to achieve the generation of the forms and the handling of the HTTP responses. \n\n\nStoreFront makes extensive use of service location and inversion-of-control (IoC) containers; see http://martinfowler.com/articles/injection.html for more details of this software pattern.\n\n\n\n\nForms Generation Components for a conversation requiring Active Directory credential validation\n\n\nHandling HTTP requests and responses is the responsibility of a small set of built-in MVCs (model view controllers). In most cases there will be no need for custom form implementers to implement new controllers. For general forms, where there is no requirement to validate Active Directory credentials, the FormsAuthenticationController ASP.Net MVC controller should be used. If validating Active Directory credentials is required, then the ExplicitFormsAuthenticationController controller should be used. The MVC controllers validate the requests and extract the state associated with the conversation and then construct and invoke the conversation engine.\n\n\nThe conversation engine is responsible for running the conversation, which includes creating the appropriate conversation object and dispatching messages to it. There are two built-in conversation engines: ConversationEngine, used when validating Active Directory credentials is not required, and ExplicitConversationEngine, used when validating Active Directory credentials is required. Again, it is not anticipated that custom forms implementers will need to modify the conversation engine functionality.\n\n\nThe configuration for the MVC route includes the name, used by the Service Locator to find a class that implements the IFormsConversationFactory interface, stored in the IoC container. The appropriate conversation engine uses this to locate the custom conversation factory that uses any settings required, to create a new custom conversation object.\n\n\nThe custom conversation object is responsible for orchestrating the sequence of forms and dispatching messages to appropriate form objects. It is expected that custom forms implementers that require a complex series of forms will implement a conversation object. However, there are two built-in classes that provide the base functionality that implementers can build on. These are FormsConversationBase, used when validating Active Directory credentials is not required, and ExplicitConversation, used when validating Active Directory credentials is required.\n\n\nAn individual form is usually composed of two elements: the form object and the associated form template. The form object is responsible for generating a dynamic data model that is passed to the forms template engine with the name of the forms template to generate the form that will be transmitted to the client. The form object is also responsible for processing the response to the form generated by the client. Although StoreFront has a small number of built-in form objects and their associated templates, custom forms implementers will generally have to implement new forms objects and templates.\n\n\nThe forms template engine is the built-in component that can be used by individual forms to generate the final Receiver Common Form XML from a template and dynamic data. It is not expected that custom forms implementers will be required to modify this component.\n\n\nFormsConversationBase, used when validating Active Directory credentials is not required, and ExplicitConversation, used when validating Active Directory credentials is required.\n\n\nAn individual form is usually composed of two elements: the form object and the associated form template. The form object is responsible for generating a dynamic data model that is passed to the forms template engine with the name of the forms template to generate the form that will be transmitted to the client. The form object is also responsible for processing the response to the form generated by the client. Although StoreFront has a small number of built-in form objects and their associated templates, custom forms implementers will generally have to implement new forms objects and templates.\n\n\nThe forms template engine is the built-in component that can be used by individual forms to generate the final Receiver Common Form XML from a template and dynamic data. It is not expected that custom forms implementers will be required to modify this component.\n\n\nForm Conversation Factory\n\n\nIf a custom conversation is required, then a custom factory is required that implements the following interface:\n\n\nnamespace Citrix.DeliveryServices.Authentication.FormsProtocol.Conversations.Interfaces\n{\n    /// \nsummary\n\n    /// This interface represents a factory for instances of \nseealso cref=\nIFormsConversation\n/\n\n    /// \n/summary\n\n    public interface IFormsConversationFactory\n    {\n        /// \nsummary\n\n        /// Create a new instance of an object that implements \nseealso cref=\nIFormsConversation\n/\n\n        /// \n/summary\n\n        /// \nparam name=\ncontrollerContext\n\n        /// The \nseealso cref=\nControllerContext\n/\n for where the conversation will be run\n/param\n\n        /// \nparam name=\ntemplateEngine\n\n        /// The \nseealso cref=\nFormsTemplateEngine\n/\n to use to render the conversation\n/param\n\n        /// \nparam name=\ncultures\nThe current language cultures\n/param\n\n        /// \nreturns\n\n        /// A new instance of an object that implements \nseealso cref=\nIFormsConversation\n/\n\n        /// \n/returns\n\n        IFormsConversation Create(ControllerContext controllerContext,\n                                  FormsTemplateEngine templateEngine,\n                                  IEnumerable\nCultureInfo\n cultures);\n    }\n}\n\n\n\n\nThis factory must be stored in the IoC container with a specific name, and this is usually achieved through the use of a start-up module (see the StoreFront Service Authentication SDK for more details on start-up modules). The appropriate conversation engine obtains the factory name from the route data associated with the start of the customized conversation in the web.config file. For example, the following is the route data for the built-in user name and password conversation:\n\n\n    \nexplicitAuthentication\n\n      \nrouteTable order=\n0\n\n        \nroutes\n\n          \nroute name=\nStartExplicitAuthentication\n url=\nExplicitForms/Start\n\n            \ndefaults\n\n              \nadd param=\ncontroller\n value=\nExplicitFormsAuthentication\n /\n\n              \nadd param=\naction\n value=\nAuthenticateStart\n /\n\n              \nadd param=\npostbackAction\n value=\nAuthenticate\n /\n\n              \nadd param=\ncancelAction\n value=\nCancelAuthenticate\n /\n\n              \nadd param=\nconversationFactory\n value=\nExplicitAuthentication\n /\n\n              \nadd param=\nchangePasswordAction\n value=\nStartChangePassword\n /\n\n              \nadd param=\nchangePasswordController\n value=\nChangePassword\n /\n\n              \nadd param=\nprotocol\n value=\nExplicitForms\n /\n\n            \n/defaults\n\n            \ndata /\n\n          \n/route\n\n          \nroute name=\nExplicitAuthentication\n url=\nExplicitForms\n\n            \ndefaults\n\n              \nadd param=\ncontroller\n value=\nExplicitFormsAuthentication\n /\n\n              \nadd param=\naction\n value=\nAuthenticate\n /\n\n              \nadd param=\nprotocol\n value=\nExplicitForms\n /\n\n            \n/defaults\n\n            \ndata /\n\n          \n/route\n\n          \nroute name=\nCancelExplicitAuthentication\n url=\nExplicitForms/Cancel\n\n            \ndefaults\n\n              \nadd param=\ncontroller\n value=\nExplicitFormsAuthentication\n /\n\n              \nadd param=\naction\n value=\nCancelAuthenticate\n /\n\n              \nadd param=\nprotocol\n value=\nExplicitForms\n /\n\n            \n/defaults\n\n            \ndata /\n\n          \n/route\n\n        \n/routes\n\n      \n/routeTable\n\n    \n/explicitAuthentication\n\n\n\n\nThe conversation engine uses the service locator to obtain the factory object with the specified name and then invokes the Create() method to obtain the custom conversation object.\n\n\n\n\nForm Conversation\n\n\nMost new authentication conversations will require a conversation object to orchestrate the sequence of forms. The StoreFront Services Authentication SDK contains samples that demonstrate creating custom conversation objects.\n\n\nWhen a conversation is started, the first action is to create a ConversationState object that has the following API:\n\n\nnamespace Citrix.DeliveryServices.Authentication.FormsProtocol.Conversations\n{\n    /// \nsummary\n\n    /// This data class contains the conversation state that is required\n    /// to be stored in the session state between requests.\n    /// \n/summary\n\n    public class ConversationState\n    {\n        /// \nsummary\n\n        /// Constructor\n        /// \n/summary\n\n        public ConversationState()\n        {\n            Extensions = new Dictionary\nstring, object\n();\n        }\n\n        /// \nsummary\n\n        /// Gets or sets the \nseealso cref=\nFormsTemplateEngine\n/\n.\n        /// \n/summary\n\n        /// \nremarks\n\n        /// This is used to render the forms that make up the conversation.\n        /// \n/remarks\n\n        public FormsTemplateEngine TemplateEngine { get; set; }\n\n        /// \nsummary\n\n        /// Gets or sets the current \nseealso cref=\nIFormsConversation\n/\n\n        /// \n/summary\n\n        public IFormsConversation CurrentConversation { get; set; }\n\n        /// \nsummary\n\n        /// Gets or sets the \nseealso cref=\nRequestToken\n/\n message\n        /// sent at the start of the conversation.\n        /// \n/summary\n\n        /// \nremarks\n\n        /// This is used to generate the request security token response\n        /// at the end of the conversation.\n        /// \n/remarks\n\n        public RequestToken RequestToken { get; set; }\n\n        /// \nsummary\n\n        /// Gets or sets the \nseealso cref=\nITokenService\n/\n used to\n        /// issue the \nseealso cref=\nIToken\n/\n generated at the end\n        /// of the conversation.\n        /// \n/summary\n\n        public ITokenService TokenIssuingService { get; set; }\n\n        /// \nsummary\n\n        /// Gets or sets whether or not this conversation is delegated using the\n        /// delegated forms protocol\n        /// \n/summary\n\n        public bool Delegated { get; set; }\n\n        /// \nsummary\n\n        /// Gets or sets the \nseealso cref=\nIStringCipher\n/\n to use for the delegated result\n        /// \n/summary\n\n        public IStringCipher Cipher { get; set; }\n\n        /// \nsummary\n\n        /// Gets or sets a dictionary of extension objects\n        /// \n/summary\n\n        public Dictionary\nstring, object\n Extensions { get; private set; }\n    }\n}\n\n\n\n\nThis object is used to store the state of the conversation between HTTP requests and responses. The conversation object is re-created for each HTTP request or response, so custom conversation implementers should not attempt to add member variables to their custom conversation class to store data. Implementers should instead store their custom data in the conversation state Extensions dictionary if they require the data to persist between HTTP requests or responses.\n\n\nA conversation object must implement the following interface:\n\n\n    /// \nsummary\n\n    /// This interface represents a Forms conversation, or part of a conversation\n    /// \n/summary\n\n    public interface IFormsConversation\n    {\n        /// \nsummary\n\n        /// Start the Form conversation\n        /// \n/summary\n\n        /// \nparam name=\nabsoluteBaseUrl\n\n        /// This is the absolute Url of the end-point to be used for\n        /// the conversation.\n        /// \n/param\n\n        /// \nparam name=\nabsoluteCancelUrl\n\n        /// This is the absolute Url of the end-point to be used to\n        /// cancel the conversation.\n        /// \n/param\n\n        /// \nparam name=\nhttpContext\nThe \nseealso cref=\nHttpContextBase\n/\n/param\n\n        /// \nreturns\n/returns\n\n        FormResult Start(string absoluteBaseUrl, string absoluteCancelUrl,\n                         HttpContextBase httpContext);\n\n        /// \nsummary\n\n        /// Cancel the current Form conversation\n        /// \n/summary\n\n        /// \nparam name=\nhttpContext\nThe \nseealso cref=\nHttpContextBase\n/\n/param\n\n        /// \nreturns\n/returns\n\n        FormResult Cancel(HttpContextBase httpContext);\n\n        /// \nsummary\n\n        /// Get the next form in the conversation.\n        /// \n/summary\n\n        /// \nreturns\n/returns\n\n        RenderedForm GetNextForm();\n\n        /// \nsummary\n\n        /// Process the response to form\n        /// \n/summary\n\n        /// \nparam name=\nhttpContext\n\n        /// The \nseealso cref=\nHttpContextBase\n/\n containing all the information\n        /// regarding the form response.\n        /// \n/param\n\n        /// \nparam name=\nFormData\nThe Form data\n/param\n\n        /// \nreturns\n/returns\n\n        FormResult ProcessFormResponse(HttpContextBase httpContext, NameValueCollection FormData);\n\n        /// \nsummary\n\n        /// Gets the collection of credential types required for this conversation.\n        /// \n/summary\n\n        IEnumerable\nstring\n RequiredCredentialTypes { get; }\n\n        /// \nsummary\n\n        /// Gets the host-relative endpoint for this conversation.\n        /// \n/summary\n\n        string Endpoint { get; }\n\n        /// \nsummary\n\n        /// Gets the host-relative endpoint to cancel this conversation.\n        /// \n/summary\n\n        string CancelEndpoint { get; }\n    }\n\n    /// \nsummary\n\n    /// Enumeration of Form results\n    /// \n/summary\n\n    public enum FormResult\n    {\n        /// \nsummary\n\n        /// More information is required. A new form will be issued to\n        /// collect the required information\n        /// \n/summary\n\n        moreInfo,\n\n        /// \nsummary\n\n        /// The form failed\n        /// \n/summary\n\n        fail,\n\n        /// \nsummary\n\n        /// Authentication succeeded\n        /// \n/summary\n\n        success,\n\n        /// \nsummary\n\n        /// The user cancelled the form request\n        /// \n/summary\n\n        canceled\n    };\n\n\n\n\nStoreFront Services contains a base class that implementers can inherit from:\n\n\nCitrix.DeliveryServices.Authentication.FormsProtocol.Conversations.FormsConversationBase\n\n\nThis class implements the basic required functionality, but the implementer must implement the following methods:\n\n\n        /// \nsummary\n\n        /// Cancel the current Form conversation\n        /// \n/summary\n\n        /// \nparam name=\nhttpContext\nThe \nseealso cref=\nHttpContext\n/\n/param\n\n        /// \nreturns\n/returns\n\n        public virtual FormResult Cancel(HttpContextBase httpContext)\n        {\n            throw new NotImplementedException();\n        }\n\n        /// \nsummary\n\n        /// Get the next form in the conversation.\n        /// \n/summary\n\n        /// \nreturns\n/returns\n\n        public virtual RenderedForm GetNextForm()\n        {\n            throw new NotImplementedException();\n        }\n\n        /// \nsummary\n\n        /// Process the response to form\n        /// \n/summary\n\n        /// \nparam name=\nhttpContext\n\n        /// The \nseealso cref=\nHttpContext\n/\n containing all the information\n        /// regarding the form response.\n        /// \n/param\n\n        /// \nparam name=\nFormData\nThe Form data\n/param\n\n        /// \nreturns\n/returns\n\n        public virtual FormResult ProcessFormResponse(HttpContextBase httpContext, \n                                                      NameValueCollection FormData)\n        {\n            throw new NotImplementedException();\n        }\n\n        /// \nsummary\n\n        /// Override this method to get the initial \nseealso cref=\nIForm\n/\n in the conversation\n        /// \n/summary\n\n        protected virtual IForm GetInitialForm()\n        {\n            throw new NotImplementedException();\n        }\n\n\n\n\nFor conversations that require Active Directory credential validation, the conversation object must also implement the following interface:\n\n\nnamespace Citrix.DeliveryServices.Authentication.Forms.Engine.Interfaces\n{\n    /// \nsummary\n\n    /// This interface defines access to an \nseealso cref=\nAuthenticationResult\n/\n\n    /// \n/summary\n\n    public interface IAuthenticationResultHolder\n    {\n        /// \nsummary\n\n        /// Gets the result of the authentication conversation.\n        /// \n/summary\n\n        AuthenticationResult AuthenticationResult { get; }\n    }\n}\n\n\n\n\n\n\nNotes\n\n\nThe FormsConversationBase class contains a default implementation of this interface.\n\n\n\n\nForms\n\n\nForm objects within a conversation represent a high-level task, such as validating a user name and password. A form object is responsible for the generation of the specific Receiver Common Form XML for the task and the processing of the user agent\u2019s response. A form object may repeatedly generate XML forms until its task is complete, for example to re-prompt for a password and show an error message if the previously submitted password was incorrect.\n\n\nForms must implement the following interface:\n\n\nnamespace Citrix.DeliveryServices.Authentication.Forms.Engine.Interfaces\n{\n    /// \nsummary\n\n    /// The expected next action for the form\n    /// \n/summary\n\n    public enum FormState\n    {\n        /// \nsummary\n\n        /// Rendering the next form\n        /// \n/summary\n\n        Rendering,\n\n        /// \nsummary\n\n        /// Processing the response to the last form\n        /// \n/summary\n\n        Processing,\n\n        /// \nsummary\n\n        /// This form is complete\n        /// \n/summary\n\n        Complete\n    };\n\n    /// \nsummary\n\n    /// This interface represents a single Form\n    /// \n/summary\n\n    public interface IForm\n    {\n        /// \nsummary\n\n        /// Render the next form.\n        /// \n/summary\n\n        /// \nreturns\nThe next \nseealso cref=\nRenderedForm\n/\n/returns\n\n        RenderedForm GetNextForm();\n\n        /// \nsummary\n\n        /// Process the response to the last form\n        /// \n/summary\n\n        /// \nparam name=\nhttpContext\n\n        /// The \nseealso cref=\nHttpContextBase\n/\n containing all the information\n        /// regarding the form response.\n        /// \n/param\n\n        /// \nparam name=\nformData\nThe form data.\n/param\n\n        /// \nreturns\nThe \nseealso cref=\nFormResult\n/\n from processing the response\n/returns\n\n        FormResult ProcessFormResponse(HttpContextBase httpContext, NameValueCollection formData);\n\n        /// \nsummary\n\n        /// Gets the collection of credential types required for this conversation.\n        /// \n/summary\n\n        IEnumerable\nstring\n RequiredCredentialTypes { get; }\n\n        /// \nsummary\n\n        /// Gets the current state of the form\n        /// \n/summary\n\n        FormState State { get; }\n    }\n}\n\n\n\n\nStoreFront Services contains a base class that implementers can inherit from:\n\n\nCitrix.DeliveryServices.Authentication.FormsProtocol.Forms.FormBase\n\n\nThis class implements the basic required functionality, but the implementer must implement the following methods:\n\n\n        /// \nsummary\nRender the next form.\n/summary\n\n        /// \nreturns\nThe next \nseealso cref=\nRenderedForm\n/\n/returns\n\n        public virtual RenderedForm GetNextForm()\n        {\n            throw new NotImplementedException();\n        }\n\n        /// \nsummary\nProcess the response to the last form\n/summary\n\n        /// \nparam name=\nhttpContext\n\n        /// The \nseealso cref=\nHttpContextBase\n/\n containing all the information\n        /// regarding the form response.\n        /// \n/param\n\n        /// \nparam name=\nformData\nThe form data\n/param\n\n        /// \nreturns\nThe \nseealso cref=\nFormResult\n/\n from processing the response\n/returns\n\n        public virtual FormResult ProcessFormResponse(HttpContextBase httpContext,\n                                                      NameValueCollection formData)\n        {\n            throw new NotImplementedException();\n        }\n\n\n\n\nThe GetNextForm() method may use the forms template engine, described below, to generate the Receiver Common Form XML to be sent to the client. Then RenderedForm returned has the following structure:\n\n\nnamespace Citrix.DeliveryServices.Authentication.Forms.Engine.Interfaces\n{\n    /// \nsummary\n\n    /// This data class represents a rendered form\n    /// \n/summary\n\n    public class RenderedForm\n    {\n        /// \nsummary\n\n        /// Gets or sets the rendered Form as an \nseealso cref=\nXmlDocument\n/\n\n        /// \n/summary\n\n        public XmlDocument Form { get; set; }\n\n        /// \nsummary\n\n        /// Get or sets whether the associated form is the last form\n        /// \n/summary\n\n        public bool Complete { get; set; }\n    }\n}\n\n\n\n\nThe Complete flag should be set to true if the form is not expecting the client to send a response back to the form being issued. This is usually required for terminal error messages, and will result in the conversation being terminated when the form has been sent to the client.\n\n\nIf the conversation returns FormResult.moreInfo to the Conversation Engine, then it will request the next form from the conversation object.\n\n\n\n\nWhen a form has completed its processing, ProcessFormResponse should return FormResult.success. This signals to the conversation object that it should now use the next form in the sequence.\n\n\n\n\nWhen all the forms have completed their processing, then the conversation is complete and the conversation returns FormResult.success to the conversation engine. This causes it to obtain the success result, which for non-delegated forms authentication is a Request Security Token Response message, which is returned to the client containing the access token.\n\n\n\n\nBuilt-in Support\n\n\nThe StoreFront Authentication SDK has some built-in forms. It also provides access to the built-in support for verifying and managing Active Directory credentials.\n\n\nActive Directory\n\n\nThe Authentication Service IoC container is populated with several objects that can be used to verify and manage Active Directory credentials, and are described below:\n\n\nUser Name with Password Support\n\n\nThe IoC container is populated with an object that implements the following interface:\n\n\nnamespace Citrix.DeliveryServices.Authentication.Explicit.Core\n{\n    /// \nsummary\n\n    /// A class to be used to create an instance that implements \nseealso cref=\nIExplicit\n/\n.\n    /// \n/summary\n\n    public class ExplicitFactory\n    {\n        /// \nsummary\n\n        /// Initializes a new instance of the \nsee cref=\nExplicitFactory\n/\n class.\n        /// \n/summary\n\n        /// \nparam name=\nexplicitSettings\n\n        /// The \nseealso cref=\nExplicitSettings\nexplicit settings\n/seealso\n\n        /// \n/param\n\n        /// \nparam name=\nauthenticationSettings\n\n        /// The general \nseealso cref=\nAuthenticationSettings\n/\n\n        /// \n/param\n\n        public ExplicitFactory(ExplicitSettings explicitSettings,\n                               AuthenticationSettings authenticationSettings);\n\n        /// \nsummary\n\n        /// Gets or sets the \nseealso cref=\nExplicitSettings\n/\n\n        /// \n/summary\n\n        public ExplicitSettings Settings { get; private set; }\n\n        /// \nsummary\n\n        /// Gets or sets the general \nseealso cref=\nAuthenticationSettings\n/\n\n        /// \n/summary\n\n        public AuthenticationSettings AuthenticationSettings { get; private set; }\n\n        /// \nsummary\n\n        /// Create an instance that implements \nseealso cref=\nIExplicit\n/\n\n        /// \n/summary\n\n        /// \nreturns\nAn object that implements \nseealso cref=\nIExplicit\n/\n/returns\n\n        public IExplicit CreateInstance();\n    }\n}\n\n\n\n\nThe built-in ExplicitConversationFactory uses this to create an object that provides the user name with password support. One of these objects, implementing the interface below, is created for each ExplicitConversation object.\n\n\nnamespace Citrix.DeliveryServices.Authentication.Explicit.Core.Interfaces\n{\n    /// \nsummary\n\n    /// The interface to the explicit business logic\n    /// \n/summary\n\n    public interface IExplicit\n    {\n        /// \nsummary\n\n        /// Gets the \nseealso cref=\nExplicitSettings\n/\n\n        /// of this object.\n        /// \n/summary\n\n        ExplicitSettings Settings { get; }\n\n        /// \nsummary\n\n        /// Gets the general \nseealso cref=\nAuthenticationSettings\n/\n\n        /// of this object.\n        /// \n/summary\n\n        AuthenticationSettings AuthenticationSettings { get; }\n\n        /// \nsummary\n\n        /// Gets the full user identity of the account whose password has expired\n        /// \n/summary\n\n        /// \nremarks\n\n        /// Only returns a valid value when \nsee cref=\nAuthenticate(string,string,string)\n/\n\n        /// has been called within the current conversation and it has returned\n        /// \nsee cref=\nAuthenticationStatus.FailedChangeExpiredSecret\n/\n\n        /// \n/remarks\n\n        string ExpiredUser { get; }\n\n        /// \nsummary\n\n        /// When a user calls an action that resets the state such as Authenticate we need to\n        /// forget all previous cached information.\n        /// \n/summary\n\n        void ClearState();\n\n        /// \nsummary\n\n        /// Returns whether the given password is sufficiently complex\n        /// \n/summary\n\n        /// \nparam name=\npassword\nThe password to check\n/param\n\n        /// \nreturns\nTrue, if meets complexity check\n/returns\n\n        bool PasswordMeetsComplexity(string password);\n\n        /// \nsummary\n\n        /// Authenticate the specified credentials. If the password\n        /// has expired and password changing is configured, the username and domain will\n        /// be saved in the object state for use in a subsequent call to\n        /// \nsee cref=\nChangeExpiredPassword\n/\n\n        /// \n/summary\n\n        /// \nparam name=\nuserName\nThe username to verify\n/param\n\n        /// \nparam name=\ndomain\n\n        /// The domain of the user, which can be null if the domain is specified in username\n        /// \n/param\n\n        /// \nparam name=\npassword\n\n        /// The password to verify, which can be an empty string\n        /// \n/param\n\n        /// \nreturns\n\n        /// An \nseealso cref=\nAuthenticationResult\n/\n indicating authentication status\n        /// \n/returns\n\n        /// \nexception cref=\nExplicitAuthenticationException\nif the credentials could not\n        /// be authenticated\n/exception\n\n        AuthenticationResult Authenticate(string userName, string domain, string password);\n\n        /// \nsummary\n\n        /// Perform a domain restriction check\n        /// \n/summary\n\n        /// \nparam name=\nUserInfo\nThe \nseealso cref=\nUserInfo\n/\n to check\n/param\n\n        /// \nremarks\n\n        /// If the configuration contains a list of domains then perform a domain, or\n        /// user principle name suffix, restriction check.\n        /// \n/remarks\n\n        void PerformDomainRestriction(UserInfo UserInfo);\n\n        /// \nsummary\n\n        /// Attempt to change the password for the user associated with the last\n        /// call to \nsee cref=\nAuthenticate(string,string,string)\n/\n.\n        /// \n/summary\n\n        /// \nparam name=\noldPassword\nThe existing password\n/param\n\n        /// \nparam name=\nnewPassword\nThe new password\n/param\n\n        /// \nreturns\nan \nsee cref=\nChangePasswordResult\n /\n\n        /// indicating the password change status\n        /// \n/returns\n\n        /// \nexception cref=\nInvalidOperationException\n\n        /// If no user has been saved to the object state\n        /// \n/exception\n\n        /// \nexception cref=\nExplicitAuthenticationException\n\n        /// If the password change operation failed\n        /// \n/exception\n\n        /// \nexception cref=\nArgumentNullException\n\n        /// If oldPassword of newPassword is null.\n        /// \n/exception\n\n        ChangePasswordResult ChangeExpiredPassword(string oldPassword, string newPassword);\n\n        /// \nsummary\n\n        /// Attempt to change the password for the credentials indicated by the\n        /// given principal.\n        /// \n/summary\n\n        /// \nparam name=\nprincipal\n\n        /// The \nseealso cref=\nIClaimsPrincipal\n/\n representing the user\n        /// \n/param\n\n        /// \nparam name=\noldPassword\nThe existing password\n/param\n\n        /// \nparam name=\nnewPassword\nThe new password\n/param\n\n        /// \nreturns\n\n        /// an \nseealso cref=\nChangePasswordResult\n/\n indicating the password change status\n        /// \n/returns\n\n        ChangePasswordResult ChangePassword(IClaimsPrincipal principal, string oldPassword,\n                                            string newPassword);\n    }\n}\n\n\n\n\nThe ExplicitSettings object has the following definition:\n\n\nnamespace Citrix.DeliveryServices.Authentication.Explicit.Core.Configuration\n{\n    /// \nsummary\n\n    /// A data class to hold the Explicit business logic settings\n    /// \n/summary\n\n    public class ExplicitSettings\n    {\n        /// \nsummary\n\n        /// Gets or sets service locator name for the authenticator to use\n        /// \n/summary\n\n        public string AuthenticatorName { get; set; }\n\n        /// \nsummary\n\n        /// Gets or sets the require account security identifiers property\n        /// \n/summary\n\n        public bool RequireAccountSIDs { get; set; }\n\n        /// \nsummary\n\n        /// Gets or sets the hide domain field property\n        /// \n/summary\n\n        public bool HideDomainField { get; set; }\n\n        /// \nsummary\n\n        /// Gets or sets the allow user to change their password property\n        /// \n/summary\n\n        public AllowPasswordChangeValue AllowUserPasswordChange { get; set; }\n\n        /// \nsummary\n\n        /// Gets or sets the password expiry warning mode\n        /// \n/summary\n\n        public PasswordExpiryWarningValue ShowPasswordExpiryWarning { get; set; }\n\n        /// \nsummary\n\n        /// Gets or sets the override for the password expiry warning period in days\n        /// \n/summary\n\n        public int PasswordExpiryWarningPeriod { get; set; }\n\n        /// \nsummary\n\n        /// Gets the list of trusted domains\n        /// \n/summary\n\n        public IList\nstring\n Domains { get; set; }\n\n        /// \nsummary\n\n        /// Gets the default trusted domain\n        /// \n/summary\n\n        /// \nremarks\n\n        /// This will be null, if no trusted domains are specified,\n        /// otherwise it must be a member of the trusted domains.\n        /// \n/remarks\n\n        public string DefaultDomain { get; set; }\n\n        /// \nsummary\n\n        /// Gets the allow zero length password property\n        /// \n/summary\n\n        public bool AllowZeroLengthPassword { get; set; }\n    }\n}\n\n\n\n\nThe settings are built from the following configuration section of the Authentication Service and stored in the IoC container:\n\n\nconfiguration\n\n  \ncitrix.deliveryservices\n\n    \nexplicitBL authenticator=\ndefaultDelegatedAuthenticator\n hideDomainField=\ntrue\n\n                allowUserPasswordChange=\nNever\n allowZeroLengthPassword=\nfalse\n \n                showPasswordExpiryWarning=\nWindows\n \n                passwordExpiryWarningPeriod=\n10\n requireAccountSIDs=\ntrue\n\n      \ndomainSelection default=\n\n        \nclear /\n\n      \n/domainSelection\n\n    \n/explicitBL\n\n  \n/citrix.deliveryservices\n\n\n/configuration\n\n\n\n\nThe explicitBL section has the following configuration items that control the expected user interface in addition to authentication policy:\n\n\n\n\nauthenticator: This value must not be changed\n\n\nhideDomainField:\n\n\nIf this value is true, then forms should not display a separate user interface element for the user to supply the domain where their credential is stored. Instead they will be asked for their user name in the form of domain\\user or user@domain.\n\n\nIf this value is false, then a domain user interface element will be displayed. If the \n element is empty, then a text box for the user to type their domain should be displayed, otherwise a combo box containing all the values from the \n element should be displayed.\n\n\n\n\n\n\nallowUserPasswordChange: This value controls when a user is allowed to change their password and can have the following values:\n\n\nNever: The user is not allowed to change their password through StoreFront. A user attempting to authenticate with an expired password will fail to gain access to the system, and will be directed to change their password elsewhere.\n\n\nExpiredOnly: The user is allowed to change an expired password during the authentication process.\n\n\nAlways: The user can change an expired password during authentication, but will also receive a warning when their password is about to expire, and will be able to choose to change their password at any time.\n\n\n\n\n\n\nallowZeroLengthPassword: This is usually false and prevents users with zero length passwords from gaining access to the system or changing their password to a zero length.\n\n\nshowPasswordExpiryWarning: This setting controls when a password expiry warning notice is presented to the user, if allowUserChangePassword=Always, and this setting can have the following values:\n\n\nWindows: The period is determined by the Windows setting described here: http://technet.microsoft.com/en-us/library/ee829687(v=ws.10).aspx \n\n\nCustom: The period is determined by the passwordExpiryWarningPeriod setting below\n\n\nNever: The notification is never shown to the user\n\n\n\n\n\n\npasswordExpiryWarningPeriod: This setting, in days, determines when to display a password expiry warning notice to the user, if allowUserChangePassword=Always and showPasswordExpiryWarning=Custom\n\n\nrequireAccountSIDs: This setting determines whether or not to include the Windows Group information with the authentication data. This value should be left as true, as other StoreFront components rely on the information being present.\n\n\ndomainSelection: This element allows the specification of a set of domains. These can be specified as either short domain or fully qualified domain names. The user is then restricted to either selecting or typing a valid domain. It is possible to specify a default.\n\n\nNote: The comparison is a string comparison only.\n\n\n\n\n\n\n\n\nKerberos Support\n\n\nStoreFront also allows the use of Kerberos Service-For-User (S4U) for partial account validation and to obtain information about the account, including group information. The IoC container is populated with an object that implements the following interface that can be used for this purpose:\n\n\nnamespace Citrix.DeliveryServices.Authentication.Kerberos\n{\n    /// \nsummary\n\n    /// Interface for attempting kerberos authentication\n    /// \n/summary\n\n    public interface IKerberosAuthenticator\n    {\n        /// \nsummary\n\n        /// Authenticate the user specified by their user principal name\n        /// \n/summary\n\n        /// \nparam name=\nuserPrincipalName\nThe user principal name\n/param\n\n        /// \nparam name=\nclientRealm\nThe optional client realm \n/param\n\n        /// \nreturns\nThe \nseealso cref=\nAuthenticationResult\n/\n/returns\n\n        AuthenticationResult Authenticate(string userPrincipalName, string clientRealm = null);\n\n        /// \nsummary\n\n        /// Authenticate the user specified by a user certificate\n        /// \n/summary\n\n        /// \nparam name=\nuserCertificate\nThe user certificate\n/param\n\n        /// \nparam name=\ndomainHint\nThe optional domain hint \n/param\n\n        /// \nreturns\nThe \nseealso cref=\nAuthenticationResult\n/\n/returns\n\n        AuthenticationResult Authenticate(X509Certificate2 userCertificate,\n                                          string domainHint = null);\n\n        /// \nsummary\n\n        /// Authenticate the user specified by a user certificate\n        /// \n/summary\n\n        /// \nparam name=\nuserCertificate\nThe user certificate\n/param\n\n        /// \nparam name=\ndomainHint\nThe optional domain hint \n/param\n\n        /// \nreturns\nThe \nseealso cref=\nAuthenticationResult\n/\n/returns\n\n        AuthenticationResult Authenticate(HttpClientCertificate userCertificate,\n                                          string domainHint = null);\n    }\n}\n\n\n\n\nForms\n\n\nThe Authentication SDK provides the following built-in forms:\n\n\nCancelledForm\n\n\nThis class creates the required form in response to a cancel request.\n\n\nConstructor:\n\n\nCitrix.DeliveryServices.Authentication.FormsProtocol.Forms.CancelledForm(\n                  FormsTemplateEngine templateEngine, IEnumerable\nCultureInfo\n cultures)\n\n\n\n\nParameters:\n\n\n\n\ntemplateEngine: The template engine. This is a required parameter.\n\n\ncultures: The currently available cultures. This is a required parameter.\n\n\n\n\nForm:\n\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/response/1\n\n  \nStatus\nsuccess\n/Status\n\n  \nResult\ncancelled\n/Result\n\n  \nStateContext /\n\n\n/AuthenticateResponse\n\n\n\n\nTemplate:\n \n\n\nCancelled.tfrm\n\n\nFailureMessageForm\n\n\nThis class creates a mini-conversation of a message form, to inform the user of the reason for the error, followed by a failure form.\n\n\nConstructor:\n\n\nCitrix.DeliveryServices.Authentication.FormsProtocol.Forms.FailureMessageForm(\n              FormsTemplateEngine templateEngine, IEnumerable\nCultureInfo\n cultures,\n               IEnumerable\nFormsMessage\n messages, string postbackUrl, string cancelUrl)\n\n\n\n\nParameters:\n\n\n\n\n\n\ntemplateEngine: The template engine.\n\n\n\n\n\n\ncultures: The currently available cultures.\n\n\n\n\n\n\nmessages: The messages to display.\n\n\n\n\n\n\npostbackUrl: The host relative URL to POST the form response to.\n\n\n\n\n\n\ncancelUrl: The host relative URL to POST a cancel form response to.\n\n\n\n\n\n\nTemplate:\n Messages.tfrm \n Failed.tfrm\n\n\nChangeExpiredPasswordForm\n\n\nThis class creates a mini-conversation to change a user\u2019s expired password.\n\n\nConstructor:\n\n\nCitrix.DeliveryServices.Authentication.FormsProtocol.Forms.ChangePassword.ChangeExpiredPasswordForm\n(\n    FormsTemplateEngine templateEngine, IEnumerable\nCultureInfo\n cultures, IExplicit explicitBL,\n    string postbackUrl, string cancelUrl\n)\n\n\n\n\nParameters:\n\n\n\n\ntemplateEngine: The template engine.\n\n\ncultures: The currently available cultures.\n\n\nexplicitBL: The explicit credential business object, described above.\n\n\npostbackUrl: The host relative URL to POST the form response to.\n\n\ncancelUrl: The host relative URL to POST a cancel form response to.\n\n\n\n\nTemplate:\n ChangeExpiredPassword.tfrm and ConfirmChangePassword.tfrm\n\n\n\n\nNotes\n\n\n\n\nThe explicitBL object must have previously been used in the conversation to attempt to authenticate the user and discover that their password has expired. If this is not done, then an error form will be generated.\n\n\nThe settings for explicitBL object must have the AllowUserPasswordChange value set to either ExpiredOnly or Always. If the value is Never, then an error form will be issued.\n\n\n\n\n\n\nUsernamePasswordForm\n\n\nThis class creates a mini-conversation to allow a user to authenticate by explicitly providing their user name and password in the form. If configured it will also allow the user to change their expired password as part of this form.\n\n\nConstructor:\n\n\nCitrix.DeliveryServices.Authentication.FormsProtocol.Forms.UsernamePasswordForm\n(\n    FormsTemplateEngine templateEngine, IEnumerable\nCultureInfo\n cultures, IExplicit explicitBL,\n    string postbackUrl, string cancelUrl, bool allowChangeExpiredPasswordIfConfigured=true\n)\n\n\n\n\nParameters:\n\n- templateEngine: The template engine.\n- cultures: The currently available cultures.\n- explicitBL: The explicit credential business object, described above.\n- postbackUrl: The host relative URL to POST the form response to.\n- cancelUrl: The host relative URL to POST a cancel form response to.\n- allowChangeExpiredPasswordIfConfigured: This optional parameter defines whether or not the the user is allowed to change their expired password as part of this form.\n    - true: This is the default value, and allows the user to change their expired password, if the explicitBL object has been configured to allow it.\n    - false:The user is never allowed to change their password as part of this form.\n\n\nTemplate:\n UsernamePassword.tfrm and optionally ChangeExpiredPassword.tfrm and ConfirmChangePassword.tfrm\n\n\nChangePasswordController\n\n\nThe ChangePasswordController is a built-in ASP.Net MVC Controller for handling requests for a user to choose to change their password before it has expired. This Controller is deployed by default and an MVC route to it is defined in the Authentication Service web.config as shown below:\n\n\ncommonExplicitEndpoints\n\n  \nrouteTable order=\n10\n\n    \nroutes\n\n      \nroute name=\nStartChangePassword\n url=\nChangePassword/Start\n\n        \ndefaults\n\n          \nadd param=\ncontroller\n value=\nChangePassword\n /\n\n          \nadd param=\naction\n value=\nStartChangePassword\n /\n\n          \nadd param=\npostbackAction\n value=\nChangePassword\n /\n\n          \nadd param=\ncancelAction\n value=\nCancelChangePassword\n /\n\n          \nadd param=\nconversationFactory\n value=\nChangePassword\n /\n\n          \nadd param=\nchangePasswordAction\n value=\nStartChangePassword\n /\n\n          \nadd param=\nchangePasswordController\n value=\nChangePassword\n /\n\n        \n/defaults\n\n        \ndata /\n\n      \n/route\n\n      \nroute name=\nChangePassword\n url=\nChangePassword\n\n        \ndefaults\n\n          \nadd param=\ncontroller\n value=\nChangePassword\n /\n\n          \nadd param=\naction\n value=\nChangePassword\n /\n\n        \n/defaults\n\n        \ndata /\n\n      \n/route\n\n      \nroute name=\nCancelChangePassword\n url=\nChangePassword/Cancel\n\n        \ndefaults\n\n          \nadd param=\ncontroller\n value=\nChangePassword\n /\n\n          \nadd param=\naction\n value=\nCancelChangePassword\n /\n\n        \n/defaults\n\n        \ndata /\n\n      \n/route\n\n    \n/routes\n\n  \n/routeTable\n\n\n/commonExplicitEndpoints\n\n\n\n\nIn order for the client to discover this route, the CredentialUpdateService URL information must be present in the Request Security Token Response, as illustrated below:\n\n\n?xml version=\n1.0\n encoding=\nUTF-8\n standalone=\nyes\n?\n\n\nrequesttokenresponse xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/requesttokenresponse\n\n                      xmlns:ar=\nhttp://citrix.com/authentication/response/1\n\n  \nfor-service\na service identifier\n/for-service\n\n  \nissued\n2009-05-12T15:27:28.1550000Z\n/issued\n\n  \nexpiry\n2009-05-12T16:29:31.1550000Z\n/expiry\n\n  \nlifetime\n0.01:02:03\n/lifetime\n\n  \ntoken-template\nabcdef\n/token-template\n\n  \ntoken\nABCDEF123===\n/token\n\n  \nar:CredentialUpdateInformationList\n\n    \nar:CredentialUpdateInformation\n\n      \nar:CredentialDisplayName\nDomainName\n/ar:CredentialDisplayName\n\n      \nar:AuthenticationInfoId\n1\n/ar:AuthenticationInfoId\n\n      \nar:ExpiryTime\n2010-05-12T15:27:28.155Z\n/ar:ExpiryTime\n\n      \nar:TimeRemaining\n10.05:33:09\n/ar:TimeRemaining\n\n      \nar:CredentialUpdateService\n/ChangePasswordStart\n/ar:CredentialUpdateService\n\n    \n/ar:CredentialUpdateInformation\n\n  \n/ar:CredentialUpdateInformationList\n\n\n/requesttokenresponse\n\n\n\n\nA custom conversation can use the built-in functionality by setting the change password controller name and action name in the route data of the route associated with the conversation, as shown below:\n\n\nroute name=\nStartExplicitAuthentication\n url=\nExplicitForms/Start\n\n  \ndefaults\n\n    \nadd param=\ncontroller\n value=\nExplicitFormsAuthentication\n /\n\n    \nadd param=\naction\n value=\nAuthenticateStart\n /\n\n    \nadd param=\npostbackAction\n value=\nAuthenticate\n /\n\n    \nadd param=\ncancelAction\n value=\nCancelAuthenticate\n /\n\n    \nadd param=\nconversationFactory\n value=\nExplicitAuthentication\n /\n\n    \nadd param=\nchangePasswordAction\n value=\nStartChangePassword\n /\n\n    \nadd param=\nchangePasswordController\n value=\nChangePassword\n /\n\n    \nadd param=\nprotocol\n value=\nExplicitForms\n /\n\n  \n/defaults\n\n  \ndata /\n\n\n/route\n\n\n\n\nThis data is resolved by the built-in code to find the change password start URL . The built-in code also ensures that the correct RSTR is returned so the client can discover the change password end-point.\n\n\nTemplates:\n ChangeExpiredPassword.tfrm and ConfirmChangePassword.tfrm\n\n\n\n\nNotes\n\n\n\n\nThe user must be authenticated in order to change their password. The authenticated user must have authenticated using a password, otherwise an error form is issued. The password originally supplied during authentication is verified against a value supplied by the user in the form, and changing the password is not allowed unless the passwords match.\n\n\nThe settings for explicitBL object must have the AllowUserPasswordChange value set to Always. If the value is Never or ExpiredOnly, then an error form will be issued.\u2003\n\n\n\n\n\n\nForms Template Engine\n\n\nIntroduction\n\n\nThe forms template engine is the StoreFront component responsible for generating the Receiver Common Forms from templates. The templates are based on the ASP.NET Razor View Engine (see http://www.asp.net/web-pages/tutorials/basics/2-introduction-to-asp-net-web-programming-using-the-razor-syntax) with methods specific to the Receiver Common Forms domain that comprises the Forms Template Language described below.\n\n\nThe StoreFront Authentication SDK samples contain examples of how to define new templates, use the API, generate localized textual content, and use the Forms Template Language. Further details of the APIs can also be found in the XML documentation file at:\n\n\nAuthSDK.zip\\Assemblies\\StoreFront\\Citrix.DeliveryServices.Authentication.Forms.Template.XML\n\n\nIf there are issues with the template processing, the Forms Template Engine adds events to the Event log as described in Appendix A.\n\n\nCreation\n\n\nTemplate Engine Creation\n\n\nFor a particular web application, there is one and only one instance of the Forms Template Engine. It is stored in the StoreFront IoC container by the Forms Protocol start-up module during the application start-up and is accessed through the service locator.\n\n\nFirst a Razor engine host is created and configured to generate C# code. The base class is configured to be:\n\n\nCitrix.DeliveryServices.Authentication.Forms.Template.FormsTemplateBase\n\n\nThis base class contains the domain-specific business rules relating to the Citrix Receiver Common Forms.\n\n\nThe Razor host imports the following namespaces:\n\n\n\n\nSystem\n\n\nCitrix.DeliveryServices.Authentication.Forms.Template.Requirements\n\n\n\n\n\n\nNotes\n\n\nA limitation of this version is that it is not possible to add other namespaces or references to custom assemblies.\n\n\n\n\nThe Forms Template Engine is then constructed from a Razor template engine, wrapping the razor host and the Citrix localization factory, before loading and compiling the templates.\n\n\nThe templates are files with the file extension tfrm that are stored in the directory ~/App_Data/Templates. The template engine also finds and loads images with the following file extensions: gif, jpg, jpeg, png, bmp. The Forms Template Engine also watches for changes to the templates directory and automatically reloads the templates when a change is made. When the templates are reloaded, an event is added to the Citrix Delivery Services Event log, as described in Appendix A, with Event Id: 5. \n\n\nThe Forms Template Engine is finally stored in the IoC.\n\n\nTemplate Compilation\n\n\nThe compilation of a template, named CustomTemplate.tfrm for example, has the following steps:\n\n\n1.The Razor engine takes the template contents and generates code that represents the class Citrix.CompiledForms.CustomTemplate as C# code with FormsTemplateBase as its base class.\n\n\n2.The C# is then compiled into a code DOM using the CSharpCodeProvider.\n\n\n3.The code DOM is then compiled into an in-memory assembly that is loaded into the process.\n\n\n4.The loaded assembly is then stored in the Forms Template Engine, indexed as: CustomTemplate.\n\n\n\n\nNotes\n\n\nThe Razor template processing requires that the process has write access to the %TEMP% directory\n\n\n\n\nTemplate Rendering\n\n\nImages\n\n\nThe Receiver Common Authentication Forms Language allows the use of images as part of the authentication process, for example Captcha images. In addition to the templates, the Forms Template Engine will also search the template folder for files with extensions: gif, jpg, jpeg, png, and bmp. It will load all the files found and convert them to appropriate RFC 2397 data URIs, ready for use in the required templates. Again, adding, removing, or modifying an image will result in the images being reloaded automatically.\n\n\nImages can also be dynamically generated, with support built-in for converting raw image data to data URIs for use in forms.\n\n\nLocalization\n\n\nThe forms Template Engine supports the generation of localized textual content from a single template. In order for localized content to be available to the Forms Template Engine, the forms author should create localized content as standard Microsoft resx files (see http://msdn.microsoft.com/en-us/library/ekyft91f(v=vs.90).aspx). These resource files should be placed in the directory:\n\n\n~/App_Data/resources.\n\n\nStoreFront Services needs to be configured to become aware of new localization files, as described below.\n\n\nAPIs that accept localization keys can also accept either strings that do not require localization, or pre-localized strings. The processing of a localization key has the following steps.\n\n\nA key is expected to be an indexed resource key of form: ResourceSetPrefix:Key. The ResourceSetPrefix is configured in the Authentication Service web.config, and maps a prefix to a set of resources. For example, the default prefixes are defined as:\n\n\nconfiguration\n  \n  \ncitrix.deliveryservices\n\n    \nlocalisation\n\n      \nresourceSets\n\n        \nclear /\n\n        \nadd prefix=\nFormsProtocol\n resourcePath=\nApp_Data/resources/FormsProtocol\n /\n\n        \nadd prefix=\nExplicitCore\n resourcePath=\nApp_Data/resources/ExplicitCore\n /\n\n        \nadd prefix=\nExplicitFormsCommon\n resourcePath=\nApp_Data/resources/ExplicitFormsCommon\n /\n\n        \nadd prefix=\nExplicitAuth\n resourcePath=\nApp_Data/resources/ExplicitAuth\n /\n\n      \n/resourceSets\n\n    \n/localisation\n\n  \n/citrix.deliveryservices\n\n\n/configuration\n\n\n\n\nSo, for example, the resource named: \u201ctest\u201d defined in the FormsProtocol.resx file would be accessed by the localization key:\n\n\nFormsProtocol:test\n\n\nCustomizations are expected to update the above configuration with their resource sets.\n\n\nIf a localization key is supplied that does not correspond to this pattern, or that specifies a resource set prefix not mapped in the above configuration, then the supplied key is just returned as the localized string. Examples include:\n\n\n\n\n\u201cString not to be localized\u201d would be localized as: \u201cString not to be localized\u201d\n\n\n\u201cPre-localized\u201d would be localized as: \u201cPre-localized\u201d\n\n\n\u201cUnknownReseourceSetPrefix:Key\u201d would be localized as: \u201cUnknownReseourceSetPrefix:Key\u201d\n\n\n\n\nIf a valid resource set prefix is found, then the associated resource provider is used to locate the appropriate localized string into the requested language. If the localization key exists, but the request is to localize to a language not provided, then the string will be localized into the default language, which is English.\n\n\nTemplate Rendering\n\n\nThe Forms Template Engine is used by Forms objects to generate the Forms through the following methods on the Forms Template Engine:\n\n\n        /// \nsummary\n\n        /// Render the specified template using the specified anonymous object\n        /// as the model.\n        /// \n/summary\n\n        /// \nparam name=\ntemplateName\nThe name of the template to render\n/param\n\n        /// \nparam name=\ncurrentCultures\nThe current \nseealso cref=\nCultureInfo\n/\n to use to \n                                          localize text items\n/param\n\n        /// \nparam name=\nmodel\nThe anonymous model\n/param\n\n        /// \nparam name=\nmessages\nThe \nseealso cref=\nFormsMessage\n/\n to render\n/param\n\n        /// \nreturns\nThe rendered Xml\n/returns\n\n        public XmlDocument RenderTemplate(string templateName,\n                                          IEnumerable\nCultureInfo\n currentCultures,\n                                          object model,\n                                          IEnumerable\nFormsMessage\n messages = null);\n\n        /// \nsummary\n\n        /// Render the specified template using the specified dictionary of named objects\n        /// as the values.\n        /// \n/summary\n\n        /// \nparam name=\ntemplateName\nThe name of the template to render\n/param\n\n        /// \nparam name=\ncurrentCultures\nThe current \nseealso cref=\nCultureInfo\n/\n to use to \n                                          localize text items\n/param\n\n        /// \nparam name=\nrenderValues\nThe dictionary of named objects to use as values\n/param\n\n        /// \nparam name=\nmessages\nThe \nseealso cref=\nFormsMessage\n/\n to render\n/param\n\n        /// \nreturns\nThe rendered Xml\n/returns\n\n        public XmlDocument RenderTemplate(string templateName,\n                                          IEnumerable\nCultureInfo\n currentCultures,\n                                          IDictionary\nstring, object\n renderValues,\n                                          IEnumerable\nFormsMessage\n messages=null);\n\n\n\n\nIn the above, the template name is the index of the compiled template, as described above; for example, the name to be used for test.tfrm is: test. The data model, whether an anonymous data class or a dictionary, allows the form to define named data items referenced in the associated template. Examples of data models can be seen in the Forms Template Language section below.\n\n\nThe FormsMessage object has the following API, and is used for associating messages with credentials:\n\n\nnamespace Citrix.DeliveryServices.Authentication.Forms.Template.RequirementAPI\n{\n    /// \nsummary\n\n    /// This class represents a message to be displayed on a form.\n    /// The message is one of the following categories:\n    ///     information, warning or error.\n    /// \n/summary\n\n    public class FormsMessage\n    {\n        /// \nsummary\n\n        /// Gets or sets the localization key\n        /// \n/summary\n\n        public string LocalisationKey { get; set; }\n\n        /// \nsummary\n\n        /// Gets or sets the localized message\n        /// \n/summary\n\n        internal string Message { get; set; }\n\n        /// \nsummary\n\n        /// Gets or sets the collection of filed identifiers that this\n        /// message relates to.\n        /// \n/summary\n\n        public IEnumerable\nstring\n FieldIds { get; set; }\n\n        /// \nsummary\n\n        /// Gets or sets the form message type\n        /// This must be: information, warning or error\n        /// \n/summary\n\n        public Label.LabelType MessageType { get; set; }\n\n        /// \nsummary\n\n        /// Render this message into the specified buffer\n        /// \n/summary\n\n        /// \nparam name=\nsb\n\n        /// The \nseealso cref=\nStringBuilder\n/\n to render this message into\n        /// \n/param\n\n        /// \nreturns\nThe string of the the rendered message\n/returns\n\n        public void RenderMessageToBuffer(StringBuilder sb);\n    }\n}\n\n\n\n\nFor example, consider a change password form with a requirement for the user to re-enter their existing password:\n\n\nRequirement\n\n  \nCredential\n\n    \nID\noldPassword\n/ID\n\n    \nType\npassword\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nOld password:\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nText\n\n      \nSecret\ntrue\n/Secret\n\n      \nReadOnly\nfalse\n/ReadOnly\n\n      \nInitialValue\n/InitialValue\n\n      \nConstraint\n.+\n/Constraint\n\n    \n/Text\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nIf the user enters an invalid value, then an error label is returned that specifies the oldPassword requirement to be highlighted. This would be done by creating a FormsMessage as follows:\n\n\nnew FormsMessage\n    {\n        MessageType = Label.LabelType.error,\n        LocalisationKey = \nExplicitCore:OldInvalid\n,\n        FieldIds = new[] { \noldPassword\n }\n    }\nThis would result in the following XML:\n\nRequirement\n\n  \nCredential\n\n    \nType\nnone\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nHighlightFields\n\n      \nCredentialID\noldPassword\n/CredentialID\n\n    \n/HighlightFields\n\n    \nText\nOld password incorrect\n/Text\n\n    \nType\nerror\n/Type\n\n  \n/Label\n\n  \nInput /\n\n\n/Requirement\n\n\n\n\nThe generated form XML is returned to the client by the conversation engine and the MVC Controller in an appropriately formatted message.\n\n\nThe Authentication SDK samples contain detailed examples of how to use the Template Rendering API.\n\n\nForms Template Language\n\n\nThe FormsTemplateBase C# class has a collection of methods that can be accessed in the template. These form the domain- specific forms template language. The language is divided into three APIs: low-level, requirements and high-level, which allow different levels of control of the final Receiver Common Forms XML. Appendix B illustrates a single form generated using the three APIs, so that they can be compared and contrasted.\n\n\nThe following description expects a basic understanding of the layout of the Receiver Common Forms XML as described in [2]. The APIs also expect an understanding of C# optional and named Parameters, as described here: http://msdn.microsoft.com/en-gb/library/dd264739.aspx \n\n\nIn addition to these domain-specific methods, many general Razor programming constructs may be used.\n\n\nLow Level API\n\n\nThis API is the lowest level API and is based around the generation of strings for XML documents.\n\n\nFor the low-level methods, all the Parameters are required.\n\n\nContainsValue\n\n\nbool ContainsValue(string valueName)\n\n\nThis method returns true if the specified named index is associated with an object in the data model.\n\n\nParameters:\n\n\n\n\nvalueName: The name of an object in the data model.\n\n\n\n\nReturns: True if the specified named index is valid\n\n\nExample:\n\n\nModel: new { AssistiveText = \"Help Text\"};\n\n\nTemplate:\n\n\nInput\n\n@if (ContainsValue(\nAssistiveText\n))\n{\n@: \nAssistiveText\n@GetValue(\nAssistiveText\n)\n/AssistiveText \n\n}\n  \nText\n\n    \nConstraint\n.+\n/Constraint\n\n  \n/Text\n\n\n/Input\n\n\n\n\nOutput:\n\n\nInput\n\n  \nAssistiveText\nHelp Text\n/AssistiveText\n\n  \nText\n\n    \nConstraint\n.+\n/Constraint\n\n  \n/Text\n\n\n/Input\n\n\n\n\nGetObject\n\n\nobject GetObject(string valueName)\n\n\nThis method returns the object in the data model with the specified named index.\n\n\nParameters:\n:\n\n\n\n\nvalueName: The name of an object in the data model.\n\n\n\n\nReturns: The specified object from the data model, or null if the index is not valid.\n\n\nExample:\n\n\nModel:\n\n\nnew\n{\n    PhoneNumbers = new []\n                   {\n                       new Tuple\nstring, string\n (\nHome Number\n, \n01954 283 710\n),\n                       new Tuple\nstring, string\n (\nFax Number\n, \n01954 283 601\n)\n                   }\n}\n\n\n\n\nTemplate:\n\n\n@foreach(Tuple\nstring, string\n phoneNumber in (IEnumerable)GetObject(\nPhoneNumbers\n))\n{\n@:      \nRequirement\n\n@Credential(credentialType: \nnone\n)\n@TextLabel(labelKey: @phoneNumber.Item1)\n@:        \nInput\n\n@:          \nText\n\n@:            \nInitialValue\n@phoneNumber.Item2\n/InitialValue\n\n@:            \nConstraint\n.+\n/Constraint\n\n@:          \n/Text\n\n@:        \n/Input\n\n@:      \n/Requirement\n\n}\n\n\n\n\nOutput:\n\n\nRequirement\n\n  \nCredential\n\n    \nType\nnone\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nHome Number\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nText\n\n      \nInitialValue\n01954 283 710\n/InitialValue\n\n      \nConstraint\n.+\n/Constraint\n\n    \n/Text\n\n  \n/Input\n\n\n/Requirement\n\n\nRequirement\n\n  \nCredential\n\n    \nType\nnone\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nFax Number\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nText\n\n      \nInitialValue\n01954 283 601\n/InitialValue\n\n      \nConstraint\n.+\n/Constraint\n\n    \n/Text\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nGetValue\n\n\nstring GetValue(string valueName)\n\n\nThis method returns the object in the data model with the specified named index, as a string. This method will convert the specified object to a string, if required.\n\n\nParameters:\n\n\n\n\nvalueName: The name of an object in the data model.\n\n\n\n\nReturns: The specified string from the data model, or the empty string if the index is not valid\n\n\nExample:\n\n\nModel: new { Date = DateTime.Now() };\n\n\nTemplate: \n@GetValue(\"Date\")\n\n\nOutput: 5/6/2005 02:34:42 PM\n\n\nControlValue\n\n\nbool ControlValue(string valueName)\n\n\nThis method returns the object in the data model with the specified named index, as a Boolean value. This method expects that the stored object is a Boolean and will not attempt to convert from other types.\n\n\nParameters:\n\n\n\n\nvalueName: The name of an object in the data model.\n\n\n\n\nReturns: The specified Boolean value from the data model, or false if the index is not valid\n\n\nExample:\n\n\nModel: new { Display = true  };\n\n\nTemplate:\n\n\n@if (ControlValue(\nDisplay\n))\n{\n@: \nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/response/1\n\n}\n\n\n\n\nOutput: \n\n\nAuthenticateResponse xmlns=\"http://citrix.com/authentication/response/1\"\n\n\nGetAttributeValue\n\n\nstring GetAttributeValue(string valueName)\n\n\nThis method returns the object in the data model with the specified named index, as a string encoded for using as an XML attribute. This method will convert the specified object to a string, if required.\n\n\nParameters:\n:\n\n\n\n\nvalueName: The name of an object in the data model.\n\n\n\n\nReturns: The specified string from the data model encoded to be used as an XML attribute, or the empty string if the index is not valid\n\n\nExample:\n\n\nModel: new { Namespace = \"http://citrix.com/authentication/response/1\"};\n\n\nTemplate: \n\n\nAuthenticateResponse xmlns=\"@GetAttributeValue(\"Namespace\")\"\n\n\nOutput: \n\n\nAuthenticateResponse xmlns=\"http://citrix.com/authentication/response/1\"\n\n\nGetElementValue\n\n\nstring GetElementValue(string valueName)\n\n\nThis method returns the object in the data model with the specified named index, as a string encoded for using as an XML element. This method will convert the specified object to a string, if required.\n\n\nParameters:\n\n- valueName: The name of an object in the data model.\n\n\nReturns: The specified string from the data model encoded to be used as an XML element, or the empty string if the index is not valid\n\n\nExample:\n\n\nModel: new { \"StateContextElementName\", \"StateContext\"};\n\n\nTemplate: \n\n\n@GetElementValue(\"StateContextElementName\")\n\n\nOutput: \n\n\nStateContext\n\n\nGetTextValue\n\n\nstring GetTextValue(string valueName)\n\n\nThis method returns the object in the data model with the specified named index, as a string encoded for using as XML text. This method will convert the specified object to a string, if required.\n\n\nParameters:\n\n\n\n\nvalueName: The name of an object in the data model.\n\n\n\n\nReturns: \n\n\nThe specified string from the data model encoded to be used as XML text, or the empty string if the index is not valid\n\n\nExample:\n\n\nModel: new { TestText = \"This is non-localized \n unencoded text\"};\n\n\nTemplate: \n\n\n@GetTextValue(\"TestText\")\n\n\nOutput: \n\n\nThis is non-localized \n unencoded text.\n\n\nGetLocalisedTextValue\n\n\nstring GetLocalisedTextValue(string valueName)\n\n\nThis method will use the localization key to provide a localized string encoded as XML text.\n\n\nParameters:\n\n\n\n\nvalueName: The name of an object in the data model containing a localization key\n\n\n\n\nReturns: The localized string, encoded as XML text, or the empty string if the index is not valid\n\n\nExample:\n\n\nTemplate: @GetLocalisedTextValue(\"Test:TestKey\")\n\n\nOutput: \n\n\nThis is a localized test string\n\n\nGetLocalisedFormattedValue\n\n\nstring GetLocalisedFormattedValue(string formatName, params object[] Parameters)\n\n\nThis method will use the localization key to obtain a format string that is used with the Parameters to generate a localized string, encoded as XML text.\n\n\nParameters:\n\n\n\n\nvalueName: The name of an object in the data model containing a localization key\n\n\n\n\nReturns: \n\n\nThe localized string, encoded as XML text, or the empty string if the index is not valid\n\n\nExample:\n\n\nTemplate: @GetLocalisedTextValue(\"Test:FormatKey\", DateTime.Now)\n\n\nOutput: \n\n\nCalled at: 5/6/2005 02:34:42 PM\n\n\nRequirements\n\n\nA Receiver Common Form contains a list of authentication requirements. Each authentication requirement contains the following elements: \nCredential\n, \nLabel\n, and \nInput\n. This API is focused around the generation of these three elements.\nIn cases where there are many arguments, defaults are provided where possible, and it is expected that Parameters are specified by name for ease of use, as demonstrated in the examples.\n\n\nCredential\n\n\nstring Credential(string credentialType, string id = null, string saveId = null)\n\n\nCreate a \n authentication requirement fragment with the specified values.\n\n\nParameters:\n\n\n\n\ncredentialType: The credential type (see the Receiver Common Authentication Forms Language document for more information). This parameter is required.\n\n\nid: The optional credential identifier. The default is to have no identifier.\n\n\nsaveId: The optional identifier to be used to save this credential on a client. The default is to have no save identifier.\n\n\n\n\nReturns: \n\n\nThe \n xml fragment\n\n\nExample:\n\n\nTemplate: \n\n\n@Credential(credentialType: \"username\", id: \"UsernameID\", saveId: \"SaveUsernameID\")\n\n\nOutput:\n\n\nCredential\n\n  \nID\nUsernameID\n/ID\n\n  \nSaveID\nSaveUsernameID\n/SaveID\n\n  \nType\nusername\n/Type\n\n\n/Credential\n\n\n\n\nTextLabel\n\n\nstring TextLabel(string labelKey, Label.LabelType labelType = Label.LabelType.plain)\n\n\nCreate a text-based \n authentication requirement fragment from the specified values.\n\n\nParameters:\n\n\n\n\nlabelKey: The localization key for the label. This parameter is required.\n\n\nlabelType: The optional label type (see the Receiver Common Authentication Forms Language document for more information). The default label type is: plain\n\n\n\n\nReturns: The text-based \n xml fragment\n\n\nExample:\n\n\nTemplate: @TextLabel(labelKey: \"Test:UsernameLabelKey\")\n\n\nOutput:\n\n\nLabel\n\n  \nText\nUser name:\n/Text\n\n  \nType\nplain\n/Type\n\n\n/Label\n\n\n\n\nImageLabel\n\n\nstring ImageLabel(string imageKey)\n\n\nCreate an image-based \n authentication requirement fragment from an image stored in the Template folder.\n\n\nParameters:\n\n\n\n\nimageKey: The name of the image file in the Template directory. This is a required parameter.\n\n\n\n\nReturns: The image-based \n xml fragment\n\n\nExample:\n\n\nTemplate: \n\n\n@ImageLabel(imageKey: \"captcha.png\")\n\n\nOutput:\n\n\nLabel\n\n  \nBinary\ndata:image/png;base64,iVBORw0KGgoAAAANSUh\u2026/sAAAAASUVORK5CYII=\n/Binary\n\n  \nType\nimage\n/Type\n\n\n/Label\n\n\n\n\nNote: \n\n\nIt is possible to dynamically create images and display them, for example:\n\n\nForm:\n\n\nbyte[] dynamicImage; \nvar converted = FormsTemplateEngine.GetImageDataUri(dynamicImage, @\nimage/gif\n);      \nTemplateEngine.RenderTemplate(FormName, Cultures, Values,\n            new { DynamicImage = converted});\n\n\n\n\nTemplate:\n\n\nLabel\n\n  \nBinary\n@GetTextValue(\nDynamicImage\n)\n/Binary\n\n  \nType\nimage\n/Type\n\n\n/Label\n\n\n\n\nOutput:\n\n\nLabel\n\n  \nBinary\ndata:image/png;base64,iVBORw0KGgoAAAANSUh\u2026/sAAAAASUVORK5CYII=\n/Binary\n\n  \nType\nimage\n/Type\n\n\n/Label\n\n\n\n\nInputButton\n\n\nstring InputButton(string buttonKey, string assistiveTextKey=null)\n\n\nCreate a button \nInput\n authentication requirement fragment.\n\n\nParameters:\n\n\n\n\n\n\nbuttonKey: The localization key for the button label. This is a required parameter.\n\n\n\n\n\n\nassistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.\n\n\n\n\n\n\nReturns: The button \n xml fragment\n\n\nExample:\n\n\nTemplate: \n\n\n@InputButton(buttonKey: \"Test:LogonButtonKey\")\n\n\nOutput:\n\n\nInput\n\n  \nButton\nLog On\n/Button\n\n\n/Input\n\n\n\n\nInputComboBox\n\n\nstring InputComboBox(string displayItemsValueName, string initialSelectionValueName = null,\n                     string assistiveTextKey = null)\n\n\n\n\nCreate a combo-box \nInput\n authentication requirement fragment.\n\n\nParameters:\n\n\n\n\ndisplayItemsValueName: The name of the dictionary of display-value pairs in the model. This is a required parameter.\n\n\ninitialSelectionValueName: The optional initially selected display value. The default is to select the first value.\n\n\nassistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.\n\n\n\n\nReturns: \n\n\nThe combo-box \nInput\n xml fragment\n\n\nExample:\n\n\nModel:\n\n\nnew\n{\n    Domains = new Dictionary\nstring, string\n\n              {\n                  { @\ncitrix\n, @\ncitrix.com\n},\n                  { @\ncitrite\n, @\ncitrite.local\n}\n              },\n    InitialDomain = @\ncitrite.local\n\n}\n\n\n\n\nTemplate: \n\n\n@InputComboBox(displayItemsValueName: \nDomains\n,\n                       initialSelectionValueName: \nInitialDomain\n,\n                       assistiveTextKey: \nDomainAssistiveTextKey\n)\n\n\n\n\nOutput:\n\n\nInput\n\n  \nAssistiveText\nPlease select your domain\n/AssistiveText\n\n  \nComboBox\n\n    \nInitialSelection\ncitrite.local\n/InitialSelection\n\n    \nDisplayValues\n\n      \nDisplayValue\n\n        \nDisplay\ncitrix\n/Display\n\n        \nValue\ncitrix.com\n/Value\n\n      \n/DisplayValue\n\n      \nDisplayValue\n\n        \nDisplay\ncitrite\n/Display\n\n        \nValue\ncitrite.local\n/Value\n\n      \n/DisplayValue\n\n    \n/DisplayValues\n\n  \n/ComboBox\n\n\n/Input\n\n\n\n\nNote: \n\n\nThe display values for combo box, radio button, and multi-combo box, can be localized, for example, the following model is taken from the Test Forms sample:\n\n\nnew\n{\n    multiComboValues = new Dictionary\nstring, string\n\n            {\n                {@\nTestForms:ComboDisplayTextOne\n, @\nValue1\n},\n                {@\nTestForms:ComboDisplayTextTwo\n, @\nValue2\n},\n                {@\nTestForms:ComboDisplayTextThree\n, @\nValue3\n}\n            }\n}\n\n\n\n\nInputRadioButton\n\n\nstring InputRadioButton(string displayItemsValueName, string initialSelectionValueName = null,\n                        string assistiveTextKey = null)\n\n\n\n\nCreate a combo-box \nInput\n authentication requirement fragment.\n\n\nParameters:\n\n\n\n\ndisplayItemsValueName: The name of the dictionary of display-value pairs in the model. This is a required parameter.\n\n\ninitialSelectionValueName: The optional initially selected display value. The default is is to select the first value.\n\n\nassistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.\n\n\n\n\nReturns: \n\n\nThe radio button \nInput\n xml fragment\n\n\nExample:\n\n\nModel:\n\n\nnew\n{\n    Domains = new Dictionary\nstring, string\n\n              {\n                  { @\ncitrix\n, @\ncitrix.com\n},\n                  { @\ncitrite\n, @\ncitrite.local\n}\n              },\n    InitialDomain = @\ncitrite.local\n\n}\n\n\n\n\nTemplate: \n\n\n@InputRadioButton(displayItemsValueName: \nDomains\n,\n                          initialSelectionValueName: \nInitialDomain\n,\n                          assistiveTextKey: \nDomainAssistiveTextKey\n)\n\n\n\n\nOutput:\n\n\nInput\n\n  \nAssistiveText\nPlease select your domain\n/AssistiveText\n\n  \nRadioButton\n\n    \nInitialSelection\ncitrite.local\n/InitialSelection\n\n    \nDisplayValues\n\n      \nDisplayValue\n\n        \nDisplay\nanimaniacs\n/Display\n\n        \nValue\nanimaniacs.net\n/Value\n\n      \n/DisplayValue\n\n      \nDisplayValue\n\n        \nDisplay\ncitrite\n/Display\n\n        \nValue\ncitrite.local\n/Value\n\n      \n/DisplayValue\n\n    \n/DisplayValues\n\n  \n/RadioButton\n\n\n/Input\n\n\n\n\nInputMultiComboBox\n\n\nstring InputMultiComboBox(string displayItemsValueName, string assistiveTextKey = null)\n\n\nCreate a multi-select combo-box \nInput\n authentication requirement fragment.\n\n\nParameters:\n\n\n\n\ndisplayItemsValueName: The name of the dictionary of display, value and selection flag tuples in the model. This is a required parameter.\n\n\nassistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.\n\n\n\n\nReturns: \n\n\nThe multi-selection combo-box \nInput\n xml fragment\n\n\nExample:\n\n\nModel:\n\n\nnew\n{\n    Users = new Dictionary\nstring, Tuple\nstring, bool?\n\n                {\n                    { @\nAlice\n, new Tuple\nstring, bool?\n(\nAlice\n, null)},\n                    { @\nBob\n,  new Tuple\nstring, bool?\n(\nBob\n, false)},\n                    { @\nEve\n,  new Tuple\nstring, bool?\n(\nEve\n, true)}\n                }\n}\n\n\n\n\nTemplate: \n\n\n@InputMultiComboBox(displayItemsValueName: \nUsers\n,\n                            assistiveTextKey: \nMultiComboBoxAssistiveTextKey\n)\n\n\n\n\nOutput:\n\n\nInput\n\n  \nAssistiveText\nPlease select who is a hacker\n/AssistiveText\n\n  \nMultiComboBox\n\n    \nDisplayValues\n\n      \nDisplayValue\n\n        \nDisplay\nAlice\n/Display\n\n        \nValue\nAlice\n/Value\n\n      \n/DisplayValue\n\n      \nDisplayValue\n\n        \nDisplay\nBob\n/Display\n\n        \nValue\nBob\n/Value\n\n        \nSelect\nfalse\n/Select\n\n      \n/DisplayValue\n\n      \nDisplayValue\n\n        \nDisplay\nEve\n/Display\n\n        \nValue\nEve\n/Value\n\n        \nSelect\ntrue\n/Select\n\n      \n/DisplayValue\n\n    \n/DisplayValues\n\n  \n/MultiComboBox\n\n\n/Input\n\n\n\n\nInputCheckBox\n\n\nstring InputCheckBox(bool? initiallyChecked=null, string assistiveTextKey = null)\n\n\nCreate a check box \nInput\n authentication requirement fragment.\n\n\nParameters:\n\n\n\n\ninitiallyChecked: The optional value to set whether the check box is initially checked. If the value is null, which is the default, then the optional \n InitialValue \n element is not included.\n\n\nassistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.\n\n\n\n\nReturns: \n\n\nThe check box \nInput\n xml fragment\n\n\nExample:\n\n\nTemplate: \n\n\n@InputCheckBox(initiallyChecked: true,\n                       assistiveTextKey: \nCheckBoxAssistiveTextKey\n)\n\n\n\n\nOutput:\n\n\nInput\n\n  \nAssistiveText\nCheck box assistive text\n/AssistiveText\n\n  \nCheckBox\n\n    \nInitialValue\ntrue\n/InitialValue\n\n  \n/ CheckBox \n\n\n/Input\n\n\n\n\nInputTextBox\n\n\nstring InputTextBox(string assistiveTextKey = null, string initialValueName = null,\n                    string constraint = TextBox.DefaultConstraint, bool? secret = null,\n                    bool? readOnly = null)\n\n\n\n\nCreate a text-based \nInput\n authentication requirement fragment.\n\n\nParameters:\n\n\n\n\ninitialValueName: The optional name of the model value that contains the initial value of the text box. Note that this is a raw string not a key to be localized. The default is not to have an initial value.\n\n\nconstraint: The optional, and unused, regular expression for the text to be entered.\n\n\nsecret: If true then the text typed by the user should be obscured. This parameter is optional. If the value is null, which is the default, then the optional \n element is not included.\n\n\nreadOnly: This optional parameter makes the initial text value read-only. If the value is null, which is the default, then the optional \n element is not included.\n\n\nassistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.\n\n\n\n\nReturns: \n\n\nThe text \nInput\n xml fragment\n\n\nExample:\n\n\nTemplate: @InputTextBox(secret: true,\n                      assistiveTextKey: \nPasswordAssistiveTextKey\n)\n\n\n\n\nOutput:\n\n\nInput\n\n  \nAssistiveText\nPlease enter your password\n/AssistiveText\n\n  \nText\n\n    \nSecret\ntrue\n/Secret\n\n    \nConstraint\n.+\n/Constraint\n\n  \n/Text\n\n\n/Input\n\n\n\n\nHigh Level API\n\n\nThe high level API is also focused on the authentication requirements, but creates a complete requirement, including the \nCredential\n, \nLabel\n, and \nInput\n values. These methods provide a higher-level abstraction and ensure that the authentication requirements produced are internally consistent. For this reason, it is recommended that these methods should be used where possible.\n\n\nIn cases where there are many arguments, defaults are provided where possible, and it is expected that Parameters are specified by name for ease of use.\n\n\nControlHeaders\n\n\nstring ControlHeaders(string status, string result, string stateContext = null,\n                      string logMessageKey = null)\n\n\n\n\nCreate the control header fragment.\n\n\nParameters:\n\n- status: The authentication status (see the Receiver Common Authentication Forms Language document). This parameter is required.\n- result: The authentication result (see the Receiver Common Authentication Forms Language document). This parameter is required.\n- stateContext: The optional state context. The default is an empty state context.\n- logMessage: This optional parameter is a key to a localized message to be logged by the client. The default is to not include the optional \n element.\n\n\nReturns: The control xml fragment\n\n\nExample:\n\n\nTemplate: @ControlHeaders(status: StatusSuccess, result: ResultMoreInfo, stateContext: \"0x12345678\")\n\n\nOutput:\n\n\nStatus\nsuccess\n/Status\n\n\nResult\nmore-info\n/Result\n\n\nStateContext\n0x12345678\n/StateContext\n\n\n\n\nTextbox\n\n\nstring Textbox(string type, string id = null, string saveId = null, string assistiveTextKey = null,\n               string labelKey = null, Label.LabelType labelType = Label.LabelType.plain,\n               string initialValueName = null, string constraint = TextBox.DefaultConstraint,\n               bool? secret = null, bool? readOnly = null)\n\n\n\n\nCreate a general text box authentication requirement fragment.\n\n\nParameters:\n\n\n\n\ntype: The type of the associated credential (see the Receiver Common Authentication Forms Language document). This parameter is required.\n\n\nid: The optional credential identifier. If not specified, then the option \n element is not included.\n\n\nsaveId: The optional identifier to be used to save this credential on a client. The default is to have no save identifier.\n\n\nassistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.\n\n\nlabelKey: The localization key for the label. This parameter is required.\n\n\nlabelType: The optional label type (see the Receiver Common Authentication Forms Language document for more information). The default label type is: plain\n\n\ninitialValueName: The optional name of a model value that contains the initial value of the text box. Note that this is a raw string not a key to be localized. The default is not to have an initial value.\n\n\nconstraint: The optional, and unused, regular expression for the text to be entered.\n\n\nsecret: If true then the text typed by the user should be obscured. This parameter is optional. If the value is null, which is the default, then the optional \n element is not included.\n\n\nreadOnly: This optional parameter makes the initial text value read-only. If the value is null, which is the default, then the optional \n element is not included.\n\n\n\n\nReturns: \n\n\nThe text box authentication requirement XML fragment\n\n\nExample:\n\n\nTemplate:\n\n\n@Textbox(type: \nusername\n, id:\nUsernameID\n, saveId: \nSaveUsernameID\n,\n         labelKey: \nTest:UsernameLabelKey\n,\n         assistiveTextKey: \nTest:UsernameAssistiveTextKey\n)\n\n\n\n\nOutput:\n\n\nRequirement\n\n  \nCredential\n\n    \nID\nUsernameID\n/ID\n\n    \nSaveID\nSaveUsernameID\n/SaveID\n\n    \nType\nusername\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nUser name:\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nAssistiveText\ndomain\\user or user@domain.com\n/AssistiveText\n\n    \nText\n\n      \nConstraint\n.+\n/Constraint\n\n    \n/Text\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nPasswordTextBox\n\n\nstring PasswordTextBox(string id = null, string saveId = null, string assistiveTextKey = null,\n                       string labelKey = null, Label.LabelType labelType = Label.LabelType.plain,\n                       string initialValueName = null,\n                       string constraint = TextBox.DefaultConstraint, bool? readOnly = false)\n\n\n\n\nCreate a password text box authentication requirement fragment.\n\n\nParameters:\n\n\n\n\nid: The optional credential identifier. If not specified, then the option \n element is not included.\n\n\nsaveId: The optional identifier to be used to save this credential on a client. The default is to have no save identifier.\n\n\nassistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.\n\n\nlabelKey: The localization key for the label. This parameter is required.\n\n\nlabelType: The optional label type (see the Receiver Common Authentication Forms Language document for more information). The default label type is: plain\n\n\ninitialValueName: The optional name of a model value that contains the initial value of the text box. Note that this is a raw string not a key to be localized. The default is not to have an initial value.\n\n\nconstraint: The optional, and unused, regular expression for the text to be entered.\n\n\nreadOnly: This optional parameter makes the initial text value read-only. If the value is null, which is the default, then the optional \n element is not included.\n\n\n\n\nReturns: \n\n\nThe password text box authentication requirement XML fragment\n\n\nExample:\n\n\nTemplate:\n\n\n@PasswordTextBox(id:\"PasswordID\", saveId: \"SavePasswordID\", labelKey: \"Test:PasswordLabelKey\")\n\n\nOutput:\n\n\nRequirement\n\n  \nCredential\n\n    \nID\nPasswordID\n/ID\n\n    \nSaveID\nSavePasswordID\n/SaveID\n\n    \nType\npassword\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nPassword:\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nText\n\n      \nSecret\ntrue\n/Secret\n\n      \nReadOnly\nfalse\n/ReadOnly\n\n      \nConstraint\n.+\n/Constraint\n\n    \n/Text\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nUsernameTextBox\n\n\nstring UsernameTextBox(string id = null, string saveId = null, string assistiveTextKey = null,\n                       string labelKey = null, Label.LabelType labelType = Label.LabelType.plain,\n                       string initialValueName = null,\n                       string constraint = TextBox.DefaultConstraint, bool? secret = null,\n                       bool? readOnly = null)\n\n\n\n\nCreate a user name text box authentication requirement fragment.\n\n\nParameters:\n\n\n\n\nid: The optional credential identifier. If not specified, then the option \n element is not included.\n\n\nsaveId: The optional identifier to be used to save this credential on a client. The default is to have no save identifier.\n\n\nassistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.\n\n\nlabelKey: The localization key for the label. This parameter is required.\n\n\nlabelType: The optional label type (see the Receiver Common Authentication Forms Language document for more information). The default label type is: plain\n\n\ninitialValueName: The optional name of a model value that contains the initial value of the text box. Note that this is a raw string not a key to be localized. The default is not to have an initial value.\n\n\nconstraint: The optional, and unused, regular expression for the text to be entered.\n\n\nsecret: If true then the text typed by the user should be obscured. This parameter is optional. If the value is null, which is the default, then the optional \n element is not included.\n\n\nreadOnly: This optional parameter makes the initial text value read-only. If the value is null, which is the default, then the optional \n element is not included.\n\n\n\n\nReturns: The user name text box authentication requirement XML fragment\n\n\nExample:\n\n\nTemplate:\n\n\n@UsernameTextBox(id:\nUsernameID\n, saveId: \nSaveUsernameID\n, labelKey: \nTest:UsernameLabelKey\n,\n                 assistiveTextKey: \nTest:UsernameAssistiveTextKey\n)\n\n\n\n\nOutput:\n\n\nRequirement\n\n  \nCredential\n\n    \nID\nUsernameID\n/ID\n\n    \nSaveID\nSaveUsernameID\n/SaveID\n\n    \nType\nusername\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nUser name:\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nAssistiveText\ndomain\\user or user@domain.com\n/AssistiveText\n\n    \nText\n\n      \nConstraint\n.+\n/Constraint\n\n    \n/Text\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nNewPasswordTextBox\n\n\nstring NewPasswordTextBox(string id = null, string saveId = null, string assistiveTextKey = null,\n                          string labelKey = null,Label.LabelType labelType = Label.LabelType.plain,\n                          string initialValueName = null,\n                          string constraint = TextBox.DefaultConstraint, bool? secret = null,\n                          bool? readOnly = null)\n\n\n\n\nCreate a new password text box authentication requirement fragment.\n\n\nParameters:\n\n\n\n\nid: The optional credential identifier. If not specified, then the option \n element is not included.\n\n\nsaveId: The optional identifier to be used to save this credential on a client. The default is to have no save identifier.\n\n\nassistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.\n\n\nlabelKey: The localization key for the label. This parameter is required.\n\n\nlabelType: The optional label type (see the Receiver Common Authentication Forms Language document for more information). The default label type is: plain\n\n\ninitialValueName: The optional name of a model value that contains the initial value of the text box. Note that this is a raw string not a key to be localized. The default is not to have an initial value.\n\n\nconstraint: The optional, and unused, regular expression for the text to be entered.\n\n\nsecret: If true then the text typed by the user should be obscured. This parameter is optional. If the value is null, which is the default, then the optional \n element is not included.\n\n\nreadOnly: This optional parameter makes the initial text value read-only. If the value is null, which is the default, then the optional \n element is not included.\n\n\n\n\nReturns: \n\n\nThe new password text box authentication requirement xml fragment\n\n\nExample:\n\n\nTemplate:\n\n\n@NewPasswordTextBox(id:\nNewPasswordID\n, saveId: \nSavePasswordID\n, \n                    labelKey:\nTest:NewPasswordLabelKey\n,\n                    assistiveTextKey: \nTest:NewPasswordAssisitiveTextKey\n)\n\n\n\n\nOutput:\n\n\nRequirement\n\n  \nCredential\n\n    \nID\nNewPasswordID\n/ID\n\n    \nSaveID\nSavePasswordID\n/SaveID\n\n    \nType\nnewpassword\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nPassword:\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nAssistiveText\nMust meet complexity requirements\n/AssistiveText\n\n    \nText\n\n      \nSecret\ntrue\n/Secret\n\n      \nConstraint\n.+\n/Constraint\n\n    \n/Text\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nPasscodeTextBox\n\n\nstring PasscodeTextBox(string id = null, string assistiveTextKey = null, string labelKey = null,\n                       Label.LabelType labelType = Label.LabelType.plain,\n                       string constraint = TextBox.DefaultConstraint)\n\n\n\n\nCreate a passcode text box authentication requirement fragment.\n\n\nParameters:\n\n\n\n\nid: The optional credential identifier. If not specified, then the option \n element is not included.\n\n\nassistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.\n\n\nlabelKey: The localization key for the label. This parameter is required.\n\n\nlabelType: The optional label type (see the Receiver Common Authentication Forms Language document for more information). The default label type is: plain\n\n\nconstraint: The optional, and unused, regular expression for the text to be entered.\n\n\n\n\nReturns: \n\n\nThe passcode text box authentication requirement xml fragment\n\n\nExample:\n\n\nTemplate:\n\n\n@PasscodeTextBox(id:\nPasscodeID\n, labelKey: \nTest:PasscodeLabelKey\n,\n                 assistiveTextKey: \nTest:PasscodeAssisitiveTextKey\n)\n\n\n\n\nOutput:\n\n\nRequirement\n\n  \nCredential\n\n    \nID\nPasscodeID\n/ID\n\n    \nType\npasscode\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nPasscode:\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nAssistiveText\nPIN and token\n/AssistiveText\n\n    \nText\n\n      \nSecret\ntrue\n/Secret\n\n      \nConstraint\n.+\n/Constraint\n\n    \n/Text\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nImage\n\n\nstring Image(string imageKey)\n\n\nCreate an image label authentication requirement fragment with no associated input.\n\n\nParameters:\n\n\n\n\nimageKey: The image key, i.e. the file name in the Templates directory. This is a required parameter.\n\n\n\n\nReturns: \n\n\nThe image label authentication requirement XML fragment\n\n\nExample:\n\n\nTemplate:\n\n\n@Image(\ncitrix_logo.gif\n)\nOutput:\n\nRequirement\n\n  \nCredential\n\n    \nType\nnone\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nBinary\ndata:image/gif;base64,R0lGODlhXAAkAEAAACH5BAAAAA\u2026+l105A7NZ1PAQEAOw==\n/Binary\n\n    \nType\nimage\n/Type\n\n  \n/Label\n\n  \nInput /\n\n\n/Requirement\n\n\n\n\nText\n\n\nstring Text(string textKey)\n\n\nCreate a text label authentication requirement fragment with no associated input, in the plain style.\n\n\nParameters:\n\n- textKey: The text localization key. This is a required parameter.\n\n\nReturns: \n\n\nThe text label authentication requirement xml fragment\n\n\nExample:\n\n\nTemplate:\n\n\n@Text(\nTest:PlainKey\n)\nOutput:\n\nRequirement\n\n  \nCredential\n\n    \nType\nnone\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nThis is plain text.\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput /\n\n\n/Requirement\n\n\n\n\nHeading\n\n\nstring Heading(string headingKey)\n\n\nCreate a heading text label authentication requirement fragment with no associated input.\n\n\nParameters:\n\n\n\n\nheadingKey: The text localization key. This is a required parameter.\n\n\n\n\nReturns: \n\n\nThe heading text label authentication requirement XML fragment\n\n\nExample:\n\n\nTemplate:\n\n\n@Heading(\"Test:HeadingKey\")\n\n\nOutput:\n\n\nRequirement\n\n  \nCredential\n\n    \nType\nnone\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nThis is a heading.\n/Text\n\n    \nType\nheading\n/Type\n\n  \n/Label\n\n  \nInput /\n\n\n/Requirement\n\n\n\n\nInformation\n\n\nstring Information(string informationKey)\n\n\nCreate an information text label authentication requirement fragment with no associated input.\n\n\nParameters:\n\n\n\n\ninformationKey: The text localization key. This is a required parameter.\n\n\n\n\nReturns: \n\n\nThe information text label authentication requirement XML fragment\n\n\nExample:\n\n\nTemplate:\n\n\n@Information(\nTest:InformationKey\n)\nOutput:\n\nRequirement\n\n  \nCredential\n\n    \nType\nnone\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nThis is an information item.\n/Text\n\n    \nType\ninformation\n/Type\n\n  \n/Label\n\n  \nInput /\n\n\n/Requirement\n\n\n\n\nWarning\n\n\nstring Warning(string warningKey)\n\n\nCreate a warning text label authentication requirement fragment with no associated input.\n\n\nParameters:\n\n\n\n\nwarningKey: The text localization key. This is a required parameter.\n\n\n\n\nReturns: \n\n\nThe warning text label authentication requirement XML fragment\n\n\nExample:\n\n\nTemplate:\n\n\n@Warning(\nTest:WarningKey\n)\nOutput:\n\nRequirement\n\n  \nCredential\n\n    \nType\nnone\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nThis is a warning.\n/Text\n\n    \nType\nwarning\n/Type\n\n  \n/Label\n\n  \nInput /\n\n\n/Requirement\n\n\n\n\nError\n\n\nstring Error(string errorKey)\n\n\nCreate an error text label authentication requirement fragment with no associated input.\n\n\nParameters:\n\n\n\n\nerrorKey: The text localization key. This is a required parameter.\n\n\n\n\nReturns: \n\n\nThe error text label authentication requirement XML fragment\n\n\nExample:\n\n\nTemplate:\n\n\n@Error(\nTest:ErrorKey\n)\nOutput:\n\nRequirement\n\n  \nCredential\n\n    \nType\nnone\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nThis is an error.\n/Text\n\n    \nType\nerror\n/Type\n\n  \n/Label\n\n  \nInput /\n\n\n/Requirement\n\n\n\n\nConfirmation\n\n\nstring Confirmation(string confirmationKey)\n\n\nCreate a confirmation text label authentication requirement fragment with no associated input.\n\n\nParameters:\n\n- confirmationKey: The text localization key. This is a required parameter.\n\n\nReturns: The confirmation text label authentication requirement XML fragment\n\n\nExample:\n\n\nTemplate:\n\n\n@Confirmation(\nTest:ConfirmationKey\n)\nOutput:\n\nRequirement\n\n  \nCredential\n\n    \nType\nnone\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nThis is a confirmation.\n/Text\n\n    \nType\nconfirmation\n/Type\n\n  \n/Label\n\n  \nInput /\n\n\n/Requirement\n\n\n\n\nInfoMessages\n\n\nstring InfoMessages()\n\n\nCreate a fragment that represents the list of all information label authentication requirements generated in the form.\n\n\nParameters:\n \n\n\nNone\n\n\nReturns: \n\n\nAll the information label authentication requirements as an XML fragment\n\n\nExample:\n\n\nForm:\n\n\nTemplateEngine.RenderTemplate(FormName, Cultures, Values,\n            new[]\n            {\n                new FormsMessage\n                    {\n                        LocalisationKey = PasswordExpiredLocalisationKey,\n                        MessageType = Label.LabelType.information\n                    }\n            })\n\n\n\n\nTemplate:\n\n\n@InfoMessages()\nOutput:\n\nRequirement\n\n  \nCredential\n\n    \nType\nnone\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nYour password has expired and must be changed.\n/Text\n\n    \nType\ninformation\n/Type\n\n  \n/Label\n\n  \nInput /\n\n \n/Requirement\n\n\n\n\nWarningMessages\n\n\nstring WarningMessages()\n\n\nCreate a fragment that represents the list of all warning label authentication requirements generated in the form.\n\n\nParameters:\n \n\n\nNone\n\n\nReturns: \n\n\nAll the warning label authentication requirements as an XML fragment\n\n\nExample:\n\n\nForm:\n\n\nTemplateEngine.RenderTemplate(FormName, Cultures, Values,\n            new[]\n            {\n                new FormsMessage\n                    {\n                        LocalisationKey = WarningLocalizationKey,\n                        MessageType = Label.LabelType.warning\n                    }\n            })\n\n\n\n\nTemplate:\n\n\n@WarningMessages()\nOutput:\n\nRequirement\n\n  \nCredential\n\n    \nType\nnone\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nThis is a warning message.\n/Text\n\n    \nType\nwarning\n/Type\n\n  \n/Label\n\n  \nInput /\n\n \n/Requirement\n\n\n\n\nErrorMessages\n\n\nstring ErrorMessages()\n\n\nCreate a fragment that represents the list of all error label authentication requirements generated in the form.\n\n\nParameters:\n \n\n\nNone\n\n\nReturns: \n\n\nAll the error label authentication requirements as an XML fragment\n\n\nExample:\n\n\nForm:\n\n\nTemplateEngine.RenderTemplate(FormName, Cultures, Values,\n            new[]\n            {\n                new FormsMessage\n                    {\n                        LocalisationKey = ErrorLocalizationKey,\n                        MessageType = Label.LabelType.error\n                    }\n            })\n\n\n\n\nTemplate:\n\n\n@ErrorMessages()\nOutput:\n\nRequirement\n\n  \nCredential\n\n    \nType\nnone\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nThis is an error message.\n/Text\n\n    \nType\nerror\n/Type\n\n  \n/Label\n\n  \nInput /\n\n \n/Requirement\n\n\n\n\nButton\n\n\nstring Button(string id, string buttonKey, string assistiveTextKey = null)\n\n\nCreate a button authentication requirement fragment.\n\n\nParameters:\n\n\n\n\nid: The button identifier. This is a required parameter.\n\n\nbuttonKey: The localization key for the button text. This is a required parameter.\n\n\nassistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.\n\n\n\n\nReturns: The button authentication requirement XML fragment\n\n\nExample:\n\n\nTemplate:\n\n\n@Button(id:\"loginBtn\", buttonKey: \"LogonButtonKey\")\n\n\nOutput:\n\n\nRequirement\n\n  \nCredential\n\n    \nID\nloginBtn\n/ID\n\n    \nType\nnone\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nType\nnone\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nButton\nLog On\n/Button\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nSaveCredential\n\n\nstring SaveCredential(string id, string assistiveTextKey = null, string labelKey = null,\n                      Label.LabelType labelType = Label.LabelType.plain,\n                      bool? initiallyChecked = null)\n\n\n\n\nCreate a save credential requirement fragment.\n\n\nParameters:\n\n\n\n\nid: The optional credential identifier. If not specified, then the option \n element is not included.\n\n\nassistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.\n\n\nlabelKey: The localization key for the label. This parameter is required.\n\n\nlabelType: The optional label type (see the Receiver Common Authentication Forms Language document for more information). The default label type is: plain\n\n\ninitiallyChecked: The optional value to set whether the associated check box is initially checked. If the value is null, which is the default, then the optional \n InitialValue \n element is not included.\n\n\n\n\nReturns: \n\n\nThe save credential authentication requirement XML fragment\n\n\nExample:\n\n\nTemplate:\n\n\n@SaveCredential(id:\nSaveCredentialID\n, labelKey: \nTest:SaveCredentialKey\n,\n                assistiveTextKey: \nSaveCredentialAssistiveTextKey\n, initiallyChecked: true)\n\n\n\n\nOutput:\n\n\nRequirement\n\n  \nCredential\n\n    \nID\nSaveCredentialID\n/ID\n\n    \nType\nsavecredentials\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nRemember my password\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nAssistiveText\nSave your credentials locally\n/AssistiveText\n\n    \nCheckBox\n\n      \nInitialValue\ntrue\n/InitialValue\n\n    \n/CheckBox\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nDomainComboBox\n\n\nstring DomainComboBox(string id, string displayItemsValueName,\n                      string initialSelectionValueName = null, string saveId = null,\n                      string assistiveTextKey = null, string labelKey = null,\n                      Label.LabelType labelType = Label.LabelType.plain)\n\n\n\n\nCreate a combo box authentication requirement fragment for domains.\n\n\nParameters:\n\n\n\n\nid: The optional credential identifier. If not specified, then the option \n element is not included.\n\n\ndisplayItemsValueName: The name of the dictionary of display-value pairs in the model. This is a required parameter.\n\n\ninitialSelectionValueName: The optional initially selected display value. The default is to select the first value.\n\n\nsaveId: The optional identifier to be used to save this credential on a client. The default is to have no save identifier.\n\n\nassistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.\n\n\nlabelKey: The localization key for the label. This parameter is required.\n\n\nlabelType: The optional label type (see the Receiver Common Authentication Forms Language document for more information). The default label type is: plain\n\n\n\n\nReturns: \n\n\nThe domain combo box authentication requirement XML fragment\n\n\nExample:\n\n\nModel:\n\n\nnew\n{\n    Domains = new Dictionary\nstring, string\n\n              {\n                  { @\ncitrix\n, @\ncitrix.com\n},\n                  { @\ncitrite\n, @\ncitrite.local\n}\n              },\n    InitialDomain = @\ncitrite.local\n\n}\n\n\n\n\nTemplate:\n\n\n@DomainComboBox(id:\nDomainID\n, displayItemsValueName: \nDomains\n,\n                initialSelectionValueName: \nInitialDomain\n, saveId: \nSaveDomainID\n,\n                labelKey: \nTest:DomainKey\n,\n                assistiveTextKey: \nTest:DomainComboBoxAssistiveTextKey\n)\n\n\n\n\nOutput:\n\n\nRequirement\n\n  \nCredential\n\n    \nID\nDomainID\n/ID\n\n    \nSaveID\nSaveDomainID\n/SaveID\n\n    \nType\ndomain\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nDomain:\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nAssistiveText\nPlease select your domain\n/AssistiveText\n\n    \nComboBox\n\n      \nInitialSelection\ncitrite.local\n/InitialSelection\n\n      \nDisplayValues\n\n        \nDisplayValue\n\n          \nDisplay\ncitrix\n/Display\n\n          \nValue\ncitrix.com\n/Value\n\n        \n/DisplayValue\n\n        \nDisplayValue\n\n          \nDisplay\ncitrite\n/Display\n\n          \nValue\ncitrite.local\n/Value\n\n        \n/DisplayValue\n\n      \n/DisplayValues\n\n    \n/ComboBox\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nDomainTextBox\n\n\nstring DomainTextBox(string id = null, string saveId = null, string assistiveTextKey = null,\n                     string labelKey = null, Label.LabelType labelType = Label.LabelType.plain,\n                     string initialValueName = null,\n                     string constraint = TextBox.DefaultConstraint, bool? secret = null,\n                     bool? readOnly = null)\n\n\n\n\nCreate a text box authentication requirement fragment for domains.\n\n\nParameters:\n\n\n\n\nid: The optional credential identifier. If not specified, then the option \n element is not included.\n\n\nsaveId: The optional identifier to be used to save this credential on a client. The default is to have no save identifier.\n\n\nassistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.\n\n\nlabelKey: The localization key for the label. This parameter is required.\n\n\nlabelType: The optional label type (see the Receiver Common Authentication Forms Language document for more information). The default label type is: plain\n\n\ninitialValueName: The optional name of a model value that contains the initial value of the text box. Note that this is a raw string not a key to be localized. The default is not to have an initial value.\n\n\nconstraint: The optional, and unused, regular expression for the text to be entered.\n\n\nsecret: If true then the text typed by the user should be obscured. This parameter is optional. If the value is null, which is the default, then the optional \n element is not included.\n\n\nreadOnly: This optional parameter makes the initial text value read-only. If the value is null, which is the default, then the optional \n element is not included.\n\n\n\n\nReturns: \n\n\nThe domain text box authentication requirement XML fragment\n\n\nExample:\n\n\nTemplate:\n\n\n@DomainTextBox(id:\nDomainID\n, saveId: \nSaveDomainID\n, labelKey: \nTest:DomainKey\n,\n               assistiveTextKey: \nTest:DomainTextBoxAssistiveTextKey\n)\n\n\n\n\nOutput:\n\n\nRequirement\n\n  \nCredential\n\n    \nID\nDomainID\n/ID\n\n    \nSaveID\nSaveDomainID\n/SaveID\n\n    \nType\ndomain\n/Type\n\n  \n/Credential\n\n  \nLabel\n\n    \nText\nDomain:\n/Text\n\n    \nType\nplain\n/Type\n\n  \n/Label\n\n  \nInput\n\n    \nAssistiveText\nPlease supply your domain\n/AssistiveText\n\n      \nText\n\n        \nInitialValue\n/InitialValue\n\n        \nConstraint\n.+\n/Constraint\n\n      \n/Text\n\n  \n/Input\n\n\n/Requirement\n\n\n\n\nAppendix A: Event Log Entries\n\n\nIf there are issues with the template processing, the Forms Template Engine adds events to the event log at the following location, with Task Category 1170:\n\n\nEvent Viewer \n Applications and Services Logs \n Citrix Delivery Services\n\n\nThe following examples illustrate the errors that can be produced.\n\n\nRazor Template Error: Event Id 1\n\n\nThere was a Razor compilation error of a template named UsernamePassword with contents:\n\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/response/1\n\n@* \u00a92014 Citrix Systems, Inc.   All rights reserved. *@\n@foreach\n@ControlHeaders(status: StatusSuccess, result: ResultMoreInfo, stateContext: GetValue(\nStateContext\n))\n  \nAuthenticationRequirements\n\n    \nPostBack\n@GetTextValue(\nPostBackUrl\n)\n/PostBack\n\n    \nCancelPostBack\n@GetTextValue(\nCancelPostBackUrl\n)\n/CancelPostBack\n\n    \nCancelButtonText\n@GetLocalisedTextValue(\nExplicitFormsCommon:CancelButtonText\n)\n/CancelButtonText\n\n    \nRequirements\n\n      @* @Heading(\nExplicitAuth:AuthenticateHeadingText\n) *@\n      @InfoMessages()\n      @WarningMessages()\n      @UsernameTextBox(id: @GetTextValue(\nusernameId\n), saveId: @GetTextValue(\nusernameSaveId\n), labelKey: \nExplicitFormsCommon:UsernameLabel\n, initialValueName: \nInitialUsername\n, assistiveTextKey: @GetTextValue(\nAssistiveTextValue\n), secret: false, readOnly: false)\n      @PasswordTextBox(id: @GetTextValue(\npasswordId\n), saveId: @GetTextValue(\npasswordSaveId\n), labelKey: \nExplicitFormsCommon:PasswordLabel\n, initialValueName: \ndummy\n, readOnly: false)\n      @if (ControlValue(\nDisplayDomainText\n)) {\n      @DomainTextBox(id: @GetTextValue(\ndomainId\n), saveId: @GetTextValue(\ndomainSaveId\n), labelKey: \nExplicitFormsCommon:DomainLabel\n, readOnly: false)\n      } else if (ControlValue(\nDisplayDomainCombo\n)) {\n      @DomainComboBox(id: @GetTextValue(\ndomainId\n), saveId: @GetTextValue(\ndomainSaveId\n), displayItemsValueName: \nDomainValues\n, initialSelectionValueName: \nInitialDomain\n, labelKey: \nExplicitFormsCommon:DomainLabel\n)\n      }\n      @SaveCredential(id: @GetTextValue(\nsaveCredentialsId\n), labelKey: \nExplicitFormsCommon:SaveCredentialsLabel\n, initiallyChecked: ControlValue(\nSaveCredentials\n))\n      @ErrorMessages()\n      @Button(id: @GetTextValue(\nloginButtonId\n), buttonKey: \nExplicitFormsCommon:LoginButtonText\n)\n    \n/Requirements\n\n  \n/AuthenticationRequirements\n\n\n/AuthenticateResponse\n\n\n\n\nErrors:\n\n\nExpected a \n{\n but found a \n@\n.  Block statements must be enclosed in \n{\n and \n}\n.  You cannot use single-statement control-flow statements in CSHTML pages. For example, the following is not allowed:\n\n@if(isLoggedIn)\n    \np\nHello, @user\n/p\n\n\n\n\nInstead, wrap the contents of the block in \"{}\":\n\n\n@if(isLoggedIn) {\n    \np\nHello, @user\n/p\n\n} at line:(183:4,0)\n\n\n\n\nC# Compilation Error: Event Id 2\n\n\nThere was a C# compilation error of a template named UsernamePassword with contents:\n\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/response/1\n\n@* \u00a92014 Citrix Systems, Inc.   All rights reserved. *@\n@ControlHeaders(status: StatusSuccess, result: ResultMoreInfo, stateContext: GetValue(\nStateContext\n))\n  \nAuthenticationRequirements\n\n    \nPostBack\n@GetTextValue2(\nPostBackUrl\n)\n/PostBack\n\n    \nCancelPostBack\n@GetTextValue(\nCancelPostBackUrl\n)\n/CancelPostBack\n\n    \nCancelButtonText\n@GetLocalisedTextValue(\nExplicitFormsCommon:CancelButtonText\n)\n/CancelButtonText\n\n    \nRequirements\n\n      @* @Heading(\nExplicitAuth:AuthenticateHeadingText\n) *@\n      @InfoMessages()\n      @WarningMessages()\n      @UsernameTextBox(id: @GetTextValue(\nusernameId\n), saveId: @GetTextValue(\nusernameSaveId\n), labelKey: \nExplicitFormsCommon:UsernameLabel\n, initialValueName: \nInitialUsername\n, assistiveTextKey: @GetTextValue(\nAssistiveTextValue\n), secret: false, readOnly: false)\n      @PasswordTextBox(id: @GetTextValue(\npasswordId\n), saveId: @GetTextValue(\npasswordSaveId\n), labelKey: \nExplicitFormsCommon:PasswordLabel\n, initialValueName: \ndummy\n, readOnly: false)\n      @if (ControlValue(\nDisplayDomainText\n)) {\n      @DomainTextBox(id: @GetTextValue(\ndomainId\n), saveId: @GetTextValue(\ndomainSaveId\n), labelKey: \nExplicitFormsCommon:DomainLabel\n, readOnly: false)\n      } else if (ControlValue(\nDisplayDomainCombo\n)) {\n      @DomainComboBox(id: @GetTextValue(\ndomainId\n), saveId: @GetTextValue(\ndomainSaveId\n), displayItemsValueName: \nDomainValues\n, initialSelectionValueName: \nInitialDomain\n, labelKey: \nExplicitFormsCommon:DomainLabel\n)\n      }\n      @SaveCredential(id: @GetTextValue(\nsaveCredentialsId\n), labelKey: \nExplicitFormsCommon:SaveCredentialsLabel\n, initiallyChecked: ControlValue(\nSaveCredentials\n))\n      @ErrorMessages()\n      @Button(id: @GetTextValue(\nloginButtonId\n), buttonKey: \nExplicitFormsCommon:LoginButtonText\n)\n    \n/Requirements\n\n  \n/AuthenticationRequirements\n\n\n/AuthenticateResponse\n\n\n\n\nSource Code:\n\n\n//------------------------------------------------------------------------------\n// \nauto-generated\n\n//     This code was generated by a tool.\n//     Runtime Version:4.0.30319.18449\n//\n//     Changes to this file may cause incorrect behavior and will be lost if\n//     the code is regenerated.\n// \n/auto-generated\n\n//------------------------------------------------------------------------------\n\nnamespace Citrix.CompiledForms {\n    using System;\n    using Citrix.DeliveryServices.Authentication.Forms.Template.Requirements;\n    using Citrix.DeliveryServices.Authentication.Forms.Template;    \n\n    public class UsernamePassword : Citrix.DeliveryServices.Authentication.Forms.Template.FormsTemplateBase {\n\n#line hidden\n\n        public UsernamePassword() {\n        }\n\n        public override void Execute() {\nWriteLiteral(\n?xml version=\\\n1.0\\\n encoding=\\\nUTF-8\\\n?\n\\r\\n\nAuthenticateResponse\n);\n\nWriteLiteral(\n xmlns=\\\nhttp://citrix.com/authentication/response/1\\\n);\nWriteLiteral(\n\\r\\n\n);\nWriteLiteral(\n\\r\\n\n);\n\n            #line 4 \nUsernamePassword.tfrm\n\nWrite(ControlHeaders(status: StatusSuccess, result: ResultMoreInfo, stateContext: GetValue(\nStateContext\n)));\n\n            #line default\n            #line hidden\nWriteLiteral(\n\\r\\n  \nAuthenticationRequirements\n\\r\\n    \nPostBack\n);\n\n            #line 6 \nUsernamePassword.tfrm\n\n         Write(GetTextValue2(\nPostBackUrl\n));\n\n            #line default\n            #line hidden\nWriteLiteral(\n/PostBack\n\\r\\n    \nCancelPostBack\n);\n\n            #line 7 \nUsernamePassword.tfrm\n\n               Write(GetTextValue(\nCancelPostBackUrl\n));\n\n            #line default\n            #line hidden\nWriteLiteral(\n/CancelPostBack\n\\r\\n    \nCancelButtonText\n);\n\n            #line 8 \nUsernamePassword.tfrm\n\n                 Write(GetLocalisedTextValue(\nExplicitFormsCommon:CancelButtonText\n));\n\n            #line default\n            #line hidden\nWriteLiteral(\n/CancelButtonText\n\\r\\n    \nRequirements\n\\r\\n      \n);\nWriteLiteral(\n\\r\\n\n);\nWriteLiteral(\n      \n);\n\n            #line 11 \nUsernamePassword.tfrm\n\n Write(InfoMessages());\n\n\n            #line default\n            #line hidden\nWriteLiteral(\n\\r\\n\n);\nWriteLiteral(\n      \n);\n\n            #line 12 \nUsernamePassword.tfrm\n\nWrite(WarningMessages());\n\n            #line default\n            #line hidden\nWriteLiteral(\n\\r\\n\n);\nWriteLiteral(\n      \n);\n\n            #line 13 \nUsernamePassword.tfrm\n\nWrite(UsernameTextBox(id: @GetTextValue(\nusernameId\n), saveId: @GetTextValue(\nusernameSaveId\n), labelKey: \nExplicitFormsCommon:UsernameLabel\n, initialValueName: \nInitialUsername\n, assistiveTextKey: @GetTextValue(\nAssistiveTextValue\n), secret: false, readOnly: false));\n\n            #line default\n            #line hidden\nWriteLiteral(\n\\r\\n\n);\nWriteLiteral(\n      \n);\n\n            #line 14 \nUsernamePassword.tfrm\n\nWrite(PasswordTextBox(id: @GetTextValue(\npasswordId\n), saveId: @GetTextValue(\npasswordSaveId\n), labelKey: \nExplicitFormsCommon:PasswordLabel\n, initialValueName: \ndummy\n, readOnly: false));\n\n            #line default\n            #line hidden\nWriteLiteral(\n\\r\\n\n);\n\n            #line 15 \nUsernamePassword.tfrm\n\n\n            #line default\n            #line hidden\n\n            #line 15 \nUsernamePassword.tfrm\n\n       if (ControlValue(\nDisplayDomainText\n)) {\n\n            #line default\n            #line hidden\n\n            #line 16 \nUsernamePassword.tfrm\n\nWrite(DomainTextBox(id: @GetTextValue(\ndomainId\n), saveId: @GetTextValue(\ndomainSaveId\n), labelKey: \nExplicitFormsCommon:DomainLabel\n, readOnly: false));\n\n            #line default\n            #line hidden\n\n            #line 16 \nUsernamePassword.tfrm\n\n\n      } else if (ControlValue(\nDisplayDomainCombo\n)) {    \n\n            #line default\n            #line hidden\n\n            #line 18 \nUsernamePassword.tfrm\n\nWrite(DomainComboBox(id: @GetTextValue(\ndomainId\n), saveId: @GetTextValue(\ndomainSaveId\n), displayItemsValueName: \nDomainValues\n, initialSelectionValueName: \nInitialDomain\n, labelKey: \nExplicitFormsCommon:DomainLabel\n));\n\n            #line default\n            #line hidden\n\n            #line 18 \nUsernamePassword.tfrm\n\n\n      }\n\n            #line default\n            #line hidden\nWriteLiteral(\n      \n);\n\n            #line 20 \nUsernamePassword.tfrm\n\nWrite(SaveCredential(id: @GetTextValue(\nsaveCredentialsId\n), labelKey: \nExplicitFormsCommon:SaveCredentialsLabel\n, initiallyChecked: ControlValue(\nSaveCredentials\n)));\n\n            #line default\n            #line hidden\nWriteLiteral(\n\\r\\n\n);\nWriteLiteral(\n      \n);\n\n            #line 21 \nUsernamePassword.tfrm\n\nWrite(ErrorMessages());\n\n            #line default\n            #line hidden\nWriteLiteral(\n\\r\\n\n);\nWriteLiteral(\n      \n);\n\n\n            #line 22 \nUsernamePassword.tfrm\n\nWrite(Button(id: @GetTextValue(\nloginButtonId\n), buttonKey: \nExplicitFormsCommon:LoginButtonText\n));\n\n            #line default\n            #line hidden\nWriteLiteral(\n\\r\\n    \n/Requirements\n\\r\\n  \n/AuthenticationRequirements\n\\r\\n\n/AuthenticateResponse\n);\n\n        }\n    }\n}\n\n\n\n\nErrors:\n\n\nThe name 'GetTextValue2' does not exist in the current context at line:6\n\n\nInvalid Reciever Common Form Xml: Event Id 4\n\n\nThe Forms template generated invalid Xml:\n\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/response/1\n\n\n\n\n            \nRequirement\n\n        \nCredential\n\n          \nID\nusername\n/ID\n\n          \nSaveID\nUsernamePasswordForm-Username\n/SaveID\n\n          \nType\nusername\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nUser name:\n/Text\n\n          \nType\nplain\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nAssistiveText\ndomain\\user or user@domain.com\n/AssistiveText\n\n          \nText\n\n            \nSecret\nfalse\n/Secret\n\n            \nReadOnly\nfalse\n/ReadOnly\n\n            \nInitialValue\n/InitialValue\n\n            \nConstraint\n.+\n/Constraint\n\n          \n/Text\n\n        \n/Input\n\n      \n/Requirement\n\n            \nRequirement\n\n        \nCredential\n\n          \nID\npassword\n/ID\n\n          \nSaveID\nUsernamePasswordForm-Password\n/SaveID\n\n          \nType\npassword\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nPassword:\n/Text\n\n          \nType\nplain\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nText\n\n            \nSecret\ntrue\n/Secret\n\n            \nReadOnly\nfalse\n/ReadOnly\n\n            \nInitialValue\n/InitialValue\n\n            \nConstraint\n.+\n/Constraint\n\n          \n/Text\n\n        \n/Input\n\n      \n/Requirement\n\n            \nRequirement\n\n        \nCredential\n\n          \nID\nsaveCredentials\n/ID\n\n          \nType\nsavecredentials\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nRemember my password\n/Text\n\n          \nType\nplain\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nCheckBox\n\n            \nInitialValue\nfalse\n/InitialValue\n\n          \n/CheckBox\n\n        \n/Input\n\n      \n/Requirement\n\n\n            \nRequirement\n\n        \nCredential\n\n          \nID\nloginBtn\n/ID\n\n          \nType\nnone\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nType\nnone\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nButton\nLog On\n/Button\n\n        \n/Input\n\n      \n/Requirement\n\n    \n/Requirements\n\n  \n/AuthenticationRequirements\n\n\n/AuthenticateResponse\n\n\n\n\nSystem.Xml.XmlException, System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\nThe 'AuthenticateResponse' start tag on line 2 position 2 does not match the end tag of 'Requirements'. Line 73, position 7.\n   at System.Xml.XmlTextReaderImpl.Throw(String res, String[] args)\n   at System.Xml.XmlTextReaderImpl.ThrowTagMismatch(NodeData startTag)\n   at System.Xml.XmlTextReaderImpl.ParseEndElement()\n   at System.Xml.XmlTextReaderImpl.ParseElementContent()\n   at System.Xml.XmlLoader.LoadNode(Boolean skipOverWhitespace)\n   at System.Xml.XmlLoader.LoadDocSequence(XmlDocument parentDoc)\n   at System.Xml.XmlDocument.Load(XmlReader reader)\n   at System.Xml.XmlDocument.LoadXml(String xml)\n   at Citrix.DeliveryServices.Authentication.Forms.Template.FormsTemplateBase.Render(IDictionary`2 renderValues, ILocaliser localiser, IEnumerable`1 messages)\n\n\n\n\nAppendix B: Form Template Language Examples\n\n\nThe following templates all generate the same Receiver Common Forms XML:\n\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/response/1\n\n  \nStatus\nsuccess\n/Status\n\n  \nResult\nmore-info\n/Result\n\n  \nStateContext\n0x12345678\n/StateContext\n\n  \nAuthenticationRequirements\n\n    \nPostBack\n/Postback\n/PostBack\n\n    \nCancelPostBack\n/Cancel\n/CancelPostBack\n\n    \nCancelButtonText\nCancel\n/CancelButtonText\n\n    \nRequirements\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\nUsernameID\n/ID\n\n          \nSaveID\nSaveUsernameID\n/SaveID\n\n          \nType\nusername\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\nUser name:\n/Text\n\n          \nType\nplain\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nAssistiveText\ndomain\\user or user@domain.com\n/AssistiveText\n\n          \nText\n\n            \nConstraint\n.+\n/Constraint\n\n          \n/Text\n\n        \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\nloginBtn\n/ID\n\n          \nType\nnone\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nType\nnone\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nButton\nLog On\n/Button\n\n        \n/Input\n\n      \n/Requirement\n\n    \n/Requirements\n\n  \n/AuthenticationRequirements\n\n\n/AuthenticateResponse\n\n\n\n\nLow Level API\n\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/response/1\n\n  \nStatus\nsuccess\n/Status\n\n  \nResult\nmore-info\n/Result\n\n  \nStateContext\n0x12345678\n/StateContext\n\n  \nAuthenticationRequirements\n\n    \nPostBack\n/Postback\n/PostBack\n\n    \nCancelPostBack\n/Cancel\n/CancelPostBack\n\n    \nCancelButtonText\n@GetLocalisedTextValue(\nCancelButtonText\n)\n/CancelButtonText\n\n    \nRequirements\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\nUsernameID\n/ID\n\n          \nSaveID\nSaveUsernameID\n/SaveID\n\n          \nType\nusername\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nText\n@GetLocalisedTextValue(\nUsernameLabelKey\n)\n/Text\n\n          \nType\nplain\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nAssistiveText\n@GetLocalisedTextValue(\nUsernameAssistiveTextKey\n)\n/AssistiveText\n\n          \nText\n\n            \nConstraint\n.+\n/Constraint\n\n          \n/Text\n\n        \n/Input\n\n      \n/Requirement\n\n      \nRequirement\n\n        \nCredential\n\n          \nID\nloginBtn\n/ID\n\n          \nType\nnone\n/Type\n\n        \n/Credential\n\n        \nLabel\n\n          \nType\nnone\n/Type\n\n        \n/Label\n\n        \nInput\n\n          \nButton\n@GetLocalisedTextValue(\nLogonButtonKey\n)\n/Button\n\n        \n/Input\n\n      \n/Requirement\n\n    \n/Requirements\n\n  \n/AuthenticationRequirements\n\n\n/AuthenticateResponse\n\n\n\n\nRequirements API\n\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/response/1\n\n@ControlHeaders(status: StatusSuccess, result: ResultMoreInfo, stateContext: \n0x12345678\n)\n  \nAuthenticationRequirements\n\n    \nPostBack\n/Postback\n/PostBack\n\n    \nCancelPostBack\n/Cancel\n/CancelPostBack\n\n    \nCancelButtonText\nCancel\n/CancelButtonText\n\n    \nRequirements\n\n      \nRequirement\n\n@Credential(credentialType: \nusername\n, id: \nUsernameID\n, saveId: \nSaveUsernameID\n)\n@TextLabel(labelKey: \nUsernameLabelKey\n)\n@InputTextBox(assistiveTextKey: \nUsernameAssistiveTextKey\n)\n      \n/Requirement\n\n      \nRequirement\n\n@Credential(credentialType: \nnone\n, id: \nloginBtn\n)\n@TextLabel(labelKey: null, labelType: Label.LabelType.none)\n@InputButton(buttonKey: \nLogonButtonKey\n)\n      \n/Requirement\n\n    \n/Requirements\n\n  \n/AuthenticationRequirements\n\n\n/AuthenticateResponse\n\n\n\n\nHigh Level API\n\n\n?xml version=\n1.0\n encoding=\nUTF-8\n?\n\n\nAuthenticateResponse xmlns=\nhttp://citrix.com/authentication/response/1\n\n@ControlHeaders(status: StatusSuccess, result: ResultMoreInfo, stateContext: \n0x12345678\n)\n  \nAuthenticationRequirements\n\n    \nPostBack\n/Postback\n/PostBack\n\n    \nCancelPostBack\n/Cancel\n/CancelPostBack\n\n    \nCancelButtonText\nCancel\n/CancelButtonText\n\n    \nRequirements\n\n@UsernameTextBox(id:\nUsernameID\n, saveId: \nSaveUsernameID\n, labelKey: \nUsernameLabelKey\n,\n                 assistiveTextKey: \nUsernameAssistiveTextKey\n)\n@Button(id:\nloginBtn\n, buttonKey: \nLogonButtonKey\n)\n    \n/Requirements\n\n  \n/AuthenticationRequirements\n\n\n/AuthenticateResponse", 
            "title": "StoreFront Authentication Form Generation"
        }, 
        {
            "location": "/authentication-form-generation/#introduction", 
            "text": "Citrix has devised a common authentication protocol that is implemented by its next generation services and gateway platforms, referred to here as StoreFront Services and NetScaler Gateway. Citrix has implemented client support for this common authentication protocol in native user agents, such as Receiver and Worx, for the major device platforms, notably Windows, Mac, iOS, Android, Linux, and Receiver for Web for browser-based user agents.  An important part of the common authentication protocol is a generic forms language, which is described in the Receiver Common Authentication Forms Language document [2]. This language is designed to allow third parties to express a wide range of authentication forms using a set of user interface constructs that are similar to basic HTML forms; see RFC 1867 [http://www.ietf.org/rfc/rfc1867.txt] and 2388 [http://www.ietf.org/rfc/rfc2388.txt] for more details.  Third parties can extend the authentication methods supported by StoreFront Services and NetScaler Gateway by implementing server logic that emits and consumes forms defined in the common forms language; see the Citrix Authentication Software Development Kit [1] for more details.  This document aims to enable Citrix partners to understand how StoreFront generates the formsand to enable them to customize the existing form definitions, create new forms, and new sequences of forms to create new authentication conversations.", 
            "title": "Introduction"
        }, 
        {
            "location": "/authentication-form-generation/#overview", 
            "text": "Forms-based authentication is a conversation using the HTTP protocol where the client responds to a series of forms generated by the server to establish an identity on the server. The HTTP API is described in the Citrix Common Forms API document [3]. There are several StoreFront components that interact to achieve the generation of the forms and the handling of the HTTP responses.   StoreFront makes extensive use of service location and inversion-of-control (IoC) containers; see http://martinfowler.com/articles/injection.html for more details of this software pattern.   Forms Generation Components for a conversation requiring Active Directory credential validation  Handling HTTP requests and responses is the responsibility of a small set of built-in MVCs (model view controllers). In most cases there will be no need for custom form implementers to implement new controllers. For general forms, where there is no requirement to validate Active Directory credentials, the FormsAuthenticationController ASP.Net MVC controller should be used. If validating Active Directory credentials is required, then the ExplicitFormsAuthenticationController controller should be used. The MVC controllers validate the requests and extract the state associated with the conversation and then construct and invoke the conversation engine.  The conversation engine is responsible for running the conversation, which includes creating the appropriate conversation object and dispatching messages to it. There are two built-in conversation engines: ConversationEngine, used when validating Active Directory credentials is not required, and ExplicitConversationEngine, used when validating Active Directory credentials is required. Again, it is not anticipated that custom forms implementers will need to modify the conversation engine functionality.  The configuration for the MVC route includes the name, used by the Service Locator to find a class that implements the IFormsConversationFactory interface, stored in the IoC container. The appropriate conversation engine uses this to locate the custom conversation factory that uses any settings required, to create a new custom conversation object.  The custom conversation object is responsible for orchestrating the sequence of forms and dispatching messages to appropriate form objects. It is expected that custom forms implementers that require a complex series of forms will implement a conversation object. However, there are two built-in classes that provide the base functionality that implementers can build on. These are FormsConversationBase, used when validating Active Directory credentials is not required, and ExplicitConversation, used when validating Active Directory credentials is required.  An individual form is usually composed of two elements: the form object and the associated form template. The form object is responsible for generating a dynamic data model that is passed to the forms template engine with the name of the forms template to generate the form that will be transmitted to the client. The form object is also responsible for processing the response to the form generated by the client. Although StoreFront has a small number of built-in form objects and their associated templates, custom forms implementers will generally have to implement new forms objects and templates.  The forms template engine is the built-in component that can be used by individual forms to generate the final Receiver Common Form XML from a template and dynamic data. It is not expected that custom forms implementers will be required to modify this component.  FormsConversationBase, used when validating Active Directory credentials is not required, and ExplicitConversation, used when validating Active Directory credentials is required.  An individual form is usually composed of two elements: the form object and the associated form template. The form object is responsible for generating a dynamic data model that is passed to the forms template engine with the name of the forms template to generate the form that will be transmitted to the client. The form object is also responsible for processing the response to the form generated by the client. Although StoreFront has a small number of built-in form objects and their associated templates, custom forms implementers will generally have to implement new forms objects and templates.  The forms template engine is the built-in component that can be used by individual forms to generate the final Receiver Common Form XML from a template and dynamic data. It is not expected that custom forms implementers will be required to modify this component.", 
            "title": "Overview"
        }, 
        {
            "location": "/authentication-form-generation/#form-conversation-factory", 
            "text": "If a custom conversation is required, then a custom factory is required that implements the following interface:  namespace Citrix.DeliveryServices.Authentication.FormsProtocol.Conversations.Interfaces\n{\n    ///  summary \n    /// This interface represents a factory for instances of  seealso cref= IFormsConversation / \n    ///  /summary \n    public interface IFormsConversationFactory\n    {\n        ///  summary \n        /// Create a new instance of an object that implements  seealso cref= IFormsConversation / \n        ///  /summary \n        ///  param name= controllerContext \n        /// The  seealso cref= ControllerContext /  for where the conversation will be run /param \n        ///  param name= templateEngine \n        /// The  seealso cref= FormsTemplateEngine /  to use to render the conversation /param \n        ///  param name= cultures The current language cultures /param \n        ///  returns \n        /// A new instance of an object that implements  seealso cref= IFormsConversation / \n        ///  /returns \n        IFormsConversation Create(ControllerContext controllerContext,\n                                  FormsTemplateEngine templateEngine,\n                                  IEnumerable CultureInfo  cultures);\n    }\n}  This factory must be stored in the IoC container with a specific name, and this is usually achieved through the use of a start-up module (see the StoreFront Service Authentication SDK for more details on start-up modules). The appropriate conversation engine obtains the factory name from the route data associated with the start of the customized conversation in the web.config file. For example, the following is the route data for the built-in user name and password conversation:       explicitAuthentication \n       routeTable order= 0 \n         routes \n           route name= StartExplicitAuthentication  url= ExplicitForms/Start \n             defaults \n               add param= controller  value= ExplicitFormsAuthentication  / \n               add param= action  value= AuthenticateStart  / \n               add param= postbackAction  value= Authenticate  / \n               add param= cancelAction  value= CancelAuthenticate  / \n               add param= conversationFactory  value= ExplicitAuthentication  / \n               add param= changePasswordAction  value= StartChangePassword  / \n               add param= changePasswordController  value= ChangePassword  / \n               add param= protocol  value= ExplicitForms  / \n             /defaults \n             data / \n           /route \n           route name= ExplicitAuthentication  url= ExplicitForms \n             defaults \n               add param= controller  value= ExplicitFormsAuthentication  / \n               add param= action  value= Authenticate  / \n               add param= protocol  value= ExplicitForms  / \n             /defaults \n             data / \n           /route \n           route name= CancelExplicitAuthentication  url= ExplicitForms/Cancel \n             defaults \n               add param= controller  value= ExplicitFormsAuthentication  / \n               add param= action  value= CancelAuthenticate  / \n               add param= protocol  value= ExplicitForms  / \n             /defaults \n             data / \n           /route \n         /routes \n       /routeTable \n     /explicitAuthentication  The conversation engine uses the service locator to obtain the factory object with the specified name and then invokes the Create() method to obtain the custom conversation object.", 
            "title": "Form Conversation Factory"
        }, 
        {
            "location": "/authentication-form-generation/#form-conversation", 
            "text": "Most new authentication conversations will require a conversation object to orchestrate the sequence of forms. The StoreFront Services Authentication SDK contains samples that demonstrate creating custom conversation objects.  When a conversation is started, the first action is to create a ConversationState object that has the following API:  namespace Citrix.DeliveryServices.Authentication.FormsProtocol.Conversations\n{\n    ///  summary \n    /// This data class contains the conversation state that is required\n    /// to be stored in the session state between requests.\n    ///  /summary \n    public class ConversationState\n    {\n        ///  summary \n        /// Constructor\n        ///  /summary \n        public ConversationState()\n        {\n            Extensions = new Dictionary string, object ();\n        }\n\n        ///  summary \n        /// Gets or sets the  seealso cref= FormsTemplateEngine / .\n        ///  /summary \n        ///  remarks \n        /// This is used to render the forms that make up the conversation.\n        ///  /remarks \n        public FormsTemplateEngine TemplateEngine { get; set; }\n\n        ///  summary \n        /// Gets or sets the current  seealso cref= IFormsConversation / \n        ///  /summary \n        public IFormsConversation CurrentConversation { get; set; }\n\n        ///  summary \n        /// Gets or sets the  seealso cref= RequestToken /  message\n        /// sent at the start of the conversation.\n        ///  /summary \n        ///  remarks \n        /// This is used to generate the request security token response\n        /// at the end of the conversation.\n        ///  /remarks \n        public RequestToken RequestToken { get; set; }\n\n        ///  summary \n        /// Gets or sets the  seealso cref= ITokenService /  used to\n        /// issue the  seealso cref= IToken /  generated at the end\n        /// of the conversation.\n        ///  /summary \n        public ITokenService TokenIssuingService { get; set; }\n\n        ///  summary \n        /// Gets or sets whether or not this conversation is delegated using the\n        /// delegated forms protocol\n        ///  /summary \n        public bool Delegated { get; set; }\n\n        ///  summary \n        /// Gets or sets the  seealso cref= IStringCipher /  to use for the delegated result\n        ///  /summary \n        public IStringCipher Cipher { get; set; }\n\n        ///  summary \n        /// Gets or sets a dictionary of extension objects\n        ///  /summary \n        public Dictionary string, object  Extensions { get; private set; }\n    }\n}  This object is used to store the state of the conversation between HTTP requests and responses. The conversation object is re-created for each HTTP request or response, so custom conversation implementers should not attempt to add member variables to their custom conversation class to store data. Implementers should instead store their custom data in the conversation state Extensions dictionary if they require the data to persist between HTTP requests or responses.  A conversation object must implement the following interface:      ///  summary \n    /// This interface represents a Forms conversation, or part of a conversation\n    ///  /summary \n    public interface IFormsConversation\n    {\n        ///  summary \n        /// Start the Form conversation\n        ///  /summary \n        ///  param name= absoluteBaseUrl \n        /// This is the absolute Url of the end-point to be used for\n        /// the conversation.\n        ///  /param \n        ///  param name= absoluteCancelUrl \n        /// This is the absolute Url of the end-point to be used to\n        /// cancel the conversation.\n        ///  /param \n        ///  param name= httpContext The  seealso cref= HttpContextBase / /param \n        ///  returns /returns \n        FormResult Start(string absoluteBaseUrl, string absoluteCancelUrl,\n                         HttpContextBase httpContext);\n\n        ///  summary \n        /// Cancel the current Form conversation\n        ///  /summary \n        ///  param name= httpContext The  seealso cref= HttpContextBase / /param \n        ///  returns /returns \n        FormResult Cancel(HttpContextBase httpContext);\n\n        ///  summary \n        /// Get the next form in the conversation.\n        ///  /summary \n        ///  returns /returns \n        RenderedForm GetNextForm();\n\n        ///  summary \n        /// Process the response to form\n        ///  /summary \n        ///  param name= httpContext \n        /// The  seealso cref= HttpContextBase /  containing all the information\n        /// regarding the form response.\n        ///  /param \n        ///  param name= FormData The Form data /param \n        ///  returns /returns \n        FormResult ProcessFormResponse(HttpContextBase httpContext, NameValueCollection FormData);\n\n        ///  summary \n        /// Gets the collection of credential types required for this conversation.\n        ///  /summary \n        IEnumerable string  RequiredCredentialTypes { get; }\n\n        ///  summary \n        /// Gets the host-relative endpoint for this conversation.\n        ///  /summary \n        string Endpoint { get; }\n\n        ///  summary \n        /// Gets the host-relative endpoint to cancel this conversation.\n        ///  /summary \n        string CancelEndpoint { get; }\n    }\n\n    ///  summary \n    /// Enumeration of Form results\n    ///  /summary \n    public enum FormResult\n    {\n        ///  summary \n        /// More information is required. A new form will be issued to\n        /// collect the required information\n        ///  /summary \n        moreInfo,\n\n        ///  summary \n        /// The form failed\n        ///  /summary \n        fail,\n\n        ///  summary \n        /// Authentication succeeded\n        ///  /summary \n        success,\n\n        ///  summary \n        /// The user cancelled the form request\n        ///  /summary \n        canceled\n    };  StoreFront Services contains a base class that implementers can inherit from:  Citrix.DeliveryServices.Authentication.FormsProtocol.Conversations.FormsConversationBase  This class implements the basic required functionality, but the implementer must implement the following methods:          ///  summary \n        /// Cancel the current Form conversation\n        ///  /summary \n        ///  param name= httpContext The  seealso cref= HttpContext / /param \n        ///  returns /returns \n        public virtual FormResult Cancel(HttpContextBase httpContext)\n        {\n            throw new NotImplementedException();\n        }\n\n        ///  summary \n        /// Get the next form in the conversation.\n        ///  /summary \n        ///  returns /returns \n        public virtual RenderedForm GetNextForm()\n        {\n            throw new NotImplementedException();\n        }\n\n        ///  summary \n        /// Process the response to form\n        ///  /summary \n        ///  param name= httpContext \n        /// The  seealso cref= HttpContext /  containing all the information\n        /// regarding the form response.\n        ///  /param \n        ///  param name= FormData The Form data /param \n        ///  returns /returns \n        public virtual FormResult ProcessFormResponse(HttpContextBase httpContext, \n                                                      NameValueCollection FormData)\n        {\n            throw new NotImplementedException();\n        }\n\n        ///  summary \n        /// Override this method to get the initial  seealso cref= IForm /  in the conversation\n        ///  /summary \n        protected virtual IForm GetInitialForm()\n        {\n            throw new NotImplementedException();\n        }  For conversations that require Active Directory credential validation, the conversation object must also implement the following interface:  namespace Citrix.DeliveryServices.Authentication.Forms.Engine.Interfaces\n{\n    ///  summary \n    /// This interface defines access to an  seealso cref= AuthenticationResult / \n    ///  /summary \n    public interface IAuthenticationResultHolder\n    {\n        ///  summary \n        /// Gets the result of the authentication conversation.\n        ///  /summary \n        AuthenticationResult AuthenticationResult { get; }\n    }\n}   Notes  The FormsConversationBase class contains a default implementation of this interface.", 
            "title": "Form Conversation"
        }, 
        {
            "location": "/authentication-form-generation/#forms", 
            "text": "Form objects within a conversation represent a high-level task, such as validating a user name and password. A form object is responsible for the generation of the specific Receiver Common Form XML for the task and the processing of the user agent\u2019s response. A form object may repeatedly generate XML forms until its task is complete, for example to re-prompt for a password and show an error message if the previously submitted password was incorrect.  Forms must implement the following interface:  namespace Citrix.DeliveryServices.Authentication.Forms.Engine.Interfaces\n{\n    ///  summary \n    /// The expected next action for the form\n    ///  /summary \n    public enum FormState\n    {\n        ///  summary \n        /// Rendering the next form\n        ///  /summary \n        Rendering,\n\n        ///  summary \n        /// Processing the response to the last form\n        ///  /summary \n        Processing,\n\n        ///  summary \n        /// This form is complete\n        ///  /summary \n        Complete\n    };\n\n    ///  summary \n    /// This interface represents a single Form\n    ///  /summary \n    public interface IForm\n    {\n        ///  summary \n        /// Render the next form.\n        ///  /summary \n        ///  returns The next  seealso cref= RenderedForm / /returns \n        RenderedForm GetNextForm();\n\n        ///  summary \n        /// Process the response to the last form\n        ///  /summary \n        ///  param name= httpContext \n        /// The  seealso cref= HttpContextBase /  containing all the information\n        /// regarding the form response.\n        ///  /param \n        ///  param name= formData The form data. /param \n        ///  returns The  seealso cref= FormResult /  from processing the response /returns \n        FormResult ProcessFormResponse(HttpContextBase httpContext, NameValueCollection formData);\n\n        ///  summary \n        /// Gets the collection of credential types required for this conversation.\n        ///  /summary \n        IEnumerable string  RequiredCredentialTypes { get; }\n\n        ///  summary \n        /// Gets the current state of the form\n        ///  /summary \n        FormState State { get; }\n    }\n}  StoreFront Services contains a base class that implementers can inherit from:  Citrix.DeliveryServices.Authentication.FormsProtocol.Forms.FormBase  This class implements the basic required functionality, but the implementer must implement the following methods:          ///  summary Render the next form. /summary \n        ///  returns The next  seealso cref= RenderedForm / /returns \n        public virtual RenderedForm GetNextForm()\n        {\n            throw new NotImplementedException();\n        }\n\n        ///  summary Process the response to the last form /summary \n        ///  param name= httpContext \n        /// The  seealso cref= HttpContextBase /  containing all the information\n        /// regarding the form response.\n        ///  /param \n        ///  param name= formData The form data /param \n        ///  returns The  seealso cref= FormResult /  from processing the response /returns \n        public virtual FormResult ProcessFormResponse(HttpContextBase httpContext,\n                                                      NameValueCollection formData)\n        {\n            throw new NotImplementedException();\n        }  The GetNextForm() method may use the forms template engine, described below, to generate the Receiver Common Form XML to be sent to the client. Then RenderedForm returned has the following structure:  namespace Citrix.DeliveryServices.Authentication.Forms.Engine.Interfaces\n{\n    ///  summary \n    /// This data class represents a rendered form\n    ///  /summary \n    public class RenderedForm\n    {\n        ///  summary \n        /// Gets or sets the rendered Form as an  seealso cref= XmlDocument / \n        ///  /summary \n        public XmlDocument Form { get; set; }\n\n        ///  summary \n        /// Get or sets whether the associated form is the last form\n        ///  /summary \n        public bool Complete { get; set; }\n    }\n}  The Complete flag should be set to true if the form is not expecting the client to send a response back to the form being issued. This is usually required for terminal error messages, and will result in the conversation being terminated when the form has been sent to the client.  If the conversation returns FormResult.moreInfo to the Conversation Engine, then it will request the next form from the conversation object.   When a form has completed its processing, ProcessFormResponse should return FormResult.success. This signals to the conversation object that it should now use the next form in the sequence.   When all the forms have completed their processing, then the conversation is complete and the conversation returns FormResult.success to the conversation engine. This causes it to obtain the success result, which for non-delegated forms authentication is a Request Security Token Response message, which is returned to the client containing the access token.", 
            "title": "Forms"
        }, 
        {
            "location": "/authentication-form-generation/#built-in-support", 
            "text": "The StoreFront Authentication SDK has some built-in forms. It also provides access to the built-in support for verifying and managing Active Directory credentials.", 
            "title": "Built-in Support"
        }, 
        {
            "location": "/authentication-form-generation/#active-directory", 
            "text": "The Authentication Service IoC container is populated with several objects that can be used to verify and manage Active Directory credentials, and are described below:", 
            "title": "Active Directory"
        }, 
        {
            "location": "/authentication-form-generation/#user-name-with-password-support", 
            "text": "The IoC container is populated with an object that implements the following interface:  namespace Citrix.DeliveryServices.Authentication.Explicit.Core\n{\n    ///  summary \n    /// A class to be used to create an instance that implements  seealso cref= IExplicit / .\n    ///  /summary \n    public class ExplicitFactory\n    {\n        ///  summary \n        /// Initializes a new instance of the  see cref= ExplicitFactory /  class.\n        ///  /summary \n        ///  param name= explicitSettings \n        /// The  seealso cref= ExplicitSettings explicit settings /seealso \n        ///  /param \n        ///  param name= authenticationSettings \n        /// The general  seealso cref= AuthenticationSettings / \n        ///  /param \n        public ExplicitFactory(ExplicitSettings explicitSettings,\n                               AuthenticationSettings authenticationSettings);\n\n        ///  summary \n        /// Gets or sets the  seealso cref= ExplicitSettings / \n        ///  /summary \n        public ExplicitSettings Settings { get; private set; }\n\n        ///  summary \n        /// Gets or sets the general  seealso cref= AuthenticationSettings / \n        ///  /summary \n        public AuthenticationSettings AuthenticationSettings { get; private set; }\n\n        ///  summary \n        /// Create an instance that implements  seealso cref= IExplicit / \n        ///  /summary \n        ///  returns An object that implements  seealso cref= IExplicit / /returns \n        public IExplicit CreateInstance();\n    }\n}  The built-in ExplicitConversationFactory uses this to create an object that provides the user name with password support. One of these objects, implementing the interface below, is created for each ExplicitConversation object.  namespace Citrix.DeliveryServices.Authentication.Explicit.Core.Interfaces\n{\n    ///  summary \n    /// The interface to the explicit business logic\n    ///  /summary \n    public interface IExplicit\n    {\n        ///  summary \n        /// Gets the  seealso cref= ExplicitSettings / \n        /// of this object.\n        ///  /summary \n        ExplicitSettings Settings { get; }\n\n        ///  summary \n        /// Gets the general  seealso cref= AuthenticationSettings / \n        /// of this object.\n        ///  /summary \n        AuthenticationSettings AuthenticationSettings { get; }\n\n        ///  summary \n        /// Gets the full user identity of the account whose password has expired\n        ///  /summary \n        ///  remarks \n        /// Only returns a valid value when  see cref= Authenticate(string,string,string) / \n        /// has been called within the current conversation and it has returned\n        ///  see cref= AuthenticationStatus.FailedChangeExpiredSecret / \n        ///  /remarks \n        string ExpiredUser { get; }\n\n        ///  summary \n        /// When a user calls an action that resets the state such as Authenticate we need to\n        /// forget all previous cached information.\n        ///  /summary \n        void ClearState();\n\n        ///  summary \n        /// Returns whether the given password is sufficiently complex\n        ///  /summary \n        ///  param name= password The password to check /param \n        ///  returns True, if meets complexity check /returns \n        bool PasswordMeetsComplexity(string password);\n\n        ///  summary \n        /// Authenticate the specified credentials. If the password\n        /// has expired and password changing is configured, the username and domain will\n        /// be saved in the object state for use in a subsequent call to\n        ///  see cref= ChangeExpiredPassword / \n        ///  /summary \n        ///  param name= userName The username to verify /param \n        ///  param name= domain \n        /// The domain of the user, which can be null if the domain is specified in username\n        ///  /param \n        ///  param name= password \n        /// The password to verify, which can be an empty string\n        ///  /param \n        ///  returns \n        /// An  seealso cref= AuthenticationResult /  indicating authentication status\n        ///  /returns \n        ///  exception cref= ExplicitAuthenticationException if the credentials could not\n        /// be authenticated /exception \n        AuthenticationResult Authenticate(string userName, string domain, string password);\n\n        ///  summary \n        /// Perform a domain restriction check\n        ///  /summary \n        ///  param name= UserInfo The  seealso cref= UserInfo /  to check /param \n        ///  remarks \n        /// If the configuration contains a list of domains then perform a domain, or\n        /// user principle name suffix, restriction check.\n        ///  /remarks \n        void PerformDomainRestriction(UserInfo UserInfo);\n\n        ///  summary \n        /// Attempt to change the password for the user associated with the last\n        /// call to  see cref= Authenticate(string,string,string) / .\n        ///  /summary \n        ///  param name= oldPassword The existing password /param \n        ///  param name= newPassword The new password /param \n        ///  returns an  see cref= ChangePasswordResult  / \n        /// indicating the password change status\n        ///  /returns \n        ///  exception cref= InvalidOperationException \n        /// If no user has been saved to the object state\n        ///  /exception \n        ///  exception cref= ExplicitAuthenticationException \n        /// If the password change operation failed\n        ///  /exception \n        ///  exception cref= ArgumentNullException \n        /// If oldPassword of newPassword is null.\n        ///  /exception \n        ChangePasswordResult ChangeExpiredPassword(string oldPassword, string newPassword);\n\n        ///  summary \n        /// Attempt to change the password for the credentials indicated by the\n        /// given principal.\n        ///  /summary \n        ///  param name= principal \n        /// The  seealso cref= IClaimsPrincipal /  representing the user\n        ///  /param \n        ///  param name= oldPassword The existing password /param \n        ///  param name= newPassword The new password /param \n        ///  returns \n        /// an  seealso cref= ChangePasswordResult /  indicating the password change status\n        ///  /returns \n        ChangePasswordResult ChangePassword(IClaimsPrincipal principal, string oldPassword,\n                                            string newPassword);\n    }\n}  The ExplicitSettings object has the following definition:  namespace Citrix.DeliveryServices.Authentication.Explicit.Core.Configuration\n{\n    ///  summary \n    /// A data class to hold the Explicit business logic settings\n    ///  /summary \n    public class ExplicitSettings\n    {\n        ///  summary \n        /// Gets or sets service locator name for the authenticator to use\n        ///  /summary \n        public string AuthenticatorName { get; set; }\n\n        ///  summary \n        /// Gets or sets the require account security identifiers property\n        ///  /summary \n        public bool RequireAccountSIDs { get; set; }\n\n        ///  summary \n        /// Gets or sets the hide domain field property\n        ///  /summary \n        public bool HideDomainField { get; set; }\n\n        ///  summary \n        /// Gets or sets the allow user to change their password property\n        ///  /summary \n        public AllowPasswordChangeValue AllowUserPasswordChange { get; set; }\n\n        ///  summary \n        /// Gets or sets the password expiry warning mode\n        ///  /summary \n        public PasswordExpiryWarningValue ShowPasswordExpiryWarning { get; set; }\n\n        ///  summary \n        /// Gets or sets the override for the password expiry warning period in days\n        ///  /summary \n        public int PasswordExpiryWarningPeriod { get; set; }\n\n        ///  summary \n        /// Gets the list of trusted domains\n        ///  /summary \n        public IList string  Domains { get; set; }\n\n        ///  summary \n        /// Gets the default trusted domain\n        ///  /summary \n        ///  remarks \n        /// This will be null, if no trusted domains are specified,\n        /// otherwise it must be a member of the trusted domains.\n        ///  /remarks \n        public string DefaultDomain { get; set; }\n\n        ///  summary \n        /// Gets the allow zero length password property\n        ///  /summary \n        public bool AllowZeroLengthPassword { get; set; }\n    }\n}  The settings are built from the following configuration section of the Authentication Service and stored in the IoC container:  configuration \n   citrix.deliveryservices \n     explicitBL authenticator= defaultDelegatedAuthenticator  hideDomainField= true \n                allowUserPasswordChange= Never  allowZeroLengthPassword= false  \n                showPasswordExpiryWarning= Windows  \n                passwordExpiryWarningPeriod= 10  requireAccountSIDs= true \n       domainSelection default= \n         clear / \n       /domainSelection \n     /explicitBL \n   /citrix.deliveryservices  /configuration  The explicitBL section has the following configuration items that control the expected user interface in addition to authentication policy:   authenticator: This value must not be changed  hideDomainField:  If this value is true, then forms should not display a separate user interface element for the user to supply the domain where their credential is stored. Instead they will be asked for their user name in the form of domain\\user or user@domain.  If this value is false, then a domain user interface element will be displayed. If the   element is empty, then a text box for the user to type their domain should be displayed, otherwise a combo box containing all the values from the   element should be displayed.    allowUserPasswordChange: This value controls when a user is allowed to change their password and can have the following values:  Never: The user is not allowed to change their password through StoreFront. A user attempting to authenticate with an expired password will fail to gain access to the system, and will be directed to change their password elsewhere.  ExpiredOnly: The user is allowed to change an expired password during the authentication process.  Always: The user can change an expired password during authentication, but will also receive a warning when their password is about to expire, and will be able to choose to change their password at any time.    allowZeroLengthPassword: This is usually false and prevents users with zero length passwords from gaining access to the system or changing their password to a zero length.  showPasswordExpiryWarning: This setting controls when a password expiry warning notice is presented to the user, if allowUserChangePassword=Always, and this setting can have the following values:  Windows: The period is determined by the Windows setting described here: http://technet.microsoft.com/en-us/library/ee829687(v=ws.10).aspx   Custom: The period is determined by the passwordExpiryWarningPeriod setting below  Never: The notification is never shown to the user    passwordExpiryWarningPeriod: This setting, in days, determines when to display a password expiry warning notice to the user, if allowUserChangePassword=Always and showPasswordExpiryWarning=Custom  requireAccountSIDs: This setting determines whether or not to include the Windows Group information with the authentication data. This value should be left as true, as other StoreFront components rely on the information being present.  domainSelection: This element allows the specification of a set of domains. These can be specified as either short domain or fully qualified domain names. The user is then restricted to either selecting or typing a valid domain. It is possible to specify a default.  Note: The comparison is a string comparison only.", 
            "title": "User Name with Password Support"
        }, 
        {
            "location": "/authentication-form-generation/#kerberos-support", 
            "text": "StoreFront also allows the use of Kerberos Service-For-User (S4U) for partial account validation and to obtain information about the account, including group information. The IoC container is populated with an object that implements the following interface that can be used for this purpose:  namespace Citrix.DeliveryServices.Authentication.Kerberos\n{\n    ///  summary \n    /// Interface for attempting kerberos authentication\n    ///  /summary \n    public interface IKerberosAuthenticator\n    {\n        ///  summary \n        /// Authenticate the user specified by their user principal name\n        ///  /summary \n        ///  param name= userPrincipalName The user principal name /param \n        ///  param name= clientRealm The optional client realm  /param \n        ///  returns The  seealso cref= AuthenticationResult / /returns \n        AuthenticationResult Authenticate(string userPrincipalName, string clientRealm = null);\n\n        ///  summary \n        /// Authenticate the user specified by a user certificate\n        ///  /summary \n        ///  param name= userCertificate The user certificate /param \n        ///  param name= domainHint The optional domain hint  /param \n        ///  returns The  seealso cref= AuthenticationResult / /returns \n        AuthenticationResult Authenticate(X509Certificate2 userCertificate,\n                                          string domainHint = null);\n\n        ///  summary \n        /// Authenticate the user specified by a user certificate\n        ///  /summary \n        ///  param name= userCertificate The user certificate /param \n        ///  param name= domainHint The optional domain hint  /param \n        ///  returns The  seealso cref= AuthenticationResult / /returns \n        AuthenticationResult Authenticate(HttpClientCertificate userCertificate,\n                                          string domainHint = null);\n    }\n}", 
            "title": "Kerberos Support"
        }, 
        {
            "location": "/authentication-form-generation/#forms_1", 
            "text": "The Authentication SDK provides the following built-in forms:", 
            "title": "Forms"
        }, 
        {
            "location": "/authentication-form-generation/#cancelledform", 
            "text": "This class creates the required form in response to a cancel request.  Constructor:  Citrix.DeliveryServices.Authentication.FormsProtocol.Forms.CancelledForm(\n                  FormsTemplateEngine templateEngine, IEnumerable CultureInfo  cultures)  Parameters:   templateEngine: The template engine. This is a required parameter.  cultures: The currently available cultures. This is a required parameter.   Form:  ?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/response/1 \n   Status success /Status \n   Result cancelled /Result \n   StateContext /  /AuthenticateResponse  Template:    Cancelled.tfrm", 
            "title": "CancelledForm"
        }, 
        {
            "location": "/authentication-form-generation/#failuremessageform", 
            "text": "This class creates a mini-conversation of a message form, to inform the user of the reason for the error, followed by a failure form.  Constructor:  Citrix.DeliveryServices.Authentication.FormsProtocol.Forms.FailureMessageForm(\n              FormsTemplateEngine templateEngine, IEnumerable CultureInfo  cultures,\n               IEnumerable FormsMessage  messages, string postbackUrl, string cancelUrl)  Parameters:    templateEngine: The template engine.    cultures: The currently available cultures.    messages: The messages to display.    postbackUrl: The host relative URL to POST the form response to.    cancelUrl: The host relative URL to POST a cancel form response to.    Template:  Messages.tfrm   Failed.tfrm", 
            "title": "FailureMessageForm"
        }, 
        {
            "location": "/authentication-form-generation/#changeexpiredpasswordform", 
            "text": "This class creates a mini-conversation to change a user\u2019s expired password.  Constructor:  Citrix.DeliveryServices.Authentication.FormsProtocol.Forms.ChangePassword.ChangeExpiredPasswordForm\n(\n    FormsTemplateEngine templateEngine, IEnumerable CultureInfo  cultures, IExplicit explicitBL,\n    string postbackUrl, string cancelUrl\n)  Parameters:   templateEngine: The template engine.  cultures: The currently available cultures.  explicitBL: The explicit credential business object, described above.  postbackUrl: The host relative URL to POST the form response to.  cancelUrl: The host relative URL to POST a cancel form response to.   Template:  ChangeExpiredPassword.tfrm and ConfirmChangePassword.tfrm   Notes   The explicitBL object must have previously been used in the conversation to attempt to authenticate the user and discover that their password has expired. If this is not done, then an error form will be generated.  The settings for explicitBL object must have the AllowUserPasswordChange value set to either ExpiredOnly or Always. If the value is Never, then an error form will be issued.", 
            "title": "ChangeExpiredPasswordForm"
        }, 
        {
            "location": "/authentication-form-generation/#usernamepasswordform", 
            "text": "This class creates a mini-conversation to allow a user to authenticate by explicitly providing their user name and password in the form. If configured it will also allow the user to change their expired password as part of this form.  Constructor:  Citrix.DeliveryServices.Authentication.FormsProtocol.Forms.UsernamePasswordForm\n(\n    FormsTemplateEngine templateEngine, IEnumerable CultureInfo  cultures, IExplicit explicitBL,\n    string postbackUrl, string cancelUrl, bool allowChangeExpiredPasswordIfConfigured=true\n)  Parameters: \n- templateEngine: The template engine.\n- cultures: The currently available cultures.\n- explicitBL: The explicit credential business object, described above.\n- postbackUrl: The host relative URL to POST the form response to.\n- cancelUrl: The host relative URL to POST a cancel form response to.\n- allowChangeExpiredPasswordIfConfigured: This optional parameter defines whether or not the the user is allowed to change their expired password as part of this form.\n    - true: This is the default value, and allows the user to change their expired password, if the explicitBL object has been configured to allow it.\n    - false:The user is never allowed to change their password as part of this form.  Template:  UsernamePassword.tfrm and optionally ChangeExpiredPassword.tfrm and ConfirmChangePassword.tfrm", 
            "title": "UsernamePasswordForm"
        }, 
        {
            "location": "/authentication-form-generation/#changepasswordcontroller", 
            "text": "The ChangePasswordController is a built-in ASP.Net MVC Controller for handling requests for a user to choose to change their password before it has expired. This Controller is deployed by default and an MVC route to it is defined in the Authentication Service web.config as shown below:  commonExplicitEndpoints \n   routeTable order= 10 \n     routes \n       route name= StartChangePassword  url= ChangePassword/Start \n         defaults \n           add param= controller  value= ChangePassword  / \n           add param= action  value= StartChangePassword  / \n           add param= postbackAction  value= ChangePassword  / \n           add param= cancelAction  value= CancelChangePassword  / \n           add param= conversationFactory  value= ChangePassword  / \n           add param= changePasswordAction  value= StartChangePassword  / \n           add param= changePasswordController  value= ChangePassword  / \n         /defaults \n         data / \n       /route \n       route name= ChangePassword  url= ChangePassword \n         defaults \n           add param= controller  value= ChangePassword  / \n           add param= action  value= ChangePassword  / \n         /defaults \n         data / \n       /route \n       route name= CancelChangePassword  url= ChangePassword/Cancel \n         defaults \n           add param= controller  value= ChangePassword  / \n           add param= action  value= CancelChangePassword  / \n         /defaults \n         data / \n       /route \n     /routes \n   /routeTable  /commonExplicitEndpoints  In order for the client to discover this route, the CredentialUpdateService URL information must be present in the Request Security Token Response, as illustrated below:  ?xml version= 1.0  encoding= UTF-8  standalone= yes ?  requesttokenresponse xmlns= http://citrix.com/delivery-services/1-0/auth/requesttokenresponse \n                      xmlns:ar= http://citrix.com/authentication/response/1 \n   for-service a service identifier /for-service \n   issued 2009-05-12T15:27:28.1550000Z /issued \n   expiry 2009-05-12T16:29:31.1550000Z /expiry \n   lifetime 0.01:02:03 /lifetime \n   token-template abcdef /token-template \n   token ABCDEF123=== /token \n   ar:CredentialUpdateInformationList \n     ar:CredentialUpdateInformation \n       ar:CredentialDisplayName DomainName /ar:CredentialDisplayName \n       ar:AuthenticationInfoId 1 /ar:AuthenticationInfoId \n       ar:ExpiryTime 2010-05-12T15:27:28.155Z /ar:ExpiryTime \n       ar:TimeRemaining 10.05:33:09 /ar:TimeRemaining \n       ar:CredentialUpdateService /ChangePasswordStart /ar:CredentialUpdateService \n     /ar:CredentialUpdateInformation \n   /ar:CredentialUpdateInformationList  /requesttokenresponse  A custom conversation can use the built-in functionality by setting the change password controller name and action name in the route data of the route associated with the conversation, as shown below:  route name= StartExplicitAuthentication  url= ExplicitForms/Start \n   defaults \n     add param= controller  value= ExplicitFormsAuthentication  / \n     add param= action  value= AuthenticateStart  / \n     add param= postbackAction  value= Authenticate  / \n     add param= cancelAction  value= CancelAuthenticate  / \n     add param= conversationFactory  value= ExplicitAuthentication  / \n     add param= changePasswordAction  value= StartChangePassword  / \n     add param= changePasswordController  value= ChangePassword  / \n     add param= protocol  value= ExplicitForms  / \n   /defaults \n   data /  /route  This data is resolved by the built-in code to find the change password start URL . The built-in code also ensures that the correct RSTR is returned so the client can discover the change password end-point.  Templates:  ChangeExpiredPassword.tfrm and ConfirmChangePassword.tfrm   Notes   The user must be authenticated in order to change their password. The authenticated user must have authenticated using a password, otherwise an error form is issued. The password originally supplied during authentication is verified against a value supplied by the user in the form, and changing the password is not allowed unless the passwords match.  The settings for explicitBL object must have the AllowUserPasswordChange value set to Always. If the value is Never or ExpiredOnly, then an error form will be issued.", 
            "title": "ChangePasswordController"
        }, 
        {
            "location": "/authentication-form-generation/#forms-template-engine", 
            "text": "", 
            "title": "Forms Template Engine"
        }, 
        {
            "location": "/authentication-form-generation/#introduction_1", 
            "text": "The forms template engine is the StoreFront component responsible for generating the Receiver Common Forms from templates. The templates are based on the ASP.NET Razor View Engine (see http://www.asp.net/web-pages/tutorials/basics/2-introduction-to-asp-net-web-programming-using-the-razor-syntax) with methods specific to the Receiver Common Forms domain that comprises the Forms Template Language described below.  The StoreFront Authentication SDK samples contain examples of how to define new templates, use the API, generate localized textual content, and use the Forms Template Language. Further details of the APIs can also be found in the XML documentation file at:  AuthSDK.zip\\Assemblies\\StoreFront\\Citrix.DeliveryServices.Authentication.Forms.Template.XML  If there are issues with the template processing, the Forms Template Engine adds events to the Event log as described in Appendix A.", 
            "title": "Introduction"
        }, 
        {
            "location": "/authentication-form-generation/#creation", 
            "text": "", 
            "title": "Creation"
        }, 
        {
            "location": "/authentication-form-generation/#template-engine-creation", 
            "text": "For a particular web application, there is one and only one instance of the Forms Template Engine. It is stored in the StoreFront IoC container by the Forms Protocol start-up module during the application start-up and is accessed through the service locator.  First a Razor engine host is created and configured to generate C# code. The base class is configured to be:  Citrix.DeliveryServices.Authentication.Forms.Template.FormsTemplateBase  This base class contains the domain-specific business rules relating to the Citrix Receiver Common Forms.  The Razor host imports the following namespaces:   System  Citrix.DeliveryServices.Authentication.Forms.Template.Requirements    Notes  A limitation of this version is that it is not possible to add other namespaces or references to custom assemblies.   The Forms Template Engine is then constructed from a Razor template engine, wrapping the razor host and the Citrix localization factory, before loading and compiling the templates.  The templates are files with the file extension tfrm that are stored in the directory ~/App_Data/Templates. The template engine also finds and loads images with the following file extensions: gif, jpg, jpeg, png, bmp. The Forms Template Engine also watches for changes to the templates directory and automatically reloads the templates when a change is made. When the templates are reloaded, an event is added to the Citrix Delivery Services Event log, as described in Appendix A, with Event Id: 5.   The Forms Template Engine is finally stored in the IoC.", 
            "title": "Template Engine Creation"
        }, 
        {
            "location": "/authentication-form-generation/#template-compilation", 
            "text": "The compilation of a template, named CustomTemplate.tfrm for example, has the following steps:  1.The Razor engine takes the template contents and generates code that represents the class Citrix.CompiledForms.CustomTemplate as C# code with FormsTemplateBase as its base class.  2.The C# is then compiled into a code DOM using the CSharpCodeProvider.  3.The code DOM is then compiled into an in-memory assembly that is loaded into the process.  4.The loaded assembly is then stored in the Forms Template Engine, indexed as: CustomTemplate.   Notes  The Razor template processing requires that the process has write access to the %TEMP% directory", 
            "title": "Template Compilation"
        }, 
        {
            "location": "/authentication-form-generation/#template-rendering", 
            "text": "", 
            "title": "Template Rendering"
        }, 
        {
            "location": "/authentication-form-generation/#images", 
            "text": "The Receiver Common Authentication Forms Language allows the use of images as part of the authentication process, for example Captcha images. In addition to the templates, the Forms Template Engine will also search the template folder for files with extensions: gif, jpg, jpeg, png, and bmp. It will load all the files found and convert them to appropriate RFC 2397 data URIs, ready for use in the required templates. Again, adding, removing, or modifying an image will result in the images being reloaded automatically.  Images can also be dynamically generated, with support built-in for converting raw image data to data URIs for use in forms.", 
            "title": "Images"
        }, 
        {
            "location": "/authentication-form-generation/#localization", 
            "text": "The forms Template Engine supports the generation of localized textual content from a single template. In order for localized content to be available to the Forms Template Engine, the forms author should create localized content as standard Microsoft resx files (see http://msdn.microsoft.com/en-us/library/ekyft91f(v=vs.90).aspx). These resource files should be placed in the directory:  ~/App_Data/resources.  StoreFront Services needs to be configured to become aware of new localization files, as described below.  APIs that accept localization keys can also accept either strings that do not require localization, or pre-localized strings. The processing of a localization key has the following steps.  A key is expected to be an indexed resource key of form: ResourceSetPrefix:Key. The ResourceSetPrefix is configured in the Authentication Service web.config, and maps a prefix to a set of resources. For example, the default prefixes are defined as:  configuration   \n   citrix.deliveryservices \n     localisation \n       resourceSets \n         clear / \n         add prefix= FormsProtocol  resourcePath= App_Data/resources/FormsProtocol  / \n         add prefix= ExplicitCore  resourcePath= App_Data/resources/ExplicitCore  / \n         add prefix= ExplicitFormsCommon  resourcePath= App_Data/resources/ExplicitFormsCommon  / \n         add prefix= ExplicitAuth  resourcePath= App_Data/resources/ExplicitAuth  / \n       /resourceSets \n     /localisation \n   /citrix.deliveryservices  /configuration  So, for example, the resource named: \u201ctest\u201d defined in the FormsProtocol.resx file would be accessed by the localization key:  FormsProtocol:test  Customizations are expected to update the above configuration with their resource sets.  If a localization key is supplied that does not correspond to this pattern, or that specifies a resource set prefix not mapped in the above configuration, then the supplied key is just returned as the localized string. Examples include:   \u201cString not to be localized\u201d would be localized as: \u201cString not to be localized\u201d  \u201cPre-localized\u201d would be localized as: \u201cPre-localized\u201d  \u201cUnknownReseourceSetPrefix:Key\u201d would be localized as: \u201cUnknownReseourceSetPrefix:Key\u201d   If a valid resource set prefix is found, then the associated resource provider is used to locate the appropriate localized string into the requested language. If the localization key exists, but the request is to localize to a language not provided, then the string will be localized into the default language, which is English.", 
            "title": "Localization"
        }, 
        {
            "location": "/authentication-form-generation/#template-rendering_1", 
            "text": "The Forms Template Engine is used by Forms objects to generate the Forms through the following methods on the Forms Template Engine:          ///  summary \n        /// Render the specified template using the specified anonymous object\n        /// as the model.\n        ///  /summary \n        ///  param name= templateName The name of the template to render /param \n        ///  param name= currentCultures The current  seealso cref= CultureInfo /  to use to \n                                          localize text items /param \n        ///  param name= model The anonymous model /param \n        ///  param name= messages The  seealso cref= FormsMessage /  to render /param \n        ///  returns The rendered Xml /returns \n        public XmlDocument RenderTemplate(string templateName,\n                                          IEnumerable CultureInfo  currentCultures,\n                                          object model,\n                                          IEnumerable FormsMessage  messages = null);\n\n        ///  summary \n        /// Render the specified template using the specified dictionary of named objects\n        /// as the values.\n        ///  /summary \n        ///  param name= templateName The name of the template to render /param \n        ///  param name= currentCultures The current  seealso cref= CultureInfo /  to use to \n                                          localize text items /param \n        ///  param name= renderValues The dictionary of named objects to use as values /param \n        ///  param name= messages The  seealso cref= FormsMessage /  to render /param \n        ///  returns The rendered Xml /returns \n        public XmlDocument RenderTemplate(string templateName,\n                                          IEnumerable CultureInfo  currentCultures,\n                                          IDictionary string, object  renderValues,\n                                          IEnumerable FormsMessage  messages=null);  In the above, the template name is the index of the compiled template, as described above; for example, the name to be used for test.tfrm is: test. The data model, whether an anonymous data class or a dictionary, allows the form to define named data items referenced in the associated template. Examples of data models can be seen in the Forms Template Language section below.  The FormsMessage object has the following API, and is used for associating messages with credentials:  namespace Citrix.DeliveryServices.Authentication.Forms.Template.RequirementAPI\n{\n    ///  summary \n    /// This class represents a message to be displayed on a form.\n    /// The message is one of the following categories:\n    ///     information, warning or error.\n    ///  /summary \n    public class FormsMessage\n    {\n        ///  summary \n        /// Gets or sets the localization key\n        ///  /summary \n        public string LocalisationKey { get; set; }\n\n        ///  summary \n        /// Gets or sets the localized message\n        ///  /summary \n        internal string Message { get; set; }\n\n        ///  summary \n        /// Gets or sets the collection of filed identifiers that this\n        /// message relates to.\n        ///  /summary \n        public IEnumerable string  FieldIds { get; set; }\n\n        ///  summary \n        /// Gets or sets the form message type\n        /// This must be: information, warning or error\n        ///  /summary \n        public Label.LabelType MessageType { get; set; }\n\n        ///  summary \n        /// Render this message into the specified buffer\n        ///  /summary \n        ///  param name= sb \n        /// The  seealso cref= StringBuilder /  to render this message into\n        ///  /param \n        ///  returns The string of the the rendered message /returns \n        public void RenderMessageToBuffer(StringBuilder sb);\n    }\n}  For example, consider a change password form with a requirement for the user to re-enter their existing password:  Requirement \n   Credential \n     ID oldPassword /ID \n     Type password /Type \n   /Credential \n   Label \n     Text Old password: /Text \n     Type plain /Type \n   /Label \n   Input \n     Text \n       Secret true /Secret \n       ReadOnly false /ReadOnly \n       InitialValue /InitialValue \n       Constraint .+ /Constraint \n     /Text \n   /Input  /Requirement  If the user enters an invalid value, then an error label is returned that specifies the oldPassword requirement to be highlighted. This would be done by creating a FormsMessage as follows:  new FormsMessage\n    {\n        MessageType = Label.LabelType.error,\n        LocalisationKey =  ExplicitCore:OldInvalid ,\n        FieldIds = new[] {  oldPassword  }\n    }\nThis would result in the following XML: Requirement \n   Credential \n     Type none /Type \n   /Credential \n   Label \n     HighlightFields \n       CredentialID oldPassword /CredentialID \n     /HighlightFields \n     Text Old password incorrect /Text \n     Type error /Type \n   /Label \n   Input /  /Requirement  The generated form XML is returned to the client by the conversation engine and the MVC Controller in an appropriately formatted message.  The Authentication SDK samples contain detailed examples of how to use the Template Rendering API.", 
            "title": "Template Rendering"
        }, 
        {
            "location": "/authentication-form-generation/#forms-template-language", 
            "text": "The FormsTemplateBase C# class has a collection of methods that can be accessed in the template. These form the domain- specific forms template language. The language is divided into three APIs: low-level, requirements and high-level, which allow different levels of control of the final Receiver Common Forms XML. Appendix B illustrates a single form generated using the three APIs, so that they can be compared and contrasted.  The following description expects a basic understanding of the layout of the Receiver Common Forms XML as described in [2]. The APIs also expect an understanding of C# optional and named Parameters, as described here: http://msdn.microsoft.com/en-gb/library/dd264739.aspx   In addition to these domain-specific methods, many general Razor programming constructs may be used.", 
            "title": "Forms Template Language"
        }, 
        {
            "location": "/authentication-form-generation/#low-level-api", 
            "text": "This API is the lowest level API and is based around the generation of strings for XML documents.  For the low-level methods, all the Parameters are required.", 
            "title": "Low Level API"
        }, 
        {
            "location": "/authentication-form-generation/#containsvalue", 
            "text": "bool ContainsValue(string valueName)  This method returns true if the specified named index is associated with an object in the data model.  Parameters:   valueName: The name of an object in the data model.   Returns: True if the specified named index is valid  Example:  Model: new { AssistiveText = \"Help Text\"};  Template:  Input \n@if (ContainsValue( AssistiveText ))\n{\n@:  AssistiveText @GetValue( AssistiveText ) /AssistiveText  \n}\n   Text \n     Constraint .+ /Constraint \n   /Text  /Input  Output:  Input \n   AssistiveText Help Text /AssistiveText \n   Text \n     Constraint .+ /Constraint \n   /Text  /Input", 
            "title": "ContainsValue"
        }, 
        {
            "location": "/authentication-form-generation/#getobject", 
            "text": "object GetObject(string valueName)  This method returns the object in the data model with the specified named index.  Parameters: :   valueName: The name of an object in the data model.   Returns: The specified object from the data model, or null if the index is not valid.  Example:  Model:  new\n{\n    PhoneNumbers = new []\n                   {\n                       new Tuple string, string  ( Home Number ,  01954 283 710 ),\n                       new Tuple string, string  ( Fax Number ,  01954 283 601 )\n                   }\n}  Template:  @foreach(Tuple string, string  phoneNumber in (IEnumerable)GetObject( PhoneNumbers ))\n{\n@:       Requirement \n@Credential(credentialType:  none )\n@TextLabel(labelKey: @phoneNumber.Item1)\n@:         Input \n@:           Text \n@:             InitialValue @phoneNumber.Item2 /InitialValue \n@:             Constraint .+ /Constraint \n@:           /Text \n@:         /Input \n@:       /Requirement \n}  Output:  Requirement \n   Credential \n     Type none /Type \n   /Credential \n   Label \n     Text Home Number /Text \n     Type plain /Type \n   /Label \n   Input \n     Text \n       InitialValue 01954 283 710 /InitialValue \n       Constraint .+ /Constraint \n     /Text \n   /Input  /Requirement  Requirement \n   Credential \n     Type none /Type \n   /Credential \n   Label \n     Text Fax Number /Text \n     Type plain /Type \n   /Label \n   Input \n     Text \n       InitialValue 01954 283 601 /InitialValue \n       Constraint .+ /Constraint \n     /Text \n   /Input  /Requirement", 
            "title": "GetObject"
        }, 
        {
            "location": "/authentication-form-generation/#getvalue", 
            "text": "string GetValue(string valueName)  This method returns the object in the data model with the specified named index, as a string. This method will convert the specified object to a string, if required.  Parameters:   valueName: The name of an object in the data model.   Returns: The specified string from the data model, or the empty string if the index is not valid  Example:  Model: new { Date = DateTime.Now() };  Template:  @GetValue(\"Date\")  Output: 5/6/2005 02:34:42 PM", 
            "title": "GetValue"
        }, 
        {
            "location": "/authentication-form-generation/#controlvalue", 
            "text": "bool ControlValue(string valueName)  This method returns the object in the data model with the specified named index, as a Boolean value. This method expects that the stored object is a Boolean and will not attempt to convert from other types.  Parameters:   valueName: The name of an object in the data model.   Returns: The specified Boolean value from the data model, or false if the index is not valid  Example:  Model: new { Display = true  };  Template:  @if (ControlValue( Display ))\n{\n@:  AuthenticateResponse xmlns= http://citrix.com/authentication/response/1 \n}  Output:   AuthenticateResponse xmlns=\"http://citrix.com/authentication/response/1\"", 
            "title": "ControlValue"
        }, 
        {
            "location": "/authentication-form-generation/#getattributevalue", 
            "text": "string GetAttributeValue(string valueName)  This method returns the object in the data model with the specified named index, as a string encoded for using as an XML attribute. This method will convert the specified object to a string, if required.  Parameters: :   valueName: The name of an object in the data model.   Returns: The specified string from the data model encoded to be used as an XML attribute, or the empty string if the index is not valid  Example:  Model: new { Namespace = \"http://citrix.com/authentication/response/1\"};  Template:   AuthenticateResponse xmlns=\"@GetAttributeValue(\"Namespace\")\"  Output:   AuthenticateResponse xmlns=\"http://citrix.com/authentication/response/1\"", 
            "title": "GetAttributeValue"
        }, 
        {
            "location": "/authentication-form-generation/#getelementvalue", 
            "text": "string GetElementValue(string valueName)  This method returns the object in the data model with the specified named index, as a string encoded for using as an XML element. This method will convert the specified object to a string, if required.  Parameters: \n- valueName: The name of an object in the data model.  Returns: The specified string from the data model encoded to be used as an XML element, or the empty string if the index is not valid  Example:  Model: new { \"StateContextElementName\", \"StateContext\"};  Template:   @GetElementValue(\"StateContextElementName\")  Output:   StateContext", 
            "title": "GetElementValue"
        }, 
        {
            "location": "/authentication-form-generation/#gettextvalue", 
            "text": "string GetTextValue(string valueName)  This method returns the object in the data model with the specified named index, as a string encoded for using as XML text. This method will convert the specified object to a string, if required.  Parameters:   valueName: The name of an object in the data model.   Returns:   The specified string from the data model encoded to be used as XML text, or the empty string if the index is not valid  Example:  Model: new { TestText = \"This is non-localized   unencoded text\"};  Template:   @GetTextValue(\"TestText\")  Output:   This is non-localized   unencoded text.", 
            "title": "GetTextValue"
        }, 
        {
            "location": "/authentication-form-generation/#getlocalisedtextvalue", 
            "text": "string GetLocalisedTextValue(string valueName)  This method will use the localization key to provide a localized string encoded as XML text.  Parameters:   valueName: The name of an object in the data model containing a localization key   Returns: The localized string, encoded as XML text, or the empty string if the index is not valid  Example:  Template: @GetLocalisedTextValue(\"Test:TestKey\")  Output:   This is a localized test string", 
            "title": "GetLocalisedTextValue"
        }, 
        {
            "location": "/authentication-form-generation/#getlocalisedformattedvalue", 
            "text": "string GetLocalisedFormattedValue(string formatName, params object[] Parameters)  This method will use the localization key to obtain a format string that is used with the Parameters to generate a localized string, encoded as XML text.  Parameters:   valueName: The name of an object in the data model containing a localization key   Returns:   The localized string, encoded as XML text, or the empty string if the index is not valid  Example:  Template: @GetLocalisedTextValue(\"Test:FormatKey\", DateTime.Now)  Output:   Called at: 5/6/2005 02:34:42 PM  Requirements  A Receiver Common Form contains a list of authentication requirements. Each authentication requirement contains the following elements:  Credential ,  Label , and  Input . This API is focused around the generation of these three elements.\nIn cases where there are many arguments, defaults are provided where possible, and it is expected that Parameters are specified by name for ease of use, as demonstrated in the examples.", 
            "title": "GetLocalisedFormattedValue"
        }, 
        {
            "location": "/authentication-form-generation/#credential", 
            "text": "string Credential(string credentialType, string id = null, string saveId = null)  Create a   authentication requirement fragment with the specified values.  Parameters:   credentialType: The credential type (see the Receiver Common Authentication Forms Language document for more information). This parameter is required.  id: The optional credential identifier. The default is to have no identifier.  saveId: The optional identifier to be used to save this credential on a client. The default is to have no save identifier.   Returns:   The   xml fragment  Example:  Template:   @Credential(credentialType: \"username\", id: \"UsernameID\", saveId: \"SaveUsernameID\")  Output:  Credential \n   ID UsernameID /ID \n   SaveID SaveUsernameID /SaveID \n   Type username /Type  /Credential", 
            "title": "Credential"
        }, 
        {
            "location": "/authentication-form-generation/#textlabel", 
            "text": "string TextLabel(string labelKey, Label.LabelType labelType = Label.LabelType.plain)  Create a text-based   authentication requirement fragment from the specified values.  Parameters:   labelKey: The localization key for the label. This parameter is required.  labelType: The optional label type (see the Receiver Common Authentication Forms Language document for more information). The default label type is: plain   Returns: The text-based   xml fragment  Example:  Template: @TextLabel(labelKey: \"Test:UsernameLabelKey\")  Output:  Label \n   Text User name: /Text \n   Type plain /Type  /Label", 
            "title": "TextLabel"
        }, 
        {
            "location": "/authentication-form-generation/#imagelabel", 
            "text": "string ImageLabel(string imageKey)  Create an image-based   authentication requirement fragment from an image stored in the Template folder.  Parameters:   imageKey: The name of the image file in the Template directory. This is a required parameter.   Returns: The image-based   xml fragment  Example:  Template:   @ImageLabel(imageKey: \"captcha.png\")  Output:  Label \n   Binary data:image/png;base64,iVBORw0KGgoAAAANSUh\u2026/sAAAAASUVORK5CYII= /Binary \n   Type image /Type  /Label  Note:   It is possible to dynamically create images and display them, for example:  Form:  byte[] dynamicImage; \nvar converted = FormsTemplateEngine.GetImageDataUri(dynamicImage, @ image/gif );      \nTemplateEngine.RenderTemplate(FormName, Cultures, Values,\n            new { DynamicImage = converted});  Template:  Label \n   Binary @GetTextValue( DynamicImage ) /Binary \n   Type image /Type  /Label  Output:  Label \n   Binary data:image/png;base64,iVBORw0KGgoAAAANSUh\u2026/sAAAAASUVORK5CYII= /Binary \n   Type image /Type  /Label", 
            "title": "ImageLabel"
        }, 
        {
            "location": "/authentication-form-generation/#inputbutton", 
            "text": "string InputButton(string buttonKey, string assistiveTextKey=null)  Create a button  Input  authentication requirement fragment.  Parameters:    buttonKey: The localization key for the button label. This is a required parameter.    assistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.    Returns: The button   xml fragment  Example:  Template:   @InputButton(buttonKey: \"Test:LogonButtonKey\")  Output:  Input \n   Button Log On /Button  /Input", 
            "title": "InputButton"
        }, 
        {
            "location": "/authentication-form-generation/#inputcombobox", 
            "text": "string InputComboBox(string displayItemsValueName, string initialSelectionValueName = null,\n                     string assistiveTextKey = null)  Create a combo-box  Input  authentication requirement fragment.  Parameters:   displayItemsValueName: The name of the dictionary of display-value pairs in the model. This is a required parameter.  initialSelectionValueName: The optional initially selected display value. The default is to select the first value.  assistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.   Returns:   The combo-box  Input  xml fragment  Example:  Model:  new\n{\n    Domains = new Dictionary string, string \n              {\n                  { @ citrix , @ citrix.com },\n                  { @ citrite , @ citrite.local }\n              },\n    InitialDomain = @ citrite.local \n}  Template:   @InputComboBox(displayItemsValueName:  Domains ,\n                       initialSelectionValueName:  InitialDomain ,\n                       assistiveTextKey:  DomainAssistiveTextKey )  Output:  Input \n   AssistiveText Please select your domain /AssistiveText \n   ComboBox \n     InitialSelection citrite.local /InitialSelection \n     DisplayValues \n       DisplayValue \n         Display citrix /Display \n         Value citrix.com /Value \n       /DisplayValue \n       DisplayValue \n         Display citrite /Display \n         Value citrite.local /Value \n       /DisplayValue \n     /DisplayValues \n   /ComboBox  /Input  Note:   The display values for combo box, radio button, and multi-combo box, can be localized, for example, the following model is taken from the Test Forms sample:  new\n{\n    multiComboValues = new Dictionary string, string \n            {\n                {@ TestForms:ComboDisplayTextOne , @ Value1 },\n                {@ TestForms:ComboDisplayTextTwo , @ Value2 },\n                {@ TestForms:ComboDisplayTextThree , @ Value3 }\n            }\n}", 
            "title": "InputComboBox"
        }, 
        {
            "location": "/authentication-form-generation/#inputradiobutton", 
            "text": "string InputRadioButton(string displayItemsValueName, string initialSelectionValueName = null,\n                        string assistiveTextKey = null)  Create a combo-box  Input  authentication requirement fragment.  Parameters:   displayItemsValueName: The name of the dictionary of display-value pairs in the model. This is a required parameter.  initialSelectionValueName: The optional initially selected display value. The default is is to select the first value.  assistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.   Returns:   The radio button  Input  xml fragment  Example:  Model:  new\n{\n    Domains = new Dictionary string, string \n              {\n                  { @ citrix , @ citrix.com },\n                  { @ citrite , @ citrite.local }\n              },\n    InitialDomain = @ citrite.local \n}  Template:   @InputRadioButton(displayItemsValueName:  Domains ,\n                          initialSelectionValueName:  InitialDomain ,\n                          assistiveTextKey:  DomainAssistiveTextKey )  Output:  Input \n   AssistiveText Please select your domain /AssistiveText \n   RadioButton \n     InitialSelection citrite.local /InitialSelection \n     DisplayValues \n       DisplayValue \n         Display animaniacs /Display \n         Value animaniacs.net /Value \n       /DisplayValue \n       DisplayValue \n         Display citrite /Display \n         Value citrite.local /Value \n       /DisplayValue \n     /DisplayValues \n   /RadioButton  /Input", 
            "title": "InputRadioButton"
        }, 
        {
            "location": "/authentication-form-generation/#inputmulticombobox", 
            "text": "string InputMultiComboBox(string displayItemsValueName, string assistiveTextKey = null)  Create a multi-select combo-box  Input  authentication requirement fragment.  Parameters:   displayItemsValueName: The name of the dictionary of display, value and selection flag tuples in the model. This is a required parameter.  assistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.   Returns:   The multi-selection combo-box  Input  xml fragment  Example:  Model:  new\n{\n    Users = new Dictionary string, Tuple string, bool? \n                {\n                    { @ Alice , new Tuple string, bool? ( Alice , null)},\n                    { @ Bob ,  new Tuple string, bool? ( Bob , false)},\n                    { @ Eve ,  new Tuple string, bool? ( Eve , true)}\n                }\n}  Template:   @InputMultiComboBox(displayItemsValueName:  Users ,\n                            assistiveTextKey:  MultiComboBoxAssistiveTextKey )  Output:  Input \n   AssistiveText Please select who is a hacker /AssistiveText \n   MultiComboBox \n     DisplayValues \n       DisplayValue \n         Display Alice /Display \n         Value Alice /Value \n       /DisplayValue \n       DisplayValue \n         Display Bob /Display \n         Value Bob /Value \n         Select false /Select \n       /DisplayValue \n       DisplayValue \n         Display Eve /Display \n         Value Eve /Value \n         Select true /Select \n       /DisplayValue \n     /DisplayValues \n   /MultiComboBox  /Input", 
            "title": "InputMultiComboBox"
        }, 
        {
            "location": "/authentication-form-generation/#inputcheckbox", 
            "text": "string InputCheckBox(bool? initiallyChecked=null, string assistiveTextKey = null)  Create a check box  Input  authentication requirement fragment.  Parameters:   initiallyChecked: The optional value to set whether the check box is initially checked. If the value is null, which is the default, then the optional   InitialValue   element is not included.  assistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.   Returns:   The check box  Input  xml fragment  Example:  Template:   @InputCheckBox(initiallyChecked: true,\n                       assistiveTextKey:  CheckBoxAssistiveTextKey )  Output:  Input \n   AssistiveText Check box assistive text /AssistiveText \n   CheckBox \n     InitialValue true /InitialValue \n   / CheckBox   /Input", 
            "title": "InputCheckBox"
        }, 
        {
            "location": "/authentication-form-generation/#inputtextbox", 
            "text": "string InputTextBox(string assistiveTextKey = null, string initialValueName = null,\n                    string constraint = TextBox.DefaultConstraint, bool? secret = null,\n                    bool? readOnly = null)  Create a text-based  Input  authentication requirement fragment.  Parameters:   initialValueName: The optional name of the model value that contains the initial value of the text box. Note that this is a raw string not a key to be localized. The default is not to have an initial value.  constraint: The optional, and unused, regular expression for the text to be entered.  secret: If true then the text typed by the user should be obscured. This parameter is optional. If the value is null, which is the default, then the optional   element is not included.  readOnly: This optional parameter makes the initial text value read-only. If the value is null, which is the default, then the optional   element is not included.  assistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.   Returns:   The text  Input  xml fragment  Example:  Template: @InputTextBox(secret: true,\n                      assistiveTextKey:  PasswordAssistiveTextKey )  Output:  Input \n   AssistiveText Please enter your password /AssistiveText \n   Text \n     Secret true /Secret \n     Constraint .+ /Constraint \n   /Text  /Input", 
            "title": "InputTextBox"
        }, 
        {
            "location": "/authentication-form-generation/#high-level-api", 
            "text": "The high level API is also focused on the authentication requirements, but creates a complete requirement, including the  Credential ,  Label , and  Input  values. These methods provide a higher-level abstraction and ensure that the authentication requirements produced are internally consistent. For this reason, it is recommended that these methods should be used where possible.  In cases where there are many arguments, defaults are provided where possible, and it is expected that Parameters are specified by name for ease of use.", 
            "title": "High Level API"
        }, 
        {
            "location": "/authentication-form-generation/#controlheaders", 
            "text": "string ControlHeaders(string status, string result, string stateContext = null,\n                      string logMessageKey = null)  Create the control header fragment.  Parameters: \n- status: The authentication status (see the Receiver Common Authentication Forms Language document). This parameter is required.\n- result: The authentication result (see the Receiver Common Authentication Forms Language document). This parameter is required.\n- stateContext: The optional state context. The default is an empty state context.\n- logMessage: This optional parameter is a key to a localized message to be logged by the client. The default is to not include the optional   element.  Returns: The control xml fragment  Example:  Template: @ControlHeaders(status: StatusSuccess, result: ResultMoreInfo, stateContext: \"0x12345678\")  Output:  Status success /Status  Result more-info /Result  StateContext 0x12345678 /StateContext", 
            "title": "ControlHeaders"
        }, 
        {
            "location": "/authentication-form-generation/#textbox", 
            "text": "string Textbox(string type, string id = null, string saveId = null, string assistiveTextKey = null,\n               string labelKey = null, Label.LabelType labelType = Label.LabelType.plain,\n               string initialValueName = null, string constraint = TextBox.DefaultConstraint,\n               bool? secret = null, bool? readOnly = null)  Create a general text box authentication requirement fragment.  Parameters:   type: The type of the associated credential (see the Receiver Common Authentication Forms Language document). This parameter is required.  id: The optional credential identifier. If not specified, then the option   element is not included.  saveId: The optional identifier to be used to save this credential on a client. The default is to have no save identifier.  assistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.  labelKey: The localization key for the label. This parameter is required.  labelType: The optional label type (see the Receiver Common Authentication Forms Language document for more information). The default label type is: plain  initialValueName: The optional name of a model value that contains the initial value of the text box. Note that this is a raw string not a key to be localized. The default is not to have an initial value.  constraint: The optional, and unused, regular expression for the text to be entered.  secret: If true then the text typed by the user should be obscured. This parameter is optional. If the value is null, which is the default, then the optional   element is not included.  readOnly: This optional parameter makes the initial text value read-only. If the value is null, which is the default, then the optional   element is not included.   Returns:   The text box authentication requirement XML fragment  Example:  Template:  @Textbox(type:  username , id: UsernameID , saveId:  SaveUsernameID ,\n         labelKey:  Test:UsernameLabelKey ,\n         assistiveTextKey:  Test:UsernameAssistiveTextKey )  Output:  Requirement \n   Credential \n     ID UsernameID /ID \n     SaveID SaveUsernameID /SaveID \n     Type username /Type \n   /Credential \n   Label \n     Text User name: /Text \n     Type plain /Type \n   /Label \n   Input \n     AssistiveText domain\\user or user@domain.com /AssistiveText \n     Text \n       Constraint .+ /Constraint \n     /Text \n   /Input  /Requirement", 
            "title": "Textbox"
        }, 
        {
            "location": "/authentication-form-generation/#passwordtextbox", 
            "text": "string PasswordTextBox(string id = null, string saveId = null, string assistiveTextKey = null,\n                       string labelKey = null, Label.LabelType labelType = Label.LabelType.plain,\n                       string initialValueName = null,\n                       string constraint = TextBox.DefaultConstraint, bool? readOnly = false)  Create a password text box authentication requirement fragment.  Parameters:   id: The optional credential identifier. If not specified, then the option   element is not included.  saveId: The optional identifier to be used to save this credential on a client. The default is to have no save identifier.  assistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.  labelKey: The localization key for the label. This parameter is required.  labelType: The optional label type (see the Receiver Common Authentication Forms Language document for more information). The default label type is: plain  initialValueName: The optional name of a model value that contains the initial value of the text box. Note that this is a raw string not a key to be localized. The default is not to have an initial value.  constraint: The optional, and unused, regular expression for the text to be entered.  readOnly: This optional parameter makes the initial text value read-only. If the value is null, which is the default, then the optional   element is not included.   Returns:   The password text box authentication requirement XML fragment  Example:  Template:  @PasswordTextBox(id:\"PasswordID\", saveId: \"SavePasswordID\", labelKey: \"Test:PasswordLabelKey\")  Output:  Requirement \n   Credential \n     ID PasswordID /ID \n     SaveID SavePasswordID /SaveID \n     Type password /Type \n   /Credential \n   Label \n     Text Password: /Text \n     Type plain /Type \n   /Label \n   Input \n     Text \n       Secret true /Secret \n       ReadOnly false /ReadOnly \n       Constraint .+ /Constraint \n     /Text \n   /Input  /Requirement", 
            "title": "PasswordTextBox"
        }, 
        {
            "location": "/authentication-form-generation/#usernametextbox", 
            "text": "string UsernameTextBox(string id = null, string saveId = null, string assistiveTextKey = null,\n                       string labelKey = null, Label.LabelType labelType = Label.LabelType.plain,\n                       string initialValueName = null,\n                       string constraint = TextBox.DefaultConstraint, bool? secret = null,\n                       bool? readOnly = null)  Create a user name text box authentication requirement fragment.  Parameters:   id: The optional credential identifier. If not specified, then the option   element is not included.  saveId: The optional identifier to be used to save this credential on a client. The default is to have no save identifier.  assistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.  labelKey: The localization key for the label. This parameter is required.  labelType: The optional label type (see the Receiver Common Authentication Forms Language document for more information). The default label type is: plain  initialValueName: The optional name of a model value that contains the initial value of the text box. Note that this is a raw string not a key to be localized. The default is not to have an initial value.  constraint: The optional, and unused, regular expression for the text to be entered.  secret: If true then the text typed by the user should be obscured. This parameter is optional. If the value is null, which is the default, then the optional   element is not included.  readOnly: This optional parameter makes the initial text value read-only. If the value is null, which is the default, then the optional   element is not included.   Returns: The user name text box authentication requirement XML fragment  Example:  Template:  @UsernameTextBox(id: UsernameID , saveId:  SaveUsernameID , labelKey:  Test:UsernameLabelKey ,\n                 assistiveTextKey:  Test:UsernameAssistiveTextKey )  Output:  Requirement \n   Credential \n     ID UsernameID /ID \n     SaveID SaveUsernameID /SaveID \n     Type username /Type \n   /Credential \n   Label \n     Text User name: /Text \n     Type plain /Type \n   /Label \n   Input \n     AssistiveText domain\\user or user@domain.com /AssistiveText \n     Text \n       Constraint .+ /Constraint \n     /Text \n   /Input  /Requirement", 
            "title": "UsernameTextBox"
        }, 
        {
            "location": "/authentication-form-generation/#newpasswordtextbox", 
            "text": "string NewPasswordTextBox(string id = null, string saveId = null, string assistiveTextKey = null,\n                          string labelKey = null,Label.LabelType labelType = Label.LabelType.plain,\n                          string initialValueName = null,\n                          string constraint = TextBox.DefaultConstraint, bool? secret = null,\n                          bool? readOnly = null)  Create a new password text box authentication requirement fragment.  Parameters:   id: The optional credential identifier. If not specified, then the option   element is not included.  saveId: The optional identifier to be used to save this credential on a client. The default is to have no save identifier.  assistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.  labelKey: The localization key for the label. This parameter is required.  labelType: The optional label type (see the Receiver Common Authentication Forms Language document for more information). The default label type is: plain  initialValueName: The optional name of a model value that contains the initial value of the text box. Note that this is a raw string not a key to be localized. The default is not to have an initial value.  constraint: The optional, and unused, regular expression for the text to be entered.  secret: If true then the text typed by the user should be obscured. This parameter is optional. If the value is null, which is the default, then the optional   element is not included.  readOnly: This optional parameter makes the initial text value read-only. If the value is null, which is the default, then the optional   element is not included.   Returns:   The new password text box authentication requirement xml fragment  Example:  Template:  @NewPasswordTextBox(id: NewPasswordID , saveId:  SavePasswordID , \n                    labelKey: Test:NewPasswordLabelKey ,\n                    assistiveTextKey:  Test:NewPasswordAssisitiveTextKey )  Output:  Requirement \n   Credential \n     ID NewPasswordID /ID \n     SaveID SavePasswordID /SaveID \n     Type newpassword /Type \n   /Credential \n   Label \n     Text Password: /Text \n     Type plain /Type \n   /Label \n   Input \n     AssistiveText Must meet complexity requirements /AssistiveText \n     Text \n       Secret true /Secret \n       Constraint .+ /Constraint \n     /Text \n   /Input  /Requirement", 
            "title": "NewPasswordTextBox"
        }, 
        {
            "location": "/authentication-form-generation/#passcodetextbox", 
            "text": "string PasscodeTextBox(string id = null, string assistiveTextKey = null, string labelKey = null,\n                       Label.LabelType labelType = Label.LabelType.plain,\n                       string constraint = TextBox.DefaultConstraint)  Create a passcode text box authentication requirement fragment.  Parameters:   id: The optional credential identifier. If not specified, then the option   element is not included.  assistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.  labelKey: The localization key for the label. This parameter is required.  labelType: The optional label type (see the Receiver Common Authentication Forms Language document for more information). The default label type is: plain  constraint: The optional, and unused, regular expression for the text to be entered.   Returns:   The passcode text box authentication requirement xml fragment  Example:  Template:  @PasscodeTextBox(id: PasscodeID , labelKey:  Test:PasscodeLabelKey ,\n                 assistiveTextKey:  Test:PasscodeAssisitiveTextKey )  Output:  Requirement \n   Credential \n     ID PasscodeID /ID \n     Type passcode /Type \n   /Credential \n   Label \n     Text Passcode: /Text \n     Type plain /Type \n   /Label \n   Input \n     AssistiveText PIN and token /AssistiveText \n     Text \n       Secret true /Secret \n       Constraint .+ /Constraint \n     /Text \n   /Input  /Requirement", 
            "title": "PasscodeTextBox"
        }, 
        {
            "location": "/authentication-form-generation/#image", 
            "text": "string Image(string imageKey)  Create an image label authentication requirement fragment with no associated input.  Parameters:   imageKey: The image key, i.e. the file name in the Templates directory. This is a required parameter.   Returns:   The image label authentication requirement XML fragment  Example:  Template:  @Image( citrix_logo.gif )\nOutput: Requirement \n   Credential \n     Type none /Type \n   /Credential \n   Label \n     Binary data:image/gif;base64,R0lGODlhXAAkAEAAACH5BAAAAA\u2026+l105A7NZ1PAQEAOw== /Binary \n     Type image /Type \n   /Label \n   Input /  /Requirement", 
            "title": "Image"
        }, 
        {
            "location": "/authentication-form-generation/#text", 
            "text": "string Text(string textKey)  Create a text label authentication requirement fragment with no associated input, in the plain style.  Parameters: \n- textKey: The text localization key. This is a required parameter.  Returns:   The text label authentication requirement xml fragment  Example:  Template:  @Text( Test:PlainKey )\nOutput: Requirement \n   Credential \n     Type none /Type \n   /Credential \n   Label \n     Text This is plain text. /Text \n     Type plain /Type \n   /Label \n   Input /  /Requirement", 
            "title": "Text"
        }, 
        {
            "location": "/authentication-form-generation/#heading", 
            "text": "string Heading(string headingKey)  Create a heading text label authentication requirement fragment with no associated input.  Parameters:   headingKey: The text localization key. This is a required parameter.   Returns:   The heading text label authentication requirement XML fragment  Example:  Template:  @Heading(\"Test:HeadingKey\")  Output:  Requirement \n   Credential \n     Type none /Type \n   /Credential \n   Label \n     Text This is a heading. /Text \n     Type heading /Type \n   /Label \n   Input /  /Requirement", 
            "title": "Heading"
        }, 
        {
            "location": "/authentication-form-generation/#information", 
            "text": "string Information(string informationKey)  Create an information text label authentication requirement fragment with no associated input.  Parameters:   informationKey: The text localization key. This is a required parameter.   Returns:   The information text label authentication requirement XML fragment  Example:  Template:  @Information( Test:InformationKey )\nOutput: Requirement \n   Credential \n     Type none /Type \n   /Credential \n   Label \n     Text This is an information item. /Text \n     Type information /Type \n   /Label \n   Input /  /Requirement", 
            "title": "Information"
        }, 
        {
            "location": "/authentication-form-generation/#warning", 
            "text": "string Warning(string warningKey)  Create a warning text label authentication requirement fragment with no associated input.  Parameters:   warningKey: The text localization key. This is a required parameter.   Returns:   The warning text label authentication requirement XML fragment  Example:  Template:  @Warning( Test:WarningKey )\nOutput: Requirement \n   Credential \n     Type none /Type \n   /Credential \n   Label \n     Text This is a warning. /Text \n     Type warning /Type \n   /Label \n   Input /  /Requirement", 
            "title": "Warning"
        }, 
        {
            "location": "/authentication-form-generation/#error", 
            "text": "string Error(string errorKey)  Create an error text label authentication requirement fragment with no associated input.  Parameters:   errorKey: The text localization key. This is a required parameter.   Returns:   The error text label authentication requirement XML fragment  Example:  Template:  @Error( Test:ErrorKey )\nOutput: Requirement \n   Credential \n     Type none /Type \n   /Credential \n   Label \n     Text This is an error. /Text \n     Type error /Type \n   /Label \n   Input /  /Requirement", 
            "title": "Error"
        }, 
        {
            "location": "/authentication-form-generation/#confirmation", 
            "text": "string Confirmation(string confirmationKey)  Create a confirmation text label authentication requirement fragment with no associated input.  Parameters: \n- confirmationKey: The text localization key. This is a required parameter.  Returns: The confirmation text label authentication requirement XML fragment  Example:  Template:  @Confirmation( Test:ConfirmationKey )\nOutput: Requirement \n   Credential \n     Type none /Type \n   /Credential \n   Label \n     Text This is a confirmation. /Text \n     Type confirmation /Type \n   /Label \n   Input /  /Requirement", 
            "title": "Confirmation"
        }, 
        {
            "location": "/authentication-form-generation/#infomessages", 
            "text": "string InfoMessages()  Create a fragment that represents the list of all information label authentication requirements generated in the form.  Parameters:    None  Returns:   All the information label authentication requirements as an XML fragment  Example:  Form:  TemplateEngine.RenderTemplate(FormName, Cultures, Values,\n            new[]\n            {\n                new FormsMessage\n                    {\n                        LocalisationKey = PasswordExpiredLocalisationKey,\n                        MessageType = Label.LabelType.information\n                    }\n            })  Template:  @InfoMessages()\nOutput: Requirement \n   Credential \n     Type none /Type \n   /Credential \n   Label \n     Text Your password has expired and must be changed. /Text \n     Type information /Type \n   /Label \n   Input / \n  /Requirement", 
            "title": "InfoMessages"
        }, 
        {
            "location": "/authentication-form-generation/#warningmessages", 
            "text": "string WarningMessages()  Create a fragment that represents the list of all warning label authentication requirements generated in the form.  Parameters:    None  Returns:   All the warning label authentication requirements as an XML fragment  Example:  Form:  TemplateEngine.RenderTemplate(FormName, Cultures, Values,\n            new[]\n            {\n                new FormsMessage\n                    {\n                        LocalisationKey = WarningLocalizationKey,\n                        MessageType = Label.LabelType.warning\n                    }\n            })  Template:  @WarningMessages()\nOutput: Requirement \n   Credential \n     Type none /Type \n   /Credential \n   Label \n     Text This is a warning message. /Text \n     Type warning /Type \n   /Label \n   Input / \n  /Requirement", 
            "title": "WarningMessages"
        }, 
        {
            "location": "/authentication-form-generation/#errormessages", 
            "text": "string ErrorMessages()  Create a fragment that represents the list of all error label authentication requirements generated in the form.  Parameters:    None  Returns:   All the error label authentication requirements as an XML fragment  Example:  Form:  TemplateEngine.RenderTemplate(FormName, Cultures, Values,\n            new[]\n            {\n                new FormsMessage\n                    {\n                        LocalisationKey = ErrorLocalizationKey,\n                        MessageType = Label.LabelType.error\n                    }\n            })  Template:  @ErrorMessages()\nOutput: Requirement \n   Credential \n     Type none /Type \n   /Credential \n   Label \n     Text This is an error message. /Text \n     Type error /Type \n   /Label \n   Input / \n  /Requirement", 
            "title": "ErrorMessages"
        }, 
        {
            "location": "/authentication-form-generation/#button", 
            "text": "string Button(string id, string buttonKey, string assistiveTextKey = null)  Create a button authentication requirement fragment.  Parameters:   id: The button identifier. This is a required parameter.  buttonKey: The localization key for the button text. This is a required parameter.  assistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.   Returns: The button authentication requirement XML fragment  Example:  Template:  @Button(id:\"loginBtn\", buttonKey: \"LogonButtonKey\")  Output:  Requirement \n   Credential \n     ID loginBtn /ID \n     Type none /Type \n   /Credential \n   Label \n     Type none /Type \n   /Label \n   Input \n     Button Log On /Button \n   /Input  /Requirement", 
            "title": "Button"
        }, 
        {
            "location": "/authentication-form-generation/#savecredential", 
            "text": "string SaveCredential(string id, string assistiveTextKey = null, string labelKey = null,\n                      Label.LabelType labelType = Label.LabelType.plain,\n                      bool? initiallyChecked = null)  Create a save credential requirement fragment.  Parameters:   id: The optional credential identifier. If not specified, then the option   element is not included.  assistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.  labelKey: The localization key for the label. This parameter is required.  labelType: The optional label type (see the Receiver Common Authentication Forms Language document for more information). The default label type is: plain  initiallyChecked: The optional value to set whether the associated check box is initially checked. If the value is null, which is the default, then the optional   InitialValue   element is not included.   Returns:   The save credential authentication requirement XML fragment  Example:  Template:  @SaveCredential(id: SaveCredentialID , labelKey:  Test:SaveCredentialKey ,\n                assistiveTextKey:  SaveCredentialAssistiveTextKey , initiallyChecked: true)  Output:  Requirement \n   Credential \n     ID SaveCredentialID /ID \n     Type savecredentials /Type \n   /Credential \n   Label \n     Text Remember my password /Text \n     Type plain /Type \n   /Label \n   Input \n     AssistiveText Save your credentials locally /AssistiveText \n     CheckBox \n       InitialValue true /InitialValue \n     /CheckBox \n   /Input  /Requirement", 
            "title": "SaveCredential"
        }, 
        {
            "location": "/authentication-form-generation/#domaincombobox", 
            "text": "string DomainComboBox(string id, string displayItemsValueName,\n                      string initialSelectionValueName = null, string saveId = null,\n                      string assistiveTextKey = null, string labelKey = null,\n                      Label.LabelType labelType = Label.LabelType.plain)  Create a combo box authentication requirement fragment for domains.  Parameters:   id: The optional credential identifier. If not specified, then the option   element is not included.  displayItemsValueName: The name of the dictionary of display-value pairs in the model. This is a required parameter.  initialSelectionValueName: The optional initially selected display value. The default is to select the first value.  saveId: The optional identifier to be used to save this credential on a client. The default is to have no save identifier.  assistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.  labelKey: The localization key for the label. This parameter is required.  labelType: The optional label type (see the Receiver Common Authentication Forms Language document for more information). The default label type is: plain   Returns:   The domain combo box authentication requirement XML fragment  Example:  Model:  new\n{\n    Domains = new Dictionary string, string \n              {\n                  { @ citrix , @ citrix.com },\n                  { @ citrite , @ citrite.local }\n              },\n    InitialDomain = @ citrite.local \n}  Template:  @DomainComboBox(id: DomainID , displayItemsValueName:  Domains ,\n                initialSelectionValueName:  InitialDomain , saveId:  SaveDomainID ,\n                labelKey:  Test:DomainKey ,\n                assistiveTextKey:  Test:DomainComboBoxAssistiveTextKey )  Output:  Requirement \n   Credential \n     ID DomainID /ID \n     SaveID SaveDomainID /SaveID \n     Type domain /Type \n   /Credential \n   Label \n     Text Domain: /Text \n     Type plain /Type \n   /Label \n   Input \n     AssistiveText Please select your domain /AssistiveText \n     ComboBox \n       InitialSelection citrite.local /InitialSelection \n       DisplayValues \n         DisplayValue \n           Display citrix /Display \n           Value citrix.com /Value \n         /DisplayValue \n         DisplayValue \n           Display citrite /Display \n           Value citrite.local /Value \n         /DisplayValue \n       /DisplayValues \n     /ComboBox \n   /Input  /Requirement", 
            "title": "DomainComboBox"
        }, 
        {
            "location": "/authentication-form-generation/#domaintextbox", 
            "text": "string DomainTextBox(string id = null, string saveId = null, string assistiveTextKey = null,\n                     string labelKey = null, Label.LabelType labelType = Label.LabelType.plain,\n                     string initialValueName = null,\n                     string constraint = TextBox.DefaultConstraint, bool? secret = null,\n                     bool? readOnly = null)  Create a text box authentication requirement fragment for domains.  Parameters:   id: The optional credential identifier. If not specified, then the option   element is not included.  saveId: The optional identifier to be used to save this credential on a client. The default is to have no save identifier.  assistiveTextKey: The optional localization key for the assistive text. The default is to have no assistive text.  labelKey: The localization key for the label. This parameter is required.  labelType: The optional label type (see the Receiver Common Authentication Forms Language document for more information). The default label type is: plain  initialValueName: The optional name of a model value that contains the initial value of the text box. Note that this is a raw string not a key to be localized. The default is not to have an initial value.  constraint: The optional, and unused, regular expression for the text to be entered.  secret: If true then the text typed by the user should be obscured. This parameter is optional. If the value is null, which is the default, then the optional   element is not included.  readOnly: This optional parameter makes the initial text value read-only. If the value is null, which is the default, then the optional   element is not included.   Returns:   The domain text box authentication requirement XML fragment  Example:  Template:  @DomainTextBox(id: DomainID , saveId:  SaveDomainID , labelKey:  Test:DomainKey ,\n               assistiveTextKey:  Test:DomainTextBoxAssistiveTextKey )  Output:  Requirement \n   Credential \n     ID DomainID /ID \n     SaveID SaveDomainID /SaveID \n     Type domain /Type \n   /Credential \n   Label \n     Text Domain: /Text \n     Type plain /Type \n   /Label \n   Input \n     AssistiveText Please supply your domain /AssistiveText \n       Text \n         InitialValue /InitialValue \n         Constraint .+ /Constraint \n       /Text \n   /Input  /Requirement", 
            "title": "DomainTextBox"
        }, 
        {
            "location": "/authentication-form-generation/#appendix-a-event-log-entries", 
            "text": "If there are issues with the template processing, the Forms Template Engine adds events to the event log at the following location, with Task Category 1170:  Event Viewer   Applications and Services Logs   Citrix Delivery Services  The following examples illustrate the errors that can be produced.", 
            "title": "Appendix A: Event Log Entries"
        }, 
        {
            "location": "/authentication-form-generation/#razor-template-error-event-id-1", 
            "text": "There was a Razor compilation error of a template named UsernamePassword with contents:  ?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/response/1 \n@* \u00a92014 Citrix Systems, Inc.   All rights reserved. *@\n@foreach\n@ControlHeaders(status: StatusSuccess, result: ResultMoreInfo, stateContext: GetValue( StateContext ))\n   AuthenticationRequirements \n     PostBack @GetTextValue( PostBackUrl ) /PostBack \n     CancelPostBack @GetTextValue( CancelPostBackUrl ) /CancelPostBack \n     CancelButtonText @GetLocalisedTextValue( ExplicitFormsCommon:CancelButtonText ) /CancelButtonText \n     Requirements \n      @* @Heading( ExplicitAuth:AuthenticateHeadingText ) *@\n      @InfoMessages()\n      @WarningMessages()\n      @UsernameTextBox(id: @GetTextValue( usernameId ), saveId: @GetTextValue( usernameSaveId ), labelKey:  ExplicitFormsCommon:UsernameLabel , initialValueName:  InitialUsername , assistiveTextKey: @GetTextValue( AssistiveTextValue ), secret: false, readOnly: false)\n      @PasswordTextBox(id: @GetTextValue( passwordId ), saveId: @GetTextValue( passwordSaveId ), labelKey:  ExplicitFormsCommon:PasswordLabel , initialValueName:  dummy , readOnly: false)\n      @if (ControlValue( DisplayDomainText )) {\n      @DomainTextBox(id: @GetTextValue( domainId ), saveId: @GetTextValue( domainSaveId ), labelKey:  ExplicitFormsCommon:DomainLabel , readOnly: false)\n      } else if (ControlValue( DisplayDomainCombo )) {\n      @DomainComboBox(id: @GetTextValue( domainId ), saveId: @GetTextValue( domainSaveId ), displayItemsValueName:  DomainValues , initialSelectionValueName:  InitialDomain , labelKey:  ExplicitFormsCommon:DomainLabel )\n      }\n      @SaveCredential(id: @GetTextValue( saveCredentialsId ), labelKey:  ExplicitFormsCommon:SaveCredentialsLabel , initiallyChecked: ControlValue( SaveCredentials ))\n      @ErrorMessages()\n      @Button(id: @GetTextValue( loginButtonId ), buttonKey:  ExplicitFormsCommon:LoginButtonText )\n     /Requirements \n   /AuthenticationRequirements  /AuthenticateResponse  Errors:  Expected a  {  but found a  @ .  Block statements must be enclosed in  {  and  } .  You cannot use single-statement control-flow statements in CSHTML pages. For example, the following is not allowed:\n\n@if(isLoggedIn)\n     p Hello, @user /p  Instead, wrap the contents of the block in \"{}\":  @if(isLoggedIn) {\n     p Hello, @user /p \n} at line:(183:4,0)", 
            "title": "Razor Template Error: Event Id 1"
        }, 
        {
            "location": "/authentication-form-generation/#c-compilation-error-event-id-2", 
            "text": "There was a C# compilation error of a template named UsernamePassword with contents:  ?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/response/1 \n@* \u00a92014 Citrix Systems, Inc.   All rights reserved. *@\n@ControlHeaders(status: StatusSuccess, result: ResultMoreInfo, stateContext: GetValue( StateContext ))\n   AuthenticationRequirements \n     PostBack @GetTextValue2( PostBackUrl ) /PostBack \n     CancelPostBack @GetTextValue( CancelPostBackUrl ) /CancelPostBack \n     CancelButtonText @GetLocalisedTextValue( ExplicitFormsCommon:CancelButtonText ) /CancelButtonText \n     Requirements \n      @* @Heading( ExplicitAuth:AuthenticateHeadingText ) *@\n      @InfoMessages()\n      @WarningMessages()\n      @UsernameTextBox(id: @GetTextValue( usernameId ), saveId: @GetTextValue( usernameSaveId ), labelKey:  ExplicitFormsCommon:UsernameLabel , initialValueName:  InitialUsername , assistiveTextKey: @GetTextValue( AssistiveTextValue ), secret: false, readOnly: false)\n      @PasswordTextBox(id: @GetTextValue( passwordId ), saveId: @GetTextValue( passwordSaveId ), labelKey:  ExplicitFormsCommon:PasswordLabel , initialValueName:  dummy , readOnly: false)\n      @if (ControlValue( DisplayDomainText )) {\n      @DomainTextBox(id: @GetTextValue( domainId ), saveId: @GetTextValue( domainSaveId ), labelKey:  ExplicitFormsCommon:DomainLabel , readOnly: false)\n      } else if (ControlValue( DisplayDomainCombo )) {\n      @DomainComboBox(id: @GetTextValue( domainId ), saveId: @GetTextValue( domainSaveId ), displayItemsValueName:  DomainValues , initialSelectionValueName:  InitialDomain , labelKey:  ExplicitFormsCommon:DomainLabel )\n      }\n      @SaveCredential(id: @GetTextValue( saveCredentialsId ), labelKey:  ExplicitFormsCommon:SaveCredentialsLabel , initiallyChecked: ControlValue( SaveCredentials ))\n      @ErrorMessages()\n      @Button(id: @GetTextValue( loginButtonId ), buttonKey:  ExplicitFormsCommon:LoginButtonText )\n     /Requirements \n   /AuthenticationRequirements  /AuthenticateResponse  Source Code:  //------------------------------------------------------------------------------\n//  auto-generated \n//     This code was generated by a tool.\n//     Runtime Version:4.0.30319.18449\n//\n//     Changes to this file may cause incorrect behavior and will be lost if\n//     the code is regenerated.\n//  /auto-generated \n//------------------------------------------------------------------------------\n\nnamespace Citrix.CompiledForms {\n    using System;\n    using Citrix.DeliveryServices.Authentication.Forms.Template.Requirements;\n    using Citrix.DeliveryServices.Authentication.Forms.Template;    \n\n    public class UsernamePassword : Citrix.DeliveryServices.Authentication.Forms.Template.FormsTemplateBase {\n\n#line hidden\n\n        public UsernamePassword() {\n        }\n\n        public override void Execute() {\nWriteLiteral( ?xml version=\\ 1.0\\  encoding=\\ UTF-8\\ ? \\r\\n AuthenticateResponse );\n\nWriteLiteral(  xmlns=\\ http://citrix.com/authentication/response/1\\ );\nWriteLiteral( \\r\\n );\nWriteLiteral( \\r\\n );\n\n            #line 4  UsernamePassword.tfrm \nWrite(ControlHeaders(status: StatusSuccess, result: ResultMoreInfo, stateContext: GetValue( StateContext )));\n\n            #line default\n            #line hidden\nWriteLiteral( \\r\\n   AuthenticationRequirements \\r\\n     PostBack );\n\n            #line 6  UsernamePassword.tfrm \n         Write(GetTextValue2( PostBackUrl ));\n\n            #line default\n            #line hidden\nWriteLiteral( /PostBack \\r\\n     CancelPostBack );\n\n            #line 7  UsernamePassword.tfrm \n               Write(GetTextValue( CancelPostBackUrl ));\n\n            #line default\n            #line hidden\nWriteLiteral( /CancelPostBack \\r\\n     CancelButtonText );\n\n            #line 8  UsernamePassword.tfrm \n                 Write(GetLocalisedTextValue( ExplicitFormsCommon:CancelButtonText ));\n\n            #line default\n            #line hidden\nWriteLiteral( /CancelButtonText \\r\\n     Requirements \\r\\n       );\nWriteLiteral( \\r\\n );\nWriteLiteral(        );\n\n            #line 11  UsernamePassword.tfrm \n Write(InfoMessages());\n\n\n            #line default\n            #line hidden\nWriteLiteral( \\r\\n );\nWriteLiteral(        );\n\n            #line 12  UsernamePassword.tfrm \nWrite(WarningMessages());\n\n            #line default\n            #line hidden\nWriteLiteral( \\r\\n );\nWriteLiteral(        );\n\n            #line 13  UsernamePassword.tfrm \nWrite(UsernameTextBox(id: @GetTextValue( usernameId ), saveId: @GetTextValue( usernameSaveId ), labelKey:  ExplicitFormsCommon:UsernameLabel , initialValueName:  InitialUsername , assistiveTextKey: @GetTextValue( AssistiveTextValue ), secret: false, readOnly: false));\n\n            #line default\n            #line hidden\nWriteLiteral( \\r\\n );\nWriteLiteral(        );\n\n            #line 14  UsernamePassword.tfrm \nWrite(PasswordTextBox(id: @GetTextValue( passwordId ), saveId: @GetTextValue( passwordSaveId ), labelKey:  ExplicitFormsCommon:PasswordLabel , initialValueName:  dummy , readOnly: false));\n\n            #line default\n            #line hidden\nWriteLiteral( \\r\\n );\n\n            #line 15  UsernamePassword.tfrm \n\n            #line default\n            #line hidden\n\n            #line 15  UsernamePassword.tfrm \n       if (ControlValue( DisplayDomainText )) {\n\n            #line default\n            #line hidden\n\n            #line 16  UsernamePassword.tfrm \nWrite(DomainTextBox(id: @GetTextValue( domainId ), saveId: @GetTextValue( domainSaveId ), labelKey:  ExplicitFormsCommon:DomainLabel , readOnly: false));\n\n            #line default\n            #line hidden\n\n            #line 16  UsernamePassword.tfrm \n\n      } else if (ControlValue( DisplayDomainCombo )) {    \n\n            #line default\n            #line hidden\n\n            #line 18  UsernamePassword.tfrm \nWrite(DomainComboBox(id: @GetTextValue( domainId ), saveId: @GetTextValue( domainSaveId ), displayItemsValueName:  DomainValues , initialSelectionValueName:  InitialDomain , labelKey:  ExplicitFormsCommon:DomainLabel ));\n\n            #line default\n            #line hidden\n\n            #line 18  UsernamePassword.tfrm \n\n      }\n\n            #line default\n            #line hidden\nWriteLiteral(        );\n\n            #line 20  UsernamePassword.tfrm \nWrite(SaveCredential(id: @GetTextValue( saveCredentialsId ), labelKey:  ExplicitFormsCommon:SaveCredentialsLabel , initiallyChecked: ControlValue( SaveCredentials )));\n\n            #line default\n            #line hidden\nWriteLiteral( \\r\\n );\nWriteLiteral(        );\n\n            #line 21  UsernamePassword.tfrm \nWrite(ErrorMessages());\n\n            #line default\n            #line hidden\nWriteLiteral( \\r\\n );\nWriteLiteral(        );\n\n\n            #line 22  UsernamePassword.tfrm \nWrite(Button(id: @GetTextValue( loginButtonId ), buttonKey:  ExplicitFormsCommon:LoginButtonText ));\n\n            #line default\n            #line hidden\nWriteLiteral( \\r\\n     /Requirements \\r\\n   /AuthenticationRequirements \\r\\n /AuthenticateResponse );\n\n        }\n    }\n}  Errors:  The name 'GetTextValue2' does not exist in the current context at line:6", 
            "title": "C# Compilation Error: Event Id 2"
        }, 
        {
            "location": "/authentication-form-generation/#invalid-reciever-common-form-xml-event-id-4", 
            "text": "The Forms template generated invalid Xml:  ?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/response/1 \n\n\n\n             Requirement \n         Credential \n           ID username /ID \n           SaveID UsernamePasswordForm-Username /SaveID \n           Type username /Type \n         /Credential \n         Label \n           Text User name: /Text \n           Type plain /Type \n         /Label \n         Input \n           AssistiveText domain\\user or user@domain.com /AssistiveText \n           Text \n             Secret false /Secret \n             ReadOnly false /ReadOnly \n             InitialValue /InitialValue \n             Constraint .+ /Constraint \n           /Text \n         /Input \n       /Requirement \n             Requirement \n         Credential \n           ID password /ID \n           SaveID UsernamePasswordForm-Password /SaveID \n           Type password /Type \n         /Credential \n         Label \n           Text Password: /Text \n           Type plain /Type \n         /Label \n         Input \n           Text \n             Secret true /Secret \n             ReadOnly false /ReadOnly \n             InitialValue /InitialValue \n             Constraint .+ /Constraint \n           /Text \n         /Input \n       /Requirement \n             Requirement \n         Credential \n           ID saveCredentials /ID \n           Type savecredentials /Type \n         /Credential \n         Label \n           Text Remember my password /Text \n           Type plain /Type \n         /Label \n         Input \n           CheckBox \n             InitialValue false /InitialValue \n           /CheckBox \n         /Input \n       /Requirement \n\n             Requirement \n         Credential \n           ID loginBtn /ID \n           Type none /Type \n         /Credential \n         Label \n           Type none /Type \n         /Label \n         Input \n           Button Log On /Button \n         /Input \n       /Requirement \n     /Requirements \n   /AuthenticationRequirements  /AuthenticateResponse  System.Xml.XmlException, System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\nThe 'AuthenticateResponse' start tag on line 2 position 2 does not match the end tag of 'Requirements'. Line 73, position 7.\n   at System.Xml.XmlTextReaderImpl.Throw(String res, String[] args)\n   at System.Xml.XmlTextReaderImpl.ThrowTagMismatch(NodeData startTag)\n   at System.Xml.XmlTextReaderImpl.ParseEndElement()\n   at System.Xml.XmlTextReaderImpl.ParseElementContent()\n   at System.Xml.XmlLoader.LoadNode(Boolean skipOverWhitespace)\n   at System.Xml.XmlLoader.LoadDocSequence(XmlDocument parentDoc)\n   at System.Xml.XmlDocument.Load(XmlReader reader)\n   at System.Xml.XmlDocument.LoadXml(String xml)\n   at Citrix.DeliveryServices.Authentication.Forms.Template.FormsTemplateBase.Render(IDictionary`2 renderValues, ILocaliser localiser, IEnumerable`1 messages)", 
            "title": "Invalid Reciever Common Form Xml: Event Id 4"
        }, 
        {
            "location": "/authentication-form-generation/#appendix-b-form-template-language-examples", 
            "text": "The following templates all generate the same Receiver Common Forms XML:  ?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/response/1 \n   Status success /Status \n   Result more-info /Result \n   StateContext 0x12345678 /StateContext \n   AuthenticationRequirements \n     PostBack /Postback /PostBack \n     CancelPostBack /Cancel /CancelPostBack \n     CancelButtonText Cancel /CancelButtonText \n     Requirements \n       Requirement \n         Credential \n           ID UsernameID /ID \n           SaveID SaveUsernameID /SaveID \n           Type username /Type \n         /Credential \n         Label \n           Text User name: /Text \n           Type plain /Type \n         /Label \n         Input \n           AssistiveText domain\\user or user@domain.com /AssistiveText \n           Text \n             Constraint .+ /Constraint \n           /Text \n         /Input \n       /Requirement \n       Requirement \n         Credential \n           ID loginBtn /ID \n           Type none /Type \n         /Credential \n         Label \n           Type none /Type \n         /Label \n         Input \n           Button Log On /Button \n         /Input \n       /Requirement \n     /Requirements \n   /AuthenticationRequirements  /AuthenticateResponse", 
            "title": "Appendix B: Form Template Language Examples"
        }, 
        {
            "location": "/authentication-form-generation/#low-level-api_1", 
            "text": "?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/response/1 \n   Status success /Status \n   Result more-info /Result \n   StateContext 0x12345678 /StateContext \n   AuthenticationRequirements \n     PostBack /Postback /PostBack \n     CancelPostBack /Cancel /CancelPostBack \n     CancelButtonText @GetLocalisedTextValue( CancelButtonText ) /CancelButtonText \n     Requirements \n       Requirement \n         Credential \n           ID UsernameID /ID \n           SaveID SaveUsernameID /SaveID \n           Type username /Type \n         /Credential \n         Label \n           Text @GetLocalisedTextValue( UsernameLabelKey ) /Text \n           Type plain /Type \n         /Label \n         Input \n           AssistiveText @GetLocalisedTextValue( UsernameAssistiveTextKey ) /AssistiveText \n           Text \n             Constraint .+ /Constraint \n           /Text \n         /Input \n       /Requirement \n       Requirement \n         Credential \n           ID loginBtn /ID \n           Type none /Type \n         /Credential \n         Label \n           Type none /Type \n         /Label \n         Input \n           Button @GetLocalisedTextValue( LogonButtonKey ) /Button \n         /Input \n       /Requirement \n     /Requirements \n   /AuthenticationRequirements  /AuthenticateResponse", 
            "title": "Low Level API"
        }, 
        {
            "location": "/authentication-form-generation/#requirements-api", 
            "text": "?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/response/1 \n@ControlHeaders(status: StatusSuccess, result: ResultMoreInfo, stateContext:  0x12345678 )\n   AuthenticationRequirements \n     PostBack /Postback /PostBack \n     CancelPostBack /Cancel /CancelPostBack \n     CancelButtonText Cancel /CancelButtonText \n     Requirements \n       Requirement \n@Credential(credentialType:  username , id:  UsernameID , saveId:  SaveUsernameID )\n@TextLabel(labelKey:  UsernameLabelKey )\n@InputTextBox(assistiveTextKey:  UsernameAssistiveTextKey )\n       /Requirement \n       Requirement \n@Credential(credentialType:  none , id:  loginBtn )\n@TextLabel(labelKey: null, labelType: Label.LabelType.none)\n@InputButton(buttonKey:  LogonButtonKey )\n       /Requirement \n     /Requirements \n   /AuthenticationRequirements  /AuthenticateResponse", 
            "title": "Requirements API"
        }, 
        {
            "location": "/authentication-form-generation/#high-level-api_1", 
            "text": "?xml version= 1.0  encoding= UTF-8 ?  AuthenticateResponse xmlns= http://citrix.com/authentication/response/1 \n@ControlHeaders(status: StatusSuccess, result: ResultMoreInfo, stateContext:  0x12345678 )\n   AuthenticationRequirements \n     PostBack /Postback /PostBack \n     CancelPostBack /Cancel /CancelPostBack \n     CancelButtonText Cancel /CancelButtonText \n     Requirements \n@UsernameTextBox(id: UsernameID , saveId:  SaveUsernameID , labelKey:  UsernameLabelKey ,\n                 assistiveTextKey:  UsernameAssistiveTextKey )\n@Button(id: loginBtn , buttonKey:  LogonButtonKey )\n     /Requirements \n   /AuthenticationRequirements  /AuthenticateResponse", 
            "title": "High Level API"
        }, 
        {
            "location": "/known-issues-auth/", 
            "text": "Known Issues for Version 2.6\n\n\nThe following issues are known to exist in this release \n\n\nNot all Citrix clients correctly handle Citrix Common Forms Multi-Combo input\n\n\nNot all clients support the Citrix Common Forms Multi-Combo input and will fail a conversation if a form contains this type of input. [#496360] \n\n\nStrings in the wrong language appear in the sample installers\n\n\nSome untranslated strings appear during TestForms and MagicWord uninstallation process when SF admin console is opened [#493758]\n\n\nAuthSDK installers shows Chinese (People's Republic of China) text on Chinese (Taiwan) environment rather than English [#497560]\n\n\nReceiver for Web does not always deal correctly with Cancel and Failure cases\n\n\nSome Cancel and Failure forms result in 'Can not complete your request' message displayed in WebReceiver [#498737]\n\n\nIf an individual label is referenced more than once by a FormsMessage (information, warning, error etc) than the label is also marked with more than one '*'(star) in front of it. [#490830]", 
            "title": "Known Issues"
        }, 
        {
            "location": "/known-issues-auth/#known-issues-for-version-26", 
            "text": "The following issues are known to exist in this release   Not all Citrix clients correctly handle Citrix Common Forms Multi-Combo input  Not all clients support the Citrix Common Forms Multi-Combo input and will fail a conversation if a form contains this type of input. [#496360]   Strings in the wrong language appear in the sample installers  Some untranslated strings appear during TestForms and MagicWord uninstallation process when SF admin console is opened [#493758]  AuthSDK installers shows Chinese (People's Republic of China) text on Chinese (Taiwan) environment rather than English [#497560]  Receiver for Web does not always deal correctly with Cancel and Failure cases  Some Cancel and Failure forms result in 'Can not complete your request' message displayed in WebReceiver [#498737]  If an individual label is referenced more than once by a FormsMessage (information, warning, error etc) than the label is also marked with more than one '*'(star) in front of it. [#490830]", 
            "title": "Known Issues for Version 2.6"
        }, 
        {
            "location": "/storeFront-authentication-sdk-thirdparty/", 
            "text": "Third Party Notices\n\n\nThe Citrix StoreFront\u2122 Authentication Software Development Kit may include third party software components licensed under the following terms, in addition to those listed for the Citrix StoreFront\u2122 Product. This list was generated using third party software as of the date listed. This list may change with specific versions of the product and may not be complete; it is provided \u201cAs-Is.\u201d\n\n\nTO THE EXTENT PERMITTED BY APPLICABLE LAW, CITRIX AND ITS SUPPLIERS MAKE NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR IMPLIED, STATUTORY OR OTHERWISE, WITH REGARD TO THE LIST OR ITS ACCURACY OR COMPLETENESS, OR WITH RESPECT TO ANY RESULTS TO BE OBTAINED FROM USE OR DISTRIBUTION OF THE LIST. BY USING OR DISTRIBUTING THE LIST, YOU AGREE THAT IN NO EVENT SHALL CITRIX BE HELD LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY OTHER DAMAGES WHATSOEVER RESULTING FROM ANY USE OR DISTRIBUTION OF THIS LIST.\n\n\nMSBuildTasks\n\n\nMSBuild Community Tasks 1.4.0.61\n\n\nhttps://www.nuget.org/packages/MSBuildTasks/1.4.0.61\n\n\nLicensed under the BSD 2-Clause License\n\n\nMoq\n\n\nMoq 3.1\n\n\nCopyright (c) 2007, Moq Team \n\n\nhttp://code.google.com/p/moq/\n\n\nAll rights reserved.\n\n\nRedistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:\n\n\n\n\nRedistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.\n\n\nRedistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.\n\n\nNeither the name of the Moq Team nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.\n\n\n\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\n\nNUnit\n\n\nNUnit 2.6.2\n\n\nhttp://nunit.org/index.php?p=docHome\nr=2.6.2 \n\n\nCopyright \u00a9 2002-2012 Charlie Poole\n\n\nCopyright \u00a9 2002-2004 James W. Newkirk, Michael C. Two, Alexei A. Vorontsov\n\n\nCopyright \u00a9 2000-2002 Philip A. Craig \n\n\nThis software is provided 'as-is', without any express or implied warranty. In no event will the authors be held liable for any damages arising from the use of this software. \n\n\nPermission is granted to anyone to use this software for any purpose, including commercial applications, and to alter it and redistribute it freely, subject to the following restrictions: \n\n\n1.The origin of this software must not be misrepresented; you must not claim that you wrote the original software. If you use this software in a product, an acknowledgment (see the following) in the product documentation is required. Portions Copyright \u00a9 2002-2009 Charlie Poole or Copyright \u00a9 2002-2004 James W. Newkirk, Michael C. Two, Alexei A. Vorontsov or Copyright \u00a9 2000-2002 Philip A. Craig \n\n\n2.Altered source versions must be plainly marked as such, and must not be misrepresented as being the original software.\n\n\n3.This notice may not be removed or altered from any source distribution. \n\n\nAPPENDIX:  Referenced Licenses\n\n\nBSD 2-Clause License\n\n\nCopyright (c) \n, \n All rights reserved.\n\n\nRedistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:\n\n\n\n\n\n\nRedistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.\n\n\n\n\n\n\nRedistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.\n\n\n\n\n\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.", 
            "title": "Third Party Notices"
        }, 
        {
            "location": "/storeFront-authentication-sdk-thirdparty/#third-party-notices", 
            "text": "The Citrix StoreFront\u2122 Authentication Software Development Kit may include third party software components licensed under the following terms, in addition to those listed for the Citrix StoreFront\u2122 Product. This list was generated using third party software as of the date listed. This list may change with specific versions of the product and may not be complete; it is provided \u201cAs-Is.\u201d  TO THE EXTENT PERMITTED BY APPLICABLE LAW, CITRIX AND ITS SUPPLIERS MAKE NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR IMPLIED, STATUTORY OR OTHERWISE, WITH REGARD TO THE LIST OR ITS ACCURACY OR COMPLETENESS, OR WITH RESPECT TO ANY RESULTS TO BE OBTAINED FROM USE OR DISTRIBUTION OF THE LIST. BY USING OR DISTRIBUTING THE LIST, YOU AGREE THAT IN NO EVENT SHALL CITRIX BE HELD LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY OTHER DAMAGES WHATSOEVER RESULTING FROM ANY USE OR DISTRIBUTION OF THIS LIST.", 
            "title": "Third Party Notices"
        }, 
        {
            "location": "/storeFront-authentication-sdk-thirdparty/#msbuildtasks", 
            "text": "MSBuild Community Tasks 1.4.0.61  https://www.nuget.org/packages/MSBuildTasks/1.4.0.61  Licensed under the BSD 2-Clause License", 
            "title": "MSBuildTasks"
        }, 
        {
            "location": "/storeFront-authentication-sdk-thirdparty/#moq", 
            "text": "Moq 3.1  Copyright (c) 2007, Moq Team   http://code.google.com/p/moq/  All rights reserved.  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:   Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.  Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.  Neither the name of the Moq Team nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.", 
            "title": "Moq"
        }, 
        {
            "location": "/storeFront-authentication-sdk-thirdparty/#nunit", 
            "text": "NUnit 2.6.2  http://nunit.org/index.php?p=docHome r=2.6.2   Copyright \u00a9 2002-2012 Charlie Poole  Copyright \u00a9 2002-2004 James W. Newkirk, Michael C. Two, Alexei A. Vorontsov  Copyright \u00a9 2000-2002 Philip A. Craig   This software is provided 'as-is', without any express or implied warranty. In no event will the authors be held liable for any damages arising from the use of this software.   Permission is granted to anyone to use this software for any purpose, including commercial applications, and to alter it and redistribute it freely, subject to the following restrictions:   1.The origin of this software must not be misrepresented; you must not claim that you wrote the original software. If you use this software in a product, an acknowledgment (see the following) in the product documentation is required. Portions Copyright \u00a9 2002-2009 Charlie Poole or Copyright \u00a9 2002-2004 James W. Newkirk, Michael C. Two, Alexei A. Vorontsov or Copyright \u00a9 2000-2002 Philip A. Craig   2.Altered source versions must be plainly marked as such, and must not be misrepresented as being the original software.  3.This notice may not be removed or altered from any source distribution.", 
            "title": "NUnit"
        }, 
        {
            "location": "/storeFront-authentication-sdk-thirdparty/#appendix-referenced-licenses", 
            "text": "BSD 2-Clause License  Copyright (c)  ,   All rights reserved.  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:    Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.    Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.", 
            "title": "APPENDIX:  Referenced Licenses"
        }, 
        {
            "location": "/sample-certificate-identity-declaration/", 
            "text": "Overview\n\n\nIntroduction\n\n\nThis sample for the StoreFront Authentication SDK demonstrates how to create and add a new authentication protocol, CertificateIdentityDeclaration, to StoreFront.\nThis protocol allows a client to send a certificate to the server to identify a user, without providing proof that it has access to the associated private key. The service uses the built-in Kerberos S4U support to map this certificate to an account, verify the account, and extract the group information associated with the account. An identification-level token is then constructed that can be used to launch a session where the user has to fully authenticate to gain access.\n\n\nInstaller\n\n\nIn common with the other samples, a pre-built installer is provided in addition to the source code.\nBefore attempting to deploy the pre-built sample installers, it is required to add the certificate at AuthSDK.zip/Certificates/YourCompany.cer to the Third-Party Root Certification Authorities store of the Local Computer account where StoreFront is installed. This is not required for the development machine. If this step is not completed, then the StoreFront Administration Console will display an error because the digital signature of the PowerShell modules associated with this customization will fail to verify.\nThe installer verifies that there is not an existing customization that implements CertificateIdentityDeclaration before deploying the StoreFront Feature package and the add-ins to the administration console. To actually deploy and enable a sample the \u201cAdd/Remove Methods\u201d action from the \u201cAuthentication\u201d node of the StoreFront Administration Console should be used.\nBefore attempting to uninstall a sample, the associated authentication method must first be removed using the \u201cAdd/Remove Methods\u201d action. If this is not done, attempting to uninstall will result in a dialog informing the administrator that the feature should be removed using the StoreFront Administration Console first. The sample can then be removed by using the standard \u201cAdd/Remove Programs\u201d control panel applet.\n\n\nCode Sample\n\n\nVisual Studio Solution Layout\n\n\nThe Certificate Identity Declaration solution is composed of five projects:\n\n\n\n\nFeature contains the code that will be added to the Authentication Service to control the authentication process, including the ASP.Net MVC Controller that manages the authentication protocol.\n\n\nConsole.Extension contains the code for the administration console, including the data models, action handlers, business logic, and user interface elements.\n\n\nInstaller is a WiX project to create an msi installer to deploy and remove the Certificate Identity Declaration Feature.\n\n\nInstaller.CustomActions contains the msi custom actions required to deploy and remove the Certificate Identity Declaration Feature.\n\n\nUnitTests contains some simple unit tests to verify the merging of the code into the authentication service, and to verify the behavior of the Service Locator.\n\n\n\n\nThis sample does not require any configuration, and so does not contain a configuration project or a StoreFront Administration Console View Extension. It also requires no custom deployment steps or PowerShell commands and so does not have a Feature Installer project.\nAll the projects target the .NET Framework 4.5 and the MSIL platform, unless specifically stated. Projects that target .NET Framework 3.5 are either part of the StoreFront Administration Console, or loaded by the Console. The rationale behind this is discussed in the StoreFront Service Authentication SDK document.\n\n\nFeature Project\n\n\nThis C# class library project contains a new ASP.MVC Controller for handling the HTTP request and response. The protocol specifies a single request/response pattern that is handled by the Declare() method in the Controller, which performs the following:\n\n\n\n\nVerify that the HTTP verb is POST\n\n\nVerify that the request is an RST\n\n\nVerify that the client accepts an RSTR response\n\n\nVerify that the CertificateIdentityDeclaration protocol is enabled\n\n\nVerify that there is a token-issuing service to issue the token\n\n\nVerify that a certificate can be extracted from the required header\n\n\nUse the built-in Kerberos authenticator to validate the certificate\n\n\nOptionally, log the authentication result\n\n\nCreate and return an RSTR message\n\n\n\n\nIn addition, there are classes following the standard pattern for logging and tracing to aid with diagnostics.\n\n\nConsole.Extension Project\n\n\nThis C# class library project is responsible for:\n\n\n\n\nProviding the localized authentication method name in the StoreFront Administration Console\n\n\nProviding a single, fixed, status message in the StoreFront Administration Console\n\n\n\n\n\n\nNotes\n\n\nThis project is targeted at .NET Framework 3.5, because it will be loaded by the StoreFront Administration Console.\n\n\n\n\nInstaller Project\n\n\nThis WiX project is responsible for the following:\n- Creating the CertificateIdentityDeclaration StoreFront Feature Package\n- Creating an installer to:\n    - Deploy the Feature Package\n    - Deploy the StoreFront Administration Console extension\n    - Update the registry so that the StoreFront Administration Console will load the extension\n\n\n\n\nNotes\n\n\nThis project is targeted at the x64 platform\n\n\n\n\nInstaller.CustomActions Project\n\n\nThis C# class library project uses the standard pattern, as described in the StoreFront Authentication SDK document, with the Feature identifier and Authentication Protocol Name set to appropriate values for this customization.\n\n\n\n\nNotes\n\n\n\n\nThis project is targeted at .NET Framework 3.5.\n\n\nThis project is targeted at the x64 platform to ensure that it has access to the correct registry locations.\n\n\n\n\n\n\nUnit Tests Project\n\n\nThis project contains standard: web.config merge and unmerge, route, and protocol choice tests, in addition to tests of the protocol in terms of HTTP request and responses.\n\n\nProtocol\n\n\nThis section describes the HTTP-based protocol to use to declare a user identity with a certificate.\n\n\nEnd Point\n\n\n\n\nURL: /CertificateIdentityDeclaration\n\n\nHTTP Method: POST\n\n\nAuthentication: None\n\n\nRequest Content-Type: application/vnd.citrix.requesttoken+xml\n\n\nResponse Content-Type: application/vnd.citrix.requesttokenresponse+xml\n\n\n\n\nThe client presents the certificate associated with the user with the following header:\nX-Citrix-AM-ClientCertificateDeclaration: \n\nThe data is the result of exporting the public certificate in one of the following formats: Base64-encoded, DER-encoded X.509 certificate, or a PFX/PKCS12 certificate, before base-64 encoding the resulting data.\n\n\nWire Level\n\n\nThe following  \u201cwire-level\u201d example shows all the HTTP requests and responses when a client attempts to access a protected service (the resources service) and has to obtain security tokens to be granted access.\n\n\nRequest to Service Provider\n\n\nGET https://www.example.com/resources/v2 HTTP/1.1\nHost: www.example.com\nAccept: application/vnd.citrix.resources+xml\n\n\n\n\nResponse from Service Provider\n\n\nHTTP/1.1 401 Unauthorized\nCache-Control: public, no-store, max-age=0\nWWW-Authenticate: CitrixAuth realm=\n6b78ab94-a709-4e3a-8b9b-a49ca317c70c\n,\n                             reqtokentemplate=\n, reason=\nnotoken\n,\n                             locations=\nhttps://www.example.com/Citrix/Authentication/auth/v1/token\n,\n                             serviceroot-hint=https://www.example.com/Citrix/Store/resources/v2\n\n\n\n\nAt this point the client has to take the information provided in the CitrixAuth challenge and construct a Request for Security Token message to be POSTed to the URL specified in the challenge.\n\n\nRequest to Authentication Service\n\n\nPOST https://www.example.com/Citrix/Authentication/auth/v1/token HTTP/1.1\nContent-Type: application/vnd.citrix.requesttoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml, application/vnd.citrix.requesttokenchoices+xml\nContent-Encoding: utf-8\nHost: www.example.com\nContent-Length: xxx\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n?\n\n\nrequesttoken xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/requesttoken\n\n  \nfor-service\n6b78ab94-a709-4e3a-8b9b-a49ca317c70c\n/for-service\n\n  \nfor-service-url\nhttps://www.example.com/Citrix/Store/resources/v2\n/for-service-url\n\n  \nreqtokentemplate /\n\n  \nrequested-lifetime\n1.06:00:00\n/requested-lifetime\n\n\n/requesttoken\n\n\n\n\nResponse from Service Provider\n\n\nHTTP/1.1 401 Unauthorized\nCache-Control: public, no-store, max-age=0\nWWW-Authenticate: CitrixAuth realm=\n32f585f3-054d-4ee5-a714-b0e11e312308\n,\n                     reqtokentemplate=\n, reason=\nnotoken\n   \n                     locations=\nhttps://www.example.com/Citrix/Authentication/auth/v1/protocols\n,\n                     serviceroot-hint=\nhttps://www.example.com/Citrix/Authentication/auth/v1/token\n\n\n\n\nHence, the result of this sequence is another challenge, because the client has not presented the security token required to access the token issuing service. The client must therefore, again, parse the challenge to construct another Request Security Token message and POST it to the indicated Uri, as follows:\n\n\nRequest to Authentication Service\n\n\nPOST https://www.example.com/Citrix/Authentication/auth/v1/protocols HTTP/1.1\nContent-Type: application/vnd.citrix.requesttoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml, application/vnd.citrix.requesttokenchoices+xml\nContent-Encoding: utf-8\nHost: www.example.com\nContent-Length: xxx\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n?\n\n\nrequesttoken xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/requesttoken\n\n  \nfor-service\n32f585f3-054d-4ee5-a714-b0e11e312308\n/for-service\n\n  \nfor-service-url\nhttps://www.example.com/Citrix/Authentication/auth/v1/token\n/for-service-url\n\n  \nreqtokentemplate /\n\n  \nrequested-lifetime\n1.06:00:00\n/requested-lifetime\n\n\n/requesttoken\n\nResponse from Service Provider\nHTTP/1.1 300 Multiple Choices\nCache-Control: public, no-store, max-age=0\nContent-Type: application/vnd.citrix.requesttokenchoices+xml\nContent-Length: xxx\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n?\n\n\nrequesttokenchoices xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/requesttokenchoices\n\n  \nchoices\n\n    \nchoice\n\n      \nprotocol\nExplicitForms\n/protocol\n\n      \nlocation\nhttps://www.example.com/Citrix/Authentication/ExplicitForms/Authenticate\n/location\n\n    \n/choice\n\n    \nchoice\n\n      \nprotocol\nCertificateIdentityDeclaration\n/protocol\n\n      \nlocation\n\n           https://www.example.com/Citrix/Authentication/CertificateIdentityDeclaration\n      \n/location\n\n    \n/choice\n\n  \n/choices\n\n\n/requesttokenchoices\n\n\n\n\nIn this case the authentication service has responded with a HTTP 300 (Multiple Choices) response, indicating that the security token can be obtained from a choice of URIs. In this case, each choice represents a different authentication protocol.\nThe client has been configured with a plug-in that knows how to perform CertificateIdentityDeclaration authentication, and so chooses that method by sending the RST to the specified endpoint, as illustrated below:\n\n\nRequest to Certificate Identity Declaration End-point\n\n\nPOST https://www.example.com/Citrix/Authentication/CertificateIdentityDeclaration HTTP/1.1\nContent-Type: application/vnd.citrix.requesttoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml\nX-Citrix-AM-ClientCertificateDeclaration: \nBase64EncodedData\n\nHost: www.example.com\nContent-Length: xxx\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n?\n\n\nrequesttoken xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/requesttoken\n\n  \nfor-service\n32f585f3-054d-4ee5-a714-b0e11e312308\n/for-service\n\n  \nfor-service-url\nhttps://www.example.com/Citrix/Authentication/auth/v1/token\n/for-service-url\n\n  \nreqtokentemplate /\n\n  \nrequested-lifetime\n1.06:00:00\n/requested-lifetime\n\n\n/requesttoken\n\n\n\n\nIf the certificate represents a valid user, then the server responds with a Request Token Response, as follows:\n\n\nHTTP/1.1 200 OK\nCache-Control: no-cache; private; no-store; must-revalidate; max-stale=0; post-check=0;\n               pre-check=0; max-age=0\nContent-Type: application/vnd.citrix.requesttokenresponse+xml\nContent-Length: xxx\n\n\n?xml version=\n1.0\n encoding=\nutf-8\n?\n\n\nrequesttokenresponse xmlns=\nhttp://citrix.com/delivery-services/1-0/auth/requesttokenresponse\n\n  \nfor-service\n32f585f3-054d-4ee5-a714-b0e11e312308\n/for-service\n\n  \nissued\n2012-06-12T09:50:53.8436039Z\n/issued\n\n  \nexpiry\n2012-06-13T05:50:53.8436039Z\n/expiry\n\n  \nlifetime\n0.20:00:00\n/lifetime\n\n  \ntoken-template /\n\n  \ntoken\nH4sIAAAAAAAEAO29B2AcSZYlJi9tynt/Sv8Id/T8DXarOsQ4AAA==\n/token\n\n  \nCredentialUpdateInformationList xmlns=\nhttp://citrix.com/authentication/response/1\n\n    \nCredentialUpdateInformation\n\n      \nCredentialDisplayName\nexample.com\n/CredentialDisplayName\n\n      \nAuthenticationInfoId\nCitrix Common Forms 1.0\n/AuthenticationInfoId\n\n      \nCredentialUpdateService /\n\n    \n/CredentialUpdateInformation\n\n  \n/CredentialUpdateInformationList\n\n\n/requesttokenresponse\n\n\n\n\nThe client can then use this token to obtain a token to gain access for the resources service.", 
            "title": "Sample Certificate Identity Declaration"
        }, 
        {
            "location": "/sample-certificate-identity-declaration/#overview", 
            "text": "", 
            "title": "Overview"
        }, 
        {
            "location": "/sample-certificate-identity-declaration/#introduction", 
            "text": "This sample for the StoreFront Authentication SDK demonstrates how to create and add a new authentication protocol, CertificateIdentityDeclaration, to StoreFront.\nThis protocol allows a client to send a certificate to the server to identify a user, without providing proof that it has access to the associated private key. The service uses the built-in Kerberos S4U support to map this certificate to an account, verify the account, and extract the group information associated with the account. An identification-level token is then constructed that can be used to launch a session where the user has to fully authenticate to gain access.", 
            "title": "Introduction"
        }, 
        {
            "location": "/sample-certificate-identity-declaration/#installer", 
            "text": "In common with the other samples, a pre-built installer is provided in addition to the source code.\nBefore attempting to deploy the pre-built sample installers, it is required to add the certificate at AuthSDK.zip/Certificates/YourCompany.cer to the Third-Party Root Certification Authorities store of the Local Computer account where StoreFront is installed. This is not required for the development machine. If this step is not completed, then the StoreFront Administration Console will display an error because the digital signature of the PowerShell modules associated with this customization will fail to verify.\nThe installer verifies that there is not an existing customization that implements CertificateIdentityDeclaration before deploying the StoreFront Feature package and the add-ins to the administration console. To actually deploy and enable a sample the \u201cAdd/Remove Methods\u201d action from the \u201cAuthentication\u201d node of the StoreFront Administration Console should be used.\nBefore attempting to uninstall a sample, the associated authentication method must first be removed using the \u201cAdd/Remove Methods\u201d action. If this is not done, attempting to uninstall will result in a dialog informing the administrator that the feature should be removed using the StoreFront Administration Console first. The sample can then be removed by using the standard \u201cAdd/Remove Programs\u201d control panel applet.", 
            "title": "Installer"
        }, 
        {
            "location": "/sample-certificate-identity-declaration/#code-sample", 
            "text": "", 
            "title": "Code Sample"
        }, 
        {
            "location": "/sample-certificate-identity-declaration/#visual-studio-solution-layout", 
            "text": "The Certificate Identity Declaration solution is composed of five projects:   Feature contains the code that will be added to the Authentication Service to control the authentication process, including the ASP.Net MVC Controller that manages the authentication protocol.  Console.Extension contains the code for the administration console, including the data models, action handlers, business logic, and user interface elements.  Installer is a WiX project to create an msi installer to deploy and remove the Certificate Identity Declaration Feature.  Installer.CustomActions contains the msi custom actions required to deploy and remove the Certificate Identity Declaration Feature.  UnitTests contains some simple unit tests to verify the merging of the code into the authentication service, and to verify the behavior of the Service Locator.   This sample does not require any configuration, and so does not contain a configuration project or a StoreFront Administration Console View Extension. It also requires no custom deployment steps or PowerShell commands and so does not have a Feature Installer project.\nAll the projects target the .NET Framework 4.5 and the MSIL platform, unless specifically stated. Projects that target .NET Framework 3.5 are either part of the StoreFront Administration Console, or loaded by the Console. The rationale behind this is discussed in the StoreFront Service Authentication SDK document.", 
            "title": "Visual Studio Solution Layout"
        }, 
        {
            "location": "/sample-certificate-identity-declaration/#feature-project", 
            "text": "This C# class library project contains a new ASP.MVC Controller for handling the HTTP request and response. The protocol specifies a single request/response pattern that is handled by the Declare() method in the Controller, which performs the following:   Verify that the HTTP verb is POST  Verify that the request is an RST  Verify that the client accepts an RSTR response  Verify that the CertificateIdentityDeclaration protocol is enabled  Verify that there is a token-issuing service to issue the token  Verify that a certificate can be extracted from the required header  Use the built-in Kerberos authenticator to validate the certificate  Optionally, log the authentication result  Create and return an RSTR message   In addition, there are classes following the standard pattern for logging and tracing to aid with diagnostics.", 
            "title": "Feature Project"
        }, 
        {
            "location": "/sample-certificate-identity-declaration/#consoleextension-project", 
            "text": "This C# class library project is responsible for:   Providing the localized authentication method name in the StoreFront Administration Console  Providing a single, fixed, status message in the StoreFront Administration Console    Notes  This project is targeted at .NET Framework 3.5, because it will be loaded by the StoreFront Administration Console.", 
            "title": "Console.Extension Project"
        }, 
        {
            "location": "/sample-certificate-identity-declaration/#installer-project", 
            "text": "This WiX project is responsible for the following:\n- Creating the CertificateIdentityDeclaration StoreFront Feature Package\n- Creating an installer to:\n    - Deploy the Feature Package\n    - Deploy the StoreFront Administration Console extension\n    - Update the registry so that the StoreFront Administration Console will load the extension   Notes  This project is targeted at the x64 platform", 
            "title": "Installer Project"
        }, 
        {
            "location": "/sample-certificate-identity-declaration/#installercustomactions-project", 
            "text": "This C# class library project uses the standard pattern, as described in the StoreFront Authentication SDK document, with the Feature identifier and Authentication Protocol Name set to appropriate values for this customization.   Notes   This project is targeted at .NET Framework 3.5.  This project is targeted at the x64 platform to ensure that it has access to the correct registry locations.", 
            "title": "Installer.CustomActions Project"
        }, 
        {
            "location": "/sample-certificate-identity-declaration/#unit-tests-project", 
            "text": "This project contains standard: web.config merge and unmerge, route, and protocol choice tests, in addition to tests of the protocol in terms of HTTP request and responses.", 
            "title": "Unit Tests Project"
        }, 
        {
            "location": "/sample-certificate-identity-declaration/#protocol", 
            "text": "This section describes the HTTP-based protocol to use to declare a user identity with a certificate.", 
            "title": "Protocol"
        }, 
        {
            "location": "/sample-certificate-identity-declaration/#end-point", 
            "text": "URL: /CertificateIdentityDeclaration  HTTP Method: POST  Authentication: None  Request Content-Type: application/vnd.citrix.requesttoken+xml  Response Content-Type: application/vnd.citrix.requesttokenresponse+xml   The client presents the certificate associated with the user with the following header:\nX-Citrix-AM-ClientCertificateDeclaration:  \nThe data is the result of exporting the public certificate in one of the following formats: Base64-encoded, DER-encoded X.509 certificate, or a PFX/PKCS12 certificate, before base-64 encoding the resulting data.", 
            "title": "End Point"
        }, 
        {
            "location": "/sample-certificate-identity-declaration/#wire-level", 
            "text": "The following  \u201cwire-level\u201d example shows all the HTTP requests and responses when a client attempts to access a protected service (the resources service) and has to obtain security tokens to be granted access.  Request to Service Provider  GET https://www.example.com/resources/v2 HTTP/1.1\nHost: www.example.com\nAccept: application/vnd.citrix.resources+xml  Response from Service Provider  HTTP/1.1 401 Unauthorized\nCache-Control: public, no-store, max-age=0\nWWW-Authenticate: CitrixAuth realm= 6b78ab94-a709-4e3a-8b9b-a49ca317c70c ,\n                             reqtokentemplate= , reason= notoken ,\n                             locations= https://www.example.com/Citrix/Authentication/auth/v1/token ,\n                             serviceroot-hint=https://www.example.com/Citrix/Store/resources/v2  At this point the client has to take the information provided in the CitrixAuth challenge and construct a Request for Security Token message to be POSTed to the URL specified in the challenge.  Request to Authentication Service  POST https://www.example.com/Citrix/Authentication/auth/v1/token HTTP/1.1\nContent-Type: application/vnd.citrix.requesttoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml, application/vnd.citrix.requesttokenchoices+xml\nContent-Encoding: utf-8\nHost: www.example.com\nContent-Length: xxx ?xml version= 1.0  encoding= utf-8 ?  requesttoken xmlns= http://citrix.com/delivery-services/1-0/auth/requesttoken \n   for-service 6b78ab94-a709-4e3a-8b9b-a49ca317c70c /for-service \n   for-service-url https://www.example.com/Citrix/Store/resources/v2 /for-service-url \n   reqtokentemplate / \n   requested-lifetime 1.06:00:00 /requested-lifetime  /requesttoken  Response from Service Provider  HTTP/1.1 401 Unauthorized\nCache-Control: public, no-store, max-age=0\nWWW-Authenticate: CitrixAuth realm= 32f585f3-054d-4ee5-a714-b0e11e312308 ,\n                     reqtokentemplate= , reason= notoken    \n                     locations= https://www.example.com/Citrix/Authentication/auth/v1/protocols ,\n                     serviceroot-hint= https://www.example.com/Citrix/Authentication/auth/v1/token  Hence, the result of this sequence is another challenge, because the client has not presented the security token required to access the token issuing service. The client must therefore, again, parse the challenge to construct another Request Security Token message and POST it to the indicated Uri, as follows:  Request to Authentication Service  POST https://www.example.com/Citrix/Authentication/auth/v1/protocols HTTP/1.1\nContent-Type: application/vnd.citrix.requesttoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml, application/vnd.citrix.requesttokenchoices+xml\nContent-Encoding: utf-8\nHost: www.example.com\nContent-Length: xxx ?xml version= 1.0  encoding= utf-8 ?  requesttoken xmlns= http://citrix.com/delivery-services/1-0/auth/requesttoken \n   for-service 32f585f3-054d-4ee5-a714-b0e11e312308 /for-service \n   for-service-url https://www.example.com/Citrix/Authentication/auth/v1/token /for-service-url \n   reqtokentemplate / \n   requested-lifetime 1.06:00:00 /requested-lifetime  /requesttoken \nResponse from Service Provider\nHTTP/1.1 300 Multiple Choices\nCache-Control: public, no-store, max-age=0\nContent-Type: application/vnd.citrix.requesttokenchoices+xml\nContent-Length: xxx ?xml version= 1.0  encoding= utf-8 ?  requesttokenchoices xmlns= http://citrix.com/delivery-services/1-0/auth/requesttokenchoices \n   choices \n     choice \n       protocol ExplicitForms /protocol \n       location https://www.example.com/Citrix/Authentication/ExplicitForms/Authenticate /location \n     /choice \n     choice \n       protocol CertificateIdentityDeclaration /protocol \n       location \n           https://www.example.com/Citrix/Authentication/CertificateIdentityDeclaration\n       /location \n     /choice \n   /choices  /requesttokenchoices  In this case the authentication service has responded with a HTTP 300 (Multiple Choices) response, indicating that the security token can be obtained from a choice of URIs. In this case, each choice represents a different authentication protocol.\nThe client has been configured with a plug-in that knows how to perform CertificateIdentityDeclaration authentication, and so chooses that method by sending the RST to the specified endpoint, as illustrated below:  Request to Certificate Identity Declaration End-point  POST https://www.example.com/Citrix/Authentication/CertificateIdentityDeclaration HTTP/1.1\nContent-Type: application/vnd.citrix.requesttoken+xml\nAccept: application/vnd.citrix.requesttokenresponse+xml\nX-Citrix-AM-ClientCertificateDeclaration:  Base64EncodedData \nHost: www.example.com\nContent-Length: xxx ?xml version= 1.0  encoding= utf-8 ?  requesttoken xmlns= http://citrix.com/delivery-services/1-0/auth/requesttoken \n   for-service 32f585f3-054d-4ee5-a714-b0e11e312308 /for-service \n   for-service-url https://www.example.com/Citrix/Authentication/auth/v1/token /for-service-url \n   reqtokentemplate / \n   requested-lifetime 1.06:00:00 /requested-lifetime  /requesttoken  If the certificate represents a valid user, then the server responds with a Request Token Response, as follows:  HTTP/1.1 200 OK\nCache-Control: no-cache; private; no-store; must-revalidate; max-stale=0; post-check=0;\n               pre-check=0; max-age=0\nContent-Type: application/vnd.citrix.requesttokenresponse+xml\nContent-Length: xxx ?xml version= 1.0  encoding= utf-8 ?  requesttokenresponse xmlns= http://citrix.com/delivery-services/1-0/auth/requesttokenresponse \n   for-service 32f585f3-054d-4ee5-a714-b0e11e312308 /for-service \n   issued 2012-06-12T09:50:53.8436039Z /issued \n   expiry 2012-06-13T05:50:53.8436039Z /expiry \n   lifetime 0.20:00:00 /lifetime \n   token-template / \n   token H4sIAAAAAAAEAO29B2AcSZYlJi9tynt/Sv8Id/T8DXarOsQ4AAA== /token \n   CredentialUpdateInformationList xmlns= http://citrix.com/authentication/response/1 \n     CredentialUpdateInformation \n       CredentialDisplayName example.com /CredentialDisplayName \n       AuthenticationInfoId Citrix Common Forms 1.0 /AuthenticationInfoId \n       CredentialUpdateService / \n     /CredentialUpdateInformation \n   /CredentialUpdateInformationList  /requesttokenresponse  The client can then use this token to obtain a token to gain access for the resources service.", 
            "title": "Wire Level"
        }, 
        {
            "location": "/magic-word-sample/", 
            "text": "Overview\n\n\nIntroduction\n\n\nThis sample for the StoreFront Authentication SDK demonstrates how to create and add a custom form implementation to StoreFront. As described in the StoreFront Services Authentication SDK document, this protocol will be advertised to the clients as: CustomForms. The clients are required to recognize this protocol identifier and map it to their existing Common Forms rendering. Clients will give preference to this new protocol over the existing ExplicitForms protocol, should both be available.\n\n\n\n\nNote\n\n\nOnly one authentication method can be deployed that advertises itself with a specific protocol choice name. Because Forms customizations rely on being advertised as CustomForms, this means that only one Forms customization can be installed on a StoreFront server.\n\n\n\n\nThis sample is a simple two-factor authentication protocol where the user has to supply both their password and a fixed \u201cmagic word\u201d, as illustrated below in Receiver for Windows: \n\n\n\n\n\n\nThe sample also demonstrates:\n\n\n\n\nHow to extend the StoreFront Administration Console to add an action item that displays User Interface elements for configuring the protocol properties\n\n\nHow to configure the \u201cMagic Word\u201d that users must supply, and whether or not the protocol is split over two forms or displayed as a single form.\n\n\n\n\nIf the StoreFront Administration Console is opened after deploying this sample, selecting the \u201cAdd/Remove Methods\u201d action for the Authentication node, the following is displayed, including the \u201cMagic Word\u201d authentication method:\n\n\n\n\nSelecting the \u201cUser name, password, and magic word\u201d method will deploy and enable the method. Selecting the method in the console displays the actions associated with the method.\n\n\n\n\nThe required \u201cmagic word\u201d settings can be configured by selecting the Manage Magic Word action item in the context area for this authentication method, which brings up the following dialog:\n\n\n\n\nInstaller\n\n\nIn common with the other samples, a pre-built installer is provided in addition to the source code.\n\n\nBefore attempting to deploy the pre-built sample installers, it is required to add the certificate at AuthSDK.zip/Certificates/YourCompany.cer to the Third-Party Root Certification Authorities store of the Local Computer account where StoreFront is installed. This is not required for the development machine. If this step is not completed, then the StoreFront Administration Console will display an error because the digital signature of the PowerShell modules associated with this customization will fail to verify.\n\n\nThe installer verifies that there is not an existing customization that implements CustomForms before deploying the StoreFront Feature package and the add-ins to the administration console. To actually deploy and enable a sample the \u201cAdd/Remove Methods\u201d action from the \u201cAuthentication\u201d node of the StoreFront Administration Console should be used.\n\n\n\n\nNote\n\n\nIf the installer is being deployed to a StoreFront Server Group, it must be run on all servers in the group.\n\n\n\n\nBefore attempting to uninstall a sample, the associated authentication method must first be removed using the \u201cAdd/Remove Methods\u201d action. If this is not done, attempting to uninstall will result in a dialog informing the administratorthat the feature should be removed using the StoreFront Administration Console first. The sample can then be removed by using the standard \u201cAdd/Remove Programs\u201d control panel applet.\n\n\nCode Sample\n\n\nVisual Studio Solution Layout\n\n\nThis sample demonstrates as many aspects of the SDK as possible, and is composed of seven projects:\n\n\n\n\nConfiguration contains the configuration section, the parser for the settings, and the object to hold the settings\n\n\nFeature contains the code that will be added to the Authentication Service to control the authentication process, including:\n\n\nA custom conversation object and its associated factory\n\n\nCustom forms and templates for both the single and multi-page variants\n\n\nThe start-up module used to populate the IoC container\n\n\nA helper for event log messages\n\n\n\n\n\n\nFeatureInstaller contains the following:\n\n\nA custom feature instance to demonstrate how to add custom steps during deployment\n\n\nA demonstration of how to create a PowerShell command, and how to register the PowerShell snap-in\n\n\n\n\n\n\nConsole.Extension contains the code for the administration console, including the data models, action handlers, business logic, and user interface elements.\n\n\nInstaller is a WiX project to create an msi installer to deploy and remove the Magic Word Feature. It also contains the StoreFront Feature Package definition and builds the Feature Package.\n\n\nInstaller.CustomActions contains the msi custom actions required to deploy and remove the Magic Word Feature.\n\n\nUnitTests contains some unit tests to verify the merging of the code and configuration into the authentication service, verify the behavior of the Service Locator, and verify the behavior of the authentication conversation.\n\n\n\n\nAll the projects target the .NET Framework 4.5 and the MSIL platform, unless specifically stated. Projects that target .NET Framework 3.5 are either part of the StoreFront Administration Console, or loaded by the Console. The rationale behind this is discussed in the StoreFront Services Authentication SDK document.\n\n\nConfiguration Project\n\n\nThis C# class library project follows the standard pattern for a StoreFront configuration project and contains:\n\n\n\n\nA configuration section that controls how the settings are read from the Authentication Service web.config file\n\n\nA parser object that parses the configuration section and generates a settings object\n\n\nThe settings object\n\n\n\n\n\n\nNote\n\n\n\n\nThis project is targeted at .NET Framework 3.5, because it will be used by the StoreFront PowerShell Configuration Provider, which is used by the StoreFront Administration Console. See the StoreFront Services Authentication SDK document for more information.\n\n\nIn order for the StoreFront PowerShell Configuration Provider to be able to load the configuration section, this assembly must be placed in the .NET Global Assembly Cache, and so must be strongly named.\n\n\n\n\n\n\nFeature Project\n\n\nThis C# class library project contains the custom classes for controlling the forms conversation; see the StoreFront Authentication Form Generation document for more details. These classes include:\n\n\n\n\nThe custom conversation and its associated factory\n\n\nCustom forms and templates for both the single and multi-page variants required by this conversation\n\n\n\n\nThe project also contains the start-up module that is responsible for populating the IoC container with the objects required for this custom conversation. See the StoreFront Services Authentication SDK document for more details regarding start-up modules. This start-up module adds the following:\n\n\n\n\nThe parsed settings object\n\n\nThe conversation factory\n\n\n\n\nIn addition, there is a class following the standard pattern for logging to aid with diagnostics.\n\n\nConsole.Extension Project\n\n\nThis C# class library project contains:\n- The authentication extension class to provide status messages including:\n    - Stating that this customization will take precedence over user name and password\n    - Optionally a message stating that Delegated Forms Authentication is available, and demonstrating how to have a link in a status message, in this case to the Delegated Forms Authentication read-me document.\n    - Optionally a message stating that the Delegated Forms Authentication is not using this custom conversation, and providing a link to set Delegated Forms to use this conversation\n- The view extension class to add the following Actions:\n    - The built-in action to manage change password options\n    - The built-in action to manage trusted domains\n    - The custom action to manage the settings for this customization\n- The User Interface elements required for managing the settings, including the xaml and view model\n- The PowerShell commands in a module for managing the settings\n- The business logic object and the associated data model that utilizes the PowerShell\n- The localizer class to provide the localized authentication method name in the StoreFront Administration Console\n\n\n\n\nNote\n\n\nThis project is targeted at .NET Framework 3.5, because it will be loaded by the StoreFront Administration Console.\n\n\n\n\nInstaller Project\n\n\nThis WiX project is responsible for the following:\n\n\n\n\nCreating the Magic Word StoreFront Feature Package\n\n\nCreating an installer to:\n\n\nDeploy the Feature Package\n\n\nDeploy the StoreFront Administration Console extension\n\n\nUpdate the registry so that the StoreFront Administration Console will load the extension\n\n\n\n\n\n\n\n\nNote: This project is targeted at the x64 platform\n\n\nInstaller.CustomActions Project\n\n\nThis C# class library project uses the standard pattern, as described in the StoreFront Authentication SDK document, with the Feature identifier and Authentication Protocol Name set to appropriate values for this customization.\n\n\n\n\nNote\n\n\n\n\nThis project is targeted at .NET Framework 3.5.\n\n\nThis project is targeted at the x64 platform to ensure that it has access to the correct registry locations.\n\n\n\n\n\n\nUnit Tests Project\n\n\nThis project contains standard web.config merge and unmerge, route, and protocol choice tests, in addition to tests of the entire conversation including changing expired password and error cases.", 
            "title": "Sample Magic Word"
        }, 
        {
            "location": "/magic-word-sample/#overview", 
            "text": "", 
            "title": "Overview"
        }, 
        {
            "location": "/magic-word-sample/#introduction", 
            "text": "This sample for the StoreFront Authentication SDK demonstrates how to create and add a custom form implementation to StoreFront. As described in the StoreFront Services Authentication SDK document, this protocol will be advertised to the clients as: CustomForms. The clients are required to recognize this protocol identifier and map it to their existing Common Forms rendering. Clients will give preference to this new protocol over the existing ExplicitForms protocol, should both be available.   Note  Only one authentication method can be deployed that advertises itself with a specific protocol choice name. Because Forms customizations rely on being advertised as CustomForms, this means that only one Forms customization can be installed on a StoreFront server.   This sample is a simple two-factor authentication protocol where the user has to supply both their password and a fixed \u201cmagic word\u201d, as illustrated below in Receiver for Windows:     The sample also demonstrates:   How to extend the StoreFront Administration Console to add an action item that displays User Interface elements for configuring the protocol properties  How to configure the \u201cMagic Word\u201d that users must supply, and whether or not the protocol is split over two forms or displayed as a single form.   If the StoreFront Administration Console is opened after deploying this sample, selecting the \u201cAdd/Remove Methods\u201d action for the Authentication node, the following is displayed, including the \u201cMagic Word\u201d authentication method:   Selecting the \u201cUser name, password, and magic word\u201d method will deploy and enable the method. Selecting the method in the console displays the actions associated with the method.   The required \u201cmagic word\u201d settings can be configured by selecting the Manage Magic Word action item in the context area for this authentication method, which brings up the following dialog:", 
            "title": "Introduction"
        }, 
        {
            "location": "/magic-word-sample/#installer", 
            "text": "In common with the other samples, a pre-built installer is provided in addition to the source code.  Before attempting to deploy the pre-built sample installers, it is required to add the certificate at AuthSDK.zip/Certificates/YourCompany.cer to the Third-Party Root Certification Authorities store of the Local Computer account where StoreFront is installed. This is not required for the development machine. If this step is not completed, then the StoreFront Administration Console will display an error because the digital signature of the PowerShell modules associated with this customization will fail to verify.  The installer verifies that there is not an existing customization that implements CustomForms before deploying the StoreFront Feature package and the add-ins to the administration console. To actually deploy and enable a sample the \u201cAdd/Remove Methods\u201d action from the \u201cAuthentication\u201d node of the StoreFront Administration Console should be used.   Note  If the installer is being deployed to a StoreFront Server Group, it must be run on all servers in the group.   Before attempting to uninstall a sample, the associated authentication method must first be removed using the \u201cAdd/Remove Methods\u201d action. If this is not done, attempting to uninstall will result in a dialog informing the administratorthat the feature should be removed using the StoreFront Administration Console first. The sample can then be removed by using the standard \u201cAdd/Remove Programs\u201d control panel applet.", 
            "title": "Installer"
        }, 
        {
            "location": "/magic-word-sample/#code-sample", 
            "text": "", 
            "title": "Code Sample"
        }, 
        {
            "location": "/magic-word-sample/#visual-studio-solution-layout", 
            "text": "This sample demonstrates as many aspects of the SDK as possible, and is composed of seven projects:   Configuration contains the configuration section, the parser for the settings, and the object to hold the settings  Feature contains the code that will be added to the Authentication Service to control the authentication process, including:  A custom conversation object and its associated factory  Custom forms and templates for both the single and multi-page variants  The start-up module used to populate the IoC container  A helper for event log messages    FeatureInstaller contains the following:  A custom feature instance to demonstrate how to add custom steps during deployment  A demonstration of how to create a PowerShell command, and how to register the PowerShell snap-in    Console.Extension contains the code for the administration console, including the data models, action handlers, business logic, and user interface elements.  Installer is a WiX project to create an msi installer to deploy and remove the Magic Word Feature. It also contains the StoreFront Feature Package definition and builds the Feature Package.  Installer.CustomActions contains the msi custom actions required to deploy and remove the Magic Word Feature.  UnitTests contains some unit tests to verify the merging of the code and configuration into the authentication service, verify the behavior of the Service Locator, and verify the behavior of the authentication conversation.   All the projects target the .NET Framework 4.5 and the MSIL platform, unless specifically stated. Projects that target .NET Framework 3.5 are either part of the StoreFront Administration Console, or loaded by the Console. The rationale behind this is discussed in the StoreFront Services Authentication SDK document.", 
            "title": "Visual Studio Solution Layout"
        }, 
        {
            "location": "/magic-word-sample/#configuration-project", 
            "text": "This C# class library project follows the standard pattern for a StoreFront configuration project and contains:   A configuration section that controls how the settings are read from the Authentication Service web.config file  A parser object that parses the configuration section and generates a settings object  The settings object    Note   This project is targeted at .NET Framework 3.5, because it will be used by the StoreFront PowerShell Configuration Provider, which is used by the StoreFront Administration Console. See the StoreFront Services Authentication SDK document for more information.  In order for the StoreFront PowerShell Configuration Provider to be able to load the configuration section, this assembly must be placed in the .NET Global Assembly Cache, and so must be strongly named.", 
            "title": "Configuration Project"
        }, 
        {
            "location": "/magic-word-sample/#feature-project", 
            "text": "This C# class library project contains the custom classes for controlling the forms conversation; see the StoreFront Authentication Form Generation document for more details. These classes include:   The custom conversation and its associated factory  Custom forms and templates for both the single and multi-page variants required by this conversation   The project also contains the start-up module that is responsible for populating the IoC container with the objects required for this custom conversation. See the StoreFront Services Authentication SDK document for more details regarding start-up modules. This start-up module adds the following:   The parsed settings object  The conversation factory   In addition, there is a class following the standard pattern for logging to aid with diagnostics.", 
            "title": "Feature Project"
        }, 
        {
            "location": "/magic-word-sample/#consoleextension-project", 
            "text": "This C# class library project contains:\n- The authentication extension class to provide status messages including:\n    - Stating that this customization will take precedence over user name and password\n    - Optionally a message stating that Delegated Forms Authentication is available, and demonstrating how to have a link in a status message, in this case to the Delegated Forms Authentication read-me document.\n    - Optionally a message stating that the Delegated Forms Authentication is not using this custom conversation, and providing a link to set Delegated Forms to use this conversation\n- The view extension class to add the following Actions:\n    - The built-in action to manage change password options\n    - The built-in action to manage trusted domains\n    - The custom action to manage the settings for this customization\n- The User Interface elements required for managing the settings, including the xaml and view model\n- The PowerShell commands in a module for managing the settings\n- The business logic object and the associated data model that utilizes the PowerShell\n- The localizer class to provide the localized authentication method name in the StoreFront Administration Console   Note  This project is targeted at .NET Framework 3.5, because it will be loaded by the StoreFront Administration Console.", 
            "title": "Console.Extension Project"
        }, 
        {
            "location": "/magic-word-sample/#installer-project", 
            "text": "This WiX project is responsible for the following:   Creating the Magic Word StoreFront Feature Package  Creating an installer to:  Deploy the Feature Package  Deploy the StoreFront Administration Console extension  Update the registry so that the StoreFront Administration Console will load the extension     Note: This project is targeted at the x64 platform", 
            "title": "Installer Project"
        }, 
        {
            "location": "/magic-word-sample/#installercustomactions-project", 
            "text": "This C# class library project uses the standard pattern, as described in the StoreFront Authentication SDK document, with the Feature identifier and Authentication Protocol Name set to appropriate values for this customization.   Note   This project is targeted at .NET Framework 3.5.  This project is targeted at the x64 platform to ensure that it has access to the correct registry locations.", 
            "title": "Installer.CustomActions Project"
        }, 
        {
            "location": "/magic-word-sample/#unit-tests-project", 
            "text": "This project contains standard web.config merge and unmerge, route, and protocol choice tests, in addition to tests of the entire conversation including changing expired password and error cases.", 
            "title": "Unit Tests Project"
        }, 
        {
            "location": "/sample-test-forms/", 
            "text": "Sample: Test Forms\n\n\nOverview\n\n\nIntroduction\n\n\nThis sample for the StoreFront Authentication SDK demonstrates how to create and add a custom form implementation to StoreFront. As described in the StoreFront Services Authentication SDK document, this protocol will be advertised to the clients as: CustomForms. The clients are required to recognize this protocol identifier and map it to their existing Common Forms rendering. Clients will give preference to this new protocol over the existing ExplicitForms protocol, should both be available.\n\n\n\n\nNote\n\n\nOnly one authentication method can be deployed that advertises itself with a specific protocol choice name. As Forms customizations rely on being advertised as CustomForms, this means that only one Forms customization can be installed on a StoreFront server.\n\n\n\n\nTest Forms is a simple implementation of the Forms Protocol that runs through a sequence of pre-configured forms to demonstrate all the User Interface Widgets that are currently part of the Common Forms Language. There is no processing of the returned forms data: the next form is just displayed. At the end of the test forms, the user is offered the chance to log on using the built-in user name and password form.\n\n\nThe following shows how the sequence of forms is displayed in Receiver for Web:\n\n\nFirst an information message is displayed:\n\n\n\n\nNext a series of tests are done and the results displayed:\n\n\n\n\nThe next form demonstrates display and input of textual data:\n\n\n\n\nThis is followed by a form illustrating the other user interface elements:\n\n\n\n\nFinally the user is offered the chance to log on using the built-in user name and password form:\n\n\n\n\nIf the configuration has been updated to allow the user to change their expired password, and the user\u2019s password has expired, then the change password mini-conversation begins:\n\n\n\n\nWhen the user has successfully changed their password, they are granted access to the system.\n\n\nThe sample demonstrates how to extend the StoreFront Administration Console to enable the administrator to add this new authentication method.\n\n\nWhen the \u201cAdd/Remove Methods\u201d action is selected, the \u201cTest Forms\u201d authentication method is available to be added, as follows:\n\n\n\n\nSelecting the \u201cTest Generic Forms\u201d method will deploy and enable the method. Selecting the method in the console displays the actions and status messages associated with the method.\n\n\n\n\nInstaller\n\n\nIn common with the other samples, a pre-built installer is provided in addition to the source code.\n\n\nBefore attempting to deploy the pre-built sample installers, it is required to add the certificate at AuthSDK.zip/Certificates/YourCompany.cer to the Third-Party Root Certification Authorities store of the Local Computer account where StoreFront is installed. This is not required for the development machine. If this step is not completed, then the StoreFront Administration Console will display an error because the digital signature of the PowerShell modules associated with this customization will fail to verify.\n\n\nThe installer verifies that there is not an existing customization that implements CustomForms, before deploying the StoreFront Feature package and the add-ins to the administration console. To actually deploy and enable a sample the \u201cAdd/Remove Methods\u201d action from the \u201cAuthentication\u201d node of the StoreFront Administration Console should be used.\n\n\n\n\nNote\n\n\nIf the installer is being deployed to a StoreFront Server Group, it must be run on all servers in the group.\n\n\n\n\nBefore attempting to uninstall a sample, the associated authentication method must first be removed using the \u201cAdd/Remove Methods\u201d action. If this is not done, attempting to uninstall will result in a dialog informing the administrator that the feature should be removed using the StoreFront Administration Console first. The sample can then be removed by using the standard \u201cAdd/Remove Programs\u201d control panel applet.\n\n\nCode Sample\n\n\nVisual Studio Solution Layout\n\n\nThis sample demonstrates a subset of the available aspects of the SDK, and is composed of five projects:\n\n\n\n\nFeature contains the code that will be added to the Authentication Service to control the authentication process, including:\n\n\nA custom conversation object and its associated factory\n\n\nCustom forms and templates for the individual forms\n\n\nThe start-up module used to populate the IoC container\n\n\n\n\n\n\nConsole.Extension contains the code for the administration console, including the data models, action handlers, business logic, and user interface elements.\n\n\nInstaller is a WiX project to create an msi installer to deploy and remove the Test Forms Feature. It also contains the StoreFront Feature Package definition and builds the Feature Package.\n\n\nInstaller.CustomActions contains the msi custom actions required to deploy and remove the Test Forms Feature.\n\n\nUnitTests contains some unit tests to verify the merging of the code and configuration into the authentication service, verify the behavior of the Service Locator, and verify the behavior of the authentication conversation.\n\n\n\n\nThis sample does not require any configuration, and so does not contain a configuration project or a StoreFront Administration Console View Extension. It also requires no custom deployment steps or PowerShell commands and so does not have a Feature Installer project.\n\n\nAll the projects target the .NET Framework 4.5 and the MSIL platform, unless specifically stated. Projects that target .NET Framework 3.5 are either part of the StoreFront Administration Console, or loaded by the Console. The rationale behind this is discussed in the StoreFront Services Authentication SDK document.\n\n\nFeature Project\n\n\nThis C# class library project contains the custom classes for controlling the forms conversation; see the StoreFront Authentication Form Generation document for more details. These classes include:\n\n\n\n\nThe custom conversation and its associated factory\n\n\nCustom forms and templates for the individual forms that comprise the conversation\n\n\n\n\nThe project also contains the start-up module that is responsible for populating the IoC container with the objects required for this custom conversation. See the StoreFront Services Authentication SDK document for more details regarding start-up modules. This start-up module adds the conversation factory.\n\n\nConsole.Extension Project\n\n\nThis C# class library project contains:\n\n\n\n\nNote\n\n\nThis project is targeted at .NET Framework 3.5, because it will be loaded by the StoreFront Administration Console.\n\n\n\n\nInstaller Project\n\n\nThis WiX project is responsible for the following:\n\n\n\n\nCreating the Test Forms StoreFront Feature Package\n\n\nCreating an installer to:\n\n\nDeploy the Feature Package\n\n\nDeploy the StoreFront Administration Console extension\n\n\nUpdate the registry so that the StoreFront Administration Console will load the extension\nNote: This project is targeted at the x64 platform.\n\n\n\n\n\n\n\n\nInstaller.CustomActions Project\n\n\nThis C# class library project uses the standard pattern, as described in the StoreFront Authentication SDK document, with the Feature identifier and Authentication Protocol Name set to appropriate values for this customization.\n\n\n\n\nNote\n\n\n\n\nThis project is targeted at .NET Framework 3.5.\n\n\nThis project is targeted at the x64 platform to ensure that it has access to the correct registry locations.\n\n\n\n\n\n\nUnit Tests Project\n\n\nThis project contains standard web.config merge and unmerge, route, and protocol choice tests, in addition to tests of the entire conversation including cancel and error cases.", 
            "title": "Sample Test Forms"
        }, 
        {
            "location": "/sample-test-forms/#sample-test-forms", 
            "text": "", 
            "title": "Sample: Test Forms"
        }, 
        {
            "location": "/sample-test-forms/#overview", 
            "text": "", 
            "title": "Overview"
        }, 
        {
            "location": "/sample-test-forms/#introduction", 
            "text": "This sample for the StoreFront Authentication SDK demonstrates how to create and add a custom form implementation to StoreFront. As described in the StoreFront Services Authentication SDK document, this protocol will be advertised to the clients as: CustomForms. The clients are required to recognize this protocol identifier and map it to their existing Common Forms rendering. Clients will give preference to this new protocol over the existing ExplicitForms protocol, should both be available.   Note  Only one authentication method can be deployed that advertises itself with a specific protocol choice name. As Forms customizations rely on being advertised as CustomForms, this means that only one Forms customization can be installed on a StoreFront server.   Test Forms is a simple implementation of the Forms Protocol that runs through a sequence of pre-configured forms to demonstrate all the User Interface Widgets that are currently part of the Common Forms Language. There is no processing of the returned forms data: the next form is just displayed. At the end of the test forms, the user is offered the chance to log on using the built-in user name and password form.  The following shows how the sequence of forms is displayed in Receiver for Web:  First an information message is displayed:   Next a series of tests are done and the results displayed:   The next form demonstrates display and input of textual data:   This is followed by a form illustrating the other user interface elements:   Finally the user is offered the chance to log on using the built-in user name and password form:   If the configuration has been updated to allow the user to change their expired password, and the user\u2019s password has expired, then the change password mini-conversation begins:   When the user has successfully changed their password, they are granted access to the system.  The sample demonstrates how to extend the StoreFront Administration Console to enable the administrator to add this new authentication method.  When the \u201cAdd/Remove Methods\u201d action is selected, the \u201cTest Forms\u201d authentication method is available to be added, as follows:   Selecting the \u201cTest Generic Forms\u201d method will deploy and enable the method. Selecting the method in the console displays the actions and status messages associated with the method.", 
            "title": "Introduction"
        }, 
        {
            "location": "/sample-test-forms/#installer", 
            "text": "In common with the other samples, a pre-built installer is provided in addition to the source code.  Before attempting to deploy the pre-built sample installers, it is required to add the certificate at AuthSDK.zip/Certificates/YourCompany.cer to the Third-Party Root Certification Authorities store of the Local Computer account where StoreFront is installed. This is not required for the development machine. If this step is not completed, then the StoreFront Administration Console will display an error because the digital signature of the PowerShell modules associated with this customization will fail to verify.  The installer verifies that there is not an existing customization that implements CustomForms, before deploying the StoreFront Feature package and the add-ins to the administration console. To actually deploy and enable a sample the \u201cAdd/Remove Methods\u201d action from the \u201cAuthentication\u201d node of the StoreFront Administration Console should be used.   Note  If the installer is being deployed to a StoreFront Server Group, it must be run on all servers in the group.   Before attempting to uninstall a sample, the associated authentication method must first be removed using the \u201cAdd/Remove Methods\u201d action. If this is not done, attempting to uninstall will result in a dialog informing the administrator that the feature should be removed using the StoreFront Administration Console first. The sample can then be removed by using the standard \u201cAdd/Remove Programs\u201d control panel applet.", 
            "title": "Installer"
        }, 
        {
            "location": "/sample-test-forms/#code-sample", 
            "text": "", 
            "title": "Code Sample"
        }, 
        {
            "location": "/sample-test-forms/#visual-studio-solution-layout", 
            "text": "This sample demonstrates a subset of the available aspects of the SDK, and is composed of five projects:   Feature contains the code that will be added to the Authentication Service to control the authentication process, including:  A custom conversation object and its associated factory  Custom forms and templates for the individual forms  The start-up module used to populate the IoC container    Console.Extension contains the code for the administration console, including the data models, action handlers, business logic, and user interface elements.  Installer is a WiX project to create an msi installer to deploy and remove the Test Forms Feature. It also contains the StoreFront Feature Package definition and builds the Feature Package.  Installer.CustomActions contains the msi custom actions required to deploy and remove the Test Forms Feature.  UnitTests contains some unit tests to verify the merging of the code and configuration into the authentication service, verify the behavior of the Service Locator, and verify the behavior of the authentication conversation.   This sample does not require any configuration, and so does not contain a configuration project or a StoreFront Administration Console View Extension. It also requires no custom deployment steps or PowerShell commands and so does not have a Feature Installer project.  All the projects target the .NET Framework 4.5 and the MSIL platform, unless specifically stated. Projects that target .NET Framework 3.5 are either part of the StoreFront Administration Console, or loaded by the Console. The rationale behind this is discussed in the StoreFront Services Authentication SDK document.", 
            "title": "Visual Studio Solution Layout"
        }, 
        {
            "location": "/sample-test-forms/#feature-project", 
            "text": "This C# class library project contains the custom classes for controlling the forms conversation; see the StoreFront Authentication Form Generation document for more details. These classes include:   The custom conversation and its associated factory  Custom forms and templates for the individual forms that comprise the conversation   The project also contains the start-up module that is responsible for populating the IoC container with the objects required for this custom conversation. See the StoreFront Services Authentication SDK document for more details regarding start-up modules. This start-up module adds the conversation factory.", 
            "title": "Feature Project"
        }, 
        {
            "location": "/sample-test-forms/#consoleextension-project", 
            "text": "This C# class library project contains:   Note  This project is targeted at .NET Framework 3.5, because it will be loaded by the StoreFront Administration Console.", 
            "title": "Console.Extension Project"
        }, 
        {
            "location": "/sample-test-forms/#installer-project", 
            "text": "This WiX project is responsible for the following:   Creating the Test Forms StoreFront Feature Package  Creating an installer to:  Deploy the Feature Package  Deploy the StoreFront Administration Console extension  Update the registry so that the StoreFront Administration Console will load the extension\nNote: This project is targeted at the x64 platform.", 
            "title": "Installer Project"
        }, 
        {
            "location": "/sample-test-forms/#installercustomactions-project", 
            "text": "This C# class library project uses the standard pattern, as described in the StoreFront Authentication SDK document, with the Feature identifier and Authentication Protocol Name set to appropriate values for this customization.   Note   This project is targeted at .NET Framework 3.5.  This project is targeted at the x64 platform to ensure that it has access to the correct registry locations.", 
            "title": "Installer.CustomActions Project"
        }, 
        {
            "location": "/sample-test-forms/#unit-tests-project", 
            "text": "This project contains standard web.config merge and unmerge, route, and protocol choice tests, in addition to tests of the entire conversation including cancel and error cases.", 
            "title": "Unit Tests Project"
        }
    ]
}